var Zg=h=>{throw TypeError(h)};var eh=(h,t,i)=>t.has(h)||Zg("Cannot "+i);var te=(h,t,i)=>(eh(h,t,"read from private field"),i?i.call(h):t.get(h)),Fi=(h,t,i)=>t.has(h)?Zg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,i),qe=(h,t,i,s)=>(eh(h,t,"write to private field"),s?s.call(h,i):t.set(h,i),i),zi=(h,t,i)=>(eh(h,t,"access private method"),i);var Jg=(h,t,i,s)=>({set _(a){qe(h,t,a,i)},get _(){return te(h,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();var ih={exports:{}},dr={};var tp;function gv(){if(tp)return dr;tp=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:h,type:s,key:l,ref:a!==void 0?a:null,props:o}}return dr.Fragment=t,dr.jsx=i,dr.jsxs=i,dr}var ep;function pv(){return ep||(ep=1,ih.exports=gv()),ih.exports}var T=pv(),nh={exports:{}},wt={};var ip;function yv(){if(ip)return wt;ip=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(D){return D===null||typeof D!="object"?null:(D=b&&D[b]||D["@@iterator"],typeof D=="function"?D:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,E={};function S(D,H,W){this.props=D,this.context=H,this.refs=E,this.updater=W||w}S.prototype.isReactComponent={},S.prototype.setState=function(D,H){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,H,"setState")},S.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function M(){}M.prototype=S.prototype;function _(D,H,W){this.props=D,this.context=H,this.refs=E,this.updater=W||w}var R=_.prototype=new M;R.constructor=_,x(R,S.prototype),R.isPureReactComponent=!0;var O=Array.isArray;function k(){}var F={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function X(D,H,W){var it=W.ref;return{$$typeof:h,type:D,key:H,ref:it!==void 0?it:null,props:W}}function K(D,H){return X(D.type,H,D.props)}function Q(D){return typeof D=="object"&&D!==null&&D.$$typeof===h}function et(D){var H={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(W){return H[W]})}var ot=/\/+/g;function J(D,H){return typeof D=="object"&&D!==null&&D.key!=null?et(""+D.key):H.toString(36)}function mt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(k,k):(D.status="pending",D.then(function(H){D.status==="pending"&&(D.status="fulfilled",D.value=H)},function(H){D.status==="pending"&&(D.status="rejected",D.reason=H)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function B(D,H,W,it,ht){var yt=typeof D;(yt==="undefined"||yt==="boolean")&&(D=null);var ut=!1;if(D===null)ut=!0;else switch(yt){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(D.$$typeof){case h:case t:ut=!0;break;case g:return ut=D._init,B(ut(D._payload),H,W,it,ht)}}if(ut)return ht=ht(D),ut=it===""?"."+J(D,0):it,O(ht)?(W="",ut!=null&&(W=ut.replace(ot,"$&/")+"/"),B(ht,H,W,"",function(ui){return ui})):ht!=null&&(Q(ht)&&(ht=K(ht,W+(ht.key==null||D&&D.key===ht.key?"":(""+ht.key).replace(ot,"$&/")+"/")+ut)),H.push(ht)),1;ut=0;var Ht=it===""?".":it+":";if(O(D))for(var Nt=0;Nt<D.length;Nt++)it=D[Nt],yt=Ht+J(it,Nt),ut+=B(it,H,W,yt,ht);else if(Nt=A(D),typeof Nt=="function")for(D=Nt.call(D),Nt=0;!(it=D.next()).done;)it=it.value,yt=Ht+J(it,Nt++),ut+=B(it,H,W,yt,ht);else if(yt==="object"){if(typeof D.then=="function")return B(mt(D),H,W,it,ht);throw H=String(D),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ut}function G(D,H,W){if(D==null)return D;var it=[],ht=0;return B(D,it,"","",function(yt){return H.call(W,yt,ht++)}),it}function Z(D){if(D._status===-1){var H=D._result;H=H(),H.then(function(W){(D._status===0||D._status===-1)&&(D._status=1,D._result=W)},function(W){(D._status===0||D._status===-1)&&(D._status=2,D._result=W)}),D._status===-1&&(D._status=0,D._result=H)}if(D._status===1)return D._result.default;throw D._result}var bt=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},vt={map:G,forEach:function(D,H,W){G(D,function(){H.apply(this,arguments)},W)},count:function(D){var H=0;return G(D,function(){H++}),H},toArray:function(D){return G(D,function(H){return H})||[]},only:function(D){if(!Q(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return wt.Activity=y,wt.Children=vt,wt.Component=S,wt.Fragment=i,wt.Profiler=a,wt.PureComponent=_,wt.StrictMode=s,wt.Suspense=d,wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,wt.__COMPILER_RUNTIME={__proto__:null,c:function(D){return F.H.useMemoCache(D)}},wt.cache=function(D){return function(){return D.apply(null,arguments)}},wt.cacheSignal=function(){return null},wt.cloneElement=function(D,H,W){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var it=x({},D.props),ht=D.key;if(H!=null)for(yt in H.key!==void 0&&(ht=""+H.key),H)!j.call(H,yt)||yt==="key"||yt==="__self"||yt==="__source"||yt==="ref"&&H.ref===void 0||(it[yt]=H[yt]);var yt=arguments.length-2;if(yt===1)it.children=W;else if(1<yt){for(var ut=Array(yt),Ht=0;Ht<yt;Ht++)ut[Ht]=arguments[Ht+2];it.children=ut}return X(D.type,ht,it)},wt.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},wt.createElement=function(D,H,W){var it,ht={},yt=null;if(H!=null)for(it in H.key!==void 0&&(yt=""+H.key),H)j.call(H,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(ht[it]=H[it]);var ut=arguments.length-2;if(ut===1)ht.children=W;else if(1<ut){for(var Ht=Array(ut),Nt=0;Nt<ut;Nt++)Ht[Nt]=arguments[Nt+2];ht.children=Ht}if(D&&D.defaultProps)for(it in ut=D.defaultProps,ut)ht[it]===void 0&&(ht[it]=ut[it]);return X(D,yt,ht)},wt.createRef=function(){return{current:null}},wt.forwardRef=function(D){return{$$typeof:u,render:D}},wt.isValidElement=Q,wt.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:Z}},wt.memo=function(D,H){return{$$typeof:f,type:D,compare:H===void 0?null:H}},wt.startTransition=function(D){var H=F.T,W={};F.T=W;try{var it=D(),ht=F.S;ht!==null&&ht(W,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(k,bt)}catch(yt){bt(yt)}finally{H!==null&&W.types!==null&&(H.types=W.types),F.T=H}},wt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},wt.use=function(D){return F.H.use(D)},wt.useActionState=function(D,H,W){return F.H.useActionState(D,H,W)},wt.useCallback=function(D,H){return F.H.useCallback(D,H)},wt.useContext=function(D){return F.H.useContext(D)},wt.useDebugValue=function(){},wt.useDeferredValue=function(D,H){return F.H.useDeferredValue(D,H)},wt.useEffect=function(D,H){return F.H.useEffect(D,H)},wt.useEffectEvent=function(D){return F.H.useEffectEvent(D)},wt.useId=function(){return F.H.useId()},wt.useImperativeHandle=function(D,H,W){return F.H.useImperativeHandle(D,H,W)},wt.useInsertionEffect=function(D,H){return F.H.useInsertionEffect(D,H)},wt.useLayoutEffect=function(D,H){return F.H.useLayoutEffect(D,H)},wt.useMemo=function(D,H){return F.H.useMemo(D,H)},wt.useOptimistic=function(D,H){return F.H.useOptimistic(D,H)},wt.useReducer=function(D,H,W){return F.H.useReducer(D,H,W)},wt.useRef=function(D){return F.H.useRef(D)},wt.useState=function(D){return F.H.useState(D)},wt.useSyncExternalStore=function(D,H,W){return F.H.useSyncExternalStore(D,H,W)},wt.useTransition=function(){return F.H.useTransition()},wt.version="19.2.4",wt}var np;function Bh(){return np||(np=1,nh.exports=yv()),nh.exports}var ct=Bh(),sh={exports:{}},fr={},ah={exports:{}},rh={};var sp;function bv(){return sp||(sp=1,(function(h){function t(B,G){var Z=B.length;B.push(G);t:for(;0<Z;){var bt=Z-1>>>1,vt=B[bt];if(0<a(vt,G))B[bt]=G,B[Z]=vt,Z=bt;else break t}}function i(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var G=B[0],Z=B.pop();if(Z!==G){B[0]=Z;t:for(var bt=0,vt=B.length,D=vt>>>1;bt<D;){var H=2*(bt+1)-1,W=B[H],it=H+1,ht=B[it];if(0>a(W,Z))it<vt&&0>a(ht,W)?(B[bt]=ht,B[it]=Z,bt=it):(B[bt]=W,B[H]=Z,bt=H);else if(it<vt&&0>a(ht,Z))B[bt]=ht,B[it]=Z,bt=it;else break t}}return G}function a(B,G){var Z=B.sortIndex-G.sortIndex;return Z!==0?Z:B.id-G.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;h.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();h.unstable_now=function(){return l.now()-u}}var d=[],f=[],g=1,y=null,b=3,A=!1,w=!1,x=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function R(B){for(var G=i(f);G!==null;){if(G.callback===null)s(f);else if(G.startTime<=B)s(f),G.sortIndex=G.expirationTime,t(d,G);else break;G=i(f)}}function O(B){if(x=!1,R(B),!w)if(i(d)!==null)w=!0,k||(k=!0,et());else{var G=i(f);G!==null&&mt(O,G.startTime-B)}}var k=!1,F=-1,j=5,X=-1;function K(){return E?!0:!(h.unstable_now()-X<j)}function Q(){if(E=!1,k){var B=h.unstable_now();X=B;var G=!0;try{t:{w=!1,x&&(x=!1,M(F),F=-1),A=!0;var Z=b;try{e:{for(R(B),y=i(d);y!==null&&!(y.expirationTime>B&&K());){var bt=y.callback;if(typeof bt=="function"){y.callback=null,b=y.priorityLevel;var vt=bt(y.expirationTime<=B);if(B=h.unstable_now(),typeof vt=="function"){y.callback=vt,R(B),G=!0;break e}y===i(d)&&s(d),R(B)}else s(d);y=i(d)}if(y!==null)G=!0;else{var D=i(f);D!==null&&mt(O,D.startTime-B),G=!1}}break t}finally{y=null,b=Z,A=!1}G=void 0}}finally{G?et():k=!1}}}var et;if(typeof _=="function")et=function(){_(Q)};else if(typeof MessageChannel<"u"){var ot=new MessageChannel,J=ot.port2;ot.port1.onmessage=Q,et=function(){J.postMessage(null)}}else et=function(){S(Q,0)};function mt(B,G){F=S(function(){B(h.unstable_now())},G)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(B){B.callback=null},h.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<B?Math.floor(1e3/B):5},h.unstable_getCurrentPriorityLevel=function(){return b},h.unstable_next=function(B){switch(b){case 1:case 2:case 3:var G=3;break;default:G=b}var Z=b;b=G;try{return B()}finally{b=Z}},h.unstable_requestPaint=function(){E=!0},h.unstable_runWithPriority=function(B,G){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Z=b;b=B;try{return G()}finally{b=Z}},h.unstable_scheduleCallback=function(B,G,Z){var bt=h.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?bt+Z:bt):Z=bt,B){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=Z+vt,B={id:g++,callback:G,priorityLevel:B,startTime:Z,expirationTime:vt,sortIndex:-1},Z>bt?(B.sortIndex=Z,t(f,B),i(d)===null&&B===i(f)&&(x?(M(F),F=-1):x=!0,mt(O,Z-bt))):(B.sortIndex=vt,t(d,B),w||A||(w=!0,k||(k=!0,et()))),B},h.unstable_shouldYield=K,h.unstable_wrapCallback=function(B){var G=b;return function(){var Z=b;b=G;try{return B.apply(this,arguments)}finally{b=Z}}}})(rh)),rh}var ap;function vv(){return ap||(ap=1,ah.exports=bv()),ah.exports}var oh={exports:{}},Oe={};var rp;function Av(){if(rp)return Oe;rp=1;var h=Bh();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:g}}var l=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Oe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Oe.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(d,f,null,g)},Oe.flushSync=function(d){var f=l.T,g=s.p;try{if(l.T=null,s.p=2,d)return d()}finally{l.T=f,s.p=g,s.d.f()}},Oe.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(d,f))},Oe.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Oe.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,y=u(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?s.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):g==="script"&&s.d.X(d,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Oe.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=u(f.as,f.crossOrigin);s.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(d)},Oe.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=u(g,f.crossOrigin);s.d.L(d,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Oe.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=u(f.as,f.crossOrigin);s.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(d)},Oe.requestFormReset=function(d){s.d.r(d)},Oe.unstable_batchedUpdates=function(d,f){return d(f)},Oe.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},Oe.useFormStatus=function(){return l.H.useHostTransitionStatus()},Oe.version="19.2.4",Oe}var op;function xv(){if(op)return oh.exports;op=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),oh.exports=Av(),oh.exports}var lp;function wv(){if(lp)return fr;lp=1;var h=vv(),t=Bh(),i=xv();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var n=e,r=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(r=n.return),e=n.return;while(e)}return n.tag===3?r:null}function l(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function d(e){if(o(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=o(e),n===null)throw Error(s(188));return n!==e?null:e}for(var r=e,c=n;;){var m=r.return;if(m===null)break;var p=m.alternate;if(p===null){if(c=m.return,c!==null){r=c;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===r)return d(m),e;if(p===c)return d(m),n;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=m,c=p;else{for(var v=!1,C=m.child;C;){if(C===r){v=!0,r=m,c=p;break}if(C===c){v=!0,c=m,r=p;break}C=C.sibling}if(!v){for(C=p.child;C;){if(C===r){v=!0,r=p,c=m;break}if(C===c){v=!0,c=p,r=m;break}C=C.sibling}if(!v)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),_=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function et(e){return e===null||typeof e!="object"?null:(e=Q&&e[Q]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Symbol.for("react.client.reference");function J(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ot?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case x:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case k:return"SuspenseList";case X:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case _:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case R:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case F:return n=e.displayName||null,n!==null?n:J(e.type)||"Memo";case j:n=e._payload,e=e._init;try{return J(e(n))}catch{}}return null}var mt=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},bt=[],vt=-1;function D(e){return{current:e}}function H(e){0>vt||(e.current=bt[vt],bt[vt]=null,vt--)}function W(e,n){vt++,bt[vt]=e.current,e.current=n}var it=D(null),ht=D(null),yt=D(null),ut=D(null);function Ht(e,n){switch(W(yt,n),W(ht,e),W(it,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?xg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=xg(n),e=wg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(it),W(it,e)}function Nt(){H(it),H(ht),H(yt)}function ui(e){e.memoizedState!==null&&W(ut,e);var n=it.current,r=wg(n,e.type);n!==r&&(W(ht,e),W(it,r))}function gt(e){ht.current===e&&(H(it),H(ht)),ut.current===e&&(H(ut),lr._currentValue=Z)}var tt,st;function Tt(e){if(tt===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);tt=n&&n[1]||"",st=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tt+e+st}var Wt=!1;function Le(e,n){if(!e||Wt)return"";Wt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var $=function(){throw Error()};if(Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(V){var I=V}Reflect.construct(e,[],$)}else{try{$.call()}catch(V){I=V}e.call($.prototype)}}else{try{throw Error()}catch(V){I=V}($=e())&&typeof $.catch=="function"&&$.catch(function(){})}}catch(V){if(V&&I&&typeof V.stack=="string")return[V.stack,I.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),v=p[0],C=p[1];if(v&&C){var N=v.split(`
`),U=C.split(`
`);for(m=c=0;c<N.length&&!N[c].includes("DetermineComponentFrameRoot");)c++;for(;m<U.length&&!U[m].includes("DetermineComponentFrameRoot");)m++;if(c===N.length||m===U.length)for(c=N.length-1,m=U.length-1;1<=c&&0<=m&&N[c]!==U[m];)m--;for(;1<=c&&0<=m;c--,m--)if(N[c]!==U[m]){if(c!==1||m!==1)do if(c--,m--,0>m||N[c]!==U[m]){var Y=`
`+N[c].replace(" at new "," at ");return e.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",e.displayName)),Y}while(1<=c&&0<=m);break}}}finally{Wt=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Tt(r):""}function Pe(e,n){switch(e.tag){case 26:case 27:case 5:return Tt(e.type);case 16:return Tt("Lazy");case 13:return e.child!==n&&n!==null?Tt("Suspense Fallback"):Tt("Suspense");case 19:return Tt("SuspenseList");case 0:case 15:return Le(e.type,!1);case 11:return Le(e.type.render,!1);case 1:return Le(e.type,!0);case 31:return Tt("Activity");default:return""}}function dn(e){try{var n="",r=null;do n+=Pe(e,r),r=e,e=e.return;while(e);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Di=Object.prototype.hasOwnProperty,Ri=h.unstable_scheduleCallback,fn=h.unstable_cancelCallback,Il=h.unstable_shouldYield,Hl=h.unstable_requestPaint,ke=h.unstable_now,Ni=h.unstable_getCurrentPriorityLevel,Gi=h.unstable_ImmediatePriority,Br=h.unstable_UserBlockingPriority,Fr=h.unstable_NormalPriority,W0=h.unstable_LowPriority,td=h.unstable_IdlePriority,Q0=h.log,Z0=h.unstable_setDisableYieldValue,Aa=null,Qe=null;function mn(e){if(typeof Q0=="function"&&Z0(e),Qe&&typeof Qe.setStrictMode=="function")try{Qe.setStrictMode(Aa,e)}catch{}}var Ze=Math.clz32?Math.clz32:ey,J0=Math.log,ty=Math.LN2;function ey(e){return e>>>=0,e===0?32:31-(J0(e)/ty|0)|0}var zr=256,jr=262144,Pr=4194304;function Vn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ur(e,n,r){var c=e.pendingLanes;if(c===0)return 0;var m=0,p=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var C=c&134217727;return C!==0?(c=C&~p,c!==0?m=Vn(c):(v&=C,v!==0?m=Vn(v):r||(r=C&~e,r!==0&&(m=Vn(r))))):(C=c&~p,C!==0?m=Vn(C):v!==0?m=Vn(v):r||(r=c&~e,r!==0&&(m=Vn(r)))),m===0?0:n!==0&&n!==m&&(n&p)===0&&(p=m&-m,r=n&-n,p>=r||p===32&&(r&4194048)!==0)?n:m}function xa(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function iy(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ed(){var e=Pr;return Pr<<=1,(Pr&62914560)===0&&(Pr=4194304),e}function Gl(e){for(var n=[],r=0;31>r;r++)n.push(e);return n}function wa(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ny(e,n,r,c,m,p){var v=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var C=e.entanglements,N=e.expirationTimes,U=e.hiddenUpdates;for(r=v&~r;0<r;){var Y=31-Ze(r),$=1<<Y;C[Y]=0,N[Y]=-1;var I=U[Y];if(I!==null)for(U[Y]=null,Y=0;Y<I.length;Y++){var V=I[Y];V!==null&&(V.lane&=-536870913)}r&=~$}c!==0&&id(e,c,0),p!==0&&m===0&&e.tag!==0&&(e.suspendedLanes|=p&~(v&~n))}function id(e,n,r){e.pendingLanes|=n,e.suspendedLanes&=~n;var c=31-Ze(n);e.entangledLanes|=n,e.entanglements[c]=e.entanglements[c]|1073741824|r&261930}function nd(e,n){var r=e.entangledLanes|=n;for(e=e.entanglements;r;){var c=31-Ze(r),m=1<<c;m&n|e[c]&n&&(e[c]|=n),r&=~m}}function sd(e,n){var r=n&-n;return r=(r&42)!==0?1:Vl(r),(r&(e.suspendedLanes|n))!==0?0:r}function Vl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Xl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ad(){var e=G.p;return e!==0?e:(e=window.event,e===void 0?32:Xg(e.type))}function rd(e,n){var r=G.p;try{return G.p=e,n()}finally{G.p=r}}var gn=Math.random().toString(36).slice(2),Se="__reactFiber$"+gn,Ue="__reactProps$"+gn,ps="__reactContainer$"+gn,Yl="__reactEvents$"+gn,sy="__reactListeners$"+gn,ay="__reactHandles$"+gn,od="__reactResources$"+gn,Sa="__reactMarker$"+gn;function ql(e){delete e[Se],delete e[Ue],delete e[Yl],delete e[sy],delete e[ay]}function ys(e){var n=e[Se];if(n)return n;for(var r=e.parentNode;r;){if(n=r[ps]||r[Se]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(e=Dg(e);e!==null;){if(r=e[Se])return r;e=Dg(e)}return n}e=r,r=e.parentNode}return null}function bs(e){if(e=e[Se]||e[ps]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ea(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function vs(e){var n=e[od];return n||(n=e[od]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ve(e){e[Sa]=!0}var ld=new Set,cd={};function Xn(e,n){As(e,n),As(e+"Capture",n)}function As(e,n){for(cd[e]=n,e=0;e<n.length;e++)ld.add(n[e])}var ry=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ud={},hd={};function oy(e){return Di.call(hd,e)?!0:Di.call(ud,e)?!1:ry.test(e)?hd[e]=!0:(ud[e]=!0,!1)}function Ir(e,n,r){if(oy(n))if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+r)}}function Hr(e,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+r)}}function Vi(e,n,r,c){if(c===null)e.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(n,r,""+c)}}function hi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function dd(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ly(e,n,r){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,p=c.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return m.call(this)},set:function(v){r=""+v,p.call(this,v)}}),Object.defineProperty(e,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(v){r=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function $l(e){if(!e._valueTracker){var n=dd(e)?"checked":"value";e._valueTracker=ly(e,n,""+e[n])}}function fd(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return e&&(c=dd(e)?e.checked?"true":"false":e.value),e=c,e!==r?(n.setValue(e),!0):!1}function Gr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var cy=/[\n"\\]/g;function di(e){return e.replace(cy,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Kl(e,n,r,c,m,p,v,C){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+hi(n)):e.value!==""+hi(n)&&(e.value=""+hi(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?Wl(e,v,hi(n)):r!=null?Wl(e,v,hi(r)):c!=null&&e.removeAttribute("value"),m==null&&p!=null&&(e.defaultChecked=!!p),m!=null&&(e.checked=m&&typeof m!="function"&&typeof m!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?e.name=""+hi(C):e.removeAttribute("name")}function md(e,n,r,c,m,p,v,C){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||n!=null)){$l(e);return}r=r!=null?""+hi(r):"",n=n!=null?""+hi(n):r,C||n===e.value||(e.value=n),e.defaultValue=n}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=C?e.checked:!!c,e.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),$l(e)}function Wl(e,n,r){n==="number"&&Gr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function xs(e,n,r,c){if(e=e.options,n){n={};for(var m=0;m<r.length;m++)n["$"+r[m]]=!0;for(r=0;r<e.length;r++)m=n.hasOwnProperty("$"+e[r].value),e[r].selected!==m&&(e[r].selected=m),m&&c&&(e[r].defaultSelected=!0)}else{for(r=""+hi(r),n=null,m=0;m<e.length;m++){if(e[m].value===r){e[m].selected=!0,c&&(e[m].defaultSelected=!0);return}n!==null||e[m].disabled||(n=e[m])}n!==null&&(n.selected=!0)}}function gd(e,n,r){if(n!=null&&(n=""+hi(n),n!==e.value&&(e.value=n),r==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=r!=null?""+hi(r):""}function pd(e,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(mt(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=hi(n),e.defaultValue=r,c=e.textContent,c===r&&c!==""&&c!==null&&(e.value=c),$l(e)}function ws(e,n){if(n){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=n;return}}e.textContent=n}var uy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yd(e,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":c?e.setProperty(n,r):typeof r!="number"||r===0||uy.has(n)?n==="float"?e.cssFloat=r:e[n]=(""+r).trim():e[n]=r+"px"}function bd(e,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var m in n)c=n[m],n.hasOwnProperty(m)&&r[m]!==c&&yd(e,m,c)}else for(var p in n)n.hasOwnProperty(p)&&yd(e,p,n[p])}function Ql(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vr(e){return dy.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Xi(){}var Zl=null;function Jl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ss=null,Es=null;function vd(e){var n=bs(e);if(n&&(e=n.stateNode)){var r=e[Ue]||null;t:switch(e=n.stateNode,n.type){case"input":if(Kl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+di(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==e&&c.form===e.form){var m=c[Ue]||null;if(!m)throw Error(s(90));Kl(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===e.form&&fd(c)}break t;case"textarea":gd(e,r.value,r.defaultValue);break t;case"select":n=r.value,n!=null&&xs(e,!!r.multiple,n,!1)}}}var tc=!1;function Ad(e,n,r){if(tc)return e(n,r);tc=!0;try{var c=e(n);return c}finally{if(tc=!1,(Ss!==null||Es!==null)&&(ko(),Ss&&(n=Ss,e=Es,Es=Ss=null,vd(n),e)))for(n=0;n<e.length;n++)vd(e[n])}}function Ca(e,n){var r=e.stateNode;if(r===null)return null;var c=r[Ue]||null;if(c===null)return null;r=c[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ec=!1;if(Yi)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){ec=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{ec=!1}var pn=null,ic=null,Xr=null;function xd(){if(Xr)return Xr;var e,n=ic,r=n.length,c,m="value"in pn?pn.value:pn.textContent,p=m.length;for(e=0;e<r&&n[e]===m[e];e++);var v=r-e;for(c=1;c<=v&&n[r-c]===m[p-c];c++);return Xr=m.slice(e,1<c?1-c:void 0)}function Yr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function qr(){return!0}function wd(){return!1}function Ie(e){function n(r,c,m,p,v){this._reactName=r,this._targetInst=m,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var C in e)e.hasOwnProperty(C)&&(r=e[C],this[C]=r?r(p):p[C]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?qr:wd,this.isPropagationStopped=wd,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qr)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qr)},persist:function(){},isPersistent:qr}),n}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$r=Ie(Yn),_a=y({},Yn,{view:0,detail:0}),fy=Ie(_a),nc,sc,Ma,Kr=y({},_a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ma&&(Ma&&e.type==="mousemove"?(nc=e.screenX-Ma.screenX,sc=e.screenY-Ma.screenY):sc=nc=0,Ma=e),nc)},movementY:function(e){return"movementY"in e?e.movementY:sc}}),Sd=Ie(Kr),my=y({},Kr,{dataTransfer:0}),gy=Ie(my),py=y({},_a,{relatedTarget:0}),ac=Ie(py),yy=y({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),by=Ie(yy),vy=y({},Yn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ay=Ie(vy),xy=y({},Yn,{data:0}),Ed=Ie(xy),wy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ey={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cy(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Ey[e])?!!n[e]:!1}function rc(){return Cy}var Ty=y({},_a,{key:function(e){if(e.key){var n=wy[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Yr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Sy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rc,charCode:function(e){return e.type==="keypress"?Yr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_y=Ie(Ty),My=y({},Kr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cd=Ie(My),Dy=y({},_a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rc}),Ry=Ie(Dy),Ny=y({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ky=Ie(Ny),Oy=y({},Kr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ly=Ie(Oy),By=y({},Yn,{newState:0,oldState:0}),Fy=Ie(By),zy=[9,13,27,32],oc=Yi&&"CompositionEvent"in window,Da=null;Yi&&"documentMode"in document&&(Da=document.documentMode);var jy=Yi&&"TextEvent"in window&&!Da,Td=Yi&&(!oc||Da&&8<Da&&11>=Da),_d=" ",Md=!1;function Dd(e,n){switch(e){case"keyup":return zy.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Cs=!1;function Py(e,n){switch(e){case"compositionend":return Rd(n);case"keypress":return n.which!==32?null:(Md=!0,_d);case"textInput":return e=n.data,e===_d&&Md?null:e;default:return null}}function Uy(e,n){if(Cs)return e==="compositionend"||!oc&&Dd(e,n)?(e=xd(),Xr=ic=pn=null,Cs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Td&&n.locale!=="ko"?null:n.data;default:return null}}var Iy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nd(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Iy[e.type]:n==="textarea"}function kd(e,n,r,c){Ss?Es?Es.push(c):Es=[c]:Ss=c,n=Po(n,"onChange"),0<n.length&&(r=new $r("onChange","change",null,r,c),e.push({event:r,listeners:n}))}var Ra=null,Na=null;function Hy(e){gg(e,0)}function Wr(e){var n=Ea(e);if(fd(n))return e}function Od(e,n){if(e==="change")return n}var Ld=!1;if(Yi){var lc;if(Yi){var cc="oninput"in document;if(!cc){var Bd=document.createElement("div");Bd.setAttribute("oninput","return;"),cc=typeof Bd.oninput=="function"}lc=cc}else lc=!1;Ld=lc&&(!document.documentMode||9<document.documentMode)}function Fd(){Ra&&(Ra.detachEvent("onpropertychange",zd),Na=Ra=null)}function zd(e){if(e.propertyName==="value"&&Wr(Na)){var n=[];kd(n,Na,e,Jl(e)),Ad(Hy,n)}}function Gy(e,n,r){e==="focusin"?(Fd(),Ra=n,Na=r,Ra.attachEvent("onpropertychange",zd)):e==="focusout"&&Fd()}function Vy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wr(Na)}function Xy(e,n){if(e==="click")return Wr(n)}function Yy(e,n){if(e==="input"||e==="change")return Wr(n)}function qy(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Je=typeof Object.is=="function"?Object.is:qy;function ka(e,n){if(Je(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var r=Object.keys(e),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var m=r[c];if(!Di.call(n,m)||!Je(e[m],n[m]))return!1}return!0}function jd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pd(e,n){var r=jd(e);e=0;for(var c;r;){if(r.nodeType===3){if(c=e+r.textContent.length,e<=n&&c>=n)return{node:r,offset:n-e};e=c}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=jd(r)}}function Ud(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Ud(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Id(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Gr(e.document);n instanceof e.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)e=n.contentWindow;else break;n=Gr(e.document)}return n}function uc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var $y=Yi&&"documentMode"in document&&11>=document.documentMode,Ts=null,hc=null,Oa=null,dc=!1;function Hd(e,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dc||Ts==null||Ts!==Gr(c)||(c=Ts,"selectionStart"in c&&uc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Oa&&ka(Oa,c)||(Oa=c,c=Po(hc,"onSelect"),0<c.length&&(n=new $r("onSelect","select",null,n,r),e.push({event:n,listeners:c}),n.target=Ts)))}function qn(e,n){var r={};return r[e.toLowerCase()]=n.toLowerCase(),r["Webkit"+e]="webkit"+n,r["Moz"+e]="moz"+n,r}var _s={animationend:qn("Animation","AnimationEnd"),animationiteration:qn("Animation","AnimationIteration"),animationstart:qn("Animation","AnimationStart"),transitionrun:qn("Transition","TransitionRun"),transitionstart:qn("Transition","TransitionStart"),transitioncancel:qn("Transition","TransitionCancel"),transitionend:qn("Transition","TransitionEnd")},fc={},Gd={};Yi&&(Gd=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function $n(e){if(fc[e])return fc[e];if(!_s[e])return e;var n=_s[e],r;for(r in n)if(n.hasOwnProperty(r)&&r in Gd)return fc[e]=n[r];return e}var Vd=$n("animationend"),Xd=$n("animationiteration"),Yd=$n("animationstart"),Ky=$n("transitionrun"),Wy=$n("transitionstart"),Qy=$n("transitioncancel"),qd=$n("transitionend"),$d=new Map,mc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mc.push("scrollEnd");function Ci(e,n){$d.set(e,n),Xn(n,[e])}var Qr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},fi=[],Ms=0,gc=0;function Zr(){for(var e=Ms,n=gc=Ms=0;n<e;){var r=fi[n];fi[n++]=null;var c=fi[n];fi[n++]=null;var m=fi[n];fi[n++]=null;var p=fi[n];if(fi[n++]=null,c!==null&&m!==null){var v=c.pending;v===null?m.next=m:(m.next=v.next,v.next=m),c.pending=m}p!==0&&Kd(r,m,p)}}function Jr(e,n,r,c){fi[Ms++]=e,fi[Ms++]=n,fi[Ms++]=r,fi[Ms++]=c,gc|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function pc(e,n,r,c){return Jr(e,n,r,c),to(e)}function Kn(e,n){return Jr(e,null,null,n),to(e)}function Kd(e,n,r){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r);for(var m=!1,p=e.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(m=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,m&&n!==null&&(m=31-Ze(r),e=p.hiddenUpdates,c=e[m],c===null?e[m]=[n]:c.push(n),n.lane=r|536870912),p):null}function to(e){if(50<er)throw er=0,Cu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Ds={};function Zy(e,n,r,c){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(e,n,r,c){return new Zy(e,n,r,c)}function yc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qi(e,n){var r=e.alternate;return r===null?(r=ti(e.tag,n,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Wd(e,n){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,n=r.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function eo(e,n,r,c,m,p){var v=0;if(c=e,typeof e=="function")yc(e)&&(v=1);else if(typeof e=="string")v=nv(e,r,it.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case X:return e=ti(31,r,n,m),e.elementType=X,e.lanes=p,e;case x:return Wn(r.children,m,p,n);case E:v=8,m|=24;break;case S:return e=ti(12,r,n,m|2),e.elementType=S,e.lanes=p,e;case O:return e=ti(13,r,n,m),e.elementType=O,e.lanes=p,e;case k:return e=ti(19,r,n,m),e.elementType=k,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _:v=10;break t;case M:v=9;break t;case R:v=11;break t;case F:v=14;break t;case j:v=16,c=null;break t}v=29,r=Error(s(130,e===null?"null":typeof e,"")),c=null}return n=ti(v,r,n,m),n.elementType=e,n.type=c,n.lanes=p,n}function Wn(e,n,r,c){return e=ti(7,e,c,n),e.lanes=r,e}function bc(e,n,r){return e=ti(6,e,null,n),e.lanes=r,e}function Qd(e){var n=ti(18,null,null,0);return n.stateNode=e,n}function vc(e,n,r){return n=ti(4,e.children!==null?e.children:[],e.key,n),n.lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Zd=new WeakMap;function mi(e,n){if(typeof e=="object"&&e!==null){var r=Zd.get(e);return r!==void 0?r:(n={value:e,source:n,stack:dn(n)},Zd.set(e,n),n)}return{value:e,source:n,stack:dn(n)}}var Rs=[],Ns=0,io=null,La=0,gi=[],pi=0,yn=null,ki=1,Oi="";function $i(e,n){Rs[Ns++]=La,Rs[Ns++]=io,io=e,La=n}function Jd(e,n,r){gi[pi++]=ki,gi[pi++]=Oi,gi[pi++]=yn,yn=e;var c=ki;e=Oi;var m=32-Ze(c)-1;c&=~(1<<m),r+=1;var p=32-Ze(n)+m;if(30<p){var v=m-m%5;p=(c&(1<<v)-1).toString(32),c>>=v,m-=v,ki=1<<32-Ze(n)+m|r<<m|c,Oi=p+e}else ki=1<<p|r<<m|c,Oi=e}function Ac(e){e.return!==null&&($i(e,1),Jd(e,1,0))}function xc(e){for(;e===io;)io=Rs[--Ns],Rs[Ns]=null,La=Rs[--Ns],Rs[Ns]=null;for(;e===yn;)yn=gi[--pi],gi[pi]=null,Oi=gi[--pi],gi[pi]=null,ki=gi[--pi],gi[pi]=null}function tf(e,n){gi[pi++]=ki,gi[pi++]=Oi,gi[pi++]=yn,ki=n.id,Oi=n.overflow,yn=e}var Ee=null,Qt=null,kt=!1,bn=null,yi=!1,wc=Error(s(519));function vn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ba(mi(n,e)),wc}function ef(e){var n=e.stateNode,r=e.type,c=e.memoizedProps;switch(n[Se]=e,n[Ue]=c,r){case"dialog":Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":case"embed":Mt("load",n);break;case"video":case"audio":for(r=0;r<nr.length;r++)Mt(nr[r],n);break;case"source":Mt("error",n);break;case"img":case"image":case"link":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"input":Mt("invalid",n),md(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Mt("invalid",n);break;case"textarea":Mt("invalid",n),pd(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||vg(n.textContent,r)?(c.popover!=null&&(Mt("beforetoggle",n),Mt("toggle",n)),c.onScroll!=null&&Mt("scroll",n),c.onScrollEnd!=null&&Mt("scrollend",n),c.onClick!=null&&(n.onclick=Xi),n=!0):n=!1,n||vn(e,!0)}function nf(e){for(Ee=e.return;Ee;)switch(Ee.tag){case 5:case 31:case 13:yi=!1;return;case 27:case 3:yi=!0;return;default:Ee=Ee.return}}function ks(e){if(e!==Ee)return!1;if(!kt)return nf(e),kt=!0,!1;var n=e.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Uu(e.type,e.memoizedProps)),r=!r),r&&Qt&&vn(e),nf(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Qt=Mg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Qt=Mg(e)}else n===27?(n=Qt,On(e.type)?(e=Xu,Xu=null,Qt=e):Qt=n):Qt=Ee?vi(e.stateNode.nextSibling):null;return!0}function Qn(){Qt=Ee=null,kt=!1}function Sc(){var e=bn;return e!==null&&(Xe===null?Xe=e:Xe.push.apply(Xe,e),bn=null),e}function Ba(e){bn===null?bn=[e]:bn.push(e)}var Ec=D(null),Zn=null,Ki=null;function An(e,n,r){W(Ec,n._currentValue),n._currentValue=r}function Wi(e){e._currentValue=Ec.current,H(Ec)}function Cc(e,n,r){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===r)break;e=e.return}}function Tc(e,n,r,c){var m=e.child;for(m!==null&&(m.return=e);m!==null;){var p=m.dependencies;if(p!==null){var v=m.child;p=p.firstContext;t:for(;p!==null;){var C=p;p=m;for(var N=0;N<n.length;N++)if(C.context===n[N]){p.lanes|=r,C=p.alternate,C!==null&&(C.lanes|=r),Cc(p.return,r,e),c||(v=null);break t}p=C.next}}else if(m.tag===18){if(v=m.return,v===null)throw Error(s(341));v.lanes|=r,p=v.alternate,p!==null&&(p.lanes|=r),Cc(v,r,e),v=null}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===e){v=null;break}if(m=v.sibling,m!==null){m.return=v.return,v=m;break}v=v.return}m=v}}function Os(e,n,r,c){e=null;for(var m=n,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var v=m.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var C=m.type;Je(m.pendingProps.value,v.value)||(e!==null?e.push(C):e=[C])}}else if(m===ut.current){if(v=m.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(e!==null?e.push(lr):e=[lr])}m=m.return}e!==null&&Tc(n,e,r,c),n.flags|=262144}function no(e){for(e=e.firstContext;e!==null;){if(!Je(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Jn(e){Zn=e,Ki=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ce(e){return sf(Zn,e)}function so(e,n){return Zn===null&&Jn(e),sf(e,n)}function sf(e,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Ki===null){if(e===null)throw Error(s(308));Ki=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Ki=Ki.next=n;return r}var Jy=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(r,c){e.push(c)}};this.abort=function(){n.aborted=!0,e.forEach(function(r){return r()})}},tb=h.unstable_scheduleCallback,eb=h.unstable_NormalPriority,ue={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _c(){return{controller:new Jy,data:new Map,refCount:0}}function Fa(e){e.refCount--,e.refCount===0&&tb(eb,function(){e.controller.abort()})}var za=null,Mc=0,Ls=0,Bs=null;function ib(e,n){if(za===null){var r=za=[];Mc=0,Ls=Nu(),Bs={status:"pending",value:void 0,then:function(c){r.push(c)}}}return Mc++,n.then(af,af),n}function af(){if(--Mc===0&&za!==null){Bs!==null&&(Bs.status="fulfilled");var e=za;za=null,Ls=0,Bs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function nb(e,n){var r=[],c={status:"pending",value:null,reason:null,then:function(m){r.push(m)}};return e.then(function(){c.status="fulfilled",c.value=n;for(var m=0;m<r.length;m++)(0,r[m])(n)},function(m){for(c.status="rejected",c.reason=m,m=0;m<r.length;m++)(0,r[m])(void 0)}),c}var rf=B.S;B.S=function(e,n){Gm=ke(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&ib(e,n),rf!==null&&rf(e,n)};var ts=D(null);function Dc(){var e=ts.current;return e!==null?e:Kt.pooledCache}function ao(e,n){n===null?W(ts,ts.current):W(ts,n.pool)}function of(){var e=Dc();return e===null?null:{parent:ue._currentValue,pool:e}}var Fs=Error(s(460)),Rc=Error(s(474)),ro=Error(s(542)),oo={then:function(){}};function lf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function cf(e,n,r){switch(r=e[r],r===void 0?e.push(n):r!==n&&(n.then(Xi,Xi),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,hf(e),e;default:if(typeof n.status=="string")n.then(Xi,Xi);else{if(e=Kt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(c){if(n.status==="pending"){var m=n;m.status="fulfilled",m.value=c}},function(c){if(n.status==="pending"){var m=n;m.status="rejected",m.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,hf(e),e}throw is=n,Fs}}function es(e){try{var n=e._init;return n(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(is=r,Fs):r}}var is=null;function uf(){if(is===null)throw Error(s(459));var e=is;return is=null,e}function hf(e){if(e===Fs||e===ro)throw Error(s(483))}var zs=null,ja=0;function lo(e){var n=ja;return ja+=1,zs===null&&(zs=[]),cf(zs,e,n)}function Pa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function co(e,n){throw n.$$typeof===b?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function df(e){function n(z,L){if(e){var P=z.deletions;P===null?(z.deletions=[L],z.flags|=16):P.push(L)}}function r(z,L){if(!e)return null;for(;L!==null;)n(z,L),L=L.sibling;return null}function c(z){for(var L=new Map;z!==null;)z.key!==null?L.set(z.key,z):L.set(z.index,z),z=z.sibling;return L}function m(z,L){return z=qi(z,L),z.index=0,z.sibling=null,z}function p(z,L,P){return z.index=P,e?(P=z.alternate,P!==null?(P=P.index,P<L?(z.flags|=67108866,L):P):(z.flags|=67108866,L)):(z.flags|=1048576,L)}function v(z){return e&&z.alternate===null&&(z.flags|=67108866),z}function C(z,L,P,q){return L===null||L.tag!==6?(L=bc(P,z.mode,q),L.return=z,L):(L=m(L,P),L.return=z,L)}function N(z,L,P,q){var dt=P.type;return dt===x?Y(z,L,P.props.children,q,P.key):L!==null&&(L.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===j&&es(dt)===L.type)?(L=m(L,P.props),Pa(L,P),L.return=z,L):(L=eo(P.type,P.key,P.props,null,z.mode,q),Pa(L,P),L.return=z,L)}function U(z,L,P,q){return L===null||L.tag!==4||L.stateNode.containerInfo!==P.containerInfo||L.stateNode.implementation!==P.implementation?(L=vc(P,z.mode,q),L.return=z,L):(L=m(L,P.children||[]),L.return=z,L)}function Y(z,L,P,q,dt){return L===null||L.tag!==7?(L=Wn(P,z.mode,q,dt),L.return=z,L):(L=m(L,P),L.return=z,L)}function $(z,L,P){if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return L=bc(""+L,z.mode,P),L.return=z,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case A:return P=eo(L.type,L.key,L.props,null,z.mode,P),Pa(P,L),P.return=z,P;case w:return L=vc(L,z.mode,P),L.return=z,L;case j:return L=es(L),$(z,L,P)}if(mt(L)||et(L))return L=Wn(L,z.mode,P,null),L.return=z,L;if(typeof L.then=="function")return $(z,lo(L),P);if(L.$$typeof===_)return $(z,so(z,L),P);co(z,L)}return null}function I(z,L,P,q){var dt=L!==null?L.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return dt!==null?null:C(z,L,""+P,q);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case A:return P.key===dt?N(z,L,P,q):null;case w:return P.key===dt?U(z,L,P,q):null;case j:return P=es(P),I(z,L,P,q)}if(mt(P)||et(P))return dt!==null?null:Y(z,L,P,q,null);if(typeof P.then=="function")return I(z,L,lo(P),q);if(P.$$typeof===_)return I(z,L,so(z,P),q);co(z,P)}return null}function V(z,L,P,q,dt){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return z=z.get(P)||null,C(L,z,""+q,dt);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case A:return z=z.get(q.key===null?P:q.key)||null,N(L,z,q,dt);case w:return z=z.get(q.key===null?P:q.key)||null,U(L,z,q,dt);case j:return q=es(q),V(z,L,P,q,dt)}if(mt(q)||et(q))return z=z.get(P)||null,Y(L,z,q,dt,null);if(typeof q.then=="function")return V(z,L,P,lo(q),dt);if(q.$$typeof===_)return V(z,L,P,so(L,q),dt);co(L,q)}return null}function rt(z,L,P,q){for(var dt=null,Lt=null,lt=L,Ct=L=0,Rt=null;lt!==null&&Ct<P.length;Ct++){lt.index>Ct?(Rt=lt,lt=null):Rt=lt.sibling;var Bt=I(z,lt,P[Ct],q);if(Bt===null){lt===null&&(lt=Rt);break}e&&lt&&Bt.alternate===null&&n(z,lt),L=p(Bt,L,Ct),Lt===null?dt=Bt:Lt.sibling=Bt,Lt=Bt,lt=Rt}if(Ct===P.length)return r(z,lt),kt&&$i(z,Ct),dt;if(lt===null){for(;Ct<P.length;Ct++)lt=$(z,P[Ct],q),lt!==null&&(L=p(lt,L,Ct),Lt===null?dt=lt:Lt.sibling=lt,Lt=lt);return kt&&$i(z,Ct),dt}for(lt=c(lt);Ct<P.length;Ct++)Rt=V(lt,z,Ct,P[Ct],q),Rt!==null&&(e&&Rt.alternate!==null&&lt.delete(Rt.key===null?Ct:Rt.key),L=p(Rt,L,Ct),Lt===null?dt=Rt:Lt.sibling=Rt,Lt=Rt);return e&&lt.forEach(function(jn){return n(z,jn)}),kt&&$i(z,Ct),dt}function pt(z,L,P,q){if(P==null)throw Error(s(151));for(var dt=null,Lt=null,lt=L,Ct=L=0,Rt=null,Bt=P.next();lt!==null&&!Bt.done;Ct++,Bt=P.next()){lt.index>Ct?(Rt=lt,lt=null):Rt=lt.sibling;var jn=I(z,lt,Bt.value,q);if(jn===null){lt===null&&(lt=Rt);break}e&&lt&&jn.alternate===null&&n(z,lt),L=p(jn,L,Ct),Lt===null?dt=jn:Lt.sibling=jn,Lt=jn,lt=Rt}if(Bt.done)return r(z,lt),kt&&$i(z,Ct),dt;if(lt===null){for(;!Bt.done;Ct++,Bt=P.next())Bt=$(z,Bt.value,q),Bt!==null&&(L=p(Bt,L,Ct),Lt===null?dt=Bt:Lt.sibling=Bt,Lt=Bt);return kt&&$i(z,Ct),dt}for(lt=c(lt);!Bt.done;Ct++,Bt=P.next())Bt=V(lt,z,Ct,Bt.value,q),Bt!==null&&(e&&Bt.alternate!==null&&lt.delete(Bt.key===null?Ct:Bt.key),L=p(Bt,L,Ct),Lt===null?dt=Bt:Lt.sibling=Bt,Lt=Bt);return e&&lt.forEach(function(mv){return n(z,mv)}),kt&&$i(z,Ct),dt}function qt(z,L,P,q){if(typeof P=="object"&&P!==null&&P.type===x&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case A:t:{for(var dt=P.key;L!==null;){if(L.key===dt){if(dt=P.type,dt===x){if(L.tag===7){r(z,L.sibling),q=m(L,P.props.children),q.return=z,z=q;break t}}else if(L.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===j&&es(dt)===L.type){r(z,L.sibling),q=m(L,P.props),Pa(q,P),q.return=z,z=q;break t}r(z,L);break}else n(z,L);L=L.sibling}P.type===x?(q=Wn(P.props.children,z.mode,q,P.key),q.return=z,z=q):(q=eo(P.type,P.key,P.props,null,z.mode,q),Pa(q,P),q.return=z,z=q)}return v(z);case w:t:{for(dt=P.key;L!==null;){if(L.key===dt)if(L.tag===4&&L.stateNode.containerInfo===P.containerInfo&&L.stateNode.implementation===P.implementation){r(z,L.sibling),q=m(L,P.children||[]),q.return=z,z=q;break t}else{r(z,L);break}else n(z,L);L=L.sibling}q=vc(P,z.mode,q),q.return=z,z=q}return v(z);case j:return P=es(P),qt(z,L,P,q)}if(mt(P))return rt(z,L,P,q);if(et(P)){if(dt=et(P),typeof dt!="function")throw Error(s(150));return P=dt.call(P),pt(z,L,P,q)}if(typeof P.then=="function")return qt(z,L,lo(P),q);if(P.$$typeof===_)return qt(z,L,so(z,P),q);co(z,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,L!==null&&L.tag===6?(r(z,L.sibling),q=m(L,P),q.return=z,z=q):(r(z,L),q=bc(P,z.mode,q),q.return=z,z=q),v(z)):r(z,L)}return function(z,L,P,q){try{ja=0;var dt=qt(z,L,P,q);return zs=null,dt}catch(lt){if(lt===Fs||lt===ro)throw lt;var Lt=ti(29,lt,null,z.mode);return Lt.lanes=q,Lt.return=z,Lt}}}var ns=df(!0),ff=df(!1),xn=!1;function Nc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function wn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Sn(e,n,r){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(Ft&2)!==0){var m=c.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),c.pending=n,n=to(e),Kd(e,null,r),n}return Jr(e,c,n,r),to(e)}function Ua(e,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,nd(e,r)}}function Oc(e,n){var r=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var m=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var v={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?m=p=v:p=p.next=v,r=r.next}while(r!==null);p===null?m=p=n:p=p.next=n}else m=p=n;r={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=n:e.next=n,r.lastBaseUpdate=n}var Lc=!1;function Ia(){if(Lc){var e=Bs;if(e!==null)throw e}}function Ha(e,n,r,c){Lc=!1;var m=e.updateQueue;xn=!1;var p=m.firstBaseUpdate,v=m.lastBaseUpdate,C=m.shared.pending;if(C!==null){m.shared.pending=null;var N=C,U=N.next;N.next=null,v===null?p=U:v.next=U,v=N;var Y=e.alternate;Y!==null&&(Y=Y.updateQueue,C=Y.lastBaseUpdate,C!==v&&(C===null?Y.firstBaseUpdate=U:C.next=U,Y.lastBaseUpdate=N))}if(p!==null){var $=m.baseState;v=0,Y=U=N=null,C=p;do{var I=C.lane&-536870913,V=I!==C.lane;if(V?(Dt&I)===I:(c&I)===I){I!==0&&I===Ls&&(Lc=!0),Y!==null&&(Y=Y.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});t:{var rt=e,pt=C;I=n;var qt=r;switch(pt.tag){case 1:if(rt=pt.payload,typeof rt=="function"){$=rt.call(qt,$,I);break t}$=rt;break t;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=pt.payload,I=typeof rt=="function"?rt.call(qt,$,I):rt,I==null)break t;$=y({},$,I);break t;case 2:xn=!0}}I=C.callback,I!==null&&(e.flags|=64,V&&(e.flags|=8192),V=m.callbacks,V===null?m.callbacks=[I]:V.push(I))}else V={lane:I,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Y===null?(U=Y=V,N=$):Y=Y.next=V,v|=I;if(C=C.next,C===null){if(C=m.shared.pending,C===null)break;V=C,C=V.next,V.next=null,m.lastBaseUpdate=V,m.shared.pending=null}}while(!0);Y===null&&(N=$),m.baseState=N,m.firstBaseUpdate=U,m.lastBaseUpdate=Y,p===null&&(m.shared.lanes=0),Mn|=v,e.lanes=v,e.memoizedState=$}}function mf(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function gf(e,n){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)mf(r[e],n)}var js=D(null),uo=D(0);function pf(e,n){e=rn,W(uo,e),W(js,n),rn=e|n.baseLanes}function Bc(){W(uo,rn),W(js,js.current)}function Fc(){rn=uo.current,H(js),H(uo)}var ei=D(null),bi=null;function En(e){var n=e.alternate;W(oe,oe.current&1),W(ei,e),bi===null&&(n===null||js.current!==null||n.memoizedState!==null)&&(bi=e)}function zc(e){W(oe,oe.current),W(ei,e),bi===null&&(bi=e)}function yf(e){e.tag===22?(W(oe,oe.current),W(ei,e),bi===null&&(bi=e)):Cn()}function Cn(){W(oe,oe.current),W(ei,ei.current)}function ii(e){H(ei),bi===e&&(bi=null),H(oe)}var oe=D(0);function ho(e){for(var n=e;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Gu(r)||Vu(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Qi=0,Et=null,Xt=null,he=null,fo=!1,Ps=!1,ss=!1,mo=0,Ga=0,Us=null,sb=0;function se(){throw Error(s(321))}function jc(e,n){if(n===null)return!1;for(var r=0;r<n.length&&r<e.length;r++)if(!Je(e[r],n[r]))return!1;return!0}function Pc(e,n,r,c,m,p){return Qi=p,Et=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,B.H=e===null||e.memoizedState===null?tm:tu,ss=!1,p=r(c,m),ss=!1,Ps&&(p=vf(n,r,c,m)),bf(e),p}function bf(e){B.H=Ya;var n=Xt!==null&&Xt.next!==null;if(Qi=0,he=Xt=Et=null,fo=!1,Ga=0,Us=null,n)throw Error(s(300));e===null||de||(e=e.dependencies,e!==null&&no(e)&&(de=!0))}function vf(e,n,r,c){Et=e;var m=0;do{if(Ps&&(Us=null),Ga=0,Ps=!1,25<=m)throw Error(s(301));if(m+=1,he=Xt=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}B.H=em,p=n(r,c)}while(Ps);return p}function ab(){var e=B.H,n=e.useState()[0];return n=typeof n.then=="function"?Va(n):n,e=e.useState()[0],(Xt!==null?Xt.memoizedState:null)!==e&&(Et.flags|=1024),n}function Uc(){var e=mo!==0;return mo=0,e}function Ic(e,n,r){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r}function Hc(e){if(fo){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}fo=!1}Qi=0,he=Xt=Et=null,Ps=!1,Ga=mo=0,Us=null}function Be(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return he===null?Et.memoizedState=he=e:he=he.next=e,he}function le(){if(Xt===null){var e=Et.alternate;e=e!==null?e.memoizedState:null}else e=Xt.next;var n=he===null?Et.memoizedState:he.next;if(n!==null)he=n,Xt=e;else{if(e===null)throw Et.alternate===null?Error(s(467)):Error(s(310));Xt=e,e={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},he===null?Et.memoizedState=he=e:he=he.next=e}return he}function go(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Va(e){var n=Ga;return Ga+=1,Us===null&&(Us=[]),e=cf(Us,e,n),n=Et,(he===null?n.memoizedState:he.next)===null&&(n=n.alternate,B.H=n===null||n.memoizedState===null?tm:tu),e}function po(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Va(e);if(e.$$typeof===_)return Ce(e)}throw Error(s(438,String(e)))}function Gc(e){var n=null,r=Et.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=Et.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(m){return m.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=go(),Et.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(e),c=0;c<e;c++)r[c]=K;return n.index++,r}function Zi(e,n){return typeof n=="function"?n(e):n}function yo(e){var n=le();return Vc(n,Xt,e)}function Vc(e,n,r){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var m=e.baseQueue,p=c.pending;if(p!==null){if(m!==null){var v=m.next;m.next=p.next,p.next=v}n.baseQueue=m=p,c.pending=null}if(p=e.baseState,m===null)e.memoizedState=p;else{n=m.next;var C=v=null,N=null,U=n,Y=!1;do{var $=U.lane&-536870913;if($!==U.lane?(Dt&$)===$:(Qi&$)===$){var I=U.revertLane;if(I===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),$===Ls&&(Y=!0);else if((Qi&I)===I){U=U.next,I===Ls&&(Y=!0);continue}else $={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},N===null?(C=N=$,v=p):N=N.next=$,Et.lanes|=I,Mn|=I;$=U.action,ss&&r(p,$),p=U.hasEagerState?U.eagerState:r(p,$)}else I={lane:$,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},N===null?(C=N=I,v=p):N=N.next=I,Et.lanes|=$,Mn|=$;U=U.next}while(U!==null&&U!==n);if(N===null?v=p:N.next=C,!Je(p,e.memoizedState)&&(de=!0,Y&&(r=Bs,r!==null)))throw r;e.memoizedState=p,e.baseState=v,e.baseQueue=N,c.lastRenderedState=p}return m===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Xc(e){var n=le(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=e;var c=r.dispatch,m=r.pending,p=n.memoizedState;if(m!==null){r.pending=null;var v=m=m.next;do p=e(p,v.action),v=v.next;while(v!==m);Je(p,n.memoizedState)||(de=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),r.lastRenderedState=p}return[p,c]}function Af(e,n,r){var c=Et,m=le(),p=kt;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=n();var v=!Je((Xt||m).memoizedState,r);if(v&&(m.memoizedState=r,de=!0),m=m.queue,$c(Sf.bind(null,c,m,e),[e]),m.getSnapshot!==n||v||he!==null&&he.memoizedState.tag&1){if(c.flags|=2048,Is(9,{destroy:void 0},wf.bind(null,c,m,r,n),null),Kt===null)throw Error(s(349));p||(Qi&127)!==0||xf(c,n,r)}return r}function xf(e,n,r){e.flags|=16384,e={getSnapshot:n,value:r},n=Et.updateQueue,n===null?(n=go(),Et.updateQueue=n,n.stores=[e]):(r=n.stores,r===null?n.stores=[e]:r.push(e))}function wf(e,n,r,c){n.value=r,n.getSnapshot=c,Ef(n)&&Cf(e)}function Sf(e,n,r){return r(function(){Ef(n)&&Cf(e)})}function Ef(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!Je(e,r)}catch{return!0}}function Cf(e){var n=Kn(e,2);n!==null&&Ye(n,e,2)}function Yc(e){var n=Be();if(typeof e=="function"){var r=e;if(e=r(),ss){mn(!0);try{r()}finally{mn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:e},n}function Tf(e,n,r,c){return e.baseState=r,Vc(e,Xt,typeof c=="function"?c:Zi)}function rb(e,n,r,c,m){if(Ao(e))throw Error(s(485));if(e=n.action,e!==null){var p={payload:m,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};B.T!==null?r(!0):p.isTransition=!1,c(p),r=n.pending,r===null?(p.next=n.pending=p,_f(n,p)):(p.next=r.next,n.pending=r.next=p)}}function _f(e,n){var r=n.action,c=n.payload,m=e.state;if(n.isTransition){var p=B.T,v={};B.T=v;try{var C=r(m,c),N=B.S;N!==null&&N(v,C),Mf(e,n,C)}catch(U){qc(e,n,U)}finally{p!==null&&v.types!==null&&(p.types=v.types),B.T=p}}else try{p=r(m,c),Mf(e,n,p)}catch(U){qc(e,n,U)}}function Mf(e,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){Df(e,n,c)},function(c){return qc(e,n,c)}):Df(e,n,r)}function Df(e,n,r){n.status="fulfilled",n.value=r,Rf(n),e.state=r,n=e.pending,n!==null&&(r=n.next,r===n?e.pending=null:(r=r.next,n.next=r,_f(e,r)))}function qc(e,n,r){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,Rf(n),n=n.next;while(n!==c)}e.action=null}function Rf(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Nf(e,n){return n}function kf(e,n){if(kt){var r=Kt.formState;if(r!==null){t:{var c=Et;if(kt){if(Qt){e:{for(var m=Qt,p=yi;m.nodeType!==8;){if(!p){m=null;break e}if(m=vi(m.nextSibling),m===null){m=null;break e}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){Qt=vi(m.nextSibling),c=m.data==="F!";break t}}vn(c)}c=!1}c&&(n=r[0])}}return r=Be(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nf,lastRenderedState:n},r.queue=c,r=Qf.bind(null,Et,c),c.dispatch=r,c=Yc(!1),p=Jc.bind(null,Et,!1,c.queue),c=Be(),m={state:n,dispatch:null,action:e,pending:null},c.queue=m,r=rb.bind(null,Et,m,p,r),m.dispatch=r,c.memoizedState=e,[n,r,!1]}function Of(e){var n=le();return Lf(n,Xt,e)}function Lf(e,n,r){if(n=Vc(e,n,Nf)[0],e=yo(Zi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=Va(n)}catch(v){throw v===Fs?ro:v}else c=n;n=le();var m=n.queue,p=m.dispatch;return r!==n.memoizedState&&(Et.flags|=2048,Is(9,{destroy:void 0},ob.bind(null,m,r),null)),[c,p,e]}function ob(e,n){e.action=n}function Bf(e){var n=le(),r=Xt;if(r!==null)return Lf(n,r,e);le(),n=n.memoizedState,r=le();var c=r.queue.dispatch;return r.memoizedState=e,[n,c,!1]}function Is(e,n,r,c){return e={tag:e,create:r,deps:c,inst:n,next:null},n=Et.updateQueue,n===null&&(n=go(),Et.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=e.next=e:(c=r.next,r.next=e,e.next=c,n.lastEffect=e),e}function Ff(){return le().memoizedState}function bo(e,n,r,c){var m=Be();Et.flags|=e,m.memoizedState=Is(1|n,{destroy:void 0},r,c===void 0?null:c)}function vo(e,n,r,c){var m=le();c=c===void 0?null:c;var p=m.memoizedState.inst;Xt!==null&&c!==null&&jc(c,Xt.memoizedState.deps)?m.memoizedState=Is(n,p,r,c):(Et.flags|=e,m.memoizedState=Is(1|n,p,r,c))}function zf(e,n){bo(8390656,8,e,n)}function $c(e,n){vo(2048,8,e,n)}function lb(e){Et.flags|=4;var n=Et.updateQueue;if(n===null)n=go(),Et.updateQueue=n,n.events=[e];else{var r=n.events;r===null?n.events=[e]:r.push(e)}}function jf(e){var n=le().memoizedState;return lb({ref:n,nextImpl:e}),function(){if((Ft&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function Pf(e,n){return vo(4,2,e,n)}function Uf(e,n){return vo(4,4,e,n)}function If(e,n){if(typeof n=="function"){e=e();var r=n(e);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Hf(e,n,r){r=r!=null?r.concat([e]):null,vo(4,4,If.bind(null,n,e),r)}function Kc(){}function Gf(e,n){var r=le();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&jc(n,c[1])?c[0]:(r.memoizedState=[e,n],e)}function Vf(e,n){var r=le();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&jc(n,c[1]))return c[0];if(c=e(),ss){mn(!0);try{e()}finally{mn(!1)}}return r.memoizedState=[c,n],c}function Wc(e,n,r){return r===void 0||(Qi&1073741824)!==0&&(Dt&261930)===0?e.memoizedState=n:(e.memoizedState=r,e=Xm(),Et.lanes|=e,Mn|=e,r)}function Xf(e,n,r,c){return Je(r,n)?r:js.current!==null?(e=Wc(e,r,c),Je(e,n)||(de=!0),e):(Qi&42)===0||(Qi&1073741824)!==0&&(Dt&261930)===0?(de=!0,e.memoizedState=r):(e=Xm(),Et.lanes|=e,Mn|=e,n)}function Yf(e,n,r,c,m){var p=G.p;G.p=p!==0&&8>p?p:8;var v=B.T,C={};B.T=C,Jc(e,!1,n,r);try{var N=m(),U=B.S;if(U!==null&&U(C,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var Y=nb(N,c);Xa(e,n,Y,ai(e))}else Xa(e,n,c,ai(e))}catch($){Xa(e,n,{then:function(){},status:"rejected",reason:$},ai())}finally{G.p=p,v!==null&&C.types!==null&&(v.types=C.types),B.T=v}}function cb(){}function Qc(e,n,r,c){if(e.tag!==5)throw Error(s(476));var m=qf(e).queue;Yf(e,m,n,Z,r===null?cb:function(){return $f(e),r(c)})}function qf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:Z},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:r},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function $f(e){var n=qf(e);n.next===null&&(n=e.alternate.memoizedState),Xa(e,n.next.queue,{},ai())}function Zc(){return Ce(lr)}function Kf(){return le().memoizedState}function Wf(){return le().memoizedState}function ub(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var r=ai();e=wn(r);var c=Sn(n,e,r);c!==null&&(Ye(c,n,r),Ua(c,n,r)),n={cache:_c()},e.payload=n;return}n=n.return}}function hb(e,n,r){var c=ai();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Ao(e)?Zf(n,r):(r=pc(e,n,r,c),r!==null&&(Ye(r,e,c),Jf(r,n,c)))}function Qf(e,n,r){var c=ai();Xa(e,n,r,c)}function Xa(e,n,r,c){var m={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ao(e))Zf(n,m);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var v=n.lastRenderedState,C=p(v,r);if(m.hasEagerState=!0,m.eagerState=C,Je(C,v))return Jr(e,n,m,0),Kt===null&&Zr(),!1}catch{}if(r=pc(e,n,m,c),r!==null)return Ye(r,e,c),Jf(r,n,c),!0}return!1}function Jc(e,n,r,c){if(c={lane:2,revertLane:Nu(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ao(e)){if(n)throw Error(s(479))}else n=pc(e,r,c,2),n!==null&&Ye(n,e,2)}function Ao(e){var n=e.alternate;return e===Et||n!==null&&n===Et}function Zf(e,n){Ps=fo=!0;var r=e.pending;r===null?n.next=n:(n.next=r.next,r.next=n),e.pending=n}function Jf(e,n,r){if((r&4194048)!==0){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,nd(e,r)}}var Ya={readContext:Ce,use:po,useCallback:se,useContext:se,useEffect:se,useImperativeHandle:se,useLayoutEffect:se,useInsertionEffect:se,useMemo:se,useReducer:se,useRef:se,useState:se,useDebugValue:se,useDeferredValue:se,useTransition:se,useSyncExternalStore:se,useId:se,useHostTransitionStatus:se,useFormState:se,useActionState:se,useOptimistic:se,useMemoCache:se,useCacheRefresh:se};Ya.useEffectEvent=se;var tm={readContext:Ce,use:po,useCallback:function(e,n){return Be().memoizedState=[e,n===void 0?null:n],e},useContext:Ce,useEffect:zf,useImperativeHandle:function(e,n,r){r=r!=null?r.concat([e]):null,bo(4194308,4,If.bind(null,n,e),r)},useLayoutEffect:function(e,n){return bo(4194308,4,e,n)},useInsertionEffect:function(e,n){bo(4,2,e,n)},useMemo:function(e,n){var r=Be();n=n===void 0?null:n;var c=e();if(ss){mn(!0);try{e()}finally{mn(!1)}}return r.memoizedState=[c,n],c},useReducer:function(e,n,r){var c=Be();if(r!==void 0){var m=r(n);if(ss){mn(!0);try{r(n)}finally{mn(!1)}}}else m=n;return c.memoizedState=c.baseState=m,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:m},c.queue=e,e=e.dispatch=hb.bind(null,Et,e),[c.memoizedState,e]},useRef:function(e){var n=Be();return e={current:e},n.memoizedState=e},useState:function(e){e=Yc(e);var n=e.queue,r=Qf.bind(null,Et,n);return n.dispatch=r,[e.memoizedState,r]},useDebugValue:Kc,useDeferredValue:function(e,n){var r=Be();return Wc(r,e,n)},useTransition:function(){var e=Yc(!1);return e=Yf.bind(null,Et,e.queue,!0,!1),Be().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,r){var c=Et,m=Be();if(kt){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),Kt===null)throw Error(s(349));(Dt&127)!==0||xf(c,n,r)}m.memoizedState=r;var p={value:r,getSnapshot:n};return m.queue=p,zf(Sf.bind(null,c,p,e),[e]),c.flags|=2048,Is(9,{destroy:void 0},wf.bind(null,c,p,r,n),null),r},useId:function(){var e=Be(),n=Kt.identifierPrefix;if(kt){var r=Oi,c=ki;r=(c&~(1<<32-Ze(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=mo++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=sb++,n="_"+n+"r_"+r.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Zc,useFormState:kf,useActionState:kf,useOptimistic:function(e){var n=Be();n.memoizedState=n.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=Jc.bind(null,Et,!0,r),r.dispatch=n,[e,n]},useMemoCache:Gc,useCacheRefresh:function(){return Be().memoizedState=ub.bind(null,Et)},useEffectEvent:function(e){var n=Be(),r={impl:e};return n.memoizedState=r,function(){if((Ft&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},tu={readContext:Ce,use:po,useCallback:Gf,useContext:Ce,useEffect:$c,useImperativeHandle:Hf,useInsertionEffect:Pf,useLayoutEffect:Uf,useMemo:Vf,useReducer:yo,useRef:Ff,useState:function(){return yo(Zi)},useDebugValue:Kc,useDeferredValue:function(e,n){var r=le();return Xf(r,Xt.memoizedState,e,n)},useTransition:function(){var e=yo(Zi)[0],n=le().memoizedState;return[typeof e=="boolean"?e:Va(e),n]},useSyncExternalStore:Af,useId:Kf,useHostTransitionStatus:Zc,useFormState:Of,useActionState:Of,useOptimistic:function(e,n){var r=le();return Tf(r,Xt,e,n)},useMemoCache:Gc,useCacheRefresh:Wf};tu.useEffectEvent=jf;var em={readContext:Ce,use:po,useCallback:Gf,useContext:Ce,useEffect:$c,useImperativeHandle:Hf,useInsertionEffect:Pf,useLayoutEffect:Uf,useMemo:Vf,useReducer:Xc,useRef:Ff,useState:function(){return Xc(Zi)},useDebugValue:Kc,useDeferredValue:function(e,n){var r=le();return Xt===null?Wc(r,e,n):Xf(r,Xt.memoizedState,e,n)},useTransition:function(){var e=Xc(Zi)[0],n=le().memoizedState;return[typeof e=="boolean"?e:Va(e),n]},useSyncExternalStore:Af,useId:Kf,useHostTransitionStatus:Zc,useFormState:Bf,useActionState:Bf,useOptimistic:function(e,n){var r=le();return Xt!==null?Tf(r,Xt,e,n):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Gc,useCacheRefresh:Wf};em.useEffectEvent=jf;function eu(e,n,r,c){n=e.memoizedState,r=r(c,n),r=r==null?n:y({},n,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var iu={enqueueSetState:function(e,n,r){e=e._reactInternals;var c=ai(),m=wn(c);m.payload=n,r!=null&&(m.callback=r),n=Sn(e,m,c),n!==null&&(Ye(n,e,c),Ua(n,e,c))},enqueueReplaceState:function(e,n,r){e=e._reactInternals;var c=ai(),m=wn(c);m.tag=1,m.payload=n,r!=null&&(m.callback=r),n=Sn(e,m,c),n!==null&&(Ye(n,e,c),Ua(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var r=ai(),c=wn(r);c.tag=2,n!=null&&(c.callback=n),n=Sn(e,c,r),n!==null&&(Ye(n,e,r),Ua(n,e,r))}};function im(e,n,r,c,m,p,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,p,v):n.prototype&&n.prototype.isPureReactComponent?!ka(r,c)||!ka(m,p):!0}function nm(e,n,r,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==e&&iu.enqueueReplaceState(n,n.state,null)}function as(e,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(e=e.defaultProps){r===n&&(r=y({},r));for(var m in e)r[m]===void 0&&(r[m]=e[m])}return r}function sm(e){Qr(e)}function am(e){console.error(e)}function rm(e){Qr(e)}function xo(e,n){try{var r=e.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function om(e,n,r){try{var c=e.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function nu(e,n,r){return r=wn(r),r.tag=3,r.payload={element:null},r.callback=function(){xo(e,n)},r}function lm(e){return e=wn(e),e.tag=3,e}function cm(e,n,r,c){var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var p=c.value;e.payload=function(){return m(p)},e.callback=function(){om(n,r,c)}}var v=r.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){om(n,r,c),typeof m!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})})}function db(e,n,r,c,m){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Os(n,r,m,!0),r=ei.current,r!==null){switch(r.tag){case 31:case 13:return bi===null?Oo():r.alternate===null&&ae===0&&(ae=3),r.flags&=-257,r.flags|=65536,r.lanes=m,c===oo?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),Mu(e,c,m)),!1;case 22:return r.flags|=65536,c===oo?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),Mu(e,c,m)),!1}throw Error(s(435,r.tag))}return Mu(e,c,m),Oo(),!1}if(kt)return n=ei.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=m,c!==wc&&(e=Error(s(422),{cause:c}),Ba(mi(e,r)))):(c!==wc&&(n=Error(s(423),{cause:c}),Ba(mi(n,r))),e=e.current.alternate,e.flags|=65536,m&=-m,e.lanes|=m,c=mi(c,r),m=nu(e.stateNode,c,m),Oc(e,m),ae!==4&&(ae=2)),!1;var p=Error(s(520),{cause:c});if(p=mi(p,r),tr===null?tr=[p]:tr.push(p),ae!==4&&(ae=2),n===null)return!0;c=mi(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,e=m&-m,r.lanes|=e,e=nu(r.stateNode,c,e),Oc(r,e),!1;case 1:if(n=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Dn===null||!Dn.has(p))))return r.flags|=65536,m&=-m,r.lanes|=m,m=lm(m),cm(m,e,r,c),Oc(r,m),!1}r=r.return}while(r!==null);return!1}var su=Error(s(461)),de=!1;function Te(e,n,r,c){n.child=e===null?ff(n,null,r,c):ns(n,e.child,r,c)}function um(e,n,r,c,m){r=r.render;var p=n.ref;if("ref"in c){var v={};for(var C in c)C!=="ref"&&(v[C]=c[C])}else v=c;return Jn(n),c=Pc(e,n,r,v,p,m),C=Uc(),e!==null&&!de?(Ic(e,n,m),Ji(e,n,m)):(kt&&C&&Ac(n),n.flags|=1,Te(e,n,c,m),n.child)}function hm(e,n,r,c,m){if(e===null){var p=r.type;return typeof p=="function"&&!yc(p)&&p.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=p,dm(e,n,p,c,m)):(e=eo(r.type,null,c,n,n.mode,m),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!du(e,m)){var v=p.memoizedProps;if(r=r.compare,r=r!==null?r:ka,r(v,c)&&e.ref===n.ref)return Ji(e,n,m)}return n.flags|=1,e=qi(p,c),e.ref=n.ref,e.return=n,n.child=e}function dm(e,n,r,c,m){if(e!==null){var p=e.memoizedProps;if(ka(p,c)&&e.ref===n.ref)if(de=!1,n.pendingProps=c=p,du(e,m))(e.flags&131072)!==0&&(de=!0);else return n.lanes=e.lanes,Ji(e,n,m)}return au(e,n,r,c,m)}function fm(e,n,r,c){var m=c.children,p=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(p=p!==null?p.baseLanes|r:r,e!==null){for(c=n.child=e.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~p}else c=0,n.child=null;return mm(e,n,p,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&ao(n,p!==null?p.cachePool:null),p!==null?pf(n,p):Bc(),yf(n);else return c=n.lanes=536870912,mm(e,n,p!==null?p.baseLanes|r:r,r,c)}else p!==null?(ao(n,p.cachePool),pf(n,p),Cn(),n.memoizedState=null):(e!==null&&ao(n,null),Bc(),Cn());return Te(e,n,m,r),n.child}function qa(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function mm(e,n,r,c,m){var p=Dc();return p=p===null?null:{parent:ue._currentValue,pool:p},n.memoizedState={baseLanes:r,cachePool:p},e!==null&&ao(n,null),Bc(),yf(n),e!==null&&Os(e,n,c,!0),n.childLanes=m,null}function wo(e,n){return n=Eo({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function gm(e,n,r){return ns(n,e.child,null,r),e=wo(n,n.pendingProps),e.flags|=2,ii(n),n.memoizedState=null,e}function fb(e,n,r){var c=n.pendingProps,m=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(kt){if(c.mode==="hidden")return e=wo(n,c),n.lanes=536870912,qa(null,e);if(zc(n),(e=Qt)?(e=_g(e,yi),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:yn!==null?{id:ki,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},r=Qd(e),r.return=n,n.child=r,Ee=n,Qt=null)):e=null,e===null)throw vn(n);return n.lanes=536870912,null}return wo(n,c)}var p=e.memoizedState;if(p!==null){var v=p.dehydrated;if(zc(n),m)if(n.flags&256)n.flags&=-257,n=gm(e,n,r);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(de||Os(e,n,r,!1),m=(r&e.childLanes)!==0,de||m){if(c=Kt,c!==null&&(v=sd(c,r),v!==0&&v!==p.retryLane))throw p.retryLane=v,Kn(e,v),Ye(c,e,v),su;Oo(),n=gm(e,n,r)}else e=p.treeContext,Qt=vi(v.nextSibling),Ee=n,kt=!0,bn=null,yi=!1,e!==null&&tf(n,e),n=wo(n,c),n.flags|=4096;return n}return e=qi(e.child,{mode:c.mode,children:c.children}),e.ref=n.ref,n.child=e,e.return=n,e}function So(e,n){var r=n.ref;if(r===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(e===null||e.ref!==r)&&(n.flags|=4194816)}}function au(e,n,r,c,m){return Jn(n),r=Pc(e,n,r,c,void 0,m),c=Uc(),e!==null&&!de?(Ic(e,n,m),Ji(e,n,m)):(kt&&c&&Ac(n),n.flags|=1,Te(e,n,r,m),n.child)}function pm(e,n,r,c,m,p){return Jn(n),n.updateQueue=null,r=vf(n,c,r,m),bf(e),c=Uc(),e!==null&&!de?(Ic(e,n,p),Ji(e,n,p)):(kt&&c&&Ac(n),n.flags|=1,Te(e,n,r,p),n.child)}function ym(e,n,r,c,m){if(Jn(n),n.stateNode===null){var p=Ds,v=r.contextType;typeof v=="object"&&v!==null&&(p=Ce(v)),p=new r(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=iu,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},Nc(n),v=r.contextType,p.context=typeof v=="object"&&v!==null?Ce(v):Ds,p.state=n.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(eu(n,r,v,c),p.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&iu.enqueueReplaceState(p,p.state,null),Ha(n,c,p,m),Ia(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(e===null){p=n.stateNode;var C=n.memoizedProps,N=as(r,C);p.props=N;var U=p.context,Y=r.contextType;v=Ds,typeof Y=="object"&&Y!==null&&(v=Ce(Y));var $=r.getDerivedStateFromProps;Y=typeof $=="function"||typeof p.getSnapshotBeforeUpdate=="function",C=n.pendingProps!==C,Y||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(C||U!==v)&&nm(n,p,c,v),xn=!1;var I=n.memoizedState;p.state=I,Ha(n,c,p,m),Ia(),U=n.memoizedState,C||I!==U||xn?(typeof $=="function"&&(eu(n,r,$,c),U=n.memoizedState),(N=xn||im(n,r,N,c,I,U,v))?(Y||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=U),p.props=c,p.state=U,p.context=v,c=N):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,kc(e,n),v=n.memoizedProps,Y=as(r,v),p.props=Y,$=n.pendingProps,I=p.context,U=r.contextType,N=Ds,typeof U=="object"&&U!==null&&(N=Ce(U)),C=r.getDerivedStateFromProps,(U=typeof C=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==$||I!==N)&&nm(n,p,c,N),xn=!1,I=n.memoizedState,p.state=I,Ha(n,c,p,m),Ia();var V=n.memoizedState;v!==$||I!==V||xn||e!==null&&e.dependencies!==null&&no(e.dependencies)?(typeof C=="function"&&(eu(n,r,C,c),V=n.memoizedState),(Y=xn||im(n,r,Y,c,I,V,N)||e!==null&&e.dependencies!==null&&no(e.dependencies))?(U||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,V,N),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,V,N)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=V),p.props=c,p.state=V,p.context=N,c=Y):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=1024),c=!1)}return p=c,So(e,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&c?(n.child=ns(n,e.child,null,m),n.child=ns(n,null,r,m)):Te(e,n,r,m),n.memoizedState=p.state,e=n.child):e=Ji(e,n,m),e}function bm(e,n,r,c){return Qn(),n.flags|=256,Te(e,n,r,c),n.child}var ru={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ou(e){return{baseLanes:e,cachePool:of()}}function lu(e,n,r){return e=e!==null?e.childLanes&~r:0,n&&(e|=si),e}function vm(e,n,r){var c=n.pendingProps,m=!1,p=(n.flags&128)!==0,v;if((v=p)||(v=e!==null&&e.memoizedState===null?!1:(oe.current&2)!==0),v&&(m=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(kt){if(m?En(n):Cn(),(e=Qt)?(e=_g(e,yi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:yn!==null?{id:ki,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},r=Qd(e),r.return=n,n.child=r,Ee=n,Qt=null)):e=null,e===null)throw vn(n);return Vu(e)?n.lanes=32:n.lanes=536870912,null}var C=c.children;return c=c.fallback,m?(Cn(),m=n.mode,C=Eo({mode:"hidden",children:C},m),c=Wn(c,m,r,null),C.return=n,c.return=n,C.sibling=c,n.child=C,c=n.child,c.memoizedState=ou(r),c.childLanes=lu(e,v,r),n.memoizedState=ru,qa(null,c)):(En(n),cu(n,C))}var N=e.memoizedState;if(N!==null&&(C=N.dehydrated,C!==null)){if(p)n.flags&256?(En(n),n.flags&=-257,n=uu(e,n,r)):n.memoizedState!==null?(Cn(),n.child=e.child,n.flags|=128,n=null):(Cn(),C=c.fallback,m=n.mode,c=Eo({mode:"visible",children:c.children},m),C=Wn(C,m,r,null),C.flags|=2,c.return=n,C.return=n,c.sibling=C,n.child=c,ns(n,e.child,null,r),c=n.child,c.memoizedState=ou(r),c.childLanes=lu(e,v,r),n.memoizedState=ru,n=qa(null,c));else if(En(n),Vu(C)){if(v=C.nextSibling&&C.nextSibling.dataset,v)var U=v.dgst;v=U,c=Error(s(419)),c.stack="",c.digest=v,Ba({value:c,source:null,stack:null}),n=uu(e,n,r)}else if(de||Os(e,n,r,!1),v=(r&e.childLanes)!==0,de||v){if(v=Kt,v!==null&&(c=sd(v,r),c!==0&&c!==N.retryLane))throw N.retryLane=c,Kn(e,c),Ye(v,e,c),su;Gu(C)||Oo(),n=uu(e,n,r)}else Gu(C)?(n.flags|=192,n.child=e.child,n=null):(e=N.treeContext,Qt=vi(C.nextSibling),Ee=n,kt=!0,bn=null,yi=!1,e!==null&&tf(n,e),n=cu(n,c.children),n.flags|=4096);return n}return m?(Cn(),C=c.fallback,m=n.mode,N=e.child,U=N.sibling,c=qi(N,{mode:"hidden",children:c.children}),c.subtreeFlags=N.subtreeFlags&65011712,U!==null?C=qi(U,C):(C=Wn(C,m,r,null),C.flags|=2),C.return=n,c.return=n,c.sibling=C,n.child=c,qa(null,c),c=n.child,C=e.child.memoizedState,C===null?C=ou(r):(m=C.cachePool,m!==null?(N=ue._currentValue,m=m.parent!==N?{parent:N,pool:N}:m):m=of(),C={baseLanes:C.baseLanes|r,cachePool:m}),c.memoizedState=C,c.childLanes=lu(e,v,r),n.memoizedState=ru,qa(e.child,c)):(En(n),r=e.child,e=r.sibling,r=qi(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=r,n.memoizedState=null,r)}function cu(e,n){return n=Eo({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function Eo(e,n){return e=ti(22,e,null,n),e.lanes=0,e}function uu(e,n,r){return ns(n,e.child,null,r),e=cu(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Am(e,n,r){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),Cc(e.return,n,r)}function hu(e,n,r,c,m,p){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:m,treeForkCount:p}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=r,v.tailMode=m,v.treeForkCount=p)}function xm(e,n,r){var c=n.pendingProps,m=c.revealOrder,p=c.tail;c=c.children;var v=oe.current,C=(v&2)!==0;if(C?(v=v&1|2,n.flags|=128):v&=1,W(oe,v),Te(e,n,c,r),c=kt?La:0,!C&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Am(e,r,n);else if(e.tag===19)Am(e,r,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(m){case"forwards":for(r=n.child,m=null;r!==null;)e=r.alternate,e!==null&&ho(e)===null&&(m=r),r=r.sibling;r=m,r===null?(m=n.child,n.child=null):(m=r.sibling,r.sibling=null),hu(n,!1,m,r,p,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,m=n.child,n.child=null;m!==null;){if(e=m.alternate,e!==null&&ho(e)===null){n.child=m;break}e=m.sibling,m.sibling=r,r=m,m=e}hu(n,!0,r,null,p,c);break;case"together":hu(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function Ji(e,n,r){if(e!==null&&(n.dependencies=e.dependencies),Mn|=n.lanes,(r&n.childLanes)===0)if(e!==null){if(Os(e,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,r=qi(e,e.pendingProps),n.child=r,r.return=n;e.sibling!==null;)e=e.sibling,r=r.sibling=qi(e,e.pendingProps),r.return=n;r.sibling=null}return n.child}function du(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&no(e)))}function mb(e,n,r){switch(n.tag){case 3:Ht(n,n.stateNode.containerInfo),An(n,ue,e.memoizedState.cache),Qn();break;case 27:case 5:ui(n);break;case 4:Ht(n,n.stateNode.containerInfo);break;case 10:An(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,zc(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(En(n),n.flags|=128,null):(r&n.child.childLanes)!==0?vm(e,n,r):(En(n),e=Ji(e,n,r),e!==null?e.sibling:null);En(n);break;case 19:var m=(e.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Os(e,n,r,!1),c=(r&n.childLanes)!==0),m){if(c)return xm(e,n,r);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),W(oe,oe.current),c)break;return null;case 22:return n.lanes=0,fm(e,n,r,n.pendingProps);case 24:An(n,ue,e.memoizedState.cache)}return Ji(e,n,r)}function wm(e,n,r){if(e!==null)if(e.memoizedProps!==n.pendingProps)de=!0;else{if(!du(e,r)&&(n.flags&128)===0)return de=!1,mb(e,n,r);de=(e.flags&131072)!==0}else de=!1,kt&&(n.flags&1048576)!==0&&Jd(n,La,n.index);switch(n.lanes=0,n.tag){case 16:t:{var c=n.pendingProps;if(e=es(n.elementType),n.type=e,typeof e=="function")yc(e)?(c=as(e,c),n.tag=1,n=ym(null,n,e,c,r)):(n.tag=0,n=au(null,n,e,c,r));else{if(e!=null){var m=e.$$typeof;if(m===R){n.tag=11,n=um(null,n,e,c,r);break t}else if(m===F){n.tag=14,n=hm(null,n,e,c,r);break t}}throw n=J(e)||e,Error(s(306,n,""))}}return n;case 0:return au(e,n,n.type,n.pendingProps,r);case 1:return c=n.type,m=as(c,n.pendingProps),ym(e,n,c,m,r);case 3:t:{if(Ht(n,n.stateNode.containerInfo),e===null)throw Error(s(387));c=n.pendingProps;var p=n.memoizedState;m=p.element,kc(e,n),Ha(n,c,null,r);var v=n.memoizedState;if(c=v.cache,An(n,ue,c),c!==p.cache&&Tc(n,[ue],r,!0),Ia(),c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=bm(e,n,c,r);break t}else if(c!==m){m=mi(Error(s(424)),n),Ba(m),n=bm(e,n,c,r);break t}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Qt=vi(e.firstChild),Ee=n,kt=!0,bn=null,yi=!0,r=ff(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qn(),c===m){n=Ji(e,n,r);break t}Te(e,n,c,r)}n=n.child}return n;case 26:return So(e,n),e===null?(r=Og(n.type,null,n.pendingProps,null))?n.memoizedState=r:kt||(r=n.type,e=n.pendingProps,c=Uo(yt.current).createElement(r),c[Se]=n,c[Ue]=e,_e(c,r,e),ve(c),n.stateNode=c):n.memoizedState=Og(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return ui(n),e===null&&kt&&(c=n.stateNode=Rg(n.type,n.pendingProps,yt.current),Ee=n,yi=!0,m=Qt,On(n.type)?(Xu=m,Qt=vi(c.firstChild)):Qt=m),Te(e,n,n.pendingProps.children,r),So(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&kt&&((m=c=Qt)&&(c=Vb(c,n.type,n.pendingProps,yi),c!==null?(n.stateNode=c,Ee=n,Qt=vi(c.firstChild),yi=!1,m=!0):m=!1),m||vn(n)),ui(n),m=n.type,p=n.pendingProps,v=e!==null?e.memoizedProps:null,c=p.children,Uu(m,p)?c=null:v!==null&&Uu(m,v)&&(n.flags|=32),n.memoizedState!==null&&(m=Pc(e,n,ab,null,null,r),lr._currentValue=m),So(e,n),Te(e,n,c,r),n.child;case 6:return e===null&&kt&&((e=r=Qt)&&(r=Xb(r,n.pendingProps,yi),r!==null?(n.stateNode=r,Ee=n,Qt=null,e=!0):e=!1),e||vn(n)),null;case 13:return vm(e,n,r);case 4:return Ht(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=ns(n,null,c,r):Te(e,n,c,r),n.child;case 11:return um(e,n,n.type,n.pendingProps,r);case 7:return Te(e,n,n.pendingProps,r),n.child;case 8:return Te(e,n,n.pendingProps.children,r),n.child;case 12:return Te(e,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,An(n,n.type,c.value),Te(e,n,c.children,r),n.child;case 9:return m=n.type._context,c=n.pendingProps.children,Jn(n),m=Ce(m),c=c(m),n.flags|=1,Te(e,n,c,r),n.child;case 14:return hm(e,n,n.type,n.pendingProps,r);case 15:return dm(e,n,n.type,n.pendingProps,r);case 19:return xm(e,n,r);case 31:return fb(e,n,r);case 22:return fm(e,n,r,n.pendingProps);case 24:return Jn(n),c=Ce(ue),e===null?(m=Dc(),m===null&&(m=Kt,p=_c(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=r),m=p),n.memoizedState={parent:c,cache:m},Nc(n),An(n,ue,m)):((e.lanes&r)!==0&&(kc(e,n),Ha(n,null,null,r),Ia()),m=e.memoizedState,p=n.memoizedState,m.parent!==c?(m={parent:c,cache:c},n.memoizedState=m,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=m),An(n,ue,c)):(c=p.cache,An(n,ue,c),c!==m.cache&&Tc(n,[ue],r,!0))),Te(e,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function tn(e){e.flags|=4}function fu(e,n,r,c,m){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(m&335544128)===m)if(e.stateNode.complete)e.flags|=8192;else if(Km())e.flags|=8192;else throw is=oo,Rc}else e.flags&=-16777217}function Sm(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!jg(n))if(Km())e.flags|=8192;else throw is=oo,Rc}function Co(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?ed():536870912,e.lanes|=n,Xs|=n)}function $a(e,n){if(!kt)switch(e.tailMode){case"hidden":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Zt(e){var n=e.alternate!==null&&e.alternate.child===e.child,r=0,c=0;if(n)for(var m=e.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=e,m=m.sibling;else for(m=e.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=e,m=m.sibling;return e.subtreeFlags|=c,e.childLanes=r,n}function gb(e,n,r){var c=n.pendingProps;switch(xc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(n),null;case 1:return Zt(n),null;case 3:return r=n.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Wi(ue),Nt(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ks(n)?tn(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Sc())),Zt(n),null;case 26:var m=n.type,p=n.memoizedState;return e===null?(tn(n),p!==null?(Zt(n),Sm(n,p)):(Zt(n),fu(n,m,null,c,r))):p?p!==e.memoizedState?(tn(n),Zt(n),Sm(n,p)):(Zt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==c&&tn(n),Zt(n),fu(n,m,e,c,r)),null;case 27:if(gt(n),r=yt.current,m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&tn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Zt(n),null}e=it.current,ks(n)?ef(n):(e=Rg(m,c,r),n.stateNode=e,tn(n))}return Zt(n),null;case 5:if(gt(n),m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&tn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Zt(n),null}if(p=it.current,ks(n))ef(n);else{var v=Uo(yt.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?v.createElement(m,{is:c.is}):v.createElement(m)}}p[Se]=n,p[Ue]=c;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=p;t:switch(_e(p,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&tn(n)}}return Zt(n),fu(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,r),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==c&&tn(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(e=yt.current,ks(n)){if(e=n.stateNode,r=n.memoizedProps,c=null,m=Ee,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}e[Se]=n,e=!!(e.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||vg(e.nodeValue,r)),e||vn(n,!0)}else e=Uo(e).createTextNode(c),e[Se]=n,n.stateNode=e}return Zt(n),null;case 31:if(r=n.memoizedState,e===null||e.memoizedState!==null){if(c=ks(n),r!==null){if(e===null){if(!c)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Se]=n}else Qn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Zt(n),e=!1}else r=Sc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return n.flags&256?(ii(n),n):(ii(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Zt(n),null;case 13:if(c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(m=ks(n),c!==null&&c.dehydrated!==null){if(e===null){if(!m)throw Error(s(318));if(m=n.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[Se]=n}else Qn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Zt(n),m=!1}else m=Sc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=m),m=!0;if(!m)return n.flags&256?(ii(n),n):(ii(n),null)}return ii(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,e=e!==null&&e.memoizedState!==null,r&&(c=n.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==m&&(c.flags|=2048)),r!==e&&r&&(n.child.flags|=8192),Co(n,n.updateQueue),Zt(n),null);case 4:return Nt(),e===null&&Bu(n.stateNode.containerInfo),Zt(n),null;case 10:return Wi(n.type),Zt(n),null;case 19:if(H(oe),c=n.memoizedState,c===null)return Zt(n),null;if(m=(n.flags&128)!==0,p=c.rendering,p===null)if(m)$a(c,!1);else{if(ae!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=ho(e),p!==null){for(n.flags|=128,$a(c,!1),e=p.updateQueue,n.updateQueue=e,Co(n,e),n.subtreeFlags=0,e=r,r=n.child;r!==null;)Wd(r,e),r=r.sibling;return W(oe,oe.current&1|2),kt&&$i(n,c.treeForkCount),n.child}e=e.sibling}c.tail!==null&&ke()>Ro&&(n.flags|=128,m=!0,$a(c,!1),n.lanes=4194304)}else{if(!m)if(e=ho(p),e!==null){if(n.flags|=128,m=!0,e=e.updateQueue,n.updateQueue=e,Co(n,e),$a(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!kt)return Zt(n),null}else 2*ke()-c.renderingStartTime>Ro&&r!==536870912&&(n.flags|=128,m=!0,$a(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(e=c.last,e!==null?e.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=ke(),e.sibling=null,r=oe.current,W(oe,m?r&1|2:r&1),kt&&$i(n,c.treeForkCount),e):(Zt(n),null);case 22:case 23:return ii(n),Fc(),c=n.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Zt(n),n.subtreeFlags&6&&(n.flags|=8192)):Zt(n),r=n.updateQueue,r!==null&&Co(n,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),e!==null&&H(ts),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Wi(ue),Zt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function pb(e,n){switch(xc(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Wi(ue),Nt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return gt(n),null;case 31:if(n.memoizedState!==null){if(ii(n),n.alternate===null)throw Error(s(340));Qn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(ii(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Qn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return H(oe),null;case 4:return Nt(),null;case 10:return Wi(n.type),null;case 22:case 23:return ii(n),Fc(),e!==null&&H(ts),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Wi(ue),null;case 25:return null;default:return null}}function Em(e,n){switch(xc(n),n.tag){case 3:Wi(ue),Nt();break;case 26:case 27:case 5:gt(n);break;case 4:Nt();break;case 31:n.memoizedState!==null&&ii(n);break;case 13:ii(n);break;case 19:H(oe);break;case 10:Wi(n.type);break;case 22:case 23:ii(n),Fc(),e!==null&&H(ts);break;case 24:Wi(ue)}}function Ka(e,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var m=c.next;r=m;do{if((r.tag&e)===e){c=void 0;var p=r.create,v=r.inst;c=p(),v.destroy=c}r=r.next}while(r!==m)}}catch(C){Vt(n,n.return,C)}}function Tn(e,n,r){try{var c=n.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var p=m.next;c=p;do{if((c.tag&e)===e){var v=c.inst,C=v.destroy;if(C!==void 0){v.destroy=void 0,m=n;var N=r,U=C;try{U()}catch(Y){Vt(m,N,Y)}}}c=c.next}while(c!==p)}}catch(Y){Vt(n,n.return,Y)}}function Cm(e){var n=e.updateQueue;if(n!==null){var r=e.stateNode;try{gf(n,r)}catch(c){Vt(e,e.return,c)}}}function Tm(e,n,r){r.props=as(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(c){Vt(e,n,c)}}function Wa(e,n){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof r=="function"?e.refCleanup=r(c):r.current=c}}catch(m){Vt(e,n,m)}}function Li(e,n){var r=e.ref,c=e.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(m){Vt(e,n,m)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(m){Vt(e,n,m)}else r.current=null}function _m(e){var n=e.type,r=e.memoizedProps,c=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break t;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(m){Vt(e,e.return,m)}}function mu(e,n,r){try{var c=e.stateNode;jb(c,e.type,r,n),c[Ue]=n}catch(m){Vt(e,e.return,m)}}function Mm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&On(e.type)||e.tag===4}function gu(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Mm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&On(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pu(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(e),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Xi));else if(c!==4&&(c===27&&On(e.type)&&(r=e.stateNode,n=null),e=e.child,e!==null))for(pu(e,n,r),e=e.sibling;e!==null;)pu(e,n,r),e=e.sibling}function To(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?r.insertBefore(e,n):r.appendChild(e);else if(c!==4&&(c===27&&On(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(To(e,n,r),e=e.sibling;e!==null;)To(e,n,r),e=e.sibling}function Dm(e){var n=e.stateNode,r=e.memoizedProps;try{for(var c=e.type,m=n.attributes;m.length;)n.removeAttributeNode(m[0]);_e(n,c,r),n[Se]=e,n[Ue]=r}catch(p){Vt(e,e.return,p)}}var en=!1,fe=!1,yu=!1,Rm=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function yb(e,n){if(e=e.containerInfo,ju=qo,e=Id(e),uc(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var m=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break t}var v=0,C=-1,N=-1,U=0,Y=0,$=e,I=null;e:for(;;){for(var V;$!==r||m!==0&&$.nodeType!==3||(C=v+m),$!==p||c!==0&&$.nodeType!==3||(N=v+c),$.nodeType===3&&(v+=$.nodeValue.length),(V=$.firstChild)!==null;)I=$,$=V;for(;;){if($===e)break e;if(I===r&&++U===m&&(C=v),I===p&&++Y===c&&(N=v),(V=$.nextSibling)!==null)break;$=I,I=$.parentNode}$=V}r=C===-1||N===-1?null:{start:C,end:N}}else r=null}r=r||{start:0,end:0}}else r=null;for(Pu={focusedElem:e,selectionRange:r},qo=!1,Ae=n;Ae!==null;)if(n=Ae,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Ae=e;else for(;Ae!==null;){switch(n=Ae,p=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)m=e[r],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,r=n,m=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var rt=as(r.type,m);e=c.getSnapshotBeforeUpdate(rt,p),c.__reactInternalSnapshotBeforeUpdate=e}catch(pt){Vt(r,r.return,pt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,r=e.nodeType,r===9)Hu(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Hu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,Ae=e;break}Ae=n.return}}function Nm(e,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:sn(e,r),c&4&&Ka(5,r);break;case 1:if(sn(e,r),c&4)if(e=r.stateNode,n===null)try{e.componentDidMount()}catch(v){Vt(r,r.return,v)}else{var m=as(r.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(m,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Vt(r,r.return,v)}}c&64&&Cm(r),c&512&&Wa(r,r.return);break;case 3:if(sn(e,r),c&64&&(e=r.updateQueue,e!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{gf(e,n)}catch(v){Vt(r,r.return,v)}}break;case 27:n===null&&c&4&&Dm(r);case 26:case 5:sn(e,r),n===null&&c&4&&_m(r),c&512&&Wa(r,r.return);break;case 12:sn(e,r);break;case 31:sn(e,r),c&4&&Lm(e,r);break;case 13:sn(e,r),c&4&&Bm(e,r),c&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=Tb.bind(null,r),Yb(e,r))));break;case 22:if(c=r.memoizedState!==null||en,!c){n=n!==null&&n.memoizedState!==null||fe,m=en;var p=fe;en=c,(fe=n)&&!p?an(e,r,(r.subtreeFlags&8772)!==0):sn(e,r),en=m,fe=p}break;case 30:break;default:sn(e,r)}}function km(e){var n=e.alternate;n!==null&&(e.alternate=null,km(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&ql(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Jt=null,He=!1;function nn(e,n,r){for(r=r.child;r!==null;)Om(e,n,r),r=r.sibling}function Om(e,n,r){if(Qe&&typeof Qe.onCommitFiberUnmount=="function")try{Qe.onCommitFiberUnmount(Aa,r)}catch{}switch(r.tag){case 26:fe||Li(r,n),nn(e,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:fe||Li(r,n);var c=Jt,m=He;On(r.type)&&(Jt=r.stateNode,He=!1),nn(e,n,r),ar(r.stateNode),Jt=c,He=m;break;case 5:fe||Li(r,n);case 6:if(c=Jt,m=He,Jt=null,nn(e,n,r),Jt=c,He=m,Jt!==null)if(He)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(r.stateNode)}catch(p){Vt(r,n,p)}else try{Jt.removeChild(r.stateNode)}catch(p){Vt(r,n,p)}break;case 18:Jt!==null&&(He?(e=Jt,Cg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),Js(e)):Cg(Jt,r.stateNode));break;case 4:c=Jt,m=He,Jt=r.stateNode.containerInfo,He=!0,nn(e,n,r),Jt=c,He=m;break;case 0:case 11:case 14:case 15:Tn(2,r,n),fe||Tn(4,r,n),nn(e,n,r);break;case 1:fe||(Li(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Tm(r,n,c)),nn(e,n,r);break;case 21:nn(e,n,r);break;case 22:fe=(c=fe)||r.memoizedState!==null,nn(e,n,r),fe=c;break;default:nn(e,n,r)}}function Lm(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Js(e)}catch(r){Vt(n,n.return,r)}}}function Bm(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Js(e)}catch(r){Vt(n,n.return,r)}}function bb(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Rm),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Rm),n;default:throw Error(s(435,e.tag))}}function _o(e,n){var r=bb(e);n.forEach(function(c){if(!r.has(c)){r.add(c);var m=_b.bind(null,e,c);c.then(m,m)}})}function Ge(e,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var m=r[c],p=e,v=n,C=v;t:for(;C!==null;){switch(C.tag){case 27:if(On(C.type)){Jt=C.stateNode,He=!1;break t}break;case 5:Jt=C.stateNode,He=!1;break t;case 3:case 4:Jt=C.stateNode.containerInfo,He=!0;break t}C=C.return}if(Jt===null)throw Error(s(160));Om(p,v,m),Jt=null,He=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)Fm(n,e),n=n.sibling}var Ti=null;function Fm(e,n){var r=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ge(n,e),Ve(e),c&4&&(Tn(3,e,e.return),Ka(3,e),Tn(5,e,e.return));break;case 1:Ge(n,e),Ve(e),c&512&&(fe||r===null||Li(r,r.return)),c&64&&en&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var m=Ti;if(Ge(n,e),Ve(e),c&512&&(fe||r===null||Li(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=e.memoizedState,r===null)if(c===null)if(e.stateNode===null){t:{c=e.type,r=e.memoizedProps,m=m.ownerDocument||m;e:switch(c){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Sa]||p[Se]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(c),m.head.insertBefore(p,m.querySelector("head > title"))),_e(p,c,r),p[Se]=e,ve(p),c=p;break t;case"link":var v=Fg("link","href",m).get(c+(r.href||""));if(v){for(var C=0;C<v.length;C++)if(p=v[C],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){v.splice(C,1);break e}}p=m.createElement(c),_e(p,c,r),m.head.appendChild(p);break;case"meta":if(v=Fg("meta","content",m).get(c+(r.content||""))){for(C=0;C<v.length;C++)if(p=v[C],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){v.splice(C,1);break e}}p=m.createElement(c),_e(p,c,r),m.head.appendChild(p);break;default:throw Error(s(468,c))}p[Se]=e,ve(p),c=p}e.stateNode=c}else zg(m,e.type,e.stateNode);else e.stateNode=Bg(m,c,e.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?zg(m,e.type,e.stateNode):Bg(m,c,e.memoizedProps)):c===null&&e.stateNode!==null&&mu(e,e.memoizedProps,r.memoizedProps)}break;case 27:Ge(n,e),Ve(e),c&512&&(fe||r===null||Li(r,r.return)),r!==null&&c&4&&mu(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Ge(n,e),Ve(e),c&512&&(fe||r===null||Li(r,r.return)),e.flags&32){m=e.stateNode;try{ws(m,"")}catch(rt){Vt(e,e.return,rt)}}c&4&&e.stateNode!=null&&(m=e.memoizedProps,mu(e,m,r!==null?r.memoizedProps:m)),c&1024&&(yu=!0);break;case 6:if(Ge(n,e),Ve(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,r=e.stateNode;try{r.nodeValue=c}catch(rt){Vt(e,e.return,rt)}}break;case 3:if(Go=null,m=Ti,Ti=Io(n.containerInfo),Ge(n,e),Ti=m,Ve(e),c&4&&r!==null&&r.memoizedState.isDehydrated)try{Js(n.containerInfo)}catch(rt){Vt(e,e.return,rt)}yu&&(yu=!1,zm(e));break;case 4:c=Ti,Ti=Io(e.stateNode.containerInfo),Ge(n,e),Ve(e),Ti=c;break;case 12:Ge(n,e),Ve(e);break;case 31:Ge(n,e),Ve(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,_o(e,c)));break;case 13:Ge(n,e),Ve(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Do=ke()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,_o(e,c)));break;case 22:m=e.memoizedState!==null;var N=r!==null&&r.memoizedState!==null,U=en,Y=fe;if(en=U||m,fe=Y||N,Ge(n,e),fe=Y,en=U,Ve(e),c&8192)t:for(n=e.stateNode,n._visibility=m?n._visibility&-2:n._visibility|1,m&&(r===null||N||en||fe||rs(e)),r=null,n=e;;){if(n.tag===5||n.tag===26){if(r===null){N=r=n;try{if(p=N.stateNode,m)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{C=N.stateNode;var $=N.memoizedProps.style,I=$!=null&&$.hasOwnProperty("display")?$.display:null;C.style.display=I==null||typeof I=="boolean"?"":(""+I).trim()}}catch(rt){Vt(N,N.return,rt)}}}else if(n.tag===6){if(r===null){N=n;try{N.stateNode.nodeValue=m?"":N.memoizedProps}catch(rt){Vt(N,N.return,rt)}}}else if(n.tag===18){if(r===null){N=n;try{var V=N.stateNode;m?Tg(V,!0):Tg(N.stateNode,!1)}catch(rt){Vt(N,N.return,rt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=e.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,_o(e,r))));break;case 19:Ge(n,e),Ve(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,_o(e,c)));break;case 30:break;case 21:break;default:Ge(n,e),Ve(e)}}function Ve(e){var n=e.flags;if(n&2){try{for(var r,c=e.return;c!==null;){if(Mm(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var m=r.stateNode,p=gu(e);To(e,p,m);break;case 5:var v=r.stateNode;r.flags&32&&(ws(v,""),r.flags&=-33);var C=gu(e);To(e,C,v);break;case 3:case 4:var N=r.stateNode.containerInfo,U=gu(e);pu(e,U,N);break;default:throw Error(s(161))}}catch(Y){Vt(e,e.return,Y)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function zm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;zm(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function sn(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Nm(e,n.alternate,n),n=n.sibling}function rs(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Tn(4,n,n.return),rs(n);break;case 1:Li(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&Tm(n,n.return,r),rs(n);break;case 27:ar(n.stateNode);case 26:case 5:Li(n,n.return),rs(n);break;case 22:n.memoizedState===null&&rs(n);break;case 30:rs(n);break;default:rs(n)}e=e.sibling}}function an(e,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,m=e,p=n,v=p.flags;switch(p.tag){case 0:case 11:case 15:an(m,p,r),Ka(4,p);break;case 1:if(an(m,p,r),c=p,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(U){Vt(c,c.return,U)}if(c=p,m=c.updateQueue,m!==null){var C=c.stateNode;try{var N=m.shared.hiddenCallbacks;if(N!==null)for(m.shared.hiddenCallbacks=null,m=0;m<N.length;m++)mf(N[m],C)}catch(U){Vt(c,c.return,U)}}r&&v&64&&Cm(p),Wa(p,p.return);break;case 27:Dm(p);case 26:case 5:an(m,p,r),r&&c===null&&v&4&&_m(p),Wa(p,p.return);break;case 12:an(m,p,r);break;case 31:an(m,p,r),r&&v&4&&Lm(m,p);break;case 13:an(m,p,r),r&&v&4&&Bm(m,p);break;case 22:p.memoizedState===null&&an(m,p,r),Wa(p,p.return);break;case 30:break;default:an(m,p,r)}n=n.sibling}}function bu(e,n){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Fa(r))}function vu(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Fa(e))}function _i(e,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)jm(e,n,r,c),n=n.sibling}function jm(e,n,r,c){var m=n.flags;switch(n.tag){case 0:case 11:case 15:_i(e,n,r,c),m&2048&&Ka(9,n);break;case 1:_i(e,n,r,c);break;case 3:_i(e,n,r,c),m&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Fa(e)));break;case 12:if(m&2048){_i(e,n,r,c),e=n.stateNode;try{var p=n.memoizedProps,v=p.id,C=p.onPostCommit;typeof C=="function"&&C(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){Vt(n,n.return,N)}}else _i(e,n,r,c);break;case 31:_i(e,n,r,c);break;case 13:_i(e,n,r,c);break;case 23:break;case 22:p=n.stateNode,v=n.alternate,n.memoizedState!==null?p._visibility&2?_i(e,n,r,c):Qa(e,n):p._visibility&2?_i(e,n,r,c):(p._visibility|=2,Hs(e,n,r,c,(n.subtreeFlags&10256)!==0||!1)),m&2048&&bu(v,n);break;case 24:_i(e,n,r,c),m&2048&&vu(n.alternate,n);break;default:_i(e,n,r,c)}}function Hs(e,n,r,c,m){for(m=m&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var p=e,v=n,C=r,N=c,U=v.flags;switch(v.tag){case 0:case 11:case 15:Hs(p,v,C,N,m),Ka(8,v);break;case 23:break;case 22:var Y=v.stateNode;v.memoizedState!==null?Y._visibility&2?Hs(p,v,C,N,m):Qa(p,v):(Y._visibility|=2,Hs(p,v,C,N,m)),m&&U&2048&&bu(v.alternate,v);break;case 24:Hs(p,v,C,N,m),m&&U&2048&&vu(v.alternate,v);break;default:Hs(p,v,C,N,m)}n=n.sibling}}function Qa(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=e,c=n,m=c.flags;switch(c.tag){case 22:Qa(r,c),m&2048&&bu(c.alternate,c);break;case 24:Qa(r,c),m&2048&&vu(c.alternate,c);break;default:Qa(r,c)}n=n.sibling}}var Za=8192;function Gs(e,n,r){if(e.subtreeFlags&Za)for(e=e.child;e!==null;)Pm(e,n,r),e=e.sibling}function Pm(e,n,r){switch(e.tag){case 26:Gs(e,n,r),e.flags&Za&&e.memoizedState!==null&&sv(r,Ti,e.memoizedState,e.memoizedProps);break;case 5:Gs(e,n,r);break;case 3:case 4:var c=Ti;Ti=Io(e.stateNode.containerInfo),Gs(e,n,r),Ti=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Za,Za=16777216,Gs(e,n,r),Za=c):Gs(e,n,r));break;default:Gs(e,n,r)}}function Um(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Ja(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Ae=c,Hm(c,e)}Um(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Im(e),e=e.sibling}function Im(e){switch(e.tag){case 0:case 11:case 15:Ja(e),e.flags&2048&&Tn(9,e,e.return);break;case 3:Ja(e);break;case 12:Ja(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,Mo(e)):Ja(e);break;default:Ja(e)}}function Mo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Ae=c,Hm(c,e)}Um(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Tn(8,n,n.return),Mo(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,Mo(n));break;default:Mo(n)}e=e.sibling}}function Hm(e,n){for(;Ae!==null;){var r=Ae;switch(r.tag){case 0:case 11:case 15:Tn(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Fa(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,Ae=c;else t:for(r=e;Ae!==null;){c=Ae;var m=c.sibling,p=c.return;if(km(c),c===r){Ae=null;break t}if(m!==null){m.return=p,Ae=m;break t}Ae=p}}}var vb={getCacheForType:function(e){var n=Ce(ue),r=n.data.get(e);return r===void 0&&(r=e(),n.data.set(e,r)),r},cacheSignal:function(){return Ce(ue).controller.signal}},Ab=typeof WeakMap=="function"?WeakMap:Map,Ft=0,Kt=null,_t=null,Dt=0,Gt=0,ni=null,_n=!1,Vs=!1,Au=!1,rn=0,ae=0,Mn=0,os=0,xu=0,si=0,Xs=0,tr=null,Xe=null,wu=!1,Do=0,Gm=0,Ro=1/0,No=null,Dn=null,pe=0,Rn=null,Ys=null,on=0,Su=0,Eu=null,Vm=null,er=0,Cu=null;function ai(){return(Ft&2)!==0&&Dt!==0?Dt&-Dt:B.T!==null?Nu():ad()}function Xm(){if(si===0)if((Dt&536870912)===0||kt){var e=jr;jr<<=1,(jr&3932160)===0&&(jr=262144),si=e}else si=536870912;return e=ei.current,e!==null&&(e.flags|=32),si}function Ye(e,n,r){(e===Kt&&(Gt===2||Gt===9)||e.cancelPendingCommit!==null)&&(qs(e,0),Nn(e,Dt,si,!1)),wa(e,r),((Ft&2)===0||e!==Kt)&&(e===Kt&&((Ft&2)===0&&(os|=r),ae===4&&Nn(e,Dt,si,!1)),Bi(e))}function Ym(e,n,r){if((Ft&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&e.expiredLanes)===0||xa(e,n),m=c?Sb(e,n):_u(e,n,!0),p=c;do{if(m===0){Vs&&!c&&Nn(e,n,0,!1);break}else{if(r=e.current.alternate,p&&!xb(r)){m=_u(e,n,!1),p=!1;continue}if(m===2){if(p=n,e.errorRecoveryDisabledLanes&p)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var C=e;m=tr;var N=C.current.memoizedState.isDehydrated;if(N&&(qs(C,v).flags|=256),v=_u(C,v,!1),v!==2){if(Au&&!N){C.errorRecoveryDisabledLanes|=p,os|=p,m=4;break t}p=Xe,Xe=m,p!==null&&(Xe===null?Xe=p:Xe.push.apply(Xe,p))}m=v}if(p=!1,m!==2)continue}}if(m===1){qs(e,0),Nn(e,n,0,!0);break}t:{switch(c=e,p=m,p){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Nn(c,n,si,!_n);break t;case 2:Xe=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(m=Do+300-ke(),10<m)){if(Nn(c,n,si,!_n),Ur(c,0,!0)!==0)break t;on=n,c.timeoutHandle=Sg(qm.bind(null,c,r,Xe,No,wu,n,si,os,Xs,_n,p,"Throttled",-0,0),m);break t}qm(c,r,Xe,No,wu,n,si,os,Xs,_n,p,null,-0,0)}}break}while(!0);Bi(e)}function qm(e,n,r,c,m,p,v,C,N,U,Y,$,I,V){if(e.timeoutHandle=-1,$=n.subtreeFlags,$&8192||($&16785408)===16785408){$={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xi},Pm(n,p,$);var rt=(p&62914560)===p?Do-ke():(p&4194048)===p?Gm-ke():0;if(rt=av($,rt),rt!==null){on=p,e.cancelPendingCommit=rt(eg.bind(null,e,n,p,r,c,m,v,C,N,Y,$,null,I,V)),Nn(e,p,v,!U);return}}eg(e,n,p,r,c,m,v,C,N)}function xb(e){for(var n=e;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var m=r[c],p=m.getSnapshot;m=m.value;try{if(!Je(p(),m))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Nn(e,n,r,c){n&=~xu,n&=~os,e.suspendedLanes|=n,e.pingedLanes&=~n,c&&(e.warmLanes|=n),c=e.expirationTimes;for(var m=n;0<m;){var p=31-Ze(m),v=1<<p;c[p]=-1,m&=~v}r!==0&&id(e,r,n)}function ko(){return(Ft&6)===0?(ir(0),!1):!0}function Tu(){if(_t!==null){if(Gt===0)var e=_t.return;else e=_t,Ki=Zn=null,Hc(e),zs=null,ja=0,e=_t;for(;e!==null;)Em(e.alternate,e),e=e.return;_t=null}}function qs(e,n){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Ib(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),on=0,Tu(),Kt=e,_t=r=qi(e.current,null),Dt=n,Gt=0,ni=null,_n=!1,Vs=xa(e,n),Au=!1,Xs=si=xu=os=Mn=ae=0,Xe=tr=null,wu=!1,(n&8)!==0&&(n|=n&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=n;0<c;){var m=31-Ze(c),p=1<<m;n|=e[m],c&=~p}return rn=n,Zr(),r}function $m(e,n){Et=null,B.H=Ya,n===Fs||n===ro?(n=uf(),Gt=3):n===Rc?(n=uf(),Gt=4):Gt=n===su?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ni=n,_t===null&&(ae=1,xo(e,mi(n,e.current)))}function Km(){var e=ei.current;return e===null?!0:(Dt&4194048)===Dt?bi===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?e===bi:!1}function Wm(){var e=B.H;return B.H=Ya,e===null?Ya:e}function Qm(){var e=B.A;return B.A=vb,e}function Oo(){ae=4,_n||(Dt&4194048)!==Dt&&ei.current!==null||(Vs=!0),(Mn&134217727)===0&&(os&134217727)===0||Kt===null||Nn(Kt,Dt,si,!1)}function _u(e,n,r){var c=Ft;Ft|=2;var m=Wm(),p=Qm();(Kt!==e||Dt!==n)&&(No=null,qs(e,n)),n=!1;var v=ae;t:do try{if(Gt!==0&&_t!==null){var C=_t,N=ni;switch(Gt){case 8:Tu(),v=6;break t;case 3:case 2:case 9:case 6:ei.current===null&&(n=!0);var U=Gt;if(Gt=0,ni=null,$s(e,C,N,U),r&&Vs){v=0;break t}break;default:U=Gt,Gt=0,ni=null,$s(e,C,N,U)}}wb(),v=ae;break}catch(Y){$m(e,Y)}while(!0);return n&&e.shellSuspendCounter++,Ki=Zn=null,Ft=c,B.H=m,B.A=p,_t===null&&(Kt=null,Dt=0,Zr()),v}function wb(){for(;_t!==null;)Zm(_t)}function Sb(e,n){var r=Ft;Ft|=2;var c=Wm(),m=Qm();Kt!==e||Dt!==n?(No=null,Ro=ke()+500,qs(e,n)):Vs=xa(e,n);t:do try{if(Gt!==0&&_t!==null){n=_t;var p=ni;e:switch(Gt){case 1:Gt=0,ni=null,$s(e,n,p,1);break;case 2:case 9:if(lf(p)){Gt=0,ni=null,Jm(n);break}n=function(){Gt!==2&&Gt!==9||Kt!==e||(Gt=7),Bi(e)},p.then(n,n);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:lf(p)?(Gt=0,ni=null,Jm(n)):(Gt=0,ni=null,$s(e,n,p,7));break;case 5:var v=null;switch(_t.tag){case 26:v=_t.memoizedState;case 5:case 27:var C=_t;if(v?jg(v):C.stateNode.complete){Gt=0,ni=null;var N=C.sibling;if(N!==null)_t=N;else{var U=C.return;U!==null?(_t=U,Lo(U)):_t=null}break e}}Gt=0,ni=null,$s(e,n,p,5);break;case 6:Gt=0,ni=null,$s(e,n,p,6);break;case 8:Tu(),ae=6;break t;default:throw Error(s(462))}}Eb();break}catch(Y){$m(e,Y)}while(!0);return Ki=Zn=null,B.H=c,B.A=m,Ft=r,_t!==null?0:(Kt=null,Dt=0,Zr(),ae)}function Eb(){for(;_t!==null&&!Il();)Zm(_t)}function Zm(e){var n=wm(e.alternate,e,rn);e.memoizedProps=e.pendingProps,n===null?Lo(e):_t=n}function Jm(e){var n=e,r=n.alternate;switch(n.tag){case 15:case 0:n=pm(r,n,n.pendingProps,n.type,void 0,Dt);break;case 11:n=pm(r,n,n.pendingProps,n.type.render,n.ref,Dt);break;case 5:Hc(n);default:Em(r,n),n=_t=Wd(n,rn),n=wm(r,n,rn)}e.memoizedProps=e.pendingProps,n===null?Lo(e):_t=n}function $s(e,n,r,c){Ki=Zn=null,Hc(n),zs=null,ja=0;var m=n.return;try{if(db(e,m,n,r,Dt)){ae=1,xo(e,mi(r,e.current)),_t=null;return}}catch(p){if(m!==null)throw _t=m,p;ae=1,xo(e,mi(r,e.current)),_t=null;return}n.flags&32768?(kt||c===1?e=!0:Vs||(Dt&536870912)!==0?e=!1:(_n=e=!0,(c===2||c===9||c===3||c===6)&&(c=ei.current,c!==null&&c.tag===13&&(c.flags|=16384))),tg(n,e)):Lo(n)}function Lo(e){var n=e;do{if((n.flags&32768)!==0){tg(n,_n);return}e=n.return;var r=gb(n.alternate,n,rn);if(r!==null){_t=r;return}if(n=n.sibling,n!==null){_t=n;return}_t=n=e}while(n!==null);ae===0&&(ae=5)}function tg(e,n){do{var r=pb(e.alternate,e);if(r!==null){r.flags&=32767,_t=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(e=e.sibling,e!==null)){_t=e;return}_t=e=r}while(e!==null);ae=6,_t=null}function eg(e,n,r,c,m,p,v,C,N){e.cancelPendingCommit=null;do Bo();while(pe!==0);if((Ft&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(p=n.lanes|n.childLanes,p|=gc,ny(e,r,p,v,C,N),e===Kt&&(_t=Kt=null,Dt=0),Ys=n,Rn=e,on=r,Su=p,Eu=m,Vm=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Mb(Fr,function(){return rg(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,m=G.p,G.p=2,v=Ft,Ft|=4;try{yb(e,n,r)}finally{Ft=v,G.p=m,B.T=c}}pe=1,ig(),ng(),sg()}}function ig(){if(pe===1){pe=0;var e=Rn,n=Ys,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=B.T,B.T=null;var c=G.p;G.p=2;var m=Ft;Ft|=4;try{Fm(n,e);var p=Pu,v=Id(e.containerInfo),C=p.focusedElem,N=p.selectionRange;if(v!==C&&C&&C.ownerDocument&&Ud(C.ownerDocument.documentElement,C)){if(N!==null&&uc(C)){var U=N.start,Y=N.end;if(Y===void 0&&(Y=U),"selectionStart"in C)C.selectionStart=U,C.selectionEnd=Math.min(Y,C.value.length);else{var $=C.ownerDocument||document,I=$&&$.defaultView||window;if(I.getSelection){var V=I.getSelection(),rt=C.textContent.length,pt=Math.min(N.start,rt),qt=N.end===void 0?pt:Math.min(N.end,rt);!V.extend&&pt>qt&&(v=qt,qt=pt,pt=v);var z=Pd(C,pt),L=Pd(C,qt);if(z&&L&&(V.rangeCount!==1||V.anchorNode!==z.node||V.anchorOffset!==z.offset||V.focusNode!==L.node||V.focusOffset!==L.offset)){var P=$.createRange();P.setStart(z.node,z.offset),V.removeAllRanges(),pt>qt?(V.addRange(P),V.extend(L.node,L.offset)):(P.setEnd(L.node,L.offset),V.addRange(P))}}}}for($=[],V=C;V=V.parentNode;)V.nodeType===1&&$.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<$.length;C++){var q=$[C];q.element.scrollLeft=q.left,q.element.scrollTop=q.top}}qo=!!ju,Pu=ju=null}finally{Ft=m,G.p=c,B.T=r}}e.current=n,pe=2}}function ng(){if(pe===2){pe=0;var e=Rn,n=Ys,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=B.T,B.T=null;var c=G.p;G.p=2;var m=Ft;Ft|=4;try{Nm(e,n.alternate,n)}finally{Ft=m,G.p=c,B.T=r}}pe=3}}function sg(){if(pe===4||pe===3){pe=0,Hl();var e=Rn,n=Ys,r=on,c=Vm;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?pe=5:(pe=0,Ys=Rn=null,ag(e,e.pendingLanes));var m=e.pendingLanes;if(m===0&&(Dn=null),Xl(r),n=n.stateNode,Qe&&typeof Qe.onCommitFiberRoot=="function")try{Qe.onCommitFiberRoot(Aa,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=B.T,m=G.p,G.p=2,B.T=null;try{for(var p=e.onRecoverableError,v=0;v<c.length;v++){var C=c[v];p(C.value,{componentStack:C.stack})}}finally{B.T=n,G.p=m}}(on&3)!==0&&Bo(),Bi(e),m=e.pendingLanes,(r&261930)!==0&&(m&42)!==0?e===Cu?er++:(er=0,Cu=e):er=0,ir(0)}}function ag(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Fa(n)))}function Bo(){return ig(),ng(),sg(),rg()}function rg(){if(pe!==5)return!1;var e=Rn,n=Su;Su=0;var r=Xl(on),c=B.T,m=G.p;try{G.p=32>r?32:r,B.T=null,r=Eu,Eu=null;var p=Rn,v=on;if(pe=0,Ys=Rn=null,on=0,(Ft&6)!==0)throw Error(s(331));var C=Ft;if(Ft|=4,Im(p.current),jm(p,p.current,v,r),Ft=C,ir(0,!1),Qe&&typeof Qe.onPostCommitFiberRoot=="function")try{Qe.onPostCommitFiberRoot(Aa,p)}catch{}return!0}finally{G.p=m,B.T=c,ag(e,n)}}function og(e,n,r){n=mi(r,n),n=nu(e.stateNode,n,2),e=Sn(e,n,2),e!==null&&(wa(e,2),Bi(e))}function Vt(e,n,r){if(e.tag===3)og(e,e,r);else for(;n!==null;){if(n.tag===3){og(n,e,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Dn===null||!Dn.has(c))){e=mi(r,e),r=lm(2),c=Sn(n,r,2),c!==null&&(cm(r,c,n,e),wa(c,2),Bi(c));break}}n=n.return}}function Mu(e,n,r){var c=e.pingCache;if(c===null){c=e.pingCache=new Ab;var m=new Set;c.set(n,m)}else m=c.get(n),m===void 0&&(m=new Set,c.set(n,m));m.has(r)||(Au=!0,m.add(r),e=Cb.bind(null,e,n,r),n.then(e,e))}function Cb(e,n,r){var c=e.pingCache;c!==null&&c.delete(n),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Kt===e&&(Dt&r)===r&&(ae===4||ae===3&&(Dt&62914560)===Dt&&300>ke()-Do?(Ft&2)===0&&qs(e,0):xu|=r,Xs===Dt&&(Xs=0)),Bi(e)}function lg(e,n){n===0&&(n=ed()),e=Kn(e,n),e!==null&&(wa(e,n),Bi(e))}function Tb(e){var n=e.memoizedState,r=0;n!==null&&(r=n.retryLane),lg(e,r)}function _b(e,n){var r=0;switch(e.tag){case 31:case 13:var c=e.stateNode,m=e.memoizedState;m!==null&&(r=m.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),lg(e,r)}function Mb(e,n){return Ri(e,n)}var Fo=null,Ks=null,Du=!1,zo=!1,Ru=!1,kn=0;function Bi(e){e!==Ks&&e.next===null&&(Ks===null?Fo=Ks=e:Ks=Ks.next=e),zo=!0,Du||(Du=!0,Rb())}function ir(e,n){if(!Ru&&zo){Ru=!0;do for(var r=!1,c=Fo;c!==null;){if(e!==0){var m=c.pendingLanes;if(m===0)var p=0;else{var v=c.suspendedLanes,C=c.pingedLanes;p=(1<<31-Ze(42|e)+1)-1,p&=m&~(v&~C),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,dg(c,p))}else p=Dt,p=Ur(c,c===Kt?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||xa(c,p)||(r=!0,dg(c,p));c=c.next}while(r);Ru=!1}}function Db(){cg()}function cg(){zo=Du=!1;var e=0;kn!==0&&Ub()&&(e=kn);for(var n=ke(),r=null,c=Fo;c!==null;){var m=c.next,p=ug(c,n);p===0?(c.next=null,r===null?Fo=m:r.next=m,m===null&&(Ks=r)):(r=c,(e!==0||(p&3)!==0)&&(zo=!0)),c=m}pe!==0&&pe!==5||ir(e),kn!==0&&(kn=0)}function ug(e,n){for(var r=e.suspendedLanes,c=e.pingedLanes,m=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var v=31-Ze(p),C=1<<v,N=m[v];N===-1?((C&r)===0||(C&c)!==0)&&(m[v]=iy(C,n)):N<=n&&(e.expiredLanes|=C),p&=~C}if(n=Kt,r=Dt,r=Ur(e,e===n?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,r===0||e===n&&(Gt===2||Gt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&fn(c),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||xa(e,r)){if(n=r&-r,n===e.callbackPriority)return n;switch(c!==null&&fn(c),Xl(r)){case 2:case 8:r=Br;break;case 32:r=Fr;break;case 268435456:r=td;break;default:r=Fr}return c=hg.bind(null,e),r=Ri(r,c),e.callbackPriority=n,e.callbackNode=r,n}return c!==null&&c!==null&&fn(c),e.callbackPriority=2,e.callbackNode=null,2}function hg(e,n){if(pe!==0&&pe!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Bo()&&e.callbackNode!==r)return null;var c=Dt;return c=Ur(e,e===Kt?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(Ym(e,c,n),ug(e,ke()),e.callbackNode!=null&&e.callbackNode===r?hg.bind(null,e):null)}function dg(e,n){if(Bo())return null;Ym(e,n,!0)}function Rb(){Hb(function(){(Ft&6)!==0?Ri(Gi,Db):cg()})}function Nu(){if(kn===0){var e=Ls;e===0&&(e=zr,zr<<=1,(zr&261888)===0&&(zr=256)),kn=e}return kn}function fg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Vr(""+e)}function mg(e,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,e.id&&r.setAttribute("form",e.id),n.parentNode.insertBefore(r,n),e=new FormData(e),r.parentNode.removeChild(r),e}function Nb(e,n,r,c,m){if(n==="submit"&&r&&r.stateNode===m){var p=fg((m[Ue]||null).action),v=c.submitter;v&&(n=(n=v[Ue]||null)?fg(n.formAction):v.getAttribute("formAction"),n!==null&&(p=n,v=null));var C=new $r("action","action",null,c,m);e.push({event:C,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(kn!==0){var N=v?mg(m,v):new FormData(m);Qc(r,{pending:!0,data:N,method:m.method,action:p},null,N)}}else typeof p=="function"&&(C.preventDefault(),N=v?mg(m,v):new FormData(m),Qc(r,{pending:!0,data:N,method:m.method,action:p},p,N))},currentTarget:m}]})}}for(var ku=0;ku<mc.length;ku++){var Ou=mc[ku],kb=Ou.toLowerCase(),Ob=Ou[0].toUpperCase()+Ou.slice(1);Ci(kb,"on"+Ob)}Ci(Vd,"onAnimationEnd"),Ci(Xd,"onAnimationIteration"),Ci(Yd,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(Ky,"onTransitionRun"),Ci(Wy,"onTransitionStart"),Ci(Qy,"onTransitionCancel"),Ci(qd,"onTransitionEnd"),As("onMouseEnter",["mouseout","mouseover"]),As("onMouseLeave",["mouseout","mouseover"]),As("onPointerEnter",["pointerout","pointerover"]),As("onPointerLeave",["pointerout","pointerover"]),Xn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nr));function gg(e,n){n=(n&4)!==0;for(var r=0;r<e.length;r++){var c=e[r],m=c.event;c=c.listeners;t:{var p=void 0;if(n)for(var v=c.length-1;0<=v;v--){var C=c[v],N=C.instance,U=C.currentTarget;if(C=C.listener,N!==p&&m.isPropagationStopped())break t;p=C,m.currentTarget=U;try{p(m)}catch(Y){Qr(Y)}m.currentTarget=null,p=N}else for(v=0;v<c.length;v++){if(C=c[v],N=C.instance,U=C.currentTarget,C=C.listener,N!==p&&m.isPropagationStopped())break t;p=C,m.currentTarget=U;try{p(m)}catch(Y){Qr(Y)}m.currentTarget=null,p=N}}}}function Mt(e,n){var r=n[Yl];r===void 0&&(r=n[Yl]=new Set);var c=e+"__bubble";r.has(c)||(pg(n,e,2,!1),r.add(c))}function Lu(e,n,r){var c=0;n&&(c|=4),pg(r,e,c,n)}var jo="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[jo]){e[jo]=!0,ld.forEach(function(r){r!=="selectionchange"&&(Lb.has(r)||Lu(r,!1,e),Lu(r,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[jo]||(n[jo]=!0,Lu("selectionchange",!1,n))}}function pg(e,n,r,c){switch(Xg(n)){case 2:var m=lv;break;case 8:m=cv;break;default:m=Wu}r=m.bind(null,n,r,e),m=void 0,!ec||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),c?m!==void 0?e.addEventListener(n,r,{capture:!0,passive:m}):e.addEventListener(n,r,!0):m!==void 0?e.addEventListener(n,r,{passive:m}):e.addEventListener(n,r,!1)}function Fu(e,n,r,c,m){var p=c;if((n&1)===0&&(n&2)===0&&c!==null)t:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var C=c.stateNode.containerInfo;if(C===m)break;if(v===4)for(v=c.return;v!==null;){var N=v.tag;if((N===3||N===4)&&v.stateNode.containerInfo===m)return;v=v.return}for(;C!==null;){if(v=ys(C),v===null)return;if(N=v.tag,N===5||N===6||N===26||N===27){c=p=v;continue t}C=C.parentNode}}c=c.return}Ad(function(){var U=p,Y=Jl(r),$=[];t:{var I=$d.get(e);if(I!==void 0){var V=$r,rt=e;switch(e){case"keypress":if(Yr(r)===0)break t;case"keydown":case"keyup":V=_y;break;case"focusin":rt="focus",V=ac;break;case"focusout":rt="blur",V=ac;break;case"beforeblur":case"afterblur":V=ac;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=Sd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=gy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=Ry;break;case Vd:case Xd:case Yd:V=by;break;case qd:V=ky;break;case"scroll":case"scrollend":V=fy;break;case"wheel":V=Ly;break;case"copy":case"cut":case"paste":V=Ay;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=Cd;break;case"toggle":case"beforetoggle":V=Fy}var pt=(n&4)!==0,qt=!pt&&(e==="scroll"||e==="scrollend"),z=pt?I!==null?I+"Capture":null:I;pt=[];for(var L=U,P;L!==null;){var q=L;if(P=q.stateNode,q=q.tag,q!==5&&q!==26&&q!==27||P===null||z===null||(q=Ca(L,z),q!=null&&pt.push(sr(L,q,P))),qt)break;L=L.return}0<pt.length&&(I=new V(I,rt,null,r,Y),$.push({event:I,listeners:pt}))}}if((n&7)===0){t:{if(I=e==="mouseover"||e==="pointerover",V=e==="mouseout"||e==="pointerout",I&&r!==Zl&&(rt=r.relatedTarget||r.fromElement)&&(ys(rt)||rt[ps]))break t;if((V||I)&&(I=Y.window===Y?Y:(I=Y.ownerDocument)?I.defaultView||I.parentWindow:window,V?(rt=r.relatedTarget||r.toElement,V=U,rt=rt?ys(rt):null,rt!==null&&(qt=o(rt),pt=rt.tag,rt!==qt||pt!==5&&pt!==27&&pt!==6)&&(rt=null)):(V=null,rt=U),V!==rt)){if(pt=Sd,q="onMouseLeave",z="onMouseEnter",L="mouse",(e==="pointerout"||e==="pointerover")&&(pt=Cd,q="onPointerLeave",z="onPointerEnter",L="pointer"),qt=V==null?I:Ea(V),P=rt==null?I:Ea(rt),I=new pt(q,L+"leave",V,r,Y),I.target=qt,I.relatedTarget=P,q=null,ys(Y)===U&&(pt=new pt(z,L+"enter",rt,r,Y),pt.target=P,pt.relatedTarget=qt,q=pt),qt=q,V&&rt)e:{for(pt=Bb,z=V,L=rt,P=0,q=z;q;q=pt(q))P++;q=0;for(var dt=L;dt;dt=pt(dt))q++;for(;0<P-q;)z=pt(z),P--;for(;0<q-P;)L=pt(L),q--;for(;P--;){if(z===L||L!==null&&z===L.alternate){pt=z;break e}z=pt(z),L=pt(L)}pt=null}else pt=null;V!==null&&yg($,I,V,pt,!1),rt!==null&&qt!==null&&yg($,qt,rt,pt,!0)}}t:{if(I=U?Ea(U):window,V=I.nodeName&&I.nodeName.toLowerCase(),V==="select"||V==="input"&&I.type==="file")var Lt=Od;else if(Nd(I))if(Ld)Lt=Yy;else{Lt=Vy;var lt=Gy}else V=I.nodeName,!V||V.toLowerCase()!=="input"||I.type!=="checkbox"&&I.type!=="radio"?U&&Ql(U.elementType)&&(Lt=Od):Lt=Xy;if(Lt&&(Lt=Lt(e,U))){kd($,Lt,r,Y);break t}lt&&lt(e,I,U),e==="focusout"&&U&&I.type==="number"&&U.memoizedProps.value!=null&&Wl(I,"number",I.value)}switch(lt=U?Ea(U):window,e){case"focusin":(Nd(lt)||lt.contentEditable==="true")&&(Ts=lt,hc=U,Oa=null);break;case"focusout":Oa=hc=Ts=null;break;case"mousedown":dc=!0;break;case"contextmenu":case"mouseup":case"dragend":dc=!1,Hd($,r,Y);break;case"selectionchange":if($y)break;case"keydown":case"keyup":Hd($,r,Y)}var Ct;if(oc)t:{switch(e){case"compositionstart":var Rt="onCompositionStart";break t;case"compositionend":Rt="onCompositionEnd";break t;case"compositionupdate":Rt="onCompositionUpdate";break t}Rt=void 0}else Cs?Dd(e,r)&&(Rt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Rt="onCompositionStart");Rt&&(Td&&r.locale!=="ko"&&(Cs||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Cs&&(Ct=xd()):(pn=Y,ic="value"in pn?pn.value:pn.textContent,Cs=!0)),lt=Po(U,Rt),0<lt.length&&(Rt=new Ed(Rt,e,null,r,Y),$.push({event:Rt,listeners:lt}),Ct?Rt.data=Ct:(Ct=Rd(r),Ct!==null&&(Rt.data=Ct)))),(Ct=jy?Py(e,r):Uy(e,r))&&(Rt=Po(U,"onBeforeInput"),0<Rt.length&&(lt=new Ed("onBeforeInput","beforeinput",null,r,Y),$.push({event:lt,listeners:Rt}),lt.data=Ct)),Nb($,e,U,r,Y)}gg($,n)})}function sr(e,n,r){return{instance:e,listener:n,currentTarget:r}}function Po(e,n){for(var r=n+"Capture",c=[];e!==null;){var m=e,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Ca(e,r),m!=null&&c.unshift(sr(e,m,p)),m=Ca(e,n),m!=null&&c.push(sr(e,m,p))),e.tag===3)return c;e=e.return}return[]}function Bb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function yg(e,n,r,c,m){for(var p=n._reactName,v=[];r!==null&&r!==c;){var C=r,N=C.alternate,U=C.stateNode;if(C=C.tag,N!==null&&N===c)break;C!==5&&C!==26&&C!==27||U===null||(N=U,m?(U=Ca(r,p),U!=null&&v.unshift(sr(r,U,N))):m||(U=Ca(r,p),U!=null&&v.push(sr(r,U,N)))),r=r.return}v.length!==0&&e.push({event:n,listeners:v})}var Fb=/\r\n?/g,zb=/\u0000|\uFFFD/g;function bg(e){return(typeof e=="string"?e:""+e).replace(Fb,`
`).replace(zb,"")}function vg(e,n){return n=bg(n),bg(e)===n}function Yt(e,n,r,c,m,p){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||ws(e,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&ws(e,""+c);break;case"className":Hr(e,"class",c);break;case"tabIndex":Hr(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Hr(e,r,c);break;case"style":bd(e,c,p);break;case"data":if(n!=="object"){Hr(e,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){e.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=Vr(""+c),e.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(n!=="input"&&Yt(e,n,"name",m.name,m,null),Yt(e,n,"formEncType",m.formEncType,m,null),Yt(e,n,"formMethod",m.formMethod,m,null),Yt(e,n,"formTarget",m.formTarget,m,null)):(Yt(e,n,"encType",m.encType,m,null),Yt(e,n,"method",m.method,m,null),Yt(e,n,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=Vr(""+c),e.setAttribute(r,c);break;case"onClick":c!=null&&(e.onclick=Xi);break;case"onScroll":c!=null&&Mt("scroll",e);break;case"onScrollEnd":c!=null&&Mt("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}r=Vr(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""+c):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":c===!0?e.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,c):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(r,c):e.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(r):e.setAttribute(r,c);break;case"popover":Mt("beforetoggle",e),Mt("toggle",e),Ir(e,"popover",c);break;case"xlinkActuate":Vi(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Vi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Vi(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Vi(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Vi(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Vi(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ir(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=hy.get(r)||r,Ir(e,r,c))}}function zu(e,n,r,c,m,p){switch(r){case"style":bd(e,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"children":typeof c=="string"?ws(e,c):(typeof c=="number"||typeof c=="bigint")&&ws(e,""+c);break;case"onScroll":c!=null&&Mt("scroll",e);break;case"onScrollEnd":c!=null&&Mt("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Xi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cd.hasOwnProperty(r))t:{if(r[0]==="o"&&r[1]==="n"&&(m=r.endsWith("Capture"),n=r.slice(2,m?r.length-7:void 0),p=e[Ue]||null,p=p!=null?p[r]:null,typeof p=="function"&&e.removeEventListener(n,p,m),typeof c=="function")){typeof p!="function"&&p!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(n,c,m);break t}r in e?e[r]=c:c===!0?e.setAttribute(r,""):Ir(e,r,c)}}}function _e(e,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",e),Mt("load",e);var c=!1,m=!1,p;for(p in r)if(r.hasOwnProperty(p)){var v=r[p];if(v!=null)switch(p){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Yt(e,n,p,v,r,null)}}m&&Yt(e,n,"srcSet",r.srcSet,r,null),c&&Yt(e,n,"src",r.src,r,null);return;case"input":Mt("invalid",e);var C=p=v=m=null,N=null,U=null;for(c in r)if(r.hasOwnProperty(c)){var Y=r[c];if(Y!=null)switch(c){case"name":m=Y;break;case"type":v=Y;break;case"checked":N=Y;break;case"defaultChecked":U=Y;break;case"value":p=Y;break;case"defaultValue":C=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(137,n));break;default:Yt(e,n,c,Y,r,null)}}md(e,p,C,N,U,v,m,!1);return;case"select":Mt("invalid",e),c=v=p=null;for(m in r)if(r.hasOwnProperty(m)&&(C=r[m],C!=null))switch(m){case"value":p=C;break;case"defaultValue":v=C;break;case"multiple":c=C;default:Yt(e,n,m,C,r,null)}n=p,r=v,e.multiple=!!c,n!=null?xs(e,!!c,n,!1):r!=null&&xs(e,!!c,r,!0);return;case"textarea":Mt("invalid",e),p=m=c=null;for(v in r)if(r.hasOwnProperty(v)&&(C=r[v],C!=null))switch(v){case"value":c=C;break;case"defaultValue":m=C;break;case"children":p=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:Yt(e,n,v,C,r,null)}pd(e,c,m,p);return;case"option":for(N in r)r.hasOwnProperty(N)&&(c=r[N],c!=null)&&(N==="selected"?e.selected=c&&typeof c!="function"&&typeof c!="symbol":Yt(e,n,N,c,r,null));return;case"dialog":Mt("beforetoggle",e),Mt("toggle",e),Mt("cancel",e),Mt("close",e);break;case"iframe":case"object":Mt("load",e);break;case"video":case"audio":for(c=0;c<nr.length;c++)Mt(nr[c],e);break;case"image":Mt("error",e),Mt("load",e);break;case"details":Mt("toggle",e);break;case"embed":case"source":case"link":Mt("error",e),Mt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in r)if(r.hasOwnProperty(U)&&(c=r[U],c!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Yt(e,n,U,c,r,null)}return;default:if(Ql(n)){for(Y in r)r.hasOwnProperty(Y)&&(c=r[Y],c!==void 0&&zu(e,n,Y,c,r,void 0));return}}for(C in r)r.hasOwnProperty(C)&&(c=r[C],c!=null&&Yt(e,n,C,c,r,null))}function jb(e,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,v=null,C=null,N=null,U=null,Y=null;for(V in r){var $=r[V];if(r.hasOwnProperty(V)&&$!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":N=$;default:c.hasOwnProperty(V)||Yt(e,n,V,null,c,$)}}for(var I in c){var V=c[I];if($=r[I],c.hasOwnProperty(I)&&(V!=null||$!=null))switch(I){case"type":p=V;break;case"name":m=V;break;case"checked":U=V;break;case"defaultChecked":Y=V;break;case"value":v=V;break;case"defaultValue":C=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:V!==$&&Yt(e,n,I,V,c,$)}}Kl(e,v,C,N,U,Y,p,m);return;case"select":V=v=C=I=null;for(p in r)if(N=r[p],r.hasOwnProperty(p)&&N!=null)switch(p){case"value":break;case"multiple":V=N;default:c.hasOwnProperty(p)||Yt(e,n,p,null,c,N)}for(m in c)if(p=c[m],N=r[m],c.hasOwnProperty(m)&&(p!=null||N!=null))switch(m){case"value":I=p;break;case"defaultValue":C=p;break;case"multiple":v=p;default:p!==N&&Yt(e,n,m,p,c,N)}n=C,r=v,c=V,I!=null?xs(e,!!r,I,!1):!!c!=!!r&&(n!=null?xs(e,!!r,n,!0):xs(e,!!r,r?[]:"",!1));return;case"textarea":V=I=null;for(C in r)if(m=r[C],r.hasOwnProperty(C)&&m!=null&&!c.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Yt(e,n,C,null,c,m)}for(v in c)if(m=c[v],p=r[v],c.hasOwnProperty(v)&&(m!=null||p!=null))switch(v){case"value":I=m;break;case"defaultValue":V=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==p&&Yt(e,n,v,m,c,p)}gd(e,I,V);return;case"option":for(var rt in r)I=r[rt],r.hasOwnProperty(rt)&&I!=null&&!c.hasOwnProperty(rt)&&(rt==="selected"?e.selected=!1:Yt(e,n,rt,null,c,I));for(N in c)I=c[N],V=r[N],c.hasOwnProperty(N)&&I!==V&&(I!=null||V!=null)&&(N==="selected"?e.selected=I&&typeof I!="function"&&typeof I!="symbol":Yt(e,n,N,I,c,V));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in r)I=r[pt],r.hasOwnProperty(pt)&&I!=null&&!c.hasOwnProperty(pt)&&Yt(e,n,pt,null,c,I);for(U in c)if(I=c[U],V=r[U],c.hasOwnProperty(U)&&I!==V&&(I!=null||V!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(137,n));break;default:Yt(e,n,U,I,c,V)}return;default:if(Ql(n)){for(var qt in r)I=r[qt],r.hasOwnProperty(qt)&&I!==void 0&&!c.hasOwnProperty(qt)&&zu(e,n,qt,void 0,c,I);for(Y in c)I=c[Y],V=r[Y],!c.hasOwnProperty(Y)||I===V||I===void 0&&V===void 0||zu(e,n,Y,I,c,V);return}}for(var z in r)I=r[z],r.hasOwnProperty(z)&&I!=null&&!c.hasOwnProperty(z)&&Yt(e,n,z,null,c,I);for($ in c)I=c[$],V=r[$],!c.hasOwnProperty($)||I===V||I==null&&V==null||Yt(e,n,$,I,c,V)}function Ag(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Pb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var m=r[c],p=m.transferSize,v=m.initiatorType,C=m.duration;if(p&&C&&Ag(v)){for(v=0,C=m.responseEnd,c+=1;c<r.length;c++){var N=r[c],U=N.startTime;if(U>C)break;var Y=N.transferSize,$=N.initiatorType;Y&&Ag($)&&(N=N.responseEnd,v+=Y*(N<C?1:(C-U)/(N-U)))}if(--c,n+=8*(p+v)/(m.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ju=null,Pu=null;function Uo(e){return e.nodeType===9?e:e.ownerDocument}function xg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Uu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Iu=null;function Ub(){var e=window.event;return e&&e.type==="popstate"?e===Iu?!1:(Iu=e,!0):(Iu=null,!1)}var Sg=typeof setTimeout=="function"?setTimeout:void 0,Ib=typeof clearTimeout=="function"?clearTimeout:void 0,Eg=typeof Promise=="function"?Promise:void 0,Hb=typeof queueMicrotask=="function"?queueMicrotask:typeof Eg<"u"?function(e){return Eg.resolve(null).then(e).catch(Gb)}:Sg;function Gb(e){setTimeout(function(){throw e})}function On(e){return e==="head"}function Cg(e,n){var r=n,c=0;do{var m=r.nextSibling;if(e.removeChild(r),m&&m.nodeType===8)if(r=m.data,r==="/$"||r==="/&"){if(c===0){e.removeChild(m),Js(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")ar(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,ar(r);for(var p=r.firstChild;p;){var v=p.nextSibling,C=p.nodeName;p[Sa]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&p.rel.toLowerCase()==="stylesheet"||r.removeChild(p),p=v}}else r==="body"&&ar(e.ownerDocument.body);r=m}while(r);Js(n)}function Tg(e,n){var r=e;e=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=c}while(r)}function Hu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Hu(r),ql(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Vb(e,n,r,c){for(;e.nodeType===1;){var m=r;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[Sa])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==m.rel||e.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||e.getAttribute("title")!==(m.title==null?null:m.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(m.src==null?null:m.src)||e.getAttribute("type")!==(m.type==null?null:m.type)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=vi(e.nextSibling),e===null)break}return null}function Xb(e,n,r){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=vi(e.nextSibling),e===null))return null;return e}function _g(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=vi(e.nextSibling),e===null))return null;return e}function Gu(e){return e.data==="$?"||e.data==="$~"}function Vu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Yb(e,n){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function vi(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Xu=null;function Mg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(n===0)return vi(e.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}e=e.nextSibling}return null}function Dg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return e;n--}else r!=="/$"&&r!=="/&"||n++}e=e.previousSibling}return null}function Rg(e,n,r){switch(n=Uo(r),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function ar(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);ql(e)}var Ai=new Map,Ng=new Set;function Io(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ln=G.d;G.d={f:qb,r:$b,D:Kb,C:Wb,L:Qb,m:Zb,X:tv,S:Jb,M:ev};function qb(){var e=ln.f(),n=ko();return e||n}function $b(e){var n=bs(e);n!==null&&n.tag===5&&n.type==="form"?$f(n):ln.r(e)}var Ws=typeof document>"u"?null:document;function kg(e,n,r){var c=Ws;if(c&&typeof n=="string"&&n){var m=di(n);m='link[rel="'+e+'"][href="'+m+'"]',typeof r=="string"&&(m+='[crossorigin="'+r+'"]'),Ng.has(m)||(Ng.add(m),e={rel:e,crossOrigin:r,href:n},c.querySelector(m)===null&&(n=c.createElement("link"),_e(n,"link",e),ve(n),c.head.appendChild(n)))}}function Kb(e){ln.D(e),kg("dns-prefetch",e,null)}function Wb(e,n){ln.C(e,n),kg("preconnect",e,n)}function Qb(e,n,r){ln.L(e,n,r);var c=Ws;if(c&&e&&n){var m='link[rel="preload"][as="'+di(n)+'"]';n==="image"&&r&&r.imageSrcSet?(m+='[imagesrcset="'+di(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(m+='[imagesizes="'+di(r.imageSizes)+'"]')):m+='[href="'+di(e)+'"]';var p=m;switch(n){case"style":p=Qs(e);break;case"script":p=Zs(e)}Ai.has(p)||(e=y({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:e,as:n},r),Ai.set(p,e),c.querySelector(m)!==null||n==="style"&&c.querySelector(rr(p))||n==="script"&&c.querySelector(or(p))||(n=c.createElement("link"),_e(n,"link",e),ve(n),c.head.appendChild(n)))}}function Zb(e,n){ln.m(e,n);var r=Ws;if(r&&e){var c=n&&typeof n.as=="string"?n.as:"script",m='link[rel="modulepreload"][as="'+di(c)+'"][href="'+di(e)+'"]',p=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Zs(e)}if(!Ai.has(p)&&(e=y({rel:"modulepreload",href:e},n),Ai.set(p,e),r.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(or(p)))return}c=r.createElement("link"),_e(c,"link",e),ve(c),r.head.appendChild(c)}}}function Jb(e,n,r){ln.S(e,n,r);var c=Ws;if(c&&e){var m=vs(c).hoistableStyles,p=Qs(e);n=n||"default";var v=m.get(p);if(!v){var C={loading:0,preload:null};if(v=c.querySelector(rr(p)))C.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":n},r),(r=Ai.get(p))&&Yu(e,r);var N=v=c.createElement("link");ve(N),_e(N,"link",e),N._p=new Promise(function(U,Y){N.onload=U,N.onerror=Y}),N.addEventListener("load",function(){C.loading|=1}),N.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Ho(v,n,c)}v={type:"stylesheet",instance:v,count:1,state:C},m.set(p,v)}}}function tv(e,n){ln.X(e,n);var r=Ws;if(r&&e){var c=vs(r).hoistableScripts,m=Zs(e),p=c.get(m);p||(p=r.querySelector(or(m)),p||(e=y({src:e,async:!0},n),(n=Ai.get(m))&&qu(e,n),p=r.createElement("script"),ve(p),_e(p,"link",e),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function ev(e,n){ln.M(e,n);var r=Ws;if(r&&e){var c=vs(r).hoistableScripts,m=Zs(e),p=c.get(m);p||(p=r.querySelector(or(m)),p||(e=y({src:e,async:!0,type:"module"},n),(n=Ai.get(m))&&qu(e,n),p=r.createElement("script"),ve(p),_e(p,"link",e),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function Og(e,n,r,c){var m=(m=yt.current)?Io(m):null;if(!m)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=Qs(r.href),r=vs(m).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Qs(r.href);var p=vs(m).hoistableStyles,v=p.get(e);if(v||(m=m.ownerDocument||m,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,v),(p=m.querySelector(rr(e)))&&!p._p&&(v.instance=p,v.state.loading=5),Ai.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Ai.set(e,r),p||iv(m,e,r,v.state))),n&&c===null)throw Error(s(528,""));return v}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Zs(r),r=vs(m).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Qs(e){return'href="'+di(e)+'"'}function rr(e){return'link[rel="stylesheet"]['+e+"]"}function Lg(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function iv(e,n,r,c){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=e.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),_e(n,"link",r),ve(n),e.head.appendChild(n))}function Zs(e){return'[src="'+di(e)+'"]'}function or(e){return"script[async]"+e}function Bg(e,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=e.querySelector('style[data-href~="'+di(r.href)+'"]');if(c)return n.instance=c,ve(c),c;var m=y({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),ve(c),_e(c,"style",m),Ho(c,r.precedence,e),n.instance=c;case"stylesheet":m=Qs(r.href);var p=e.querySelector(rr(m));if(p)return n.state.loading|=4,n.instance=p,ve(p),p;c=Lg(r),(m=Ai.get(m))&&Yu(c,m),p=(e.ownerDocument||e).createElement("link"),ve(p);var v=p;return v._p=new Promise(function(C,N){v.onload=C,v.onerror=N}),_e(p,"link",c),n.state.loading|=4,Ho(p,r.precedence,e),n.instance=p;case"script":return p=Zs(r.src),(m=e.querySelector(or(p)))?(n.instance=m,ve(m),m):(c=r,(m=Ai.get(p))&&(c=y({},r),qu(c,m)),e=e.ownerDocument||e,m=e.createElement("script"),ve(m),_e(m,"link",c),e.head.appendChild(m),n.instance=m);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Ho(c,r.precedence,e));return n.instance}function Ho(e,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,p=m,v=0;v<c.length;v++){var C=c[v];if(C.dataset.precedence===n)p=C;else if(p!==m)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(e,n.firstChild))}function Yu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function qu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Go=null;function Fg(e,n,r){if(Go===null){var c=new Map,m=Go=new Map;m.set(r,c)}else m=Go,c=m.get(r),c||(c=new Map,m.set(r,c));if(c.has(e))return c;for(c.set(e,null),r=r.getElementsByTagName(e),m=0;m<r.length;m++){var p=r[m];if(!(p[Sa]||p[Se]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(n)||"";v=e+v;var C=c.get(v);C?C.push(p):c.set(v,[p])}}return c}function zg(e,n,r){e=e.ownerDocument||e,e.head.insertBefore(r,n==="title"?e.querySelector("head > title"):null)}function nv(e,n,r){if(r===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function jg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function sv(e,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=Qs(c.href),p=n.querySelector(rr(m));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Vo.bind(e),n.then(e,e)),r.state.loading|=4,r.instance=p,ve(p);return}p=n.ownerDocument||n,c=Lg(c),(m=Ai.get(m))&&Yu(c,m),p=p.createElement("link"),ve(p);var v=p;v._p=new Promise(function(C,N){v.onload=C,v.onerror=N}),_e(p,"link",c),r.instance=p}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Vo.bind(e),n.addEventListener("load",r),n.addEventListener("error",r))}}var $u=0;function av(e,n){return e.stylesheets&&e.count===0&&Yo(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var c=setTimeout(function(){if(e.stylesheets&&Yo(e,e.stylesheets),e.unsuspend){var p=e.unsuspend;e.unsuspend=null,p()}},6e4+n);0<e.imgBytes&&$u===0&&($u=62500*Pb());var m=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Yo(e,e.stylesheets),e.unsuspend)){var p=e.unsuspend;e.unsuspend=null,p()}},(e.imgBytes>$u?50:800)+n);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Vo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Yo(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Xo=null;function Yo(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Xo=new Map,n.forEach(rv,e),Xo=null,Vo.call(e))}function rv(e,n){if(!(n.state.loading&4)){var r=Xo.get(e);if(r)var c=r.get(null);else{r=new Map,Xo.set(e,r);for(var m=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var v=m[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(r.set(v.dataset.precedence,v),c=v)}c&&r.set(null,c)}m=n.instance,v=m.getAttribute("data-precedence"),p=r.get(v)||c,p===c&&r.set(null,m),r.set(v,m),this.count++,c=Vo.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),p?p.parentNode.insertBefore(m,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(m,e.firstChild)),n.state.loading|=4}}var lr={$$typeof:_,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function ov(e,n,r,c,m,p,v,C,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gl(0),this.hiddenUpdates=Gl(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function Pg(e,n,r,c,m,p,v,C,N,U,Y,$){return e=new ov(e,n,r,v,N,U,Y,$,C),n=1,p===!0&&(n|=24),p=ti(3,null,null,n),e.current=p,p.stateNode=e,n=_c(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:n},Nc(p),e}function Ug(e){return e?(e=Ds,e):Ds}function Ig(e,n,r,c,m,p){m=Ug(m),c.context===null?c.context=m:c.pendingContext=m,c=wn(n),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=Sn(e,c,n),r!==null&&(Ye(r,e,n),Ua(r,e,n))}function Hg(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<n?r:n}}function Ku(e,n){Hg(e,n),(e=e.alternate)&&Hg(e,n)}function Gg(e){if(e.tag===13||e.tag===31){var n=Kn(e,67108864);n!==null&&Ye(n,e,67108864),Ku(e,67108864)}}function Vg(e){if(e.tag===13||e.tag===31){var n=ai();n=Vl(n);var r=Kn(e,n);r!==null&&Ye(r,e,n),Ku(e,n)}}var qo=!0;function lv(e,n,r,c){var m=B.T;B.T=null;var p=G.p;try{G.p=2,Wu(e,n,r,c)}finally{G.p=p,B.T=m}}function cv(e,n,r,c){var m=B.T;B.T=null;var p=G.p;try{G.p=8,Wu(e,n,r,c)}finally{G.p=p,B.T=m}}function Wu(e,n,r,c){if(qo){var m=Qu(c);if(m===null)Fu(e,n,c,$o,r),Yg(e,c);else if(hv(m,e,n,r,c))c.stopPropagation();else if(Yg(e,c),n&4&&-1<uv.indexOf(e)){for(;m!==null;){var p=bs(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=Vn(p.pendingLanes);if(v!==0){var C=p;for(C.pendingLanes|=2,C.entangledLanes|=2;v;){var N=1<<31-Ze(v);C.entanglements[1]|=N,v&=~N}Bi(p),(Ft&6)===0&&(Ro=ke()+500,ir(0))}}break;case 31:case 13:C=Kn(p,2),C!==null&&Ye(C,p,2),ko(),Ku(p,2)}if(p=Qu(c),p===null&&Fu(e,n,c,$o,r),p===m)break;m=p}m!==null&&c.stopPropagation()}else Fu(e,n,c,null,r)}}function Qu(e){return e=Jl(e),Zu(e)}var $o=null;function Zu(e){if($o=null,e=ys(e),e!==null){var n=o(e);if(n===null)e=null;else{var r=n.tag;if(r===13){if(e=l(n),e!==null)return e;e=null}else if(r===31){if(e=u(n),e!==null)return e;e=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return $o=e,null}function Xg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ni()){case Gi:return 2;case Br:return 8;case Fr:case W0:return 32;case td:return 268435456;default:return 32}default:return 32}}var Ju=!1,Ln=null,Bn=null,Fn=null,cr=new Map,ur=new Map,zn=[],uv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yg(e,n){switch(e){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":Bn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":cr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ur.delete(n.pointerId)}}function hr(e,n,r,c,m,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[m]},n!==null&&(n=bs(n),n!==null&&Gg(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),e)}function hv(e,n,r,c,m){switch(n){case"focusin":return Ln=hr(Ln,e,n,r,c,m),!0;case"dragenter":return Bn=hr(Bn,e,n,r,c,m),!0;case"mouseover":return Fn=hr(Fn,e,n,r,c,m),!0;case"pointerover":var p=m.pointerId;return cr.set(p,hr(cr.get(p)||null,e,n,r,c,m)),!0;case"gotpointercapture":return p=m.pointerId,ur.set(p,hr(ur.get(p)||null,e,n,r,c,m)),!0}return!1}function qg(e){var n=ys(e.target);if(n!==null){var r=o(n);if(r!==null){if(n=r.tag,n===13){if(n=l(r),n!==null){e.blockedOn=n,rd(e.priority,function(){Vg(r)});return}}else if(n===31){if(n=u(r),n!==null){e.blockedOn=n,rd(e.priority,function(){Vg(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ko(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var r=Qu(e.nativeEvent);if(r===null){r=e.nativeEvent;var c=new r.constructor(r.type,r);Zl=c,r.target.dispatchEvent(c),Zl=null}else return n=bs(r),n!==null&&Gg(n),e.blockedOn=r,!1;n.shift()}return!0}function $g(e,n,r){Ko(e)&&r.delete(n)}function dv(){Ju=!1,Ln!==null&&Ko(Ln)&&(Ln=null),Bn!==null&&Ko(Bn)&&(Bn=null),Fn!==null&&Ko(Fn)&&(Fn=null),cr.forEach($g),ur.forEach($g)}function Wo(e,n){e.blockedOn===n&&(e.blockedOn=null,Ju||(Ju=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,dv)))}var Qo=null;function Kg(e){Qo!==e&&(Qo=e,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){Qo===e&&(Qo=null);for(var n=0;n<e.length;n+=3){var r=e[n],c=e[n+1],m=e[n+2];if(typeof c!="function"){if(Zu(c||r)===null)continue;break}var p=bs(r);p!==null&&(e.splice(n,3),n-=3,Qc(p,{pending:!0,data:m,method:r.method,action:c},c,m))}}))}function Js(e){function n(N){return Wo(N,e)}Ln!==null&&Wo(Ln,e),Bn!==null&&Wo(Bn,e),Fn!==null&&Wo(Fn,e),cr.forEach(n),ur.forEach(n);for(var r=0;r<zn.length;r++){var c=zn[r];c.blockedOn===e&&(c.blockedOn=null)}for(;0<zn.length&&(r=zn[0],r.blockedOn===null);)qg(r),r.blockedOn===null&&zn.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var m=r[c],p=r[c+1],v=m[Ue]||null;if(typeof p=="function")v||Kg(r);else if(v){var C=null;if(p&&p.hasAttribute("formAction")){if(m=p,v=p[Ue]||null)C=v.formAction;else if(Zu(m)!==null)continue}else C=v.action;typeof C=="function"?r[c+1]=C:(r.splice(c,3),c-=3),Kg(r)}}}function Wg(){function e(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return m=v})},focusReset:"manual",scroll:"manual"})}function n(){m!==null&&(m(),m=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),m!==null&&(m(),m=null)}}}function th(e){this._internalRoot=e}Zo.prototype.render=th.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=ai();Ig(r,c,e,n,null,null)},Zo.prototype.unmount=th.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Ig(e.current,2,null,e,null,null),ko(),n[ps]=null}};function Zo(e){this._internalRoot=e}Zo.prototype.unstable_scheduleHydration=function(e){if(e){var n=ad();e={blockedOn:null,target:e,priority:n};for(var r=0;r<zn.length&&n!==0&&n<zn[r].priority;r++);zn.splice(r,0,e),r===0&&qg(e)}};var Qg=t.version;if(Qg!=="19.2.4")throw Error(s(527,Qg,"19.2.4"));G.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var fv={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jo.isDisabled&&Jo.supportsFiber)try{Aa=Jo.inject(fv),Qe=Jo}catch{}}return fr.createRoot=function(e,n){if(!a(e))throw Error(s(299));var r=!1,c="",m=sm,p=am,v=rm;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(m=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=Pg(e,1,!1,null,null,r,c,null,m,p,v,Wg),e[ps]=n.current,Bu(e),new th(n)},fr.hydrateRoot=function(e,n,r){if(!a(e))throw Error(s(299));var c=!1,m="",p=sm,v=am,C=rm,N=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(m=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(C=r.onRecoverableError),r.formState!==void 0&&(N=r.formState)),n=Pg(e,1,!0,n,r??null,c,m,N,p,v,C,Wg),n.context=Ug(null),r=n.current,c=ai(),c=Vl(c),m=wn(c),m.callback=null,Sn(r,m,c),r=c,n.current.lanes=r,wa(n,r),Bi(n),e[ps]=n.current,Bu(e),new Zo(n)},fr.version="19.2.4",fr}var cp;function Sv(){if(cp)return sh.exports;cp=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),sh.exports=wv(),sh.exports}var Ev=Sv();function Cv(h,t){if(h.match(/^[a-z]+:\/\//i))return h;if(h.match(/^\/\//))return window.location.protocol+h;if(h.match(/^[a-z]+:/i))return h;const i=document.implementation.createHTMLDocument(),s=i.createElement("base"),a=i.createElement("a");return i.head.appendChild(s),i.body.appendChild(a),t&&(s.href=t),a.href=h,a.href}const Tv=(()=>{let h=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(h+=1,`u${t()}${h}`)})();function In(h){const t=[];for(let i=0,s=h.length;i<s;i++)t.push(h[i]);return t}let ta=null;function Wp(h={}){return ta||(h.includeStyleProperties?(ta=h.includeStyleProperties,ta):(ta=In(window.getComputedStyle(document.documentElement)),ta))}function ml(h,t){const s=(h.ownerDocument.defaultView||window).getComputedStyle(h).getPropertyValue(t);return s?parseFloat(s.replace("px","")):0}function _v(h){const t=ml(h,"border-left-width"),i=ml(h,"border-right-width");return h.clientWidth+t+i}function Mv(h){const t=ml(h,"border-top-width"),i=ml(h,"border-bottom-width");return h.clientHeight+t+i}function Qp(h,t={}){const i=t.width||_v(h),s=t.height||Mv(h);return{width:i,height:s}}function Dv(){let h,t;try{t=process}catch{}const i=t&&t.env?t.env.devicePixelRatio:null;return i&&(h=parseInt(i,10),Number.isNaN(h)&&(h=1)),h||window.devicePixelRatio||1}const ri=16384;function Rv(h){(h.width>ri||h.height>ri)&&(h.width>ri&&h.height>ri?h.width>h.height?(h.height*=ri/h.width,h.width=ri):(h.width*=ri/h.height,h.height=ri):h.width>ri?(h.height*=ri/h.width,h.width=ri):(h.width*=ri/h.height,h.height=ri))}function gl(h){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{s.decode().then(()=>{requestAnimationFrame(()=>t(s))})},s.onerror=i,s.crossOrigin="anonymous",s.decoding="async",s.src=h})}async function Nv(h){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(h)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function kv(h,t,i){const s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${i}`),a.setAttribute("viewBox",`0 0 ${t} ${i}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),a.appendChild(o),o.appendChild(h),Nv(a)}const We=(h,t)=>{if(h instanceof t)return!0;const i=Object.getPrototypeOf(h);return i===null?!1:i.constructor.name===t.name||We(i,t)};function Ov(h){const t=h.getPropertyValue("content");return`${h.cssText} content: '${t.replace(/'|"/g,"")}';`}function Lv(h,t){return Wp(t).map(i=>{const s=h.getPropertyValue(i),a=h.getPropertyPriority(i);return`${i}: ${s}${a?" !important":""};`}).join(" ")}function Bv(h,t,i,s){const a=`.${h}:${t}`,o=i.cssText?Ov(i):Lv(i,s);return document.createTextNode(`${a}{${o}}`)}function up(h,t,i,s){const a=window.getComputedStyle(h,i),o=a.getPropertyValue("content");if(o===""||o==="none")return;const l=Tv();try{t.className=`${t.className} ${l}`}catch{return}const u=document.createElement("style");u.appendChild(Bv(l,i,a,s)),t.appendChild(u)}function Fv(h,t,i){up(h,t,":before",i),up(h,t,":after",i)}const hp="application/font-woff",dp="image/jpeg",zv={woff:hp,woff2:hp,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:dp,jpeg:dp,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function jv(h){const t=/\.([^./]*?)$/g.exec(h);return t?t[1]:""}function Fh(h){const t=jv(h).toLowerCase();return zv[t]||""}function Pv(h){return h.split(/,/)[1]}function vh(h){return h.search(/^(data:)/)!==-1}function Uv(h,t){return`data:${t};base64,${h}`}async function Zp(h,t,i){const s=await fetch(h,t);if(s.status===404)throw new Error(`Resource "${s.url}" not found`);const a=await s.blob();return new Promise((o,l)=>{const u=new FileReader;u.onerror=l,u.onloadend=()=>{try{o(i({res:s,result:u.result}))}catch(d){l(d)}},u.readAsDataURL(a)})}const lh={};function Iv(h,t,i){let s=h.replace(/\?.*/,"");return i&&(s=h),/ttf|otf|eot|woff2?/i.test(s)&&(s=s.replace(/.*\//,"")),t?`[${t}]${s}`:s}async function zh(h,t,i){const s=Iv(h,t,i.includeQueryParams);if(lh[s]!=null)return lh[s];i.cacheBust&&(h+=(/\?/.test(h)?"&":"?")+new Date().getTime());let a;try{const o=await Zp(h,i.fetchRequestInit,({res:l,result:u})=>(t||(t=l.headers.get("Content-Type")||""),Pv(u)));a=Uv(o,t)}catch(o){a=i.imagePlaceholder||"";let l=`Failed to fetch resource: ${h}`;o&&(l=typeof o=="string"?o:o.message),l&&console.warn(l)}return lh[s]=a,a}async function Hv(h){const t=h.toDataURL();return t==="data:,"?h.cloneNode(!1):gl(t)}async function Gv(h,t){if(h.currentSrc){const o=document.createElement("canvas"),l=o.getContext("2d");o.width=h.clientWidth,o.height=h.clientHeight,l?.drawImage(h,0,0,o.width,o.height);const u=o.toDataURL();return gl(u)}const i=h.poster,s=Fh(i),a=await zh(i,s,t);return gl(a)}async function Vv(h,t){var i;try{if(!((i=h?.contentDocument)===null||i===void 0)&&i.body)return await xl(h.contentDocument.body,t,!0)}catch{}return h.cloneNode(!1)}async function Xv(h,t){return We(h,HTMLCanvasElement)?Hv(h):We(h,HTMLVideoElement)?Gv(h,t):We(h,HTMLIFrameElement)?Vv(h,t):h.cloneNode(Jp(h))}const Yv=h=>h.tagName!=null&&h.tagName.toUpperCase()==="SLOT",Jp=h=>h.tagName!=null&&h.tagName.toUpperCase()==="SVG";async function qv(h,t,i){var s,a;if(Jp(t))return t;let o=[];return Yv(h)&&h.assignedNodes?o=In(h.assignedNodes()):We(h,HTMLIFrameElement)&&(!((s=h.contentDocument)===null||s===void 0)&&s.body)?o=In(h.contentDocument.body.childNodes):o=In(((a=h.shadowRoot)!==null&&a!==void 0?a:h).childNodes),o.length===0||We(h,HTMLVideoElement)||await o.reduce((l,u)=>l.then(()=>xl(u,i)).then(d=>{d&&t.appendChild(d)}),Promise.resolve()),t}function $v(h,t,i){const s=t.style;if(!s)return;const a=window.getComputedStyle(h);a.cssText?(s.cssText=a.cssText,s.transformOrigin=a.transformOrigin):Wp(i).forEach(o=>{let l=a.getPropertyValue(o);o==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),We(h,HTMLIFrameElement)&&o==="display"&&l==="inline"&&(l="block"),o==="d"&&t.getAttribute("d")&&(l=`path(${t.getAttribute("d")})`),s.setProperty(o,l,a.getPropertyPriority(o))})}function Kv(h,t){We(h,HTMLTextAreaElement)&&(t.innerHTML=h.value),We(h,HTMLInputElement)&&t.setAttribute("value",h.value)}function Wv(h,t){if(We(h,HTMLSelectElement)){const s=Array.from(t.children).find(a=>h.value===a.getAttribute("value"));s&&s.setAttribute("selected","")}}function Qv(h,t,i){return We(t,Element)&&($v(h,t,i),Fv(h,t,i),Kv(h,t),Wv(h,t)),t}async function Zv(h,t){const i=h.querySelectorAll?h.querySelectorAll("use"):[];if(i.length===0)return h;const s={};for(let o=0;o<i.length;o++){const u=i[o].getAttribute("xlink:href");if(u){const d=h.querySelector(u),f=document.querySelector(u);!d&&f&&!s[u]&&(s[u]=await xl(f,t,!0))}}const a=Object.values(s);if(a.length){const o="http://www.w3.org/1999/xhtml",l=document.createElementNS(o,"svg");l.setAttribute("xmlns",o),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const u=document.createElementNS(o,"defs");l.appendChild(u);for(let d=0;d<a.length;d++)u.appendChild(a[d]);h.appendChild(l)}return h}async function xl(h,t,i){return!i&&t.filter&&!t.filter(h)?null:Promise.resolve(h).then(s=>Xv(s,t)).then(s=>qv(h,s,t)).then(s=>Qv(h,s,t)).then(s=>Zv(s,t))}const t0=/url\((['"]?)([^'"]+?)\1\)/g,Jv=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,tA=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function eA(h){const t=h.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function iA(h){const t=[];return h.replace(t0,(i,s,a)=>(t.push(a),i)),t.filter(i=>!vh(i))}async function nA(h,t,i,s,a){try{const o=i?Cv(t,i):t,l=Fh(t);let u;return a||(u=await zh(o,l,s)),h.replace(eA(t),`$1${u}$3`)}catch{}return h}function sA(h,{preferredFontFormat:t}){return t?h.replace(tA,i=>{for(;;){const[s,,a]=Jv.exec(i)||[];if(!a)return"";if(a===t)return`src: ${s};`}}):h}function e0(h){return h.search(t0)!==-1}async function i0(h,t,i){if(!e0(h))return h;const s=sA(h,i);return iA(s).reduce((o,l)=>o.then(u=>nA(u,l,t,i)),Promise.resolve(s))}async function ea(h,t,i){var s;const a=(s=t.style)===null||s===void 0?void 0:s.getPropertyValue(h);if(a){const o=await i0(a,null,i);return t.style.setProperty(h,o,t.style.getPropertyPriority(h)),!0}return!1}async function aA(h,t){await ea("background",h,t)||await ea("background-image",h,t),await ea("mask",h,t)||await ea("-webkit-mask",h,t)||await ea("mask-image",h,t)||await ea("-webkit-mask-image",h,t)}async function rA(h,t){const i=We(h,HTMLImageElement);if(!(i&&!vh(h.src))&&!(We(h,SVGImageElement)&&!vh(h.href.baseVal)))return;const s=i?h.src:h.href.baseVal,a=await zh(s,Fh(s),t);await new Promise((o,l)=>{h.onload=o,h.onerror=t.onImageErrorHandler?(...d)=>{try{o(t.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const u=h;u.decode&&(u.decode=o),u.loading==="lazy"&&(u.loading="eager"),i?(h.srcset="",h.src=a):h.href.baseVal=a})}async function oA(h,t){const s=In(h.childNodes).map(a=>n0(a,t));await Promise.all(s).then(()=>h)}async function n0(h,t){We(h,Element)&&(await aA(h,t),await rA(h,t),await oA(h,t))}function lA(h,t){const{style:i}=h;t.backgroundColor&&(i.backgroundColor=t.backgroundColor),t.width&&(i.width=`${t.width}px`),t.height&&(i.height=`${t.height}px`);const s=t.style;return s!=null&&Object.keys(s).forEach(a=>{i[a]=s[a]}),h}const fp={};async function mp(h){let t=fp[h];if(t!=null)return t;const s=await(await fetch(h)).text();return t={url:h,cssText:s},fp[h]=t,t}async function gp(h,t){let i=h.cssText;const s=/url\(["']?([^"')]+)["']?\)/g,o=(i.match(/url\([^)]+\)/g)||[]).map(async l=>{let u=l.replace(s,"$1");return u.startsWith("https://")||(u=new URL(u,h.url).href),Zp(u,t.fetchRequestInit,({result:d})=>(i=i.replace(l,`url(${d})`),[l,d]))});return Promise.all(o).then(()=>i)}function pp(h){if(h==null)return[];const t=[],i=/(\/\*[\s\S]*?\*\/)/gi;let s=h.replace(i,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(s);if(d===null)break;t.push(d[0])}s=s.replace(a,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(l,"gi");for(;;){let d=o.exec(s);if(d===null){if(d=u.exec(s),d===null)break;o.lastIndex=u.lastIndex}else u.lastIndex=o.lastIndex;t.push(d[0])}return t}async function cA(h,t){const i=[],s=[];return h.forEach(a=>{if("cssRules"in a)try{In(a.cssRules||[]).forEach((o,l)=>{if(o.type===CSSRule.IMPORT_RULE){let u=l+1;const d=o.href,f=mp(d).then(g=>gp(g,t)).then(g=>pp(g).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?u+=1:a.cssRules.length)}catch(b){console.error("Error inserting rule from remote css",{rule:y,error:b})}})).catch(g=>{console.error("Error loading remote css",g.toString())});s.push(f)}})}catch(o){const l=h.find(u=>u.href==null)||document.styleSheets[0];a.href!=null&&s.push(mp(a.href).then(u=>gp(u,t)).then(u=>pp(u).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",o)}}),Promise.all(s).then(()=>(h.forEach(a=>{if("cssRules"in a)try{In(a.cssRules||[]).forEach(o=>{i.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${a.href}`,o)}}),i))}function uA(h){return h.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>e0(t.style.getPropertyValue("src")))}async function hA(h,t){if(h.ownerDocument==null)throw new Error("Provided element is not within a Document");const i=In(h.ownerDocument.styleSheets),s=await cA(i,t);return uA(s)}function s0(h){return h.trim().replace(/["']/g,"")}function dA(h){const t=new Set;function i(s){(s.style.fontFamily||getComputedStyle(s).fontFamily).split(",").forEach(o=>{t.add(s0(o))}),Array.from(s.children).forEach(o=>{o instanceof HTMLElement&&i(o)})}return i(h),t}async function fA(h,t){const i=await hA(h,t),s=dA(h);return(await Promise.all(i.filter(o=>s.has(s0(o.style.fontFamily))).map(o=>{const l=o.parentStyleSheet?o.parentStyleSheet.href:null;return i0(o.cssText,l,t)}))).join(`
`)}async function mA(h,t){const i=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await fA(h,t);if(i){const s=document.createElement("style"),a=document.createTextNode(i);s.appendChild(a),h.firstChild?h.insertBefore(s,h.firstChild):h.appendChild(s)}}async function gA(h,t={}){const{width:i,height:s}=Qp(h,t),a=await xl(h,t,!0);return await mA(a,t),await n0(a,t),lA(a,t),await kv(a,i,s)}async function pA(h,t={}){const{width:i,height:s}=Qp(h,t),a=await gA(h,t),o=await gl(a),l=document.createElement("canvas"),u=l.getContext("2d"),d=t.pixelRatio||Dv(),f=t.canvasWidth||i,g=t.canvasHeight||s;return l.width=f*d,l.height=g*d,t.skipAutoScale||Rv(l),l.style.width=`${f}`,l.style.height=`${g}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,l.width,l.height)),u.drawImage(o,0,0,l.width,l.height),l}async function ia(h,t={}){return(await pA(h,t)).toDataURL()}const mr=({icon:h,label:t,onClick:i,isImage:s=!1})=>T.jsxs("button",{onClick:i,className:"group flex flex-col items-center gap-3 w-full",children:[T.jsx("div",{className:"flex items-center justify-center w-full aspect-square bg-white rounded-xl shadow-sm group-hover:shadow-md transition-all duration-200 border border-transparent group-hover:border-gray-200 p-3 md:p-6",children:T.jsx("div",{className:"h-10 w-10 md:h-16 md:w-16 flex items-center justify-center",children:s?T.jsx("img",{src:h,alt:t,className:"max-h-full max-w-full object-contain"}):T.jsx("img",{src:h,alt:t,className:"max-h-full max-w-full object-contain"})})}),T.jsx("span",{className:"text-[10px] md:text-xs font-bold tracking-wider text-gray-900 uppercase text-center group-hover:text-black leading-tight",children:t})]}),yA=({setView:h,activeTab:t})=>T.jsxs("div",{className:"w-full max-w-2xl mt-4 md:mt-12",children:[T.jsx("h3",{className:"text-center text-xs md:text-sm font-bold text-gray-700 tracking-wider mb-6 md:mb-12 uppercase",children:"CUSTOMIZE IT YOUR WAY"}),T.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6",children:[t==="BACK"&&T.jsx(mr,{icon:"UI/icons/upload.svg",label:"UPLOAD YOUR OWN IMAGE",onClick:()=>h("upload")}),T.jsx(mr,{icon:"UI/icons/text.png",label:"TEXT",isImage:!0,onClick:()=>h("text")}),t==="BACK"&&T.jsxs(T.Fragment,{children:[T.jsx(mr,{icon:"UI/icons/monogram.svg",label:"MONOGRAM",onClick:()=>h("monogram")}),T.jsx(mr,{icon:"UI/icons/snow.svg",label:"HOLIDAY DESIGNS",onClick:()=>{}}),T.jsx(mr,{icon:"UI/icons/gallery.svg",label:"GALLERY",onClick:()=>h("gallery")})]})]})]}),wl=({setView:h,activeView:t,activeTab:i})=>{const s=[{id:"upload",label:"UPLOAD",icon:"UI/icons/upload.svg"},{id:"text",label:"TEXT",icon:"UI/icons/text.png"},{id:"monogram",label:"MONOGRAM",icon:"UI/icons/monogram.svg"},{id:"gallery",label:"GALLERY",icon:"UI/icons/gallery.svg"}],a=i==="FRONT"?s.filter(o=>o.id==="text"):s;return T.jsx("div",{className:"hidden md:flex items-start justify-center space-x-6 mb-8 transform -translate-x-2",children:a.map(o=>{const l=t===o.id;return T.jsxs("button",{onClick:l?void 0:()=>h(o.id),className:`group flex flex-col items-center gap-2 ${l?"cursor-default":""}`,children:[T.jsx("div",{className:`w-16 h-16 rounded-xl flex items-center justify-center transition-colors
                                ${l?"bg-white shadow-md border-2 border-brand-blue":"bg-white shadow-sm group-hover:bg-gray-50"}
                            `,children:T.jsx("img",{src:o.icon,className:"w-8 h-8 object-contain",alt:o.label})}),T.jsx("span",{className:"text-[10px] font-bold text-gray-900 uppercase tracking-wider",children:o.label})]},o.id)})})},bA=({setView:h,textInput:t,setTextInput:i,fonts:s,selectedFont:a,setSelectedFont:o,activeTab:l,isVertical:u,setIsVertical:d})=>T.jsxs("div",{className:"flex flex-col h-full w-full max-w-2xl",children:[T.jsx(wl,{setView:h,activeView:"text",activeTab:l}),T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-black font-bold text-xs md:text-sm tracking-widest uppercase mb-2 md:mb-6 hover:text-gray-600 transition-colors",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"BACK"]}),T.jsxs("div",{className:"bg-white rounded-lg shadow-sm  mb-3 border border-gray-200 flex items-center flex-shrink-0",children:[T.jsx("textarea",{value:t,onChange:b=>{let w=String(b.target.value||"").replace(/\r\n/g,`
`).split(`
`).map(x=>x.slice(0,20));l==="FRONT"&&(w=w.slice(0,4)),i(w.join(`
`))},placeholder:"TYPE TEXT HERE",maxLength:l==="FRONT"?83:150,rows:1,wrap:"off",className:"flex-1 w-full px-2 md:px-4 py-2 text-center text-sm md:text-base text-gray-700 placeholder-gray-300 focus:outline-none resize-none min-h-[44px] md:min-h-[48px]",onFocus:()=>{setTimeout(()=>{const b=document.getElementById("mobile-color-trigger");b&&window.innerWidth<768&&b.scrollIntoView({behavior:"smooth",block:"start"})},350)},style:s.find(b=>b.name===a)?.style}),T.jsx("div",{className:"text-green-500 px-2 pt-2",children:t&&T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),l==="BACK"&&T.jsxs("div",{className:"mb-6 flex flex-col items-start w-full px-1",children:[T.jsxs("span",{className:"text-sm font-bold text-gray-800 mb-2",children:["Orientation: ",T.jsx("span",{className:"font-normal",children:u?"Vertical":"Horizontal"})]}),T.jsxs("div",{className:"flex space-x-3",children:[T.jsx("button",{onClick:()=>d(!0),className:`w-12 h-12 rounded flex items-center justify-center transition-all bg-white
                                ${u?"border-2 border-black shadow-sm":"border border-gray-300 hover:border-gray-400"}
                            `,"aria-label":"Vertical Text",children:T.jsx("span",{className:"text-xs font-medium text-gray-800 transform rotate-90 leading-none",children:"Aaa"})}),T.jsx("button",{onClick:()=>d(!1),className:`w-12 h-12 rounded flex items-center justify-center transition-all bg-white
                                ${u?"border border-gray-300 hover:border-gray-400":"border-2 border-black shadow-sm"}
                            `,"aria-label":"Horizontal Text",children:T.jsx("span",{className:"text-xs font-medium text-gray-800 leading-none",children:"Aaa"})})]})]}),T.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:T.jsx("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:s.map(b=>T.jsx("button",{onClick:()=>o(b.name),className:`p-3 md:p-2 bg-white rounded-lg border transition-all duration-200 flex items-center justify-center h-14 md:h-12 shadow-md
                                ${a===b.name?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-transparent hover:shadow-lg hover:border-brand-blue text-gray-400 hover:text-brand-blue"}
                            `,children:T.jsx("span",{className:`text-xs md:text-sm ${a===b.name?"text-brand-blue":""}`,style:b.style,children:b.name})},b.name))})}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]}),vA=({setView:h,monogramInput:t,setMonogramInput:i,monogramStyles:s,selectedMonogram:a,setSelectedMonogram:o,activeTab:l})=>T.jsxs("div",{className:"flex flex-col h-full w-full max-w-2xl",children:[T.jsx(wl,{setView:h,activeView:"monogram",activeTab:l}),T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-black font-bold text-xs md:text-sm tracking-widest uppercase mb-2 md:mb-6 hover:text-gray-600 transition-colors",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"BACK"]}),T.jsxs("div",{className:"bg-white rounded-lg shadow-sm  mb-3 border border-gray-200 flex items-center flex-shrink-0",children:[T.jsx("input",{type:"text",value:t,onChange:u=>i(u.target.value.toUpperCase()),placeholder:s.find(u=>u.name===a)?.maxLength===1?"ONE LETTER ONLY":s.find(u=>u.name===a)?.useCircleGlyphs||s.find(u=>u.name===a)?.useNGramGlyphs?"AT LEAST 2 LETTERS":"ENTER YOUR INITIALS",maxLength:s.find(u=>u.name===a)?.maxLength||3,onFocus:()=>{setTimeout(()=>{const u=document.getElementById("mobile-color-trigger");u&&window.innerWidth<768&&u.scrollIntoView({behavior:"smooth",block:"start"})},350)},className:"flex-1 w-full px-2 md:px-4 py-2 text-center text-sm md:text-base text-gray-700 font-bold placeholder-gray-300 focus:outline-none uppercase"}),T.jsx("div",{className:"text-green-500 px-2",children:t&&T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),s.find(u=>u.name===a)?.maxLength===1&&t.length>1&&T.jsx("div",{className:"text-red-500 text-xs font-bold text-center mt-2 mb-2 flex-shrink-0",children:"ONLY FIRST LETTER WILL BE SHOWN"}),(s.find(u=>u.name===a)?.useCircleGlyphs||s.find(u=>u.name===a)?.useNGramGlyphs)&&t.length===1&&T.jsx("div",{className:"text-red-500 text-xs font-bold text-center mt-2 mb-2 flex-shrink-0",children:"PLEASE ENTER AT LEAST 2 LETTERS"}),T.jsxs("div",{className:"bg-gray-100 rounded p-2 md:p-3 mb-4 md:mb-6 text-[10px] md:text-xs text-gray-600 flex-shrink-0",children:[T.jsx("span",{className:"font-bold",children:"Note:"})," Monograms with three initials display the last name initial in the center."]}),T.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:T.jsx("div",{className:"grid grid-cols-3 gap-3 md:gap-4",children:s.map(u=>{const d=u.useCircleGlyphs,f=u.useNGramGlyphs,g=u.maxLength===1;let y="RJM",b=u.style?.fontFamily;return d?(y="rJ#",b="Three Character Circle"):f?(y="?rJ#",b="Three Character N-Gram"):g&&(y="J"),T.jsx("button",{onClick:()=>o(u.name),className:`p-4 md:p-3 bg-white rounded-lg border transition-all duration-200 flex items-center justify-center h-24 md:h-18 shadow-md
                                    ${a===u.name?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-transparent hover:shadow-lg hover:border-brand-blue text-gray-400 hover:text-brand-blue"}
                                `,children:T.jsx("span",{className:`text-4xl md:text-2xl lg:text-3xl ${a===u.name?"text-brand-blue":""}`,style:{...(({fontSize:A,...w})=>w)(u.style),fontFamily:b},children:y})},u.name)})})}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]}),yp=[{id:"nature",name:"NATURE",icon:"Tree"},{id:"animals",name:"ANIMALS",icon:"Bear"},{id:"symbols",name:"SYMBOLS",icon:"Star"},{id:"celebration",name:"CELEBRATION",icon:"Celebration"},{id:"family",name:"FAMILY",icon:"Family"},{id:"holiday",name:"HOLIDAY",icon:"Holiday"},{id:"zodiac",name:"ZODIAC",icon:"Zodiac"}],bp={nature:[{id:"cat_nature",name:"Cat",src:"gallery/nature/Cat.svg"},{id:"forest",name:"Forest",src:"gallery/nature/forest-svgrepo-com.svg"},{id:"grass",name:"Grass Patch",src:"gallery/nature/grass-patch-svgrepo-com.svg"},{id:"moon",name:"Misty Moon",src:"gallery/nature/misty-moon-svgrepo-com.svg"},{id:"mountains",name:"Mountains",src:"gallery/nature/mountains-svgrepo-com.svg"},{id:"woods-badge",name:"Woods Badge",src:"gallery/nature/nature-badge-woods-svgrepo-com.svg"},{id:"rainbow",name:"Rainbow",src:"gallery/nature/nature-rainbow-svgrepo-com.svg"},{id:"nature",name:"Nature",src:"gallery/nature/nature-svgrepo-com.svg"},{id:"bird",name:"Bird",src:"gallery/nature/Bird.svg"},{id:"butterfly",name:"Butterfly",src:"gallery/nature/Butterfly.svg"},{id:"charity_water",name:"Charity Water",src:"gallery/nature/CharityWater.svg"},{id:"comet",name:"Comet",src:"gallery/nature/Comet.svg"},{id:"mountains_2",name:"Mountains II",src:"gallery/nature/Mountains.svg"},{id:"paw",name:"Paw",src:"gallery/nature/paw.svg"}],animals:[{id:"pawprint",name:"Pawprint",src:"gallery/animals/canine-pawprint-svgrepo-com.svg"},{id:"chicken",name:"Chicken",src:"gallery/animals/chicken-svgrepo-com.svg"},{id:"grasshopper",name:"Grasshopper",src:"gallery/animals/grasshopper-sitting-svgrepo-com.svg"},{id:"pig",name:"Pig",src:"gallery/animals/pig-with-round-tail-svgrepo-com.svg"},{id:"cobra",name:"Cobra",src:"gallery/animals/poisonous-cobra-svgrepo-com.svg"},{id:"spider",name:"Spider",src:"gallery/animals/poisonous-spider-svgrepo-com.svg"},{id:"anteater",name:"Anteater",src:"gallery/animals/sitting-anteater-svgrepo-com.svg"},{id:"cat",name:"Cat",src:"gallery/animals/sitting-cat-svgrepo-com.svg"},{id:"rabbit",name:"Rabbit",src:"gallery/animals/sitting-rabbit-svgrepo-com.svg"}],symbols:[{id:"heart",name:"Heart",src:"gallery/symbols/heart-love-romance-svgrepo-com.svg"},{id:"money",name:"Money Bag",src:"gallery/symbols/money-bag-change-money-capital-svgrepo-com.svg"},{id:"network",name:"Network",src:"gallery/symbols/network-internet-web-svgrepo-com.svg"},{id:"ai",name:"AI",src:"gallery/symbols/smart-work-artificial-intelligence-ai-svgrepo-com.svg"},{id:"thumbsup",name:"Thumbs Up",src:"gallery/symbols/thumbs-up-up-yes-approve-svgrepo-com.svg"},{id:"yinyang",name:"Yin Yang",src:"gallery/symbols/yin-yang-balance-religion-wisdom-svgrepo-com.svg"}],celebration:[{id:"stethoscope",name:"Stethoscope",src:"gallery/celebration/HealthcareStethescope.svg"},{id:"bride",name:"Bride",src:"gallery/celebration/StanleyCreate_Graphics_Refresh_Bride.svg"},{id:"i_love_you",name:"I Love You",src:"gallery/celebration/ValentinesDay_ILoveYou.svg"}],family:[{id:"girl_dad",name:"Girl Dad",src:"gallery/family/GirlDad.svg"},{id:"mom_tattoo",name:"Mom Tattoo",src:"gallery/family/MomTattoo.svg"},{id:"tattoo",name:"Tattoo",src:"gallery/family/Tattoo.svg"}],holiday:[{id:"penguin",name:"Penguin",src:"gallery/holiday/StanleyCreate_Graphics_Refresh_Penguin.svg"},{id:"snowglobe",name:"Snowglobe",src:"gallery/holiday/StanleyCreate_Graphics_Refresh_Snowglobe.svg"},{id:"snowman",name:"Snowman",src:"gallery/holiday/StanleyCreate_Graphics_Refresh_Snowman.svg"},{id:"valentine_animals",name:"Valentine Animals",src:"gallery/holiday/ValentinesDay_Animals.svg"},{id:"sweethearts",name:"Sweethearts",src:"gallery/holiday/ValentinesDay_Sweethearts.svg"},{id:"valentine_tree",name:"Valentine Tree",src:"gallery/holiday/ValentinesDay_Tree.svg"}],zodiac:[{id:"aquarius",name:"Aquarius",src:"gallery/zodiac/Zodiac_Aquarius.svg"},{id:"aries",name:"Aries",src:"gallery/zodiac/Zodiac_Aries.svg"},{id:"cancer",name:"Cancer",src:"gallery/zodiac/Zodiac_Cancer.svg"},{id:"capricorn",name:"Capricorn",src:"gallery/zodiac/Zodiac_Capricorn.svg"},{id:"gemini",name:"Gemini",src:"gallery/zodiac/Zodiac_Gemini.svg"},{id:"leo",name:"Leo",src:"gallery/zodiac/Zodiac_Leo.svg"},{id:"libra",name:"Libra",src:"gallery/zodiac/Zodiac_Libra.svg"},{id:"pisces",name:"Pisces",src:"gallery/zodiac/Zodiac_Pisces.svg"},{id:"sagittarius",name:"Sagittarius",src:"gallery/zodiac/Zodiac_Sagittarius.svg"},{id:"scorpio",name:"Scorpio",src:"gallery/zodiac/Zodiac_Scorpio.svg"},{id:"taurus",name:"Taurus",src:"gallery/zodiac/Zodiac_Taurus.svg"},{id:"virgo",name:"Virgo",src:"gallery/zodiac/Zodiac_Virgo.svg"}]},AA=({setView:h,setGraphic:t,selectedGraphic:i,activeTab:s})=>{const[a,o]=ct.useState("categories"),[l,u]=ct.useState(null),d=ct.useRef(null),f=b=>{u(b),o("icons"),d.current&&(d.current.scrollTop=0)},g=b=>{t({...b,scale:1})},y=()=>{a==="icons"?(o("categories"),u(null),d.current&&(d.current.scrollTop=0)):h("main")};return T.jsxs("div",{className:"flex flex-col h-full w-full",children:[T.jsx(wl,{setView:h,activeView:"gallery",activeTab:s}),T.jsxs("button",{onClick:y,className:"flex items-center text-black font-bold text-sm mb-4 hover:text-gray-600 hover:underline self-start",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),a==="categories"?"BACK":"BACK TO CATEGORIES"]}),i&&!i.isUpload&&T.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsxs("span",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:["SELECTED: ",i.name]}),T.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[Math.round((i.scale||1)*100),"%"]})]}),T.jsx("input",{type:"range",min:"0.2",max:"1.0",step:"0.05",value:i.scale||1,onChange:b=>t({...i,scale:parseFloat(b.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#002C5F]"})]}),T.jsxs("div",{ref:d,className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:[a==="categories"&&T.jsx("div",{className:"grid grid-cols-3 gap-4",children:yp.map(b=>T.jsxs("div",{className:"flex flex-col items-center gap-2",children:[T.jsx("button",{onClick:()=>f(b.id),className:"aspect-square w-full bg-white border border-gray-200 rounded-lg flex items-center justify-center p-4 shadow-md hover:border-brand-blue hover:shadow-lg transition-all group",children:T.jsx("img",{src:bp[b.id]?.[0]?.src,alt:b.name,className:"w-12 h-12 md:w-16 md:h-16 object-contain group-hover:scale-105 transition-transform"})}),T.jsx("span",{className:`font-bold text-gray-600 uppercase tracking-wider text-center leading-tight
                                    ${b.name.length>8?"text-[10px]":"text-xs"}
                                `,children:b.name})]},b.id))}),a==="icons"&&l&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-4",children:yp.find(b=>b.id===l)?.name}),T.jsx("div",{className:"grid grid-cols-3 gap-3",children:bp[l]?.map(b=>T.jsx("button",{onClick:()=>g(b),className:`aspect-square bg-white border rounded-md flex items-center justify-center p-4 shadow-md transition-all
                                        ${i?.id===b.id?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-gray-200 hover:border-brand-blue hover:shadow-lg"}
                                    `,children:T.jsx("img",{src:b.src,alt:b.name,className:"w-full h-full object-contain"})},b.id))})]})]}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]})},xA=({colors:h,selectedColor:t,setSelectedColor:i,isMobile:s})=>{const[a,o]=ct.useState(!1),l=h.find(u=>u.id===t);return T.jsxs(T.Fragment,{children:[s&&T.jsxs("button",{id:"mobile-color-trigger",onClick:()=>o(!0),className:"absolute top-2 right-2 md:hidden flex items-center bg-white rounded-full shadow-lg p-1 pr-2 border border-gray-200 z-30 transition-transform active:scale-95",children:[T.jsx("div",{className:`w-8 h-8 rounded-full ${l?.bg} ${l?.border||""} shadow-inner`}),T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s&&a&&T.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[T.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>o(!1)}),T.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all",children:[T.jsx("button",{onClick:()=>o(!1),className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-8 pt-10",children:[T.jsx("h3",{className:"text-xl font-bold text-[#002C5F] leading-tight mb-2 tracking-wide uppercase",children:"RAMBLER 16 OZ TRAVEL BOTTLE"}),T.jsx("hr",{className:"mb-6 opacity-20"}),T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsxs("p",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-4",children:["COLOR: ",T.jsx("span",{className:"text-black ml-1",children:l?.name})]}),T.jsx("div",{className:"flex flex-wrap gap-4",children:h.map(u=>T.jsx("button",{onClick:()=>i(u.id),className:`relative w-12 h-12 rounded-full ${u.bg} ${u.border||""} 
                                                    ring-2 ring-offset-4 transition-all duration-200
                                                    ${t===u.id?"ring-[#002C5F]":"ring-transparent"}
                                                `,"aria-label":`Select ${u.name} color`,children:t===u.id&&T.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-white pointer-events-none"})},u.id))})]}),T.jsx("button",{onClick:()=>o(!1),className:"w-full bg-black text-white font-bold py-4 rounded-lg tracking-widest uppercase transition-all active:scale-[0.98] shadow-lg",children:"UPDATE"})]})]})]})]})]})},wA=({onRemove:h,onReview:t,isDisabled:i,isPreparing:s})=>{const a=i||s;return T.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-[#f3f4f6] border-t border-gray-200 p-4 md:p-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50",children:T.jsxs("div",{className:"max-w-md md:max-w-none mx-auto md:mx-0 md:ml-auto flex space-x-3 w-full md:w-auto px-4 md:pr-8",children:[T.jsx("button",{onClick:h,disabled:i||s,className:`flex-1 px-6 py-4 md:py-4 rounded-lg text-sm font-bold tracking-widest uppercase transition-colors shadow-sm
                    ${i||s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border-2 border-gray-200 text-gray-500 hover:border-red-500 hover:text-red-500"}`,children:"REMOVE"}),T.jsx("button",{onClick:t,disabled:a,className:`flex-1 px-6 py-4 md:py-4 rounded-lg text-sm font-bold tracking-widest uppercase transition-colors shadow-sm
                    ${a?"bg-gray-300 text-white cursor-not-allowed":"bg-black text-white hover:bg-gray-800"}`,children:s?"PREPARING...":"REVIEW"})]})})},SA=({isOpen:h,onClose:t,onConfirm:i})=>{const[s,a]=ct.useState(!1);return h?T.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl relative overflow-hidden flex flex-col max-h-[90vh]",children:[T.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-6 md:p-8 flex flex-col h-full overflow-hidden",children:[T.jsx("h2",{className:"text-xl font-bold text-[#007db5] text-center uppercase tracking-wider mb-6",children:"Confirm This"}),T.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 mb-6 text-sm text-gray-600 leading-relaxed space-y-4 custom-scrollbar",children:[T.jsx("p",{children:"The submitted image and/or text is not unlawful, harmful, threatening, tortious, defamatory, vulgar, obscene, libelous, invasive of another's privacy, hateful, or racially, ethnically, or otherwise objectionable, does not infringe upon any patent, trademark, copyright, trade secret, or other proprietary rights of any third party (this includes but is not limited to sports teams and licensed university logos or slogans), and does not otherwise violate any of the rights or other categories listed in our FAQs. All personalized orders are subject to review. If any of the above conditions are violated, the entire order will be canceled."}),T.jsx("p",{children:"Once you submit your order, you cannot edit or modify it. Any changes to the imprint of your order must be made before the order ships."}),T.jsx("p",{children:"Personalized items are non-refundable and cannot be canceled after you place your order. All sales of personalized products are final."}),T.jsx("p",{children:"We do not offer personalization of our stainless steel drinkware or Yonder bottles."}),T.jsx("p",{children:"If you need assistance ordering custom drinkware, for example, if you want to place an order for products with a trademarked or copyrighted image for which you have permission, or if you have any questions, please contact our Outfitter team before placing your order."}),T.jsx("p",{children:"For company logos, please visit our Corporate Sales page for information and quotes."})]}),T.jsxs("label",{className:"flex items-start space-x-3 mb-8 cursor-pointer group",children:[T.jsx("div",{className:"flex items-center h-5 mt-0.5",children:T.jsx("input",{type:"checkbox",checked:s,onChange:o=>a(o.target.checked),className:"w-5 h-5 rounded border-gray-300 text-[#007db5] focus:ring-[#007db5] cursor-pointer transition-colors"})}),T.jsx("span",{className:"text-sm font-semibold text-gray-800 group-hover:text-black transition-colors",children:"I agree to these terms and conditions"})]}),T.jsxs("div",{className:"flex space-x-4",children:[T.jsx("button",{onClick:t,className:"flex-1 py-3 bg-[#007db5] text-white font-bold uppercase tracking-widest text-xs hover:bg-[#006da0] transition-colors rounded shadow-md",children:"Cancel"}),T.jsx("button",{onClick:i,disabled:!s,className:`flex-1 py-3 font-bold uppercase tracking-widest text-xs rounded transition-all shadow-md ${s?"bg-[#007db5] text-white hover:bg-[#006da0]":"bg-[#9CA3AF] text-white cursor-not-allowed"}`,children:"Accept"})]})]})]})}):null},EA=({onClose:h,onRequestClose:t,customization:i,selectedColor:s,selectedFont:a,selectedMonogramBySide:o,frontImage:l,backImage:u,frontDesignImage:d,backDesignImage:f,setActiveTab:g,setView:y})=>{const[b,A]=ct.useState(!1),[w,x]=ct.useState(""),[E,S]=ct.useState(!1);ct.useEffect(()=>{const R=O=>{const k=O.data;!k||k.type!=="BOTTLE_CUSTOMIZER_ADD_TO_CART_STATUS"||(k.status==="loading"?(A(!0),x("")):k.status==="success"?A(!1):k.status==="error"&&(A(!1),x(k.message||"Failed to add to cart. Please try again.")))};return window.addEventListener("message",R),()=>window.removeEventListener("message",R)},[]);const M=ct.useCallback(async()=>{const R=i.FRONT.graphic&&typeof i.FRONT.graphic.src=="string"&&i.FRONT.graphic.src.startsWith("gallery/")?i.FRONT.graphic.src:"",O=i.BACK.graphic&&typeof i.BACK.graphic.src=="string"&&i.BACK.graphic.src.startsWith("gallery/")?i.BACK.graphic.src:"",k={color:s,font:a,frontMonogramStyle:o?.FRONT||"",backMonogramStyle:o?.BACK||"",monogramStyle:o?.BACK||"",frontText:i.FRONT.text||"",backText:i.BACK.text||"",frontMonogram:i.FRONT.monogram||"",backMonogram:i.BACK.monogram||"",frontGraphic:i.FRONT.graphic?i.FRONT.graphic.name:"",backGraphic:i.BACK.graphic?i.BACK.graphic.name:"",frontGraphicSrc:R,backGraphicSrc:O,frontImage:l||"",backImage:u||"",frontDesignImage:d||"",backDesignImage:f||""};console.log("Adding to Cart - Customization Data:",k),x(""),typeof window<"u"&&window.parent&&window.parent!==window?(A(!0),window.parent.postMessage({type:"BOTTLE_CUSTOMIZER_ADD_TO_CART",data:k},"*")):(console.log("Standalone mode - Add to Cart Data:",k),alert("Added to cart! (Check console for payload)"),t())},[i,s,a,o,l,u,d,f,t]),_=R=>{g(R);const O=i[R];O.graphic?y("gallery"):O.monogram?y("monogram"):y("text"),h()};return T.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col font-sans text-slate-900 animate-in fade-in active:fade-out duration-300",children:[b&&T.jsxs("div",{className:"fixed inset-0 z-[100] bg-white/90 flex flex-col items-center justify-center",children:[T.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("p",{className:"text-lg font-semibold text-[#002C5F]",children:"Adding to cart..."})]}),T.jsx("header",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:T.jsxs("div",{className:"max-w-[1920px] mx-auto px-4 md:px-6 h-14 md:h-16 flex items-center justify-between",children:[T.jsx("img",{src:"logo.png",alt:"Logo",className:"h-8 md:h-10 w-auto object-contain"}),T.jsx("button",{onClick:h,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close Review",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[#002C5F]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),T.jsxs("main",{className:"flex-1 overflow-y-auto p-3 md:p-8 bg-[#f9fafb]",children:[T.jsxs("div",{className:"text-center mb-4 md:mb-8 max-w-2xl mx-auto",children:[T.jsx("h1",{className:"text-xl md:text-2xl font-bold text-[#002C5F] uppercase tracking-wider mb-3",children:"Review Your Design"}),T.jsx("p",{className:"text-sm md:text-base text-gray-800 font-medium leading-relaxed px-4",children:"Please allow 7 business days for personalization and 2-3 days for delivery. Delivery dates cannot be guaranteed. ALL PURCHASES ARE FINAL."})]}),T.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-12 items-start",children:[T.jsxs("div",{className:"flex flex-col items-center bg-[#f9fafb] p-4 rounded-lg ",children:[T.jsx("div",{className:"relative w-full max-w-[240px] md:max-w-[300px] aspect-[3/5] flex items-center justify-center bg-[#f9fafb] rounded-md overflow-visible mb-4",children:l?T.jsx("img",{src:l,alt:"Front Preview",className:"w-full h-full object-contain drop-shadow-xl mix-blend-multiply"}):T.jsx("div",{className:"text-gray-400 text-sm",children:"No Preview Available"})}),T.jsxs("button",{onClick:()=>_("FRONT"),className:"group flex items-center space-x-2 bg-white px-6 py-3 rounded-full shadow-sm border border-gray-100 uppercase font-bold text-[#002C5F] text-xs md:text-sm tracking-wider hover:shadow-md transition-all",children:[T.jsx("span",{children:"Edit Front"}),T.jsx("div",{className:"w-6 h-6 rounded-full border border-[#002C5F] flex items-center justify-center group-hover:bg-[#002C5F] group-hover:text-white transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]})]}),T.jsxs("div",{className:"flex flex-col items-center bg-[#f9fafb] p-4 rounded-lg ",children:[T.jsx("div",{className:"relative w-full max-w-[240px] md:max-w-[300px] aspect-[3/5] flex items-center justify-center bg-[#f9fafb] rounded-md overflow-visible mb-4",children:u?T.jsx("img",{src:u,alt:"Back Preview",className:"w-full h-full object-contain drop-shadow-xl mix-blend-multiply"}):T.jsx("div",{className:"text-gray-400 text-sm",children:"No Preview Available"})}),T.jsxs("button",{onClick:()=>_("BACK"),className:"group flex items-center space-x-2 bg-white px-6 py-3 rounded-full shadow-sm border border-gray-100 uppercase font-bold text-[#002C5F] text-xs md:text-sm tracking-wider hover:shadow-md transition-all",children:[T.jsx("span",{children:"Edit Back"}),T.jsx("div",{className:"w-6 h-6 rounded-full border border-[#002C5F] flex items-center justify-center group-hover:bg-[#002C5F] group-hover:text-white transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]})]})]})]}),T.jsx("footer",{className:"bg-white border-t border-gray-200 p-3 md:p-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50 flex-shrink-0",children:T.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col items-center justify-between gap-3",children:[T.jsx("div",{className:"text-center w-full",children:w?T.jsx("p",{className:"text-sm font-medium text-red-600",children:w}):T.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Please review your spelling and design. Custom products cannot be returned."})}),T.jsxs("div",{className:"w-full flex space-x-3 px-4 md:px-0",children:[T.jsx("button",{onClick:h,disabled:b,className:`flex-1 px-6 py-4 rounded-lg text-sm bg-white border-2 border-gray-200 text-gray-500 font-bold uppercase tracking-widest transition-colors ${b?"opacity-50 cursor-not-allowed":"hover:border-[#002C5F] hover:text-[#002C5F]"}`,children:"Back"}),T.jsx("button",{onClick:()=>S(!0),disabled:b,className:`flex-1 px-6 py-4 rounded-lg text-[12px] md:text-sm bg-black text-white font-bold uppercase tracking-widest transition-colors ${b?"opacity-50 cursor-not-allowed":"hover:bg-gray-800"}`,children:b?"Adding...":"Add to Cart"})]})]})}),T.jsx(SA,{isOpen:E,onClose:()=>S(!1),onConfirm:()=>{S(!1),M()}})]})},Fe=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ah=[.001,0,0,.001,0,0],ch=1.35,oi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Pn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Er="pdfjs_internal_editor_",St={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ot={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},CA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xh={TRIANGLES:1,LATTICE:2},ye={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ge={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},oa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Sl={ERRORS:0,WARNINGS:1,INFOS:5},Cr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},gr={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},TA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let El=Sl.WARNINGS;function _A(h){Number.isInteger(h)&&(El=h)}function MA(){return El}function Cl(h){El>=Sl.INFOS&&console.info(`Info: ${h}`)}function At(h){El>=Sl.WARNINGS&&console.warn(`Warning: ${h}`)}function It(h){throw new Error(h)}function Ut(h,t){h||It(t)}function DA(h){switch(h?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function a0(h,t=null,i=null){if(!h)return null;if(i&&typeof h=="string"&&(i.addDefaultProtocol&&h.startsWith("www.")&&h.match(/\./g)?.length>=2&&(h=`http://${h}`),i.tryConvertEncoding))try{h=BA(h)}catch{}const s=t?URL.parse(h,t):URL.parse(h);return DA(s)?s:null}function r0(h,t,i=!1){const s=URL.parse(h);return s?(s.hash=t,s.href):i&&a0(h,"http://example.com")?h.split("#",1)[0]+`${t?`#${t}`:""}`:""}function xt(h,t,i,s=!1){return Object.defineProperty(h,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const ms=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class vp extends ms{constructor(t,i){super(t,"PasswordException"),this.code=i}}class uh extends ms{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class wh extends ms{constructor(t){super(t,"InvalidPDFException")}}class pl extends ms{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class RA extends ms{constructor(t){super(t,"FormatError")}}class Hn extends ms{constructor(t){super(t,"AbortException")}}function NA(h){(typeof h!="object"||h?.length===void 0)&&It("Invalid argument for bytesToString");const t=h.length,i=8192;if(t<i)return String.fromCharCode.apply(null,h);const s=[];for(let a=0;a<t;a+=i){const o=Math.min(a+i,t),l=h.subarray(a,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function Tl(h){typeof h!="string"&&It("Invalid argument for stringToBytes");const t=h.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=h.charCodeAt(s)&255;return i}function kA(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function OA(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function LA(){try{return new Function(""),!0}catch{return!1}}class be{static get isLittleEndian(){return xt(this,"isLittleEndian",OA())}static get isEvalSupported(){return xt(this,"isEvalSupported",LA())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return xt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return xt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return xt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return xt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return xt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const hh=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,i,s){return`#${hh[t]}${hh[i]}${hh[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const a=t[s],o=t[s+1];t[s]=a*i[0]+o*i[2]+i[4],t[s+1]=a*i[1]+o*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const a=i[0],o=i[1],l=i[2],u=i[3],d=i[4],f=i[5];for(let g=0;g<6;g+=2){const y=t[s+g],b=t[s+g+1];t[s+g]=y*a+b*l+d,t[s+g+1]=y*o+b*u+f}}static applyInverseTransform(t,i){const s=t[0],a=t[1],o=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-a*i[2]+i[2]*i[5]-i[4]*i[3])/o,t[1]=(-s*i[1]+a*i[0]+i[4]*i[1]-i[5]*i[0])/o}static axialAlignedBoundingBox(t,i,s){const a=i[0],o=i[1],l=i[2],u=i[3],d=i[4],f=i[5],g=t[0],y=t[1],b=t[2],A=t[3];let w=a*g+d,x=w,E=a*b+d,S=E,M=u*y+f,_=M,R=u*A+f,O=R;if(o!==0||l!==0){const k=o*g,F=o*b,j=l*y,X=l*A;w+=j,S+=j,E+=X,x+=X,M+=k,O+=k,R+=F,_+=F}s[0]=Math.min(s[0],w,E,x,S),s[1]=Math.min(s[1],M,R,_,O),s[2]=Math.max(s[2],w,E,x,S),s[3]=Math.max(s[3],M,R,_,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],a=t[1],o=t[2],l=t[3],u=s**2+a**2,d=s*o+a*l,f=o**2+l**2,g=(u+f)/2,y=Math.sqrt(g**2-(u*f-d**2));i[0]=Math.sqrt(g+y||1),i[1]=Math.sqrt(g-y||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>a)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>l?null:[s,o,a,l]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,a,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],i,a),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],i,a)}static#t(t,i,s,a,o,l,u,d,f,g){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*t+3*f*i)+3*b*s)+A*a,x=y*(y*(y*o+3*f*l)+3*b*u)+A*d;g[0]=Math.min(g[0],w),g[1]=Math.min(g[1],x),g[2]=Math.max(g[2],w),g[3]=Math.max(g[3],x)}static#e(t,i,s,a,o,l,u,d,f,g,y,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,i,s,a,o,l,u,d,-y/g,b);return}const A=g**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),x=2*f;this.#t(t,i,s,a,o,l,u,d,(-g+w)/x,b),this.#t(t,i,s,a,o,l,u,d,(-g-w)/x,b)}static bezierBoundingBox(t,i,s,a,o,l,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,d),this.#e(t,s,o,u,i,a,l,d,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,u,i,a,l,d,3*(-i+3*(a-l)+d),6*(i-2*a+l),3*(a-i),f)}}function BA(h){return decodeURIComponent(escape(h))}let dh=null,Ap=null;function FA(h){return dh||(dh=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ap=new Map([["","t"]])),h.replaceAll(dh,(t,i,s)=>i?i.normalize("NFKC"):Ap.get(s))}function o0(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const h=new Uint8Array(32);return crypto.getRandomValues(h),NA(h)}const ua="pdfjs_internal_id_";function zA(h,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,a,...o]=i;if(!h(s)&&!Number.isInteger(s)||!t(a))return!1;const l=o.length;let u=!0;switch(a.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const d of o)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function De(h,t,i){return Math.min(Math.max(h,t),i)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(h){return h.reduce((t,i)=>t+i,0)});class Tr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function a(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(Tr.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&i.push({str:l}),!!o.children)for(const d of o.children)a(d)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class l0{static setupStorage(t,i,s,a,o){const l=a.getValue(i,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{a.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:a,linkService:o}){const{attributes:l}=i,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[d,f]of Object.entries(l))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:s});const u=o!=="richText",d=t.div;if(d.append(l),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);l.append(y),u&&Tr.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const g=[[a,-1,l]];for(;g.length>0;){const[y,b,A]=g.at(-1);if(b+1===y.children.length){g.pop();continue}const w=y.children[++g.at(-1)[1]];if(w===null)continue;const{name:x}=w;if(x==="#text"){const S=document.createTextNode(w.value);f.push(S),A.append(S);continue}const E=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,x):document.createElement(x);if(A.append(E),w.attributes&&this.setAttributes({html:E,element:w,storage:i,intent:o,linkService:s}),w.children?.length>0)g.push([w,-1,E]);else if(w.value){const S=document.createTextNode(w.value);u&&Tr.shouldBuildText(x)&&f.push(S),E.append(S)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const cn="http://www.w3.org/2000/svg";class va{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Dr(h,t="text"){if(Ar(h,document.baseURI)){const i=await fetch(h);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const a=new XMLHttpRequest;a.open("GET",h,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(a.response);return}i(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class Rr{constructor({viewBox:t,userUnit:i,scale:s,rotation:a,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=a,this.offsetX=o,this.offsetY=l,s*=i;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,y,b,A;switch(a%=360,a<0&&(a+=360),a){case 180:g=-1,y=0,b=0,A=1;break;case 90:g=0,y=1,b=1,A=0;break;case 270:g=0,y=-1,b=-1,A=0;break;case 0:g=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let w,x,E,S;g===0?(w=Math.abs(f-t[1])*s+o,x=Math.abs(d-t[0])*s+l,E=(t[3]-t[1])*s,S=(t[2]-t[0])*s):(w=Math.abs(d-t[0])*s+o,x=Math.abs(f-t[1])*s+l,E=(t[2]-t[0])*s,S=(t[3]-t[1])*s),this.transform=[g*s,y*s,b*s,A*s,w-g*s*d-b*s*f,x-y*s*d-A*s*f],this.width=E,this.height=S}get rawDims(){const t=this.viewBox;return xt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:o=!1}={}){return new Rr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}convertToViewportPoint(t,i){const s=[t,i];return nt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];nt.applyTransform(i,this.transform);const s=[t[2],t[3]];return nt.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return nt.applyInverseTransform(s,this.transform),s}}class jh extends ms{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function _l(h){const t=h.length;let i=0;for(;i<t&&h[i].trim()==="";)i++;return h.substring(i,i+5).toLowerCase()==="data:"}function Ph(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function jA(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function PA(h,t="document.pdf"){if(typeof h!="string")return t;if(_l(h))return At('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(h);if(!s)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},o=/\.pdf$/i,l=s.pathname.split("/").at(-1);if(o.test(l))return a(l);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(o.test(f))return a(f);const d=Array.from(s.searchParams.keys()).reverse();for(const f of d)if(o.test(f))return a(f)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return a(d[0])}return t}class xp{started=Object.create(null);times=[];time(t){t in this.started&&At(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||At(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:a,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-a}ms
`);return t.join("")}}function Ar(h,t){const i=t?URL.parse(h,t):URL.parse(h);return i?.protocol==="http:"||i?.protocol==="https:"}function Ei(h){h.preventDefault()}function re(h){h.preventDefault(),h.stopPropagation()}function UA(h){console.log("Deprecated API usage: "+h)}class Sh{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let a=parseInt(i[2],10);a=a>=1&&a<=12?a-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(i[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(i[6],10);d=d>=0&&d<=59?d:0;const f=i[7]||"Z";let g=parseInt(i[8],10);g=g>=0&&g<=23?g:0;let y=parseInt(i[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=g,u+=y):f==="+"&&(l-=g,u-=y),new Date(Date.UTC(s,a,o,l,u,d))}}function IA(h,{scale:t=1,rotation:i=0}){const{width:s,height:a}=h.attributes.style,o=[0,0,parseInt(s),parseInt(a)];return new Rr({viewBox:o,userUnit:1,scale:t,rotation:i})}function Nr(h){if(h.startsWith("#")){const t=parseInt(h.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(t=>parseInt(t)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(At(`Not a valid color format: "${h}"`),[0,0,0])}function HA(h){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of h.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;h.set(i,Nr(s))}t.remove()}function ie(h){const{a:t,b:i,c:s,d:a,e:o,f:l}=h.getTransform();return[t,i,s,a,o,l]}function ji(h){const{a:t,b:i,c:s,d:a,e:o,f:l}=h.getTransform().invertSelf();return[t,i,s,a,o,l]}function ds(h,t,i=!1,s=!0){if(t instanceof Rr){const{pageWidth:a,pageHeight:o}=t.rawDims,{style:l}=h,u=be.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${o}px`,g=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(l.width=g,l.height=y):(l.width=y,l.height=g)}s&&h.setAttribute("data-main-rotation",t.rotation)}class Hi{constructor(){const{pixelRatio:t}=Hi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,a,o=-1){let l=1/0,u=1/0,d=1/0;s=Hi.capPixels(s,o),s>0&&(l=Math.sqrt(s/(t*i))),a!==-1&&(u=a/t,d=a/i);const f=Math.min(l,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const Eh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class GA{static get isDarkMode(){return xt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class VA{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),xt(this,"commentForegroundColor",Nr(s))}}function XA(h,t,i,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return h=Math.round(h*s+a),t=Math.round(t*s+a),i=Math.round(i*s+a),[h,t,i]}function wp(h,t){const i=h[0]/255,s=h[1]/255,a=h[2]/255,o=Math.max(i,s,a),l=Math.min(i,s,a),u=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const d=o-l;switch(t[1]=u<.5?d/(o+l):d/(2-o-l),o){case i:t[0]=((s-a)/d+(s<a?6:0))*60;break;case s:t[0]=((a-i)/d+2)*60;break;case a:t[0]=((i-s)/d+4)*60;break}}t[2]=u}function Ch(h,t){const i=h[0],s=h[1],a=h[2],o=(1-Math.abs(2*a-1))*s,l=o*(1-Math.abs(i/60%2-1)),u=a-o/2;switch(Math.floor(i/60)){case 0:t[0]=o+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=o+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=l+u;break}}function Sp(h){return h<=.03928?h/12.92:((h+.055)/1.055)**2.4}function Ep(h,t,i){Ch(h,i),i.map(Sp);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Ch(t,i),i.map(Sp);const a=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const Cp=new Map;function YA(h,t){const i=h[0]+h[1]*256+h[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Cp.get(i);if(s)return s;const a=new Float32Array(9),o=a.subarray(0,3),l=a.subarray(3,6);wp(h,l);const u=a.subarray(6,9);wp(t,u);const d=u[2]<.5,f=d?12:4.5;if(l[2]=d?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),Ep(l,u,o)<f){let g,y;d?(g=l[2],y=1):(g=0,y=l[2]);const b=.005;for(;y-g>b;){const A=l[2]=(g+y)/2;d===Ep(l,u,o)<f?g=A:y=A}l[2]=d?y:g}return Ch(l,o),s=nt.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Cp.set(i,s),s}function c0({html:h,dir:t,className:i},s){const a=document.createDocumentFragment();if(typeof h=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=h.split(/(?:\r\n?|\n)/);for(let u=0,d=l.length;u<d;++u){const f=l[u];o.append(document.createTextNode(f)),u<d-1&&o.append(document.createElement("br"))}a.append(o)}else l0.render({xfaHtml:h,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",i),s.append(a)}function u0(h){const t=new Path2D;if(!h)return t;for(let i=0,s=h.length;i<s;)switch(h[i++]){case gr.moveTo:t.moveTo(h[i++],h[i++]);break;case gr.lineTo:t.lineTo(h[i++],h[i++]);break;case gr.curveTo:t.bezierCurveTo(h[i++],h[i++],h[i++],h[i++],h[i++],h[i++]);break;case gr.quadraticCurveTo:t.quadraticCurveTo(h[i++],h[i++],h[i++],h[i++]);break;case gr.closePath:t.closePath();break;default:At(`Unrecognized drawing path operator: ${h[i-1]}`);break}return t}class jt{static#t=null;static#e=null;static#n=null;static#i=0;static#a=[];get pagesNumber(){return jt.#i}set pagesNumber(t){jt.#i!==t&&(jt.#i=t,t===0&&(jt.#e=null,jt.#t=null))}addListener(t){jt.#a.push(t)}removeListener(t){const i=jt.#a.indexOf(t);i>=0&&jt.#a.splice(i,1)}#r(){for(const t of jt.#a)t()}#s(t){if(jt.#e)return;const i=jt.#i,s=new Uint32Array(3*i),a=jt.#e=s.subarray(0,i),o=jt.#t=s.subarray(i,2*i);if(t)for(let l=0;l<i;l++)a[l]=o[l]=l+1;jt.#n=s.subarray(2*i)}movePages(t,i,s){this.#s(!0);const a=jt.#e,o=jt.#t;jt.#n.set(o);const l=i.length,u=new Uint32Array(l);let d=0;for(let A=0;A<l;A++){const w=i[A]-1;u[A]=a[w],w<s&&(d+=1)}const f=jt.#i;let g=s-d;const y=f-l;g=De(g,0,y);for(let A=0,w=0;A<f;A++)t.has(A+1)||(a[w++]=a[A]);a.copyWithin(g+l,g,y),a.set(u,g);let b=!1;for(let A=0,w=f;A<w;A++){const x=a[A];b||=x!==A+1,o[x-1]=A+1}this.#r(),b||(this.pagesNumber=0)}hasBeenAltered(){return jt.#e!==null}getPageMappingForSaving(){return{pageIndices:jt.#t?jt.#t.map(t=>t-1):null}}getPrevPageNumber(t){return jt.#n[jt.#e[t-1]-1]}getPageNumber(t){return jt.#t?.[t-1]??t}getPageId(t){return jt.#e?.[t-1]??t}static get instance(){return xt(this,"instance",new jt)}getMapping(){return jt.#e.subarray(0,this.pagesNumber)}}class Sr{#t=null;#e=null;#n;#i=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(t){this.#n=t,Sr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",Ei,{signal:i}),t.addEventListener("pointerdown",Sr.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const a=this.#n.toolbarPosition;if(a){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-a[0]:a[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,re(t)}#h(t){this.#n._focusEventsAllowed=!0,re(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Ei,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",Sr.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#p(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#p),this.#a=t}addComment(t,i=null){if(this.#r)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#s=this.#p;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(a,i)):this.#i.append(s,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#p)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#p)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null)}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const a=this.#i.querySelector(s);a&&t==="comment"&&this.addComment(i,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class qA{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",Ei,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,i){let s=0,a=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(i?o.width:0);if(l>s){a=u,s=l;continue}i?u>a&&(a=u):u<a&&(a=u)}return[i?1-a:a,s]}show(t,i,s){const[a,o]=this.#a(i,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,i,s,a){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",i);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",Ei,{signal:u}),o.addEventListener("click",a,{signal:u})),this.#t.append(o)}}function h0(h,t,i){for(const s of i)t.addEventListener(s,h[s].bind(h))}class Pt{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Pt.#e||=new Set).add(t)}static setPointer(t,i){Pt.#t||=i,Pt.#i??=t}static setTimeStamp(t){Pt.#n=t}static isSamePointerId(t){return Pt.#t===t}static isSamePointerIdOrRemove(t){return Pt.#t===t?!0:(Pt.#e?.delete(t),!1)}static isSamePointerType(t){return Pt.#i===t}static isInitializedAndDifferentPointerType(t){return Pt.#i!==null&&!Pt.isSamePointerType(t)}static isSameTimeStamp(t){return Pt.#n===t}static isUsingMultiplePointers(){return Pt.#e?.size>=1}static clearPointerType(){Pt.#i=null}static clearPointerIds(){Pt.#t=NaN,Pt.#e=null}static clearTimeStamp(){Pt.#n=NaN}}class $A{#t=0;get id(){return`${Er}${this.#t++}`}}class Uh{#t=o0();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const o=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return xt(this,"_isSVGFittingCanvas",o)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof i=="string"?(s.url=i,a=await Dr(i,"blob")):i instanceof File?a=s.file=i:i instanceof Blob&&(a=i),a.type==="image/svg+xml"){const o=Uh._isSVGFittingCanvas,l=new FileReader,u=new Image,d=new Promise((f,g)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},l.onload=async()=>{const y=s.svgUrl=l.result;u.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=l.onerror=g});l.readAsDataURL(a),await d}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){At(a),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:a,type:o}=t;return this.#i(`${i}_${s}_${a}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(i.width,i.height);return a.getContext("2d").drawImage(i,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=a.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class KA{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:a,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:i,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(l&&this.#t[this.#i].type===o){u&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class kr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=be.platform;for(const[s,a,o={}]of t)for(const l of s){const u=l.startsWith("mac+");i&&u?(this.callbacks.set(l.slice(4),{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1))):!i&&!u&&(this.callbacks.set(l,{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:a,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,i)||(a.bind(t,...l,i)(),o||re(i))}}class Ih{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return HA(t),xt(this,"_colors",t)}convert(t){const i=Nr(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,a]of this._colors)if(a.every((o,l)=>o===i[l]))return Ih._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?nt.makeHexColor(...i):t}}class Gn{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new KA;#l=null;#d=null;#h=null;#f=0;#p=new Set;#g=null;#u=null;#m=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#C=null;#S=null;#x=null;#_=null;#A=!1;#E=null;#R=new $A;#M=!1;#D=!1;#z=!1;#k=null;#L=null;#j=null;#B=null;#V=null;#T=St.NONE;#w=new Set;#O=null;#P=null;#I=null;#q=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#F=null;#X=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Gn.prototype,i=l=>l.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return xt(this,"_keyboardManager",new kr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#X.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}constructor(t,i,s,a,o,l,u,d,f,g,y,b,A,w,x,E){const S=this._signal=this.#t.signal;this.#X=t,this.#Z=i,this.#J=s,this.#r=a,this.#l=o,this.#P=l,this.#Y=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:S}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),u._on("setpreference",this.onSetPreference.bind(this),{signal:S}),u._on("switchannotationeditorparams",M=>this.updateParams(M.type,M.value),{signal:S}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:S}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:S}),this.#rt(),this.#dt(),this.#et(),this.#s=d.annotationStorage,this.#C=d.filterFactory,this.#I=f,this.#_=g||null,this.#y=y,this.#v=b,this.#b=A,this.#V=w||null,this.viewParameters={realScale:va.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=E!==!1,o?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#m.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#P?.destroy(),this.#E?.hide(),this.#E=null,this.#j?.destroy(),this.#j=null,this.#n=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#F&&(clearTimeout(this.#F),this.#F=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return xt(this,"hcmFilter",this.#I?this.#C.addHCMFilter(this.#I.foreground,this.#I.background):"none")}get direction(){return xt(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return xt(this,"_highlightColors",this.#_?new Map(this.#_.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return xt(this,"highlightColors",null);const i=new Map,s=!!this.#I;for(const[a,o]of t){const l=a.endsWith("_HCM");if(s&&l){i.set(a.replace("_HCM",""),o);continue}!s&&!l&&i.set(a,o)}return xt(this,"highlightColors",i)}get highlightColorNames(){return xt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#j=t}editAltText(t,i=!1){this.#r?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,a){this.#l?.showDialog(this,t,i,s,a)}selectComment(t,i){this.#a.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,i){const s=()=>{t.comment=i},a=()=>{this._editorUndoBar?.show(s,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:s,mustExec:!0})}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),a=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",a),i())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#P?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#P}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=i)}onPagesEdited({pagesMapper:t}){for(const a of this.#i.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const i=this.#a,s=this.#a=new Map;for(const[a,o]of i){const l=t.getPrevPageNumber(a+1)-1;if(l===-1){o.destroy();continue}s.set(l,o),o.updatePageIndex(l)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#X.focus()}findParent(t,i){for(const s of this.#a.values()){const{x:a,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+l&&i>=o&&i<=o+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*va.PDF_TO_CSS_UNITS;for(const i of this.#m)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#a.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u}=s,d=s.toString(),g=this.#Q(s).closest(".textLayer"),y=this.getSelectionBoxes(g);if(!y)return;s.empty();const b=this.#tt(g),A=this.#T===St.NONE,w=()=>{const x=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u,text:d});A&&this.showAllEditors("highlight",!0,!0),i&&x?.editComment()};if(A){this.switchToMode(St.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Q(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#E||=new qA(this),this.#E.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${Er}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#E?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#O)return;const a=this.#Q(t).closest(".textLayer");if(!a){this.#O&&(this.#E?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#O=i,this.#N({hasSelectedText:!0}),!(this.#T!==St.HIGHLIGHT&&this.#T!==St.NONE)&&(this.#T===St.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===St.HIGHLIGHT?this.#tt(a):null;if(o?.toggleDrawing(),this.#D){const l=new AbortController,u=this.combinedSignal(l),d=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===St.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#w)if(i.div.contains(t)){this.#L=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,i]=this.#L;this.#L=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#k?.abort(),this.#k=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#w){const a=s.serialize(!0);a&&i.push(a)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){At(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const o=[];for(const d of s){const f=await a.deserialize(d);if(!f)return;o.push(f)}const l=()=>{for(const d of o)this.#it(d);this.#nt(o)},u=()=>{for(const d of o)d.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){At(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==St.NONE&&!this.isEditorHandlingKeyboard&&Gn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,a])=>this.#$[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===St.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Ot.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#N({isEditing:this.#T!==St.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,a=!1,o=!1,l=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===St.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===St.NONE){this.setEditingState(!1),this.#mt();for(const u of this.#i.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#i.values())u.addStandaloneCommentButton();t===St.SIGNATURE&&await this.#P?.loadSignatures(),s&&Pt.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#a.values())u.updateMode(t);if(t===St.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#i.values()){const{annotationElementId:g,hasComment:y,deleted:b}=f;g&&u.add(g),y&&!b&&d.push(f.getData())}for(const f of this.#n){const{id:g,popupRef:y,contentsObj:b}=f;y&&b?.str&&!u.has(g)&&!this.#p.has(g)&&d.push(f)}this.#l?.showSidebar(d)}if(!i){a&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#i.values())u.uid===i?(this.setSelected(u),l?u.editComment():o?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Ot.CREATE:this.currentLayer.addNewEditor(i);return;case Ot.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#w)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const o of this.#i.values())o.editorType===t&&o.show(i);(this.#q?.get(Ot.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Ot.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#z!==t){this.#z=t;for(const i of this.#a.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#a.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#mt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#p.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#p.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#p.has(t)}removeDeletedAnnotationElement(t){this.#p.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#a.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#w)i!==t&&i.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(a,i.length===1?i[0].editorType:i.length);for(const o of i)o.remove()},a=()=>{for(const o of i)this.#it(o)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#w)i.unselect();this.#w.clear();for(const i of t)i.isEmpty()||(this.#w.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==St.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[a,o]=this.#H,l=[...this.#w],u=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of l)this.#i.has(d.id)&&(d.translateInPage(a,o),d.translationDone())},undo:()=>{for(const d of l)this.#i.has(d.id)&&(d.translateInPage(-a,-o),d.translationDone())},mustExec:!1})},u);for(const d of l)d.translateInPage(t,i),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#w)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:a,y:o,pageIndex:l},u]of t)u.newX=a,u.newY=o,u.newPageIndex=l,i||=a!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!i)return!1;const s=(a,o,l,u)=>{if(this.#i.has(a.id)){const d=this.#a.get(u);d?a._setParentAndPosition(d,o,l):(a.pageIndex=u,a.x=o,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:o,newY:l,newPageIndex:u}]of t)s(a,o,l,u)},undo:()=>{for(const[a,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(a,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==St.NONE}get imageManager(){return xt(this,"imageManager",new Uh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,g=i.rangeCount;f<g;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:a,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,g,y,b)=>({x:(g-a)/l,y:1-(f+y-s)/o,width:b/l,height:y/o});break;case"180":u=(f,g,y,b)=>({x:1-(f+y-s)/o,y:1-(g+b-a)/l,width:y/o,height:b/l});break;case"270":u=(f,g,y,b)=>({x:1-(g+b-a)/l,y:(f-s)/o,width:b/l,height:y/o});break;default:u=(f,g,y,b)=>({x:(f-s)/o,y:(g-a)/l,width:y/o,height:b/l});break}const d=[];for(let f=0,g=i.rangeCount;f<g;f++){const y=i.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:x}of y.getClientRects())w===0||x===0||d.push(u(b,A,w,x))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===St.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const a=this.#B?.get(t);a&&(a.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Ii{#t=null;#e=!1;#n=null;#i=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ii.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ii._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ii.#f.missing),i.setAttribute("data-l10n-id",Ii.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ei,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#s=!0,a(o))},{signal:s}),await this.#g(),t}get#p(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Ii._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:a,cancel:o=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===i)&&(o||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ii.#f[this.#p]),this.#i?.setAttribute("data-l10n-id",Ii.#f[`${this.#p}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#a;if(!i){this.#a=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const a=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:o})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class tl{#t=null;#e=null;#n=!1;#i=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const a=this.#i.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#i.parent.boundingClientRect;return[(t-a)/l,(i+s-o)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ei,{signal:s}),i&&(t.addEventListener("focusin",o=>{this.#i._focusEventsAllowed=!1,re(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#i._focusEventsAllowed=!0,re(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#n=!0,a(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,a;if(i)[s,a]=i;else{[s,a]=this.#i.commentButtonPosition;const{width:g,height:y,x:b,y:A}=this.#i;s=b+s*g,a=A+a*y}const o=this.#i.parent.boundingClientRect,{x:l,y:u,width:d,height:f}=o;this.#i._uiManager.editComment(this.#i,l+s*d,u+a*f,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#r=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:i,date:s}){this.#s=t,this.#r=i,this.#o=s,this.#c=!1}setInitialText(t,i=null){this.#a=t,this.data=t,this.#o=null,this.#r=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class Ml{#t;#e=!1;#n=null;#i;#a;#r;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#a=a,this.#r=o,this.#s=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Hi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,o=AbortSignal.any([this.#c,a.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(re(f),d(f))},u),l.addEventListener("pointerup",d,u),l.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:a,capture:!1,passive:!1};o.addEventListener("touchmove",this.#p.bind(this),l);const u=this.#g.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",re,l),o.addEventListener("pointermove",re,l),o.addEventListener("pointercancel",re,l),o.addEventListener("pointerup",re,l),this.#a?.()}if(re(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#p(t){if(!this.#l||t.touches.length!==2)return;re(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:a,screenY:o}=i,{screenX:l,screenY:u}=s,d=this.#l,{touch0X:f,touch0Y:g,touch1X:y,touch1Y:b}=d,A=y-f,w=b-g,x=l-a,E=u-o,S=Math.hypot(x,E)||1,M=Math.hypot(A,w)||1;if(!this.#e&&Math.abs(M-S)<=Ml.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=o,d.touch1X=l,d.touch1Y=u,!this.#e){this.#e=!0;return}const _=[(a+l)/2,(o+u)/2];this.#r?.(_,M,S)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(re(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class ft{#t=null;#e=null;#n=null;#i=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#p="";#g=!1;#u=null;#m=!1;#y=!1;#v=!1;#b=null;#C=0;#S=0;#x=null;#_=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#E=ft._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ih;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ft.prototype._resizeWithKeyboard,i=Gn.TRANSLATE_SMALL,s=Gn.TRANSLATE_BIG;return xt(this,"_resizerKeyboardManager",new kr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],ft.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[o,l];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return xt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new WA({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(ft._l10n??=t,ft._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ft._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ft._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){It("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#F(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,a){const[o,l]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/o,this.y=(i+a)/l,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,a]=this.parentDimensions;this.setAt(t*s,i*a,this.width*s,this.height*a),this._onTranslated()}#R([t,i],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#R(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,o]}=this;if(this.x+=t/a,this.y+=i/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[d,f]=this.getBaseTranslation();l+=d,u+=f;const{style:g}=s;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=ft,a=s/t,o=s/i;switch(this.rotation){case 90:return[-a,o];case 180:return[a,o];case 270:return[a,-o];default:return[-a,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,a]}=this;let{x:o,y:l,width:u,height:d}=this;if(u*=s,d*=a,o*=s,l*=a,this._mustFixPosition)switch(t){case 0:o=De(o,0,s-u),l=De(l,0,a-d);break;case 90:o=De(o,0,s-d),l=De(l,u,a);break;case 180:o=De(o,u,s),l=De(l,d,a);break;case 270:o=De(o,d,s),l=De(l,0,a-u);break}this.x=o/=s,this.y=l/=a;const[f,g]=this.getBaseTranslation();o+=f,l+=g,i.left=`${(100*o).toFixed(2)}%`,i.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return ft.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return ft.#M(t,i,360-this.parentRotation)}#D(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#k.bind(this,s),{signal:i}),a.addEventListener("contextmenu",Ei,{signal:i}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,i){i.preventDefault();const{isMac:s}=be.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",re,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ei,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#j()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#L(t,i,s,a){this.width=s,this.height=a,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#j(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,d=this.height;o===t&&l===i&&u===s&&d===a||this.addCommands({cmd:this.#L.bind(this,o,l,u,d),undo:this.#L.bind(this,t,i,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,a]=this.parentDimensions,o=this.x,l=this.y,u=this.width,d=this.height,f=ft.MIN_SIZE/s,g=ft.MIN_SIZE/a,y=this.#D(this.rotation),b=(B,G)=>[y[0]*B+y[2]*G,y[1]*B+y[3]*G],A=this.#D(360-this.rotation),w=(B,G)=>[A[0]*B+A[2]*G,A[1]*B+A[3]*G];let x,E,S=!1,M=!1;switch(t){case"topLeft":S=!0,x=(B,G)=>[0,0],E=(B,G)=>[B,G];break;case"topMiddle":x=(B,G)=>[B/2,0],E=(B,G)=>[B/2,G];break;case"topRight":S=!0,x=(B,G)=>[B,0],E=(B,G)=>[0,G];break;case"middleRight":M=!0,x=(B,G)=>[B,G/2],E=(B,G)=>[0,G/2];break;case"bottomRight":S=!0,x=(B,G)=>[B,G],E=(B,G)=>[0,0];break;case"bottomMiddle":x=(B,G)=>[B/2,G],E=(B,G)=>[B/2,0];break;case"bottomLeft":S=!0,x=(B,G)=>[0,G],E=(B,G)=>[B,0];break;case"middleLeft":M=!0,x=(B,G)=>[0,G/2],E=(B,G)=>[B,G/2];break}const _=x(u,d),R=E(u,d);let O=b(...R);const k=ft._round(o+O[0]),F=ft._round(l+O[1]);let j=1,X=1,K,Q;if(i.fromKeyboard)({deltaX:K,deltaY:Q}=i);else{const{screenX:B,screenY:G}=i,[Z,bt]=this.#l;[K,Q]=this.screenToPageTranslation(B-Z,G-bt),this.#l[0]=B,this.#l[1]=G}if([K,Q]=w(K/s,Q/a),S){const B=Math.hypot(u,d);j=X=Math.max(Math.min(Math.hypot(R[0]-_[0]-K,R[1]-_[1]-Q)/B,1/u,1/d),f/u,g/d)}else M?j=De(Math.abs(R[0]-_[0]-K),f,1)/u:X=De(Math.abs(R[1]-_[1]-Q),g,1)/d;const et=ft._round(u*j),ot=ft._round(d*X);O=b(...E(et,ot));const J=k-O[0],mt=F-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=et,this.height=ot,this.x=J,this.y=mt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Sr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ii.initialize(ft._l10n),this.#n=new Ii(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new tl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){if(!this.#i)return null;const{data:{richText:t,text:i,date:s,deleted:a}}=this.#i;return{text:i,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new tl(this),typeof t=="object"&&t!==null?this.#i.restoreData(t):this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new tl(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new tl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,u=l+o+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#I();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[a,o]=this.getInitialTranslation();return this.translate(a,o),h0(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#_||=new Ml({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let o=.7*(s/i)+1-.7;if(o===1)return;const l=this.#D(this.rotation),u=(k,F)=>[l[0]*k+l[2]*F,l[1]*k+l[3]*F],[d,f]=this.parentDimensions,g=this.x,y=this.y,b=this.width,A=this.height,w=ft.MIN_SIZE/d,x=ft.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),w/b,x/A);const E=ft._round(b*o),S=ft._round(A*o);if(E===b&&S===A)return;this.#u||=[g,y,b,A];const M=u(b/2,A/2),_=ft._round(g+M[0]),R=ft._round(y+M[1]),O=u(E/2,S/2);this.x=_-O[0],this.y=R-O[1],this.width=E,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#j()}pointerdown(t){const{isMac:i}=be.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#P(t);return}this.#O(t)}#O(t){const{isMac:i}=be.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,o=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:o},u=f=>{a.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#O(f),s&&this._onStopDragging()};i&&(this.#C=t.clientX,this.#S=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:y,pointerId:b}=f;if(b!==this.#s){re(f);return}const[A,w]=this.screenToPageTranslation(g-this.#C,y-this.#S);this.#C=g,this.#S=y,this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",re,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#_||f.isPrimary)&&u(f),re(f)},l));const d=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}re(f)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const a=this.parentScale,[o,l]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,g=i/a,y=this.x*o,b=this.y*l,A=this.width*o,w=this.height*l;switch(s){case 0:return[y+f+u,l-b-g-w+d,y+f+A+u,l-b-g+d];case 90:return[y+g+u,l-b+f+d,y+g+w+u,l-b+f+A+d];case 180:return[y-f-A+u,l-b+g+d,y-f+u,l-b+g+w+d];case 270:return[y-g-w+u,l-b-f-A+d,y-g+u,l-b-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,a,o,l]=t,u=o-s,d=l-a;switch(this.rotation){case 0:return[s,i-l,u,d];case 90:return[s,i-a,d,u];case 180:return[o,i-a,u,d];case 270:return[o,i-l,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ft._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:a,deleted:o,richText:l},uid:u,pageIndex:d,creationDate:f,modificationDate:g}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:s||g,popupRef:!o,color:i,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return i<l&&a>0&&t<o&&s>0}#I(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#I()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const a=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[o,l]=a.pageDimensions,[u,d,f,g]=a.getRectInCurrentCoords(t.rect,l);return a.x=u/o,a.y=d/l,a.width=f/o,a.height=g/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#F(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#_?.destroy(),this.#_=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,a,o,l]=this.getPDFRect();return[ft._round(s+(o-s)*t),ft._round(a+(l-a)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const l=this.#q.bind(this),u=this.#Y.bind(this),d=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#$.bind(this,g),{signal:d}),f.setAttribute("data-l10n-id",ft._l10nResizer[g])}}const s=this.#e[0];let a=0;for(const l of i){if(l===s)break;a++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==a){if(o<a)for(let u=0;u<a-o;u++)this.#c.append(this.#c.firstElementChild);else if(o>a)for(let u=0;u<o-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const u of i){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ft._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#q(t){ft._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#F()}#$(t){this.#p=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#p,{deltaX:t,deltaY:i,fromKeyboard:!0})}#F(){this.#v=!1,this.#H(-1),this.#j()}_stopResizingWithKeyboard(){this.#F(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#m}set isEditing(t){this.#m=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#x||=new Map;const{action:s}=t;let a=this.#x.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(s),this.#x.size===0&&(this.#x=null)},ft._telemetryTimeout),this.#x.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class WA extends ft{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Tp=3285377520,xi=4294901760,Pi=65535;class d0{constructor(t){this.h1=t?t&4294967295:Tp,this.h2=t?t&4294967295:Tp}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let x=0,E=t.length;x<E;x++){const S=t.charCodeAt(x);S<=255?i[s++]=S:(i[s++]=S>>>8,i[s++]=S&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,o=s-a*4,l=new Uint32Array(i.buffer,0,a);let u=0,d=0,f=this.h1,g=this.h2;const y=3432918353,b=461845907,A=y&Pi,w=b&Pi;for(let x=0;x<a;x++)x&1?(u=l[x],u=u*y&xi|u*A&Pi,u=u<<15|u>>>17,u=u*b&xi|u*w&Pi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=l[x],d=d*y&xi|d*A&Pi,d=d<<15|d>>>17,d=d*b&xi|d*w&Pi,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,o){case 3:u^=i[a*4+2]<<16;case 2:u^=i[a*4+1]<<8;case 1:u^=i[a*4],u=u*y&xi|u*A&Pi,u=u<<15|u>>>17,u=u*b&xi|u*w&Pi,a&1?f^=u:g^=u}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&xi|t*36045&Pi,i=i*4283543511&xi|((i<<16|t>>>16)*2950163797&xi)>>>16,t^=i>>>1,t=t*444984403&xi|t*60499&Pi,i=i*3301882366&xi|((i<<16|t>>>16)*3120437893&xi)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const Th=Object.freeze({map:null,hash:"",transfer:void 0});class Hh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof ft&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof ft)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let a=!1;if(s!==void 0)for(const[o,l]of Object.entries(i))s[o]!==l&&(a=!0,s[o]=l);else a=!0,this.#i.set(t,i);a&&this.#a(),i instanceof ft&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new f0(this)}get serializable(){if(this.#i.size===0)return Th;const t=new Map,i=new d0,s=[],a=Object.create(null);let o=!1;for(const[l,u]of this.#i){const d=u instanceof ft?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(l,d),i.update(`${l}:${JSON.stringify(d)}`),o||=!!d.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:Th}get editorStats(){let t=null;const i=new Map;let s=0,a=0;for(const o of this.#i.values()){if(!(o instanceof ft)){o.popup&&(o.popup.deleted?a+=1:s+=1);continue}o.isCommentDeleted?a+=1:o.hasEditedComment&&(s+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:u}=l;i.has(u)||i.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,g]of Object.entries(l)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const b=y.get(g)??0;y.set(g,b+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[o,l]of i)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class f0 extends Hh{#t;constructor(t){super();const{map:i,hash:s,transfer:a}=t.serializable,o=structuredClone(i,a?{transfer:a}:null);this.#t={map:o,hash:s,transfer:a}}get print(){It("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return xt(this,"modifiedIds",{ids:new Set,hash:""})}}class QA{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Ut(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:o,style:l}=t,u=new FontFace(a,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{At(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}It("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw At(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return xt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return xt(this,"isSyncFontLoadingSupported",Fe||be.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Ut(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:i,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(R,O){return R.charCodeAt(O)<<24|R.charCodeAt(O+1)<<16|R.charCodeAt(O+2)<<8|R.charCodeAt(O+3)&255}function a(R,O,k,F){const j=R.substring(0,O),X=R.substring(O+k);return j+F+X}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function g(R,O){if(++f>30){At("Load test font never loaded."),O();return}if(d.font="30px "+R,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,R,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=a(b,976,y.length,y);const w=16,x=1482184792;let E=s(b,w);for(o=0,l=y.length-3;o<l;o+=4)E=E-x+s(y,o)|0;o<y.length&&(E=E-x+s(y+"XXX",o)|0),b=a(b,w,4,kA(E));const S=`url(data:font/opentype;base64,${btoa(b)});`,M=`@font-face {font-family:"${y}";src:${S}}`;this.insertRule(M);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const R of[t.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=R,_.append(O)}this._document.body.append(_),g(y,()=>{_.remove(),i.complete()})}}class ZA{#t;constructor(t,i=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let a;try{a=t.get(s)}catch(l){At(`getPathGenerator - ignoring character: "${l}".`)}const o=u0(a?.path);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){xt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){xt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class ma{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let a=0;for(const f of ma.strings){const g=i.encode(t[f]);s[f]=g,a+=4+g.length}const o=new ArrayBuffer(a),l=new Uint8Array(o),u=new DataView(o);let d=0;for(const f of ma.strings){const g=s[f],y=g.length;u.setUint32(d,y),l.set(g,d+4),d+=4+y}return Ut(d===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Ut(t<ma.strings.length,"Invalid string index");let i=0;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ga{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let a=0;for(const b of ga.strings){const A=i.encode(t[b]);s[b]=A,a+=4+A.length}a+=4;let o,l,u=1+a;t.style&&(o=i.encode(t.style.style),l=i.encode(t.style.weight),u+=4+o.length+4+l.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let y=0;g.setUint8(y++,t.guessFallback?1:0),g.setUint32(y,0),y+=4,a=0;for(const b of ga.strings){const A=s[b],w=A.length;a+=4+w,g.setUint32(y,w),f.set(A,y+4),y+=4+w}return g.setUint32(y-a-4,a),t.style&&(g.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,g.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),Ut(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Ut(t<ga.strings.length,"Invalid string index");let i=5;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const a=this.#e.getUint32(t),o=this.#n.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:o}}}class $t{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#a=this.#i+1+6;#r;#s;#o;constructor({data:t,extra:i}){this.#r=t,this.#s=new TextDecoder,this.#o=new DataView(this.#r),i&&Object.assign(this,i)}#c(t){Ut(t<$t.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(i)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Ut(t<$t.numbers.length,"Invalid number index"),this.#o.getFloat64($t.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=$t.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=$t.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=$t.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Ut(t<$t.strings.length,"Invalid string index");let i=$t.#a+4;for(let o=0;o<t;o++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,i+4,s)),this.#s.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#r,t+4,o)}clearData(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const o=new Uint8Array(a);return o.set(new Uint8Array(this.#r,t+4,a)),new ma(o.buffer)}get systemFontInfo(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,t+4,s)),new ga(a.buffer)}static write(t){const i=t.systemFontInfo?ga.write(t.systemFontInfo):null,s=t.cssFontInfo?ma.write(t.cssFontInfo):null,a=new TextEncoder,o={};let l=0;for(const x of $t.strings)o[x]=a.encode(t[x]),l+=4+o[x].length;const u=$t.#a+4+l+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let y=0;const b=$t.bools.length;let A=0,w=0;for(let x=0;x<b;x++){const E=t[$t.bools[x]];A|=(E===void 0?0:E?2:1)<<w,w+=2,(w===8||x===b-1)&&(g.setUint8(y++,A),A=0,w=0)}Ut(y===$t.#t,"FontInfo.write: Boolean properties offset mismatch");for(const x of $t.numbers)g.setFloat64(y,t[x]),y+=8;if(Ut(y===$t.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(y++,4);for(const x of t.bbox)g.setInt16(y,x,!0),y+=2}else g.setUint8(y++,0),y+=8;if(Ut(y===$t.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(y++,6);for(const x of t.fontMatrix)g.setFloat64(y,x,!0),y+=8}else g.setUint8(y++,0),y+=48;if(Ut(y===$t.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(y++,1);for(const x of t.defaultVMetrics)g.setInt16(y,x,!0),y+=2}else g.setUint8(y++,0),y+=6;Ut(y===$t.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32($t.#a,0),y+=4;for(const x of $t.strings){const E=o[x],S=E.length;g.setUint32(y,S),f.set(E,y+4),y+=4+S}if(g.setUint32($t.#a,y-$t.#a-4),!i)g.setUint32(y,0),y+=4;else{const x=i.byteLength;g.setUint32(y,x),Ut(y+4+x<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+x}if(!s)g.setUint32(y,0),y+=4;else{const x=s.byteLength;g.setUint32(y,x),Ut(y+4+x<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+x}return t.data===void 0?(g.setUint32(y,0),y+=4):(g.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Ut(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class xe{static#t=0;static#e=1;static#n=2;static#i=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,a=[],o=[],l=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],l=t[3],i===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,d=t[1],a=t[2],o=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const g=Math.floor(a.length/2),y=Math.floor(o.length/3),b=l.length,A=u.length;let w=0;for(const O of u)w+=1,w=Math.ceil(w/4)*4,w+=4+O.coords.length*4,w+=4+O.colors.length*4,O.verticesPerRow!==void 0&&(w+=4);const x=20+g*8+y*3+b*8+(s?16:0)+(f?3:0)+w,E=new ArrayBuffer(x),S=new DataView(E),M=new Uint8Array(E);S.setUint8(xe.#t,i),S.setUint8(xe.#e,s?1:0),S.setUint8(xe.#n,f?1:0),S.setUint8(xe.#i,d),S.setUint32(xe.#a,g,!0),S.setUint32(xe.#r,y,!0),S.setUint32(xe.#s,b,!0),S.setUint32(xe.#o,A,!0);let _=20;new Float32Array(E,_,g*2).set(a),_+=g*8,M.set(o,_),_+=y*3;for(const[O,k]of l)S.setFloat32(_,O,!0),_+=4,S.setUint32(_,parseInt(k.slice(1),16),!0),_+=4;if(s)for(const O of s)S.setFloat32(_,O,!0),_+=4;f&&(M.set(f,_),_+=3);for(let O=0;O<u.length;O++){const k=u[O];S.setUint8(_,k.type),_+=1,_=Math.ceil(_/4)*4,S.setUint32(_,k.coords.length,!0),_+=4,new Int32Array(E,_,k.coords.length).set(k.coords),_+=k.coords.length*4,S.setUint32(_,k.colors.length,!0),_+=4,new Int32Array(E,_,k.colors.length).set(k.colors),_+=k.colors.length*4,k.verticesPerRow!==void 0&&(S.setUint32(_,k.verticesPerRow,!0),_+=4)}return E}getIR(){const t=this.view,i=this.data[xe.#t],s=!!this.data[xe.#e],a=!!this.data[xe.#n],o=t.getUint32(xe.#a,!0),l=t.getUint32(xe.#r,!0),u=t.getUint32(xe.#s,!0),d=t.getUint32(xe.#o,!0);let f=20;const g=new Float32Array(this.buffer,f,o*2);f+=o*8;const y=new Uint8Array(this.buffer,f,l*3);f+=l*3;const b=[];for(let E=0;E<u;++E){const S=t.getFloat32(f,!0);f+=4;const M=t.getUint32(f,!0);f+=4,b.push([S,`#${M.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let E=0;E<4;++E)A.push(t.getFloat32(f,!0)),f+=4}let w=null;a&&(w=new Uint8Array(this.buffer,f,3),f+=3);const x=[];for(let E=0;E<d;++E){const S=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const M=t.getUint32(f,!0);f+=4;const _=new Int32Array(this.buffer,f,M);f+=M*4;const R=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,R);f+=R*4;const k={type:S,coords:_,colors:O};S===xh.LATTICE&&(k.verticesPerRow=t.getUint32(f,!0),f+=4),x.push(k)}if(i===1)return["RadialAxial","axial",A,b,Array.from(g.slice(0,2)),Array.from(g.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,b,[g[0],g[1]],[g[3],g[4]],g[2],g[5]];if(i===3){const E=this.data[xe.#i];let S=null;if(g.length>0){let M=g[0],_=g[0],R=g[1],O=g[1];for(let k=0;k<g.length;k+=2){const F=g[k],j=g[k+1];M=M>F?F:M,R=R>j?j:R,_=_<F?F:_,O=O<j?j:O}S=[M,R,_,O]}return["Mesh",E,g,y,x,S,A,w]}throw new Error(`Unsupported pattern kind: ${i}`)}}class JA{static write(t){let i,s;return be.isFloat16ArraySupported?(s=new ArrayBuffer(t.length*2),i=new Float16Array(s)):(s=new ArrayBuffer(t.length*4),i=new Float32Array(s)),i.set(t),s}#t;constructor(t){this.#t=t}get path(){return be.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function t1(h){if(h instanceof URL)return h.href;if(typeof h=="string"){if(Fe)return h;const t=URL.parse(h,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function e1(h){if(Fe&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return Tl(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h?.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function el(h){if(typeof h!="string")return null;if(h.endsWith("/"))return h;throw new Error(`Invalid factory url: "${h}" must include trailing slash.`)}const _h=h=>typeof h=="object"&&Number.isInteger(h?.num)&&h.num>=0&&Number.isInteger(h?.gen)&&h.gen>=0,i1=h=>typeof h=="object"&&typeof h?.name=="string",n1=zA.bind(null,_h,i1);class s1{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,i,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){At("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,i);a=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(i,a)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const il={DATA:1,ERROR:2},me={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function _p(){}function $e(h){if(h instanceof Hn||h instanceof wh||h instanceof vp||h instanceof pl||h instanceof uh)return h;switch(h instanceof Error||typeof h=="object"&&h!==null||It('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new Hn(h.message);case"InvalidPDFException":return new wh(h.message);case"PasswordException":return new vp(h.message,h.code);case"ResponseException":return new pl(h.message,h.status,h.missing);case"UnknownErrorException":return new uh(h.message,h.details)}return new uh(h.message,h.toString())}class xr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===il.DATA)a.resolve(t.data);else if(t.callback===il.ERROR)a.reject($e(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,o=this.comObj;Promise.try(i,t.data).then(function(l){o.postMessage({sourceName:s,targetName:a,callback:il.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:a,callback:il.ERROR,callbackId:t.callbackId,reason:$e(l)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const a=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[a]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:i},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,i,s,a){const o=this.streamId++,l=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:i,desiredSize:f.desiredSize},a),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,d.postMessage({sourceName:l,targetName:u,stream:me.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Ut(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,d.postMessage({sourceName:l,targetName:u,stream:me.CANCEL,streamId:o,reason:$e(f)}),g.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],d={enqueue(f,g=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:a,stream:me.ENQUEUE,streamId:i,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:me.CLOSE,streamId:i}),delete l.streamSinks[i])},error(f){Ut(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:me.ERROR,streamId:i,reason:$e(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[i]=d,Promise.try(u,t.data,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:me.START_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:me.START_COMPLETE,streamId:i,reason:$e(f)})})}#i(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case me.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject($e(t.reason));break;case me.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject($e(t.reason));break;case me.PULL:if(!u){o.postMessage({sourceName:s,targetName:a,stream:me.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||_p).then(function(){o.postMessage({sourceName:s,targetName:a,stream:me.PULL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:me.PULL_COMPLETE,streamId:i,reason:$e(f)})});break;case me.ENQUEUE:if(Ut(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case me.CLOSE:if(Ut(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,i);break;case me.ERROR:Ut(l,"error should have stream controller"),l.controller.error($e(t.reason)),this.#a(l,i);break;case me.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject($e(t.reason)),this.#a(l,i);break;case me.CANCEL:if(!u)break;const d=$e(t.reason);Promise.try(u.onCancel||_p,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:me.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:me.CANCEL_COMPLETE,streamId:i,reason:$e(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#a(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class m0{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){It("Abstract method `_createCanvas` called.")}}class a1 extends m0{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class g0{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){It("Abstract method `_fetch` called.")}}class Mp extends g0{async _fetch(t){const i=await Dr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Tl(i)}}class p0{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,a,o){return"none"}destroy(t=!1){}}class r1 extends p0{#t;#e;#n;#i;#a;#r;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#a=i}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#n){const t=this.#a.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#a.createElementNS(cn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#a.createElementNS(cn,"defs"),t.append(s),s.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const g=f.join(",");return[g,g,g]}const[i,s,a]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let d=0;d<256;d++)o[d]=i[d]/255,l[d]=s[d]/255,u[d]=a[d]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#a.URL;i!==this.#a.baseURI&&(_l(i)?At('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=r0(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,a,o]=this.#d(t),l=t.length===1?s:`${s}${a}${o}`;if(i=this.#o.get(l),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(l,d);const f=this.#g(u);return this.#m(s,a,o,f),d}addHCMFilter(t,i){const s=`${t}-${i}`,a="base";let o=this.#c.get(a);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(a,o)),!t||!i))return o.url;const l=this.#v(t);t=nt.makeHexColor(...l);const u=this.#v(i);if(i=nt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const d=new Array(256);for(let A=0;A<=255;A++){const w=A/255;d[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=d.join(","),g=`g_${this.#i}_hcm_filter`,y=o.filter=this.#g(g);this.#m(f,f,f,y),this.#p(y);const b=(A,w)=>{const x=l[A]/255,E=u[A]/255,S=new Array(w+1);for(let M=0;M<=w;M++)S[M]=x+M/w*(E-x);return S.join(",")};return this.#m(b(0,5),b(1,5),b(2,5),y),o.url=this.#h(g),o.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),a=`alpha_${s}`;if(i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_alpha_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#y(s,u),l}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_luminosity_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#f(u),t&&this.#y(s,u),l}addHighlightHCMFilter(t,i,s,a,o){const l=`${i}-${s}-${a}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[d,f]=[i,s].map(this.#v.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[a,o].map(this.#v.bind(this));y<g&&([g,y,b,A]=[y,g,A,b]),this.#l.style.color="";const w=(S,M,_)=>{const R=new Array(256),O=(y-g)/_,k=S/255,F=(M-S)/(255*_);let j=0;for(let X=0;X<=_;X++){const K=Math.round(g+X*O),Q=k+X*F;for(let et=j;et<=K;et++)R[et]=Q;j=K+1}for(let X=j;X<256;X++)R[X]=R[j-1];return R.join(",")},x=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#g(x);return this.#p(E),this.#m(w(b[0],A[0],5),w(b[1],A[1],5),w(b[2],A[2],5),E),u.url=this.#h(x),u.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(t){const i=this.#a.createElementNS(cn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#p(t){const i=this.#a.createElementNS(cn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#a.createElementNS(cn,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const a=this.#a.createElementNS(cn,i);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#m(t,i,s,a){const o=this.#a.createElementNS(cn,"feComponentTransfer");a.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",i),this.#u(o,"feFuncB",s)}#y(t,i){const s=this.#a.createElementNS(cn,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,Nr(getComputedStyle(this.#l).getPropertyValue("color"))}}class y0{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){It("Abstract method `_fetch` called.")}}class Dp extends y0{async _fetch(t){const i=await Dr(t,"arraybuffer");return new Uint8Array(i)}}class b0{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){It("Abstract method `_fetch` called.")}}class Rp extends b0{async _fetch(t){const i=await Dr(t,"arraybuffer");return new Uint8Array(i)}}Fe&&At("Please use the `legacy` build in Node.js environments.");async function Gh(h){const i=await process.getBuiltinModule("fs").promises.readFile(h);return new Uint8Array(i)}class o1 extends p0{}class l1 extends m0{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class c1 extends g0{async _fetch(t){return Gh(t)}}class u1 extends y0{async _fetch(t){return Gh(t)}}class h1 extends b0{async _fetch(t){return Gh(t)}}const na="__forcedDependency",{floor:Np,ceil:kp}=Math;function nl(h,t,i,s,a,o){h[t*4+0]=Math.min(h[t*4+0],i),h[t*4+1]=Math.min(h[t*4+1],s),h[t*4+2]=Math.max(h[t*4+2],a),h[t*4+3]=Math.max(h[t*4+3],o)}const Mh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class d1{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Mh}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const sl=(h,t)=>{if(!h)return;let i=h.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},h.set(t,i)),i};class f1{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[na]:[]};#n=new Map;#i=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#p;#g;#u;#m;constructor(t,i,s=!1){this.#f=t.width,this.#p=t.height,this.#y(i),s&&(this.#m=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Mh,i.length)):this.#u.fill(Mh)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[na]:{__proto__:this.#e[na]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(sl(this.#m,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(sl(this.#m,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const i=this.#a.pop();return i!==void 0&&(sl(this.#m,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#r.push(nt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(na,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(na,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,a,o,l){const u=nt.multiplyByDOMMatrix(this.#r.at(-1),i.getTransform()),d=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([s,o,a,l],u,d);const f=nt.intersect(this.#s,d);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,a,o,l){const u=this.#s;if(u[0]===1/0)return this;const d=nt.multiplyByDOMMatrix(this.#r.at(-1),i.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([s,o,a,l],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([s,o,a,l],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,a=1,o=0,l=0,u){const d=s.bbox;let f,g;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(s),f!==!1&&(g=[0,0,0,0],nt.axialAlignedBoundingBox(d,s.fontMatrix,g),(a!==1||o!==0||l!==0)&&nt.scaleMinMax([a,0,0,-a,o,l],g),f)))return this.recordBBox(t,i,g[0],g[2],g[1],g[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&g&&f===void 0&&(f=g[0]<=o-y.actualBoundingBoxLeft&&g[2]>=o+y.actualBoundingBoxRight&&g[1]<=l-y.actualBoundingBoxAscent&&g[3]>=l+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,g[0],g[2],g[1],g[3]):this.recordBBox(t,i,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#p,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,a=this.#t,o=this.#e;for(const l of i)l in this.#t?s.add(a[l]):l in o&&o[l].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[na]),this.#m){const s=sl(this.#m,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#i.forEach(a.add,a),this.#a.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=Np(this.#o[0]*256/this.#f),a=Np(this.#o[1]*256/this.#p),o=kp(this.#o[2]*256/this.#f),l=kp(this.#o[3]*256/this.#p);nl(this.#g,t,s,a,o,l);for(const u of this.#l)u!==t&&nl(this.#g,u,s,a,o,l);for(const u of this.#i)u!==t&&nl(this.#g,u,s,a,o,l);for(const u of this.#a)u!==t&&nl(this.#g,u,s,a,o,l);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new d1(this.#u,this.#g)}takeDebugMetadata(){return this.#m}}class yl{#t;#e;#n;#i=0;#a=0;constructor(t,i,s){if(t instanceof yl&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,a,o,l){return this.#n||this.#t.recordClipBox(this.#e,i,s,a,o,l),this}recordBBox(t,i,s,a,o,l){return this.#n||this.#t.recordBBox(this.#e,i,s,a,o,l),this}recordCharacterBBox(t,i,s,a,o,l,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,a,o,l,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const wi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Re={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Dh(h,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],i,s),h.clip(a)}class Vh{isModifyingCurrentTransform(){return!1}getPattern(){It("Abstract method `getPattern` called.")}}class m1 extends Vh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,i=null){let s,a=this._p0,o=this._p1;if(i&&(a=a.slice(),o=o.slice(),nt.applyTransform(a,i),nt.applyTransform(o,i)),this._type==="axial")s=t.createLinearGradient(a[0],a[1],o[0],o[1]);else if(this._type==="radial"){let l=this._r0,u=this._r1;if(i){const d=new Float32Array(2);nt.singularValueDecompose2dScale(i,d),l*=d[0],u*=d[0]}s=t.createRadialGradient(a[0],a[1],l,o[0],o[1],u)}for(const l of this._colorStops)s.addColorStop(l[0],l[1]);return s}getPattern(t,i,s,a){let o;if(a===Re.STROKE||a===Re.FILL){if(this.isOriginBased()){let b=nt.transform(s,i.baseTransform);this.matrix&&(b=nt.transform(b,this.matrix));const A=.001,w=Math.hypot(b[0],b[1]),x=Math.hypot(b[2],b[3]),E=(b[0]*b[2]+b[1]*b[3])/(w*x);if(Math.abs(E)<A)if(this.isRadial()){if(Math.abs(w-x)<A)return this._createGradient(t,b)}else return this._createGradient(t,b)}const l=i.current.getClippedPathBoundingBox(a,ie(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,d),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),s=nt.transform(s,[1,0,0,1,l[0],l[1]]),g.transform(...i.baseTransform),this.matrix&&g.transform(...this.matrix),Dh(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);o.setTransform(y)}else Dh(t,this._bbox),o=this._createGradient(t);return o}}function fh(h,t,i,s,a,o,l,u){const d=t.coords,f=t.colors,g=h.data,y=h.width*4;let b;d[i+1]>d[s+1]&&(b=i,i=s,s=b,b=o,o=l,l=b),d[s+1]>d[a+1]&&(b=s,s=a,a=b,b=l,l=u,u=b),d[i+1]>d[s+1]&&(b=i,i=s,s=b,b=o,o=l,l=b);const A=(d[i]+t.offsetX)*t.scaleX,w=(d[i+1]+t.offsetY)*t.scaleY,x=(d[s]+t.offsetX)*t.scaleX,E=(d[s+1]+t.offsetY)*t.scaleY,S=(d[a]+t.offsetX)*t.scaleX,M=(d[a+1]+t.offsetY)*t.scaleY;if(w>=M)return;const _=f[o],R=f[o+1],O=f[o+2],k=f[l],F=f[l+1],j=f[l+2],X=f[u],K=f[u+1],Q=f[u+2],et=Math.round(w),ot=Math.round(M);let J,mt,B,G,Z,bt,vt,D;for(let H=et;H<=ot;H++){if(H<E){const ut=H<w?0:(w-H)/(w-E);J=A-(A-x)*ut,mt=_-(_-k)*ut,B=R-(R-F)*ut,G=O-(O-j)*ut}else{let ut;H>M?ut=1:E===M?ut=0:ut=(E-H)/(E-M),J=x-(x-S)*ut,mt=k-(k-X)*ut,B=F-(F-K)*ut,G=j-(j-Q)*ut}let W;H<w?W=0:H>M?W=1:W=(w-H)/(w-M),Z=A-(A-S)*W,bt=_-(_-X)*W,vt=R-(R-K)*W,D=O-(O-Q)*W;const it=Math.round(Math.min(J,Z)),ht=Math.round(Math.max(J,Z));let yt=y*H+it*4;for(let ut=it;ut<=ht;ut++)W=(J-ut)/(J-Z),W<0?W=0:W>1&&(W=1),g[yt++]=mt-(mt-bt)*W|0,g[yt++]=B-(B-vt)*W|0,g[yt++]=G-(G-D)*W|0,g[yt++]=255}}function g1(h,t,i){const s=t.coords,a=t.colors;let o,l;switch(t.type){case xh.LATTICE:const u=t.verticesPerRow,d=Math.floor(s.length/u)-1,f=u-1;for(o=0;o<d;o++){let g=o*u;for(let y=0;y<f;y++,g++)fh(h,i,s[g],s[g+1],s[g+u],a[g],a[g+1],a[g+u]),fh(h,i,s[g+u+1],s[g+1],s[g+u],a[g+u+1],a[g+1],a[g+u])}break;case xh.TRIANGLES:for(o=0,l=s.length;o<l;o+=3)fh(h,i,s[o],s[o+1],s[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class p1 extends Vh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),A=f/y,w=g/b,x={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/w},E=y+4,S=b+4,M=s.getCanvas("mesh",E,S),_=M.context,R=_.createImageData(y,b);if(i){const k=R.data;for(let F=0,j=k.length;F<j;F+=4)k[F]=i[0],k[F+1]=i[1],k[F+2]=i[2],k[F+3]=255}for(const k of this._figures)g1(R,k,x);return _.putImageData(R,2,2),{canvas:M.canvas,offsetX:u-2*A,offsetY:d-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,a){Dh(t,this._bbox);const o=new Float32Array(2);if(a===Re.SHADING)nt.singularValueDecompose2dScale(ie(t),o);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,o);const[u,d]=o;nt.singularValueDecompose2dScale(i.baseTransform,o),o[0]*=u,o[1]*=d}else nt.singularValueDecompose2dScale(i.baseTransform,o);const l=this._createMeshCanvas(o,a===Re.SHADING?null:this._background,i.cachedCanvases);return a!==Re.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class y1 extends Vh{getPattern(){return"hotpink"}}function b1(h){switch(h[0]){case"RadialAxial":return new m1(h);case"Mesh":return new p1(h);case"Dummy":return new y1}throw new Error(`Unknown IR type: ${h[0]}`)}const Op={COLORED:1,UNCOLORED:2};class Xh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,i){const{bbox:s,operatorList:a,paintType:o,tilingType:l,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),Cl("TilingType: "+l);const y=s[0],b=s[1],A=s[2],w=s[3],x=A-y,E=w-b,S=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,S);const[M,_]=S;nt.singularValueDecompose2dScale(this.baseTransform,S);const R=M*S[0],O=_*S[1];let k=x,F=E,j=!1,X=!1;const K=Math.ceil(f*R),Q=Math.ceil(g*O),et=Math.ceil(x*R),ot=Math.ceil(E*O);K>=et?k=f:j=!0,Q>=ot?F=g:X=!0;const J=this.getSizeAndScale(k,this.ctx.canvas.width,R),mt=this.getSizeAndScale(F,this.ctx.canvas.height,O),B=t.cachedCanvases.getCanvas("pattern",J.size,mt.size),G=B.context,Z=d.createCanvasGraphics(G,i);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,o,u),G.translate(-J.scale*y,-mt.scale*b),Z.transform(0,J.scale,0,0,mt.scale,0,0),G.save(),Z.dependencyTracker?.save(),this.clipBbox(Z,y,b,A,w),Z.baseTransform=ie(Z.ctx),Z.executeOperatorList(a),Z.endDrawing(),Z.dependencyTracker?.restore(),G.restore(),j||X){const bt=B.canvas;j&&(k=f),X&&(F=g);const vt=this.getSizeAndScale(k,this.ctx.canvas.width,R),D=this.getSizeAndScale(F,this.ctx.canvas.height,O),H=vt.size,W=D.size,it=t.cachedCanvases.getCanvas("pattern-workaround",H,W),ht=it.context,yt=j?Math.floor(x/f):0,ut=X?Math.floor(E/g):0;for(let Ht=0;Ht<=yt;Ht++)for(let Nt=0;Nt<=ut;Nt++)ht.drawImage(bt,H*Ht,W*Nt,H,W,0,0,H,W);return{canvas:it.canvas,scaleX:vt.scale,scaleY:D.scale,offsetX:y,offsetY:b}}return{canvas:B.canvas,scaleX:J.scale,scaleY:mt.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,i,s){const a=Math.max(Xh.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=a?o=a:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,a,o){const l=a-i,u=o-s;t.ctx.rect(i,s,l,u),nt.axialAlignedBoundingBox([i,s,a,o],ie(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const a=t.ctx,o=t.current;switch(i){case Op.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;a.fillStyle=o.fillColor=l,a.strokeStyle=o.strokeColor=u;break;case Op.UNCOLORED:a.fillStyle=a.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new RA(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,a,o){let l=s;a!==Re.SHADING&&(l=nt.transform(l,i.baseTransform),this.matrix&&(l=nt.transform(l,this.matrix)));const u=this.createPatternCanvas(i,o);let d=new DOMMatrix(l);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function v1({src:h,srcPos:t=0,dest:i,width:s,height:a,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=be.isLittleEndian?4278190080:255,[d,f]=l?[o,u]:[u,o],g=s>>3,y=s&7,b=h.length;i=new Uint32Array(i.buffer);let A=0;for(let w=0;w<a;w++){for(const E=t+g;t<E;t++){const S=t<b?h[t]:255;i[A++]=S&128?f:d,i[A++]=S&64?f:d,i[A++]=S&32?f:d,i[A++]=S&16?f:d,i[A++]=S&8?f:d,i[A++]=S&4?f:d,i[A++]=S&2?f:d,i[A++]=S&1?f:d}if(y===0)continue;const x=t<b?h[t++]:255;for(let E=0;E<y;E++)i[A++]=x&1<<7-E?f:d}return{srcPos:t,destPos:A}}const Lp=16,Bp=100,A1=15,Fp=10,Ke=16,mh=new DOMMatrix,ci=new Float32Array(2),ha=new Float32Array([1/0,1/0,-1/0,-1/0]);function x1(h,t){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){t.save(),this.__originalSave()},h.restore=function(){t.restore(),this.__originalRestore()},h.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},h.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},h.transform=function(i,s,a,o,l,u){t.transform(i,s,a,o,l,u),this.__originalTransform(i,s,a,o,l,u)},h.setTransform=function(i,s,a,o,l,u){t.setTransform(i,s,a,o,l,u),this.__originalSetTransform(i,s,a,o,l,u)},h.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},h.rotate=function(i){t.rotate(i),this.__originalRotate(i)},h.clip=function(i){t.clip(i),this.__originalClip(i)},h.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},h.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},h.bezierCurveTo=function(i,s,a,o,l,u){t.bezierCurveTo(i,s,a,o,l,u),this.__originalBezierCurveTo(i,s,a,o,l,u)},h.rect=function(i,s,a,o){t.rect(i,s,a,o),this.__originalRect(i,s,a,o)},h.closePath=function(){t.closePath(),this.__originalClosePath()},h.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class w1{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,i,s)):(a=this.canvasFactory.create(i,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function al(h,t,i,s,a,o,l,u,d,f){const[g,y,b,A,w,x]=ie(h);if(y===0&&b===0){const M=l*g+w,_=Math.round(M),R=u*A+x,O=Math.round(R),k=(l+d)*g+w,F=Math.abs(Math.round(k)-_)||1,j=(u+f)*A+x,X=Math.abs(Math.round(j)-O)||1;return h.setTransform(Math.sign(g),0,0,Math.sign(A),_,O),h.drawImage(t,i,s,a,o,0,0,F,X),h.setTransform(g,y,b,A,w,x),[F,X]}if(g===0&&A===0){const M=u*b+w,_=Math.round(M),R=l*y+x,O=Math.round(R),k=(u+f)*b+w,F=Math.abs(Math.round(k)-_)||1,j=(l+d)*y+x,X=Math.abs(Math.round(j)-O)||1;return h.setTransform(0,Math.sign(y),Math.sign(b),0,_,O),h.drawImage(t,i,s,a,o,0,0,X,F),h.setTransform(g,y,b,A,w,x),[X,F]}h.drawImage(t,i,s,a,o,l,u,d,f);const E=Math.hypot(g,y),S=Math.hypot(b,A);return[E*d,S*f]}class zp{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Ah;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=ye.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=ha.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Re.FILL,i=null){const s=this.minMax.slice();if(t===Re.STROKE){i||It("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(i,ci);const a=ci[0]*this.lineWidth/2,o=ci[1]*this.lineWidth/2;s[0]-=a,s[1]-=o,s[2]+=a,s[3]+=o}return s}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ha,0)}getClippedPathBoundingBox(t=Re.FILL,i=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function jp(h,t){if(t instanceof ImageData){h.putImageData(t,0,0);return}const i=t.height,s=t.width,a=i%Ke,o=(i-a)/Ke,l=a===0?o:o+1,u=h.createImageData(s,Ke);let d=0,f;const g=t.data,y=u.data;let b,A,w,x;if(t.kind===hl.GRAYSCALE_1BPP){const E=g.byteLength,S=new Uint32Array(y.buffer,0,y.byteLength>>2),M=S.length,_=s+7>>3,R=4294967295,O=be.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(w=b<o?Ke:a,f=0,A=0;A<w;A++){const k=E-d;let F=0;const j=k>_?s:k*8-7,X=j&-8;let K=0,Q=0;for(;F<X;F+=8)Q=g[d++],S[f++]=Q&128?R:O,S[f++]=Q&64?R:O,S[f++]=Q&32?R:O,S[f++]=Q&16?R:O,S[f++]=Q&8?R:O,S[f++]=Q&4?R:O,S[f++]=Q&2?R:O,S[f++]=Q&1?R:O;for(;F<j;F++)K===0&&(Q=g[d++],K=128),S[f++]=Q&K?R:O,K>>=1}for(;f<M;)S[f++]=0;h.putImageData(u,0,b*Ke)}}else if(t.kind===hl.RGBA_32BPP){for(A=0,x=s*Ke*4,b=0;b<o;b++)y.set(g.subarray(d,d+x)),d+=x,h.putImageData(u,0,A),A+=Ke;b<l&&(x=s*a*4,y.set(g.subarray(d,d+x)),h.putImageData(u,0,A))}else if(t.kind===hl.RGB_24BPP)for(w=Ke,x=s*w,b=0;b<l;b++){for(b>=o&&(w=a,x=s*w),f=0,A=x;A--;)y[f++]=g[d++],y[f++]=g[d++],y[f++]=g[d++],y[f++]=255;h.putImageData(u,0,b*Ke)}else throw new Error(`bad image kind: ${t.kind}`)}function Pp(h,t){if(t.bitmap){h.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,a=i%Ke,o=(i-a)/Ke,l=a===0?o:o+1,u=h.createImageData(s,Ke);let d=0;const f=t.data,g=u.data;for(let y=0;y<l;y++){const b=y<o?Ke:a;({srcPos:d}=v1({src:f,srcPos:d,dest:g,width:s,height:b,nonBlackColor:0})),h.putImageData(u,0,y*Ke)}}function pr(h,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)h[s]!==void 0&&(t[s]=h[s]);h.setLineDash!==void 0&&(t.setLineDash(h.getLineDash()),t.lineDashOffset=h.lineDashOffset)}function rl(h){h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0);const{filter:t}=h;t!=="none"&&t!==""&&(h.filter="none")}function Up(h,t){if(t)return!0;nt.singularValueDecompose2dScale(h,ci);const i=Math.fround(Hi.pixelRatio*va.PDF_TO_CSS_UNITS);return ci[0]<=i&&ci[1]<=i}const S1=["butt","round","square"],E1=["miter","round","bevel"],C1={},Ip={};class pa{constructor(t,i,s,a,o,{optionalContentConfig:l,markedContentStack:u=null},d,f,g){this.ctx=t,this.current=new zp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=a,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new w1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:a=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ie(this.compositeCtx))}this.ctx.save(),rl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=ie(this.ctx)}executeOperatorList(t,i,s,a,o){const l=t.argsArray,u=t.fnArray;let d=i||0;const f=l.length;if(f===d)return d;const g=f-d>Fp&&typeof s=="function",y=g?Date.now()+A1:0;let b=0;const A=this.commonObjs,w=this.objs;let x,E;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,s),d;if(!o||o(d))if(x=u[d],E=l[d]??null,x!==Cr.dependency)E===null?this[x](d):this[x](d,...E);else for(const S of E){this.dependencyTracker?.recordNamedData(S,d);const M=S.startsWith("g_")?A:w;if(!M.has(S))return M.get(S,s),d}if(d++,d===f)return d;if(g&&++b>Fp){if(Date.now()>y)return s(),d;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),l=Math.max(Math.hypot(i[2],i[3]),1),u=s,d=a,f="prescale1",g,y;for(;o>2&&u>1||l>2&&d>1;){let b=u,A=d;o>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/b),l>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/A),g=this.cachedCanvases.getCanvas(f,b,A),y=g.context,y.clearRect(0,0,b,A),y.drawImage(t,0,0,u,d,0,0,b,A),t=g.canvas,u=b,d=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,i){const s=this.ctx,{width:a,height:o}=i,l=this.current.fillColor,u=this.current.patternFill,d=ie(s);let f,g,y,b;if((i.bitmap||i.data)&&i.count>1){const K=i.bitmap||i.data.buffer;g=JSON.stringify(u?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get(K),f||(f=new Map,this._cachedBitmapsMap.set(K,f));const Q=f.get(g);if(Q&&!u){const et=Math.round(Math.min(d[0],d[2])+d[4]),ot=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,wi.transformAndFill),{canvas:Q,offsetX:et,offsetY:ot}}y=Q}y||(b=this.cachedCanvases.getCanvas("maskCanvas",a,o),Pp(b.context,i));let A=nt.transform(d,[1/a,0,0,-1/o,0,0]);A=nt.transform(A,[1,0,0,1,0,-o]);const w=ha.slice();nt.axialAlignedBoundingBox([0,0,a,o],A,w);const[x,E,S,M]=w,_=Math.round(S-x)||1,R=Math.round(M-E)||1,O=this.cachedCanvases.getCanvas("fillCanvas",_,R),k=O.context,F=x,j=E;k.translate(-F,-j),k.transform(...A),y||(y=this._scaleImage(b.canvas,ji(k)),y=y.img,f&&u&&f.set(g,y)),k.imageSmoothingEnabled=Up(ie(k),i.interpolate),al(k,y,0,0,y.width,y.height,0,0,a,o),k.globalCompositeOperation="source-in";const X=nt.transform(ji(k),[1,0,0,1,-F,-j]);return k.fillStyle=u?l.getPattern(s,this,X,Re.FILL,t):l,k.fillRect(0,0,a,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),this.dependencyTracker?.recordDependencies(t,wi.transformAndFill),{canvas:O.canvas,offsetX:Math.round(F),offsetY:Math.round(j)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=S1[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=E1[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,a]of i)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(a,i,s);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),pr(this.suspendedCtx,l),x1(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),pr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,a){const o=a[0],l=a[1],u=a[2]-o,d=a[3]-l;u===0||d===0||(this.genericComposeSMask(i.context,s,u,d,i.subtype,i.backdrop,i.transferMap,o,l,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,a,o,l,u,d,f,g,y){let b=t.canvas,A=d-g,w=f-y;if(l)if(A<0||w<0||A+s>b.width||w+a>b.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,a),S=E.context;S.drawImage(b,-A,-w),S.globalCompositeOperation="destination-atop",S.fillStyle=l,S.fillRect(0,0,s,a),S.globalCompositeOperation="source-over",b=E.canvas,A=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(A,w,s,a),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(A,w,s,a),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const x=new Path2D;x.rect(d,f,s,a),i.clip(x),i.globalCompositeOperation="destination-in",i.drawImage(b,A,w,s,a,d,f,s,a),i.restore()}save(t){this.inSMaskMode&&pr(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&pr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,a,o,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,a,o,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,a){let[o]=s;if(!a){o||=s[0]=new Path2D,this[i](t,o);return}if(this.dependencyTracker!==null){const l=i===Cr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-l,a[2]+l,a[1]-l,a[3]+l).recordDependencies(t,["transform"])}o instanceof Path2D||(o=s[0]=u0(o)),nt.axialAlignedBoundingBox(a,ie(this.ctx),this.current.minMax),this[i](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const a=this.ctx,o=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=o.getPattern(a,this,ji(a),Re.STROKE,t),l){const u=new Path2D;u.addPath(i,a.getTransform().invertSelf().multiplySelf(l)),i=u}this.rescaleAndStroke(i,!1),a.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,wi.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(Re.STROKE,ie(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const a=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const f=o.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=o.getPattern(a,this,ji(a),Re.FILL,t),f){const g=new Path2D;g.addPath(i,a.getTransform().invertSelf().multiplySelf(f)),i=g}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(i,"evenodd"),this.pendingEOFill=!1):a.fill(i)),this.dependencyTracker?.recordDependencies(t,wi.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,d)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,wi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=C1}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Ip}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;i!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(i!==void 0){const a=new Path2D,o=s.getTransform().invertSelf();for(const{transform:l,x:u,y:d,fontSize:f,path:g}of i)g&&a.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(u,d).scale(f,-f));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const a=this.commonObjs.get(i),o=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=a.fontMatrix||Ah,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&At("Invalid font matrix for font "+i),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${l}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let g=s;s<Lp?g=Lp:s>Bp&&(g=Bp),this.current.fontSizeScale=s/g,this.ctx.font=`${f} ${d} ${g}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),a}paintChar(t,i,s,a,o,l){const u=this.ctx,d=this.current,f=d.font,g=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,b=g&ye.FILL_STROKE_MASK,A=!!(g&ye.ADD_TO_PATH_FLAG),w=d.patternFill&&!f.missingFile,x=d.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||A||w||x)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,i)),E&&(f.disableFontFace||w||x)){u.save(),u.translate(s,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let S;if(b===ye.FILL||b===ye.FILL_STROKE)if(o){S=u.getTransform(),u.setTransform(...o);const M=this.#n(E,S,o);u.fill(M)}else u.fill(E);if(b===ye.STROKE||b===ye.FILL_STROKE)if(l){S||=u.getTransform(),u.setTransform(...l);const{a:M,b:_,c:R,d:O}=S,k=nt.inverseTransform(l),F=nt.transform([M,_,R,O,0,0],k);nt.singularValueDecompose2dScale(F,ci),u.lineWidth*=Math.max(ci[0],ci[1])/y,u.stroke(this.#n(E,S,l))}else u.lineWidth/=y,u.stroke(E);u.restore()}else(b===ye.FILL||b===ye.FILL_STROKE)&&(u.fillText(i,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(i))),(b===ye.STROKE||b===ye.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a,()=>u.measureText(i)).recordDependencies(t,wi.stroke),u.strokeText(i,s,a));A&&((this.pendingTextPaths||=[]).push({transform:ie(u),x:s,y:a,fontSize:y,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<i.length;a+=4)if(i[a]>0&&i[a]<255){s=!0;break}return xt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,wi.showText).resetBBox(t),this.current.textRenderingMode&ye.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=s.fontSizeScale,d=s.charSpacing,f=s.wordSpacing,g=s.fontDirection,y=s.textHScale*g,b=i.length,A=a.vertical,w=A?1:-1,x=a.defaultVMetrics,E=o*s.fontMatrix[0],S=s.textRenderingMode===ye.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),g>0?l.scale(y,-1):l.scale(y,1);let M,_;const R=s.textRenderingMode&ye.FILL_STROKE_MASK,O=R===ye.FILL||R===ye.FILL_STROKE,k=R===ye.STROKE||R===ye.FILL_STROKE;if(O&&s.patternFill){l.save();const Q=s.fillColor.getPattern(l,this,ji(l),Re.FILL,t);M=ie(l),l.restore(),l.fillStyle=Q}if(k&&s.patternStroke){l.save();const Q=s.strokeColor.getPattern(l,this,ji(l),Re.STROKE,t);_=ie(l),l.restore(),l.strokeStyle=Q}let F=s.lineWidth;const j=s.textMatrixScale;if(j===0||F===0?k&&(F=this.getSinglePixelWidth()):F/=j,u!==1&&(l.scale(u,u),F/=u),l.lineWidth=F,a.isInvalidPDFjsFont){const Q=[];let et=0;for(const J of i)Q.push(J.unicode),et+=J.width;const ot=Q.join("");if(l.fillText(ot,0,0),this.dependencyTracker!==null){const J=l.measureText(ot);this.dependencyTracker.recordBBox(t,this.ctx,-J.actualBoundingBoxLeft,J.actualBoundingBoxRight,-J.actualBoundingBoxAscent,J.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=et*E*y,l.restore(),this.compose();return}let X=0,K;for(K=0;K<b;++K){const Q=i[K];if(typeof Q=="number"){X+=w*Q*o/1e3;continue}let et=!1;const ot=(Q.isSpace?f:0)+d,J=Q.fontChar,mt=Q.accent;let B,G,Z=Q.width;if(A){const D=Q.vmetric||x,H=-(Q.vmetric?D[1]:Z*.5)*E,W=D[2]*E;Z=D?-D[0]:Z,B=H/u,G=(X+W)/u}else B=X/u,G=0;let bt;if(a.remeasure&&Z>0){bt=l.measureText(J);const D=bt.width*1e3/o*u;if(Z<D&&this.isFontSubpixelAAEnabled){const H=Z/D;et=!0,l.save(),l.scale(H,1),B/=H}else Z!==D&&(B+=(Z-D)/2e3*o/u)}if(this.contentVisible&&(Q.isInFont||a.missingFile)){if(S&&!mt)l.fillText(J,B,G),this.dependencyTracker?.recordCharacterBBox(t,l,bt?{bbox:null}:a,o/u,B,G,()=>bt??l.measureText(J));else if(this.paintChar(t,J,B,G,M,_),mt){const D=B+o*mt.offset.x/u,H=G-o*mt.offset.y/u;this.paintChar(t,mt.fontChar,D,H,M,_)}}const vt=A?Z*E-ot*g:Z*E+ot*g;X+=vt,et&&l.restore()}A?s.y-=X:s.x+=X*y,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,a=this.current,o=a.font,l=a.fontSize,u=a.fontDirection,d=o.vertical?1:-1,f=a.charSpacing,g=a.wordSpacing,y=a.textHScale*u,b=a.fontMatrix||Ah,A=i.length,w=a.textRenderingMode===ye.INVISIBLE;let x,E,S,M;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(y,u);const _=this.dependencyTracker;for(this.dependencyTracker=_?new yl(_,t):null,x=0;x<A;++x){if(E=i[x],typeof E=="number"){M=d*E*l/1e3,this.ctx.translate(M,0),a.x+=M*y;continue}const R=(E.isSpace?g:0)+f,O=o.charProcOperatorList[E.operatorListId];O?this.contentVisible&&(this.save(),s.scale(l,l),s.transform(...b),this.executeOperatorList(O),this.restore()):At(`Type3 character "${E.operatorListId}" is not available.`);const k=[E.width,0];nt.applyTransform(k,b),S=k[0]*l+R,s.translate(S,0),a.x+=S*y}s.restore(),_&&(this.dependencyTracker=_)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,a,o,l,u){const d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,l,o,u).recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const a=this.baseTransform||ie(this.ctx),o={createCanvasGraphics:(l,u)=>new pa(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new yl(this.dependencyTracker,u,!0):null)};s=new Xh(i,this.ctx,o,a)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=b1(this.getObject(t,i)),this.cachedPatterns.set(i,a)),s&&(a.matrix=s),a}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,i);s.fillStyle=a.getPattern(s,this,ji(s),Re.SHADING,t);const o=ji(s);if(o){const{width:l,height:u}=s.canvas,d=ha.slice();nt.axialAlignedBoundingBox([0,0,l,u],o,d);const[f,g,y,b]=d;this.ctx.fillRect(f,g,y-f,b-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,wi.transform).recordDependencies(t,wi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){It("Should not call beginInlineImage")}beginImageData(){It("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=ie(this.ctx),s)){nt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,o,l,u]=s,d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||Cl("TODO: Support non-isolated groups."),i.knockout&&At("Knockout groups not supported.");const a=ie(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=ha.slice();nt.axialAlignedBoundingBox(i.bbox,ie(s),o);const l=[0,0,s.canvas.width,s.canvas.height];o=nt.intersect(o,l)||[0,0,0,0];const u=Math.floor(o[0]),d=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),g=Math.max(Math.ceil(o[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,g]);let y="groupAt"+this.groupLevel;i.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,g),A=b.context;A.translate(-u,-d),A.transform(...a);let w=new Path2D;const[x,E,S,M]=i.bbox;if(w.rect(x,E,S-x,M-E),i.matrix){const _=new Path2D;_.addPath(w,new DOMMatrix(i.matrix)),w=_}A.clip(w),i.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:u,offsetY:d,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),pr(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=ie(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=ha.slice();nt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,i,s,a,o,l){if(this.#t(),rl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,nt.singularValueDecompose2dScale(ie(this.ctx),ci);const{viewportScale:f}=this,g=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(ci[0],0,0,-ci[1],0,d*ci[1]),rl(this.ctx)}else{rl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,d),this.ctx.clip(f)}}this.current=new zp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const a=this.ctx,o=this._createMaskCanvas(t,i),l=o.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,a=0,o=0,l,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const d=this.ctx;d.save();const f=ie(d);d.transform(s,a,o,l,0,0);const g=this._createMaskCanvas(t,i);d.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const A=nt.transform(f,[s,a,o,l,u[y],u[y+1]]);d.drawImage(g.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+g.canvas.width,A[5],A[5]+g.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,wi.transformAndFill);for(const l of i){const{data:u,width:d,height:f,transform:g}=l,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),b=y.context;b.save();const A=this.getObject(t,u,l);Pp(b,A),b.globalCompositeOperation="source-in",b.fillStyle=o?a.getPattern(b,this,ji(s),Re.FILL,t):a,b.fillRect(0,0,d,f),b.restore(),s.save(),s.transform(...g),s.scale(1,-1),al(s,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){At("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,a,o){if(!this.contentVisible)return;const l=this.getObject(t,i);if(!l){At("Dependent image isn't ready yet");return}const u=l.width,d=l.height,f=[];for(let g=0,y=o.length;g<y;g+=2)f.push({transform:[s,0,0,a,o[g],o[g+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:a}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,a),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(i,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,a=i.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/s,-1/a);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const g=this.cachedCanvases.getCanvas("inlineImage",s,a).context;jp(g,i),u=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(u,ji(o));o.imageSmoothingEnabled=Up(ie(o),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-a,0).recordDependencies(t,wi.imageXObject).recordOperation(t),al(o,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const a=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const l=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",l,u).context;jp(f,i),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),al(a,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,wi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(a||(this.pendingClip===Ip?o.clip(i,"evenodd"):o.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ie(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:a,d:o}=this.ctx.getTransform();let l,u;if(s===0&&a===0){const d=Math.abs(i),f=Math.abs(o);if(d===f)if(t===0)l=u=1/d;else{const g=d*t;l=u=g<1?1/g:1}else if(t===0)l=1/d,u=1/f;else{const g=d*t,y=f*t;l=g<1?1/g:1,u=y<1?1/y:1}}else{const d=Math.abs(i*o-s*a),f=Math.hypot(i,s),g=Math.hypot(a,o);if(t===0)l=g/d,u=f/d;else{const y=t*d;l=g>y?g/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:a}}=this,[o,l]=this.getScaleForStroking();if(o===l){s.lineWidth=(a||1)*o,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(o,l),mh.a=1/o,mh.d=1/l;const d=new Path2D;if(d.addPath(t,mh),u.length>0){const f=Math.max(o,l);s.setLineDash(u.map(g=>g/f)),s.lineDashOffset/=f}s.lineWidth=a||1,s.stroke(d),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const h in Cr)pa.prototype[h]!==void 0&&(pa.prototype[Cr[h]]=pa.prototype[h]);class ya{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class T1{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const la=Symbol("INTERNAL");class _1{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:a,rbGroups:o}){this.#t=!!(t&oi.DISPLAY),this.#e=!!(t&oi.PRINT),this.name=i,this.intent=s,this.usage=a,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==la&&It("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class M1{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=oi.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new _1(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(la,!1);for(const s of t.on)this.#e.get(s)._setVisible(la,!0);for(const s of t.off)this.#e.get(s)._setVisible(la,!1);this.#n=this.getHash()}}#a(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let a=1;a<i;a++){const o=t[a];let l;if(Array.isArray(o))l=this.#a(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return At(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Cl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(At(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return At(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return At(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return At(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return At(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return At(`Unknown optional content policy ${t.policy}.`),!0}return At(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const a=this.#e.get(t);if(!a){At(`Optional content group not found: ${t}`);return}if(s&&i&&a.rbGroups.length)for(const o of a.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(la,!1,!0);a._setVisible(la,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const o=this.#e.get(a);if(o)switch(s){case"ON":this.setVisibility(a,!0,i);break;case"OFF":this.setVisibility(a,!1,i);break;case"Toggle":this.setVisibility(a,!o.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new d0;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Dl{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,i,s){this._source=t,this.#t=i,this.#e=s}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Ut(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new this.#e(this,t,i);return this._rangeReaders.add(s),s}cancelAllRequests(t){this._fullReader?.cancel(t);for(const i of new Set(this._rangeReaders))i.cancel(t)}}class Rl{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){It("Abstract method `read` called")}cancel(t){It("Abstract method `cancel` called")}}class Nl{_stream=null;constructor(t,i,s){this._stream=t}async read(){It("Abstract method `read` called")}cancel(t){It("Abstract method `cancel` called")}}function Hp(h){return h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength?h.buffer:new Uint8Array(h).buffer}class D1 extends Dl{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,R1,N1);const{pdfDataRangeTransport:i}=t,{initialData:s,progressiveDone:a}=i;if(s?.length>0){const o=Hp(s);this._queuedChunks.push(o)}this._progressiveDone=a,i.addRangeListener((o,l)=>{this.#t(o,l)}),i.addProgressListener((o,l)=>{l!==void 0&&this._fullReader?.onProgress?.({loaded:o,total:l})}),i.addProgressiveReadListener(o=>{this.#t(void 0,o)}),i.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),i.transportReady()}#t(t,i){const s=Hp(i);if(t===void 0)this._fullReader?this._fullReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.keys().find(o=>o._begin===t);Ut(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(s)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onDone=()=>this._rangeReaders.delete(s),this._source.pdfDataRangeTransport.requestDataRange(t,i)),s}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class R1 extends Rl{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:i,disableRange:s,disableStream:a}=t._source,{length:o,contentDispositionFilename:l}=i;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=o,this._isStreamingSupported=!a,this._isRangeSupported=!s,Ph(l)&&(this._filename=l),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class N1 extends Nl{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,i,s){super(t,i,s),this._begin=i}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function k1(h){let t=!0,i=s("filename\\*","i").exec(h);if(i){i=i[1];let g=u(i);return g=unescape(g),g=d(g),g=f(g),o(g)}if(i=l(h),i){const g=f(i);return o(g)}if(i=s("filename","i").exec(h),i){i=i[1];let g=u(i);return g=f(g),o(g)}function s(g,y){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(g,y){if(g){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(g,{fatal:!0}),A=Tl(y);y=b.decode(A),t=!1}catch{}}return y}function o(g){return t&&/[\x80-\xff]/.test(g)&&(g=a("utf-8",g),t&&(g=a("iso-8859-1",g))),g}function l(g){const y=[];let b;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(g))!==null;){let[,x,E,S]=b;if(x=parseInt(x,10),x in y){if(x===0)break;continue}y[x]=[E,S]}const w=[];for(let x=0;x<y.length&&x in y;++x){let[E,S]=y[x];S=u(S),E&&(S=unescape(S),x===0&&(S=d(S))),w.push(S)}return w.join("")}function u(g){if(g.startsWith('"')){const y=g.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}g=y.join('"')}return g}function d(g){const y=g.indexOf("'");if(y===-1)return g;const b=g.slice(0,y),w=g.slice(y+1).replace(/^[^']*'/,"");return a(b,w)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,E){return String.fromCharCode(parseInt(E,16))}),a(b,w);try{w=atob(w)}catch{}return a(b,w)})}return""}function v0(h,t){const i=new Headers;if(!h||!t||typeof t!="object")return i;for(const s in t){const a=t[s];a!==void 0&&i.append(s,a)}return i}function kl(h){return URL.parse(h)?.origin??null}function A0({responseHeaders:h,isHttp:t,rangeChunkSize:i,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(h.get("Content-Length"),10);return!Number.isInteger(o)||(a.suggestedLength=o,o<=2*i)||s||!t||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function x0(h){const t=h.get("Content-Disposition");if(t){let i=k1(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(Ph(i))return i}return null}function Ol(h,t){return new pl(`Unexpected server response (${h}) while retrieving PDF "${t}".`,h,h===404||h===0&&t.startsWith("file:"))}function w0(h,t){if(h!==t)throw new Error(`Expected range response-origin "${h}" to match "${t}".`)}function S0(h,t,i,s){return fetch(h,{method:"GET",headers:t,signal:s.signal,mode:"cors",credentials:i?"include":"same-origin",redirect:"follow"})}function E0(h,t){if(h!==200&&h!==206)throw Ol(h,t)}function C0(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(At(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class O1 extends Dl{_responseOrigin=null;constructor(t){super(t,L1,B1),this.isHttp=/^https?:/i.test(t.url),this.headers=v0(this.isHttp,t.httpHeaders)}}class L1 extends Rl{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:i,disableStream:s,length:a,rangeChunkSize:o,url:l,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!i;const d=new Headers(t.headers);S0(l,d,u,this._abortController).then(f=>{t._responseOrigin=kl(f.url),E0(f.status,l),this._reader=f.body.getReader();const g=f.headers,{allowRangeRequests:y,suggestedLength:b}=A0({responseHeaders:g,isHttp:t.isHttp,rangeChunkSize:o,disableRange:i});this._isRangeSupported=y,this._contentLength=b||this._contentLength,this._filename=x0(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Hn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:C0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class B1 extends Nl{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,i,s){super(t,i,s);const{url:a,withCredentials:o}=t._source,l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`),S0(a,l,o,this._abortController).then(u=>{const d=kl(u.url);w0(d,t._responseOrigin),E0(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:C0(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const gh=200,Gp=206;function F1(h){return typeof h!="string"?h:Tl(h).buffer}class z1 extends Dl{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,j1,P1),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=v0(this.isHttp,t.httpHeaders)}_request(t){const i=new XMLHttpRequest,s={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(i,s),i.open("GET",this.url),i.withCredentials=this._source.withCredentials;for(const[a,o]of this.headers)i.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.validateStatus=a=>a===Gp||a===gh):s.validateStatus=a=>a===gh,i.responseType="arraybuffer",Ut(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>t.onError(i.status),i.onreadystatechange=this.#n.bind(this,i),i.onprogress=this.#e.bind(this,i),i.send(null),i}#e(t,i){this.#t.get(t)?.onProgress?.(i)}#n(t,i){const s=this.#t.get(t);if(!s||(t.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){s.onError(t.status);return}const a=t.status||gh;if(!s.validateStatus(a)){s.onError(t.status);return}const o=F1(t.response);if(a===Gp){const l=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(l)?s.onDone(o):(At('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone(o):s.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onClosed=()=>this._rangeReaders.delete(s)),s}}class j1 extends Rl{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:i}=t._source;this._contentLength=i,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#n.bind(this),onProgress:this.#i.bind(this)})}#t(){const t=this._stream,{disableRange:i,rangeChunkSize:s}=t._source,a=this._fullRequestXhr;t._responseOrigin=kl(a.responseURL);const o=a.getAllResponseHeaders(),l=new Headers(o?o.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[g,...y]=f.split(": ");return[g,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=A0({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:s,disableRange:i});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=x0(l),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}#n(t){this._storedError=Ol(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#i(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class P1 extends Nl{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,i,s){super(t,i,s),this._requestXhr=t._request({begin:i,end:s,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#n.bind(this),onProgress:null})}#t(){const t=kl(this._requestXhr?.responseURL);try{w0(t,this._stream._responseOrigin)}catch(i){this._storedError=i,this.#n(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#n(t){this._storedError??=Ol(t,this._stream.url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const U1=/^[a-z][a-z0-9\-+.]+:/i;function I1(h){if(U1.test(h))return new URL(h);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(h))}function T0(h){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(h):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(h)}function _0(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(At(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class H1 extends Dl{constructor(t){super(t,G1,V1),this.url=I1(t.url),Ut(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class G1 extends Rl{_reader=null;constructor(t){super(t);const{disableRange:i,disableStream:s,length:a,rangeChunkSize:o}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!i;const l=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(l).then(d=>{const f=u.createReadStream(l),g=T0(f);this._reader=g.getReader();const{size:y}=d;y<=2*o&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Hn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=Ol(0,l.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:_0(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class V1 extends Nl{_readCapability=Promise.withResolvers();_reader=null;constructor(t,i,s){super(t,i,s);const a=t.url,o=process.getBuiltinModule("fs");try{const l=o.createReadStream(a,{start:i,end:s-1}),u=T0(l);this._reader=u.getReader(),this._readCapability.resolve()}catch(l){this._readCapability.reject(l)}}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:_0(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const yr=Symbol("INITIAL_DATA");class M0{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:yr}}get(t,i=null){if(i){const a=this.#e(t);return a.promise.then(()=>i(a.data)),null}const s=this.#t[t];if(!s||s.data===yr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==yr}delete(t){const i=this.#t[t];return!i||i.data===yr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==yr&&(yield[t,i])}}}const X1=1e5,Vp=30;class li{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#p=[];#g=null;#u=[];#m=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#C=new WeakMap;static#S=null;static#x=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*Hi.pixelRatio,this.#d=s.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-l,u+o],this.#o=a,this.#s=o,li.#D(),i.style.setProperty("--min-font-size",li.#S),ds(i,s),this.#t.promise.finally(()=>{li.#x.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=be.platform;return xt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#a??=i.lang,Object.assign(this.#f,i.styles),this.#_(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),li.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Hi.pixelRatio,a=t.rotation;if(a!==this.#d&&(i?.(),this.#d=a,ds(this.#l,{rotation:a})),s!==this.#h){i?.(),this.#h=s;const o={div:null,properties:null,ctx:li.#R(this.#a)};for(const l of this.#u)o.properties=this.#m.get(l),o.div=l,this.#E(o)}}cancel(){const t=new Hn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#p}#_(t){if(this.#n)return;this.#r.ctx??=li.#R(this.#a);const i=this.#u,s=this.#p;for(const a of t){if(i.length>X1){At("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),o.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#A(a)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const a=nt.transform(this.#y,t.transform);let o=Math.atan2(a[1],a[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=li.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*li.#z(u,l,this.#a);let g,y;o===0?(g=a[4],y=a[5]-f):(g=a[4]+f*Math.sin(o),y=a[5]-f*Math.cos(o));const b=i.style;b.left=`${(100*g/this.#o).toFixed(2)}%`,b.top=`${(100*y/this.#s).toFixed(2)}%`,b.setProperty("--font-height",`${d.toFixed(2)}px`),b.fontFamily=u,s.fontSize=d,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),x=Math.abs(t.transform[3]);w!==x&&Math.max(w,x)/Math.min(w,x)>1.5&&(A=!0)}if(A&&(s.canvasWidth=l.vertical?t.height:t.width),this.#m.set(i,s),this.#r.div=i,this.#r.properties=s,this.#E(this.#r),s.hasText&&this.#e.append(i),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#E(t){const{div:i,properties:s,ctx:a}=t,{style:o}=i;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=o,{canvasWidth:u,fontSize:d}=s;li.#M(a,d*this.#h,l);const{width:f}=a.measureText(i.textContent);f>0&&o.setProperty("--scale-x",u*this.#h/f)}s.angle!==0&&o.setProperty("--rotate",`${s.angle}deg`)}static cleanup(){if(!(this.#x.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#R(t=null){let i=this.#b.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#C.set(i,{size:0,family:""})}return i}static#M(t,i,s){const a=this.#C.get(t);i===a.size&&s===a.family||(t.font=`${i}px ${s}`,a.size=i,a.family=s)}static#D(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#z(t,i,s){const a=this.#v.get(t);if(a)return a;const o=this.#R(s);o.canvas.width=o.canvas.height=Vp,this.#M(o,Vp,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return u?f=u/(u+d):(be.platform.isFirefox&&At("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const Y1=100;function D0(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const t=new Yh,{docId:i}=t,s=h.url?t1(h.url):null,a=h.data?e1(h.data):null,o=h.httpHeaders||null,l=h.withCredentials===!0,u=h.password??null,d=h.range instanceof R0?h.range:null,f=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:2**16;let g=h.worker instanceof _r?h.worker:null;const y=h.verbosity,b=typeof h.docBaseUrl=="string"&&!_l(h.docBaseUrl)?h.docBaseUrl:null,A=el(h.cMapUrl),w=h.cMapPacked!==!1,x=h.CMapReaderFactory||(Fe?c1:Mp),E=el(h.iccUrl),S=el(h.standardFontDataUrl),M=h.StandardFontDataFactory||(Fe?u1:Dp),_=el(h.wasmUrl),R=h.WasmFactory||(Fe?h1:Rp),O=h.stopAtErrors!==!0,k=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,F=h.isEvalSupported!==!1,j=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!Fe,X=typeof h.isImageDecoderSupported=="boolean"?h.isImageDecoderSupported:!Fe&&(be.platform.isFirefox||!globalThis.chrome),K=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,Q=typeof h.disableFontFace=="boolean"?h.disableFontFace:Fe,et=h.fontExtraProperties===!0,ot=h.enableXfa===!0,J=h.ownerDocument||globalThis.document,mt=h.disableRange===!0,B=h.disableStream===!0,G=h.disableAutoFetch===!0,Z=h.pdfBug===!0,bt=h.CanvasFactory||(Fe?l1:a1),vt=h.FilterFactory||(Fe?o1:r1),D=h.enableHWA===!0,H=h.useWasm!==!1,W=d?d.length:h.length??NaN,it=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!Fe&&!Q,ht=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:!!(x===Mp&&M===Dp&&R===Rp&&A&&S&&_&&Ar(A,document.baseURI)&&Ar(S,document.baseURI)&&Ar(_,document.baseURI)),yt=null;_A(y);const ut={canvasFactory:new bt({ownerDocument:J,enableHWA:D}),filterFactory:new vt({docId:i,ownerDocument:J}),cMapReaderFactory:ht?null:new x({baseUrl:A,isCompressed:w}),standardFontDataFactory:ht?null:new M({baseUrl:S}),wasmFactory:ht?null:new R({baseUrl:_})};g||(g=_r.create({verbosity:y,port:ya.workerPort}),t._worker=g);const Ht={docId:i,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:G,rangeChunkSize:f,length:W,docBaseUrl:b,enableXfa:ot,evaluatorOptions:{maxImageSize:k,disableFontFace:Q,ignoreErrors:O,isEvalSupported:F,isOffscreenCanvasSupported:j,isImageDecoderSupported:X,canvasMaxAreaInBytes:K,fontExtraProperties:et,useSystemFonts:it,useWasm:H,useWorkerFetch:ht,cMapUrl:A,iccUrl:E,standardFontDataUrl:S,wasmUrl:_}},Nt={ownerDocument:J,pdfBug:Z,styleElement:yt,enableHWA:D,loadingParams:{disableAutoFetch:G,enableXfa:ot}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ui=g.messageHandler.sendWithPromise("GetDocRequest",Ht,a?[a.buffer]:null);let gt;if(d)gt=new D1({pdfDataRangeTransport:d,disableRange:mt,disableStream:B});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const tt=Ar(s)?O1:Fe?H1:z1;gt=new tt({url:s,length:W,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:mt,disableStream:B})}return ui.then(tt=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const st=new xr(i,tt,g.port),Tt=new K1(st,t,gt,Nt,ut);t._transport=Tt,st.send("Ready",null)})}).catch(t._capability.reject),t}class Yh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Yh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class R0{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,i,s=!1,a=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#a)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){It("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class q1{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class $1{#t=!1;#e=jt.instance;constructor(t,i,s,a=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=a?new xp:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new M0,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}={}){return new Rr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:a="display",annotationMode:o=Pn.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){this._stats?.time("Overall");const x=this._transport.getRenderingIntent(a,o,y,b),{renderingIntent:E,cacheKey:S}=x;this.#t=!1,d||=this._transport.getOptionalContentConfig(E);let M=this._intentStates.get(S);M||(M=Object.create(null),this._intentStates.set(S,M)),M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null);const _=!!(E&oi.PRINT);M.displayReadyCapability||(M.displayReadyCapability=Promise.withResolvers(),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(x));const R=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(A||R),k=X=>{if(M.renderTasks.delete(F),O){const K=F.gfx?.dependencyTracker.take();K&&(F.stepper&&F.stepper.setOperatorBBoxes(K,F.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=K))}_&&(this.#t=!0),this.#n(),X?(F.capability.reject(X),this._abortOperatorList({intentState:M,reason:X instanceof Error?X:new Error(X)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},F=new da({callback:k,params:{canvas:i,canvasContext:t,dependencyTracker:O?new f1(i,M.operatorList.length,R):null,viewport:s,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:M.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:w});(M.renderTasks||=new Set).add(F);const j=F.task;return Promise.all([M.displayReadyCapability.promise,d]).then(([X,K])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(K.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:X,optionalContentConfig:K}),F.operatorListChanged()}).catch(k),j}getOperatorList({intent:t="display",annotationMode:i=Pn.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(t,i,s,a,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Tr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,a){function o(){l.read().then(function({value:d,done:f}){if(f){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),o()},a)}const l=i.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#n();return t&&i&&(this._stats&&=new xp),i}#n(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,a=t.length;s<a;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#n()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:a}){const{map:o,transfer:l}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:a},l).getReader(),f=this._intentStates.get(i);f.streamReader=d;const g=()=>{d.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),g())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#n()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};g()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof jh){let a=Y1;i.extraDelay>0&&i.extraDelay<1e3&&(a+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},a);return}}if(t.streamReader.cancel(new Hn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,o]of this._intentStates)if(o===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Un,Mi,hn,cs,Al,us,hs,je,dl,N0,k0,wr,ba,fl;const ee=class ee{constructor({name:t=null,port:i=null,verbosity:s=MA()}={}){Fi(this,je);Fi(this,Un,Promise.withResolvers());Fi(this,Mi,null);Fi(this,hn,null);Fi(this,cs,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(te(ee,hs).has(i))throw new Error("Cannot use more than one PDFWorker per port.");te(ee,hs).set(i,this),zi(this,je,N0).call(this,i)}else zi(this,je,k0).call(this)}get promise(){return te(this,Un).promise}get port(){return te(this,hn)}get messageHandler(){return te(this,Mi)}destroy(){this.destroyed=!0,te(this,cs)?.terminate(),qe(this,cs,null),te(ee,hs).delete(te(this,hn)),qe(this,hn,null),te(this,Mi)?.destroy(),qe(this,Mi,null)}static create(t){const i=te(this,hs).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new ee(t)}static get workerSrc(){if(ya.workerSrc)return ya.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return xt(this,"_setupFakeWorkerGlobal",(async()=>te(this,ba,fl)?te(this,ba,fl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Un=new WeakMap,Mi=new WeakMap,hn=new WeakMap,cs=new WeakMap,Al=new WeakMap,us=new WeakMap,hs=new WeakMap,je=new WeakSet,dl=function(){te(this,Un).resolve(),te(this,Mi).send("configure",{verbosity:this.verbosity})},N0=function(t){qe(this,hn,t),qe(this,Mi,new xr("main","worker",t)),te(this,Mi).on("ready",()=>{}),zi(this,je,dl).call(this)},k0=function(){if(te(ee,us)||te(ee,ba,fl)){zi(this,je,wr).call(this);return}let{workerSrc:t}=ee;try{ee._isSameOrigin(window.location,t)||(t=ee._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new xr("main","worker",i),a=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?te(this,Un).reject(new Error("Worker was destroyed")):zi(this,je,wr).call(this)},o=new AbortController;i.addEventListener("error",()=>{te(this,cs)||a()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){a();return}qe(this,Mi,s),qe(this,hn,i),qe(this,cs,i),zi(this,je,dl).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){a();return}try{l()}catch{zi(this,je,wr).call(this)}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{Cl("The worker has been disabled.")}zi(this,je,wr).call(this)},wr=function(){te(ee,us)||(At("Setting up fake worker."),qe(ee,us,!0)),ee._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){te(this,Un).reject(new Error("Worker was destroyed"));return}const i=new s1;qe(this,hn,i);const s=`fake${Jg(ee,Al)._++}`,a=new xr(s+"_worker",s,i);t.setup(a,i),qe(this,Mi,new xr(s,s+"_worker",i)),zi(this,je,dl).call(this)}).catch(t=>{te(this,Un).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},ba=new WeakSet,fl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Fi(ee,ba),Fi(ee,Al,0),Fi(ee,us,!1),Fi(ee,hs,new WeakMap),Fe&&(qe(ee,us,!0),ya.workerSrc||="./pdf.worker.mjs"),ee._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(i,s);return s.origin===a.origin},ee._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},ee.fromPort=t=>{if(UA("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return ee.create(t)};let _r=ee;class K1{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#n=null;#i=new Map;#a=new Map;#r=new Map;#s=null;#o=jt.instance;constructor(t,i,s,a,o){this.messageHandler=t,this.loadingTask=i,this.#n=s,this.commonObjs=new M0,this.fontLoader=new QA({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,i=new Map;for(let s=0,a=this.#o.pagesNumber;s<a;s++){const o=this.#o.getPrevPageNumber(s+1)-1,l=this.#i.get(o);l&&t.set(s,l);const u=this.#a.get(o);u&&i.set(s,u)}this.#i=t,this.#a=i}#l(t,i=null){const s=this.#e.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,i);return this.#e.set(t,a),a}#d({loaded:t,total:i}){this.loadingTask.onProgress?.({loaded:t,total:i,percent:De(Math.round(t/i*100),0,100)})}get annotationStorage(){return xt(this,"annotationStorage",new Hh)}getRenderingIntent(t,i=Pn.ENABLE,s=null,a=!1,o=!1){let l=oi.DISPLAY,u=Th;switch(t){case"any":l=oi.ANY;break;case"display":break;case"print":l=oi.PRINT;break;default:At(`getRenderingIntent - invalid intent: ${t}`)}const d=l&oi.PRINT&&s instanceof f0?s:this.annotationStorage;switch(i){case Pn.DISABLE:l+=oi.ANNOTATIONS_DISABLE;break;case Pn.ENABLE:break;case Pn.ENABLE_FORMS:l+=oi.ANNOTATIONS_FORMS;break;case Pn.ENABLE_STORAGE:l+=oi.ANNOTATIONS_STORAGE,u=d.serializable;break;default:At(`getRenderingIntent - invalid annotationMode: ${i}`)}a&&(l+=oi.IS_EDITING),o&&(l+=oi.OPLIST);const{ids:f,hash:g}=d.modifiedIds,y=[l,u.hash,g];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#i.values())t.push(s._destroy());this.#i.clear(),this.#a.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),li.cleanup(),this.#n?.cancelAllRequests(new Hn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,a)=>{Ut(this.#n,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#n.getFullReader(),this.#t.onProgress=o=>this.#d(o),a.onPull=()=>{this.#t.read().then(function({value:o,done:l}){if(l){a.close();return}Ut(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{a.error(o)})},a.onCancel=o=>{this.#t.cancel(o),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:o,contentLength:l}=this.#t;return a&&o&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,a)=>{Ut(this.#n,"GetRangeReader - no `BasePDFStream` instance available.");const o=this.#n.getRangeReader(s.begin,s.end);if(!o){a.close();return}a.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){a.close();return}Ut(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{o.cancel(l),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this.#o.pagesNumber=s.numPages,this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new q1(s,this))}),t.on("DocException",s=>{i._capability.reject($e(s))}),t.on("PasswordRequest",s=>{this.#s=Promise.withResolvers();try{if(!i.onPassword)throw $e(s);const a=o=>{o instanceof Error?this.#s.reject(o):this.#s.resolve({password:o})};i.onPassword(a,s.code)}catch(a){this.#s.reject(a)}return this.#s.promise}),t.on("DataLoaded",s=>{this.#d({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#i.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in o){const y=o.error;At(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const l=new $t(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,d=new ZA(l,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=o;Ut(f,"The imageRef must be defined.");for(const y of this.#i.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new JA(o));break;case"Image":this.commonObjs.resolve(s,o);break;case"Pattern":const g=new xe(o);this.commonObjs.resolve(s,g.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,o,l])=>{if(this.destroyed)return;const u=this.#i.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||this.#d(s)}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&At("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#o.getPageId(t)-1,a=this.#a.get(i);if(a)return a;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#r.set(l.refStr,s);const u=new $1(i,l,this,this._params.pdfBug);return this.#i.set(i,u),u});return this.#a.set(i,o),o}async getPageIndex(t){if(!_h(t))throw new Error("Invalid pageIndex request.");const i=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(i+1)-1}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:i})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(i=>new M1(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#e.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new T1(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#i.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),li.cleanup()}}cachedPageNumber(t){if(!_h(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,s=this.#r.get(i);return s>=0?this.#o.getPageNumber(s+1):null}}class W1{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this._internalRenderTask;return t.form||t.canvas&&i?.size>0}}class da{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:a,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new W1(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(da.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");da.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:o,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new pa(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),da.#e.delete(this._canvas),t||=new jh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),da.#e.delete(this._canvas),this.callback())))}}const Q1="5.4.624",Z1="384c6208b";class Si{#t=null;#e=null;#n;#i=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return xt(this,"_keyboardManager",new kr([[["Escape","mac+Escape"],Si.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Si.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Si.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Si.prototype._moveToPrevious],[["Home","mac+Home"],Si.prototype._moveToBeginning],[["End","mac+End"],Si.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#r=!1,this.#s=t):this.#r=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Si.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#p.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",Ei,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",a),o.title=s,o.setAttribute("data-l10n-id",Si.#d[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=a,o.ariaSelected=a===this.#n,o.addEventListener("click",this.#f.bind(this,a),{signal:i}),t.append(o)}return t.addEventListener("keydown",this.#p.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ot.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#m){this.#g(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#g(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#m){this.#g(t);return}this.#i.lastElementChild?.focus()}#p(t){Si._keyboardManager.exec(this,t)}#g(t){if(this.#m){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Mr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Mr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",Mr.#i[t]),a.addEventListener("input",()=>{this.#n.updateParams(i,a.value)},{signal:this.#n._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Xp(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function br(h){return Math.max(0,Math.min(255,255*h))}class Yp{static CMYK_G([t,i,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=br(t),[t,t,t]}static G_HTML([t]){const i=Xp(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(br)}static RGB_HTML(t){return`#${t.map(Xp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,i+a)]}static CMYK_rgb([t,i,s,a]){return[br(1-Math.min(1,t+a)),br(1-Math.min(1,s+a)),br(1-Math.min(1,i+a))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const a=1-t,o=1-i,l=1-s,u=Math.min(a,o,l);return["CMYK",a,o,l,u]}}class J1{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${i}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${i}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){It("Abstract method `_createSVG` called.")}}class bl extends J1{_createSVG(t){return document.createElementNS(cn,t)}}const tx=9,fs=new WeakSet,ex=new Date().getTimezoneOffset()*60*1e3;class ph{static create(t){switch(t.data.annotationType){case ge.LINK:return new qh(t);case ge.TEXT:return new nx(t);case ge.WIDGET:switch(t.data.fieldType){case"Tx":return new sx(t);case"Btn":return t.data.radioButton?new O0(t):t.data.checkBox?new rx(t):new ox(t);case"Ch":return new lx(t);case"Sig":return new ax(t)}return new gs(t);case ge.POPUP:return new Rh(t);case ge.FREETEXT:return new L0(t);case ge.LINE:return new ux(t);case ge.SQUARE:return new hx(t);case ge.CIRCLE:return new dx(t);case ge.POLYLINE:return new B0(t);case ge.CARET:return new mx(t);case ge.INK:return new $h(t);case ge.POLYGON:return new fx(t);case ge.HIGHLIGHT:return new F0(t);case ge.UNDERLINE:return new gx(t);case ge.SQUIGGLY:return new px(t);case ge.STRIKEOUT:return new yx(t);case ge.STAMP:return new z0(t);case ge.FILEATTACHMENT:return new bx(t);default:return new ne(t)}}}class ne{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ne._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:a}=this.data;let o=-1/0,l=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>l?(l=i[u+1],o=i[u+2]):i[u+1]===l&&(o=Math.max(o,i[u+2]));return[o,l]}if(s?.length>=1){for(const u of s)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>l?(l=u[d+1],o=u[d]):u[d+1]===l&&(o=Math.max(o,u[d]));if(o!==1/0)return[o,l]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-l)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Er}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${Er}${i.id}`,{id:i.id,annotationType:i.annotationType,page:this.parent.page,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let a=this.#n?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#n.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/o}%`,i.top=`${100*(l-t[3]+d)/l}%`,a===0?(i.width=`${100*(t[2]-t[0])/o}%`,i.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(a)}_createContainer(t){const{data:i,parent:{page:s,viewport:a}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),!(this instanceof gs)&&!(this instanceof qh)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof Rh){const{rotation:x}=i;return!i.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}const{width:u,height:d}=this;if(!t&&i.borderStyle.width>0){l.borderWidth=`${i.borderStyle.width}px`;const x=i.borderStyle.horizontalCornerRadius,E=i.borderStyle.verticalCornerRadius;if(x>0||E>0){const M=`calc(${x}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;l.borderRadius=M}else if(this instanceof O0){const M=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;l.borderRadius=M}switch(i.borderStyle.style){case oa.SOLID:l.borderStyle="solid";break;case oa.DASHED:l.borderStyle="dashed";break;case oa.BEVELED:At("Unimplemented border style: beveled");break;case oa.INSET:At("Unimplemented border style: inset");break;case oa.UNDERLINE:l.borderBottomStyle="solid";break}const S=i.borderColor||null;S?(this.#e=!0,l.borderColor=nt.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):l.borderWidth=0}const f=nt.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:g,pageHeight:y,pageX:b,pageY:A}=a.rawDims;l.left=`${100*(f[0]-b)/g}%`,l.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=i;return i.hasOwnCanvas||w===0?(l.width=`${100*u/g}%`,l.height=`${100*d/y}%`):this.setRotation(w,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),i.style.width=`${100*o/s}%`,i.style.height=`${100*l/a}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,a)=>{const o=a.detail[i],l=o[0],u=o.slice(1);a.target.style[s]=Yp[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:Yp[`${l}_rgb`](u)})};return xt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const a of Object.keys(i.detail))(t[a]||s[a])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[a,o]of Object.entries(i)){const l=s[a];if(l){const u={detail:{[a]:o},target:t};l(u),delete i[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,a,o]=this.data.rect.map(x=>Math.fround(x));if(t.length===8){const[x,E,S,M]=t.subarray(2,6);if(a===x&&o===E&&i===S&&s===M)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:x,borderWidth:E}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const d=a-i,f=o-s,{svgFactory:g}=this,y=g.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=g.createElement("defs");y.append(b);const A=g.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let x=2,E=t.length;x<E;x+=8){const S=t[x],M=t[x+1],_=t[x+2],R=t[x+3],O=g.createElement("rect"),k=(_-i)/d,F=(o-M)/f,j=(S-_)/d,X=(M-R)/f;O.setAttribute("x",k),O.setAttribute("y",F),O.setAttribute("width",j),O.setAttribute("height",X),A.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${F}" width="${j}" height="${X}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:i}=this;let s,a;t?(s={str:t.text},a=t.date):(s=i.contentsObj,a=i.modificationDate),this.#n=new Rh({data:{color:i.color,titleObj:i.titleObj,modificationDate:a,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){It("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:o,id:l,exportValues:u}of a){if(o===-1||l===i)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!fs.has(f)){At(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:d,domElement:f})}return s}for(const a of document.getElementsByName(t)){const{exportValue:o}=a,l=a.getAttribute("data-element-id");l!==i&&fs.has(a)&&s.push({id:l,exportValue:o,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class ix extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class qh extends ne{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",a=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,a),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(i.actions)){const o=s.get(a);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:a}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){At('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:o,include:l}=i,u=[];if(a.length!==0||o.length!==0){const g=new Set(o);for(const y of a){const b=this._fieldObjects[y]||[];for(const{id:A}of b)g.add(A)}for(const y of Object.values(this._fieldObjects))for(const b of y)g.has(b.id)===l&&u.push(b)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const d=this.annotationStorage,f=[];for(const g of u){const{id:y}=g;switch(f.push(y),g.type){case"text":{const A=g.defaultValue||"";d.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;d.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";d.setValue(y,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!fs.has(b)){At(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class nx extends ne{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class gs extends ne{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return be.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,a,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!i.focused||!l.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l)}})})}_setEventListeners(t,i,s,a){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,o,l,a),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":nt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||tx,o=t.style;let l;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(f/(ch*a))||1,y=f/g;l=Math.min(a,d(y/ch))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(a,d(f/ch))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=nt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class sx extends gs{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,a){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[i]=s),o.setValue(l.id,{[a]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(i,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),fs.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:y}=this.data,b=!!g&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",w=>{t.setValue(i,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",w=>{const x=this.data.defaultFieldValue??"";s.value=d.userValue=x,d.formattedValue=null});let A=w=>{const{formattedValue:x}=d;x!=null&&(w.target.value=x),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",x=>{if(d.focused)return;const{target:E}=x;if(b&&(E.type=g,y&&(E.step=y)),d.userValue){const S=d.userValue;if(b)if(g==="time"){const M=new Date(S),_=[M.getHours(),M.getMinutes(),M.getSeconds()];E.value=_.map(R=>R.toString().padStart(2,"0")).join(":")}else E.value=new Date(S-ex).toISOString().split(g==="date"?"T":".",1)[0];else E.value=S}d.lastCommittedValue=E.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const E={value(S){d.userValue=S.detail.value??"",b||t.setValue(i,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:M}=S.detail;d.formattedValue=M,M!=null&&S.target!==document.activeElement&&(S.target.value=M);const _={formattedValue:M};b&&(_.value=M),t.setValue(i,_)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{const{charLimit:M}=S.detail,{target:_}=S;if(M===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",M);let R=d.userValue;!R||R.length<=M||(R=R.slice(0,M),_.value=d.userValue=R,t.setValue(i,{value:R}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(E,x)}),s.addEventListener("keydown",x=>{d.commitKey=1;let E=-1;if(x.key==="Escape"?E=0:x.key==="Enter"&&!this.data.multiLine?E=2:x.key==="Tab"&&(d.commitKey=3),E===-1)return;const{value:S}=x.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:E,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const w=A;A=null,s.addEventListener("blur",x=>{if(!d.focused||!x.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:E}=x;let{value:S}=E;if(b){if(S&&g==="time"){const M=S.split(":").map(_=>parseInt(_,10));S=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),E.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();E.type="text"}d.userValue=S,d.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),w(x)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",x=>{d.lastCommittedValue=null;const{data:E,target:S}=x,{value:M,selectionStart:_,selectionEnd:R}=S;let O=_,k=R;switch(x.inputType){case"deleteWordBackward":{const F=M.substring(0,_).match(/\w*[^\w]*$/);F&&(O-=F[0].length);break}case"deleteWordForward":{const F=M.substring(_).match(/^[^\w]*\w*/);F&&(k+=F[0].length);break}case"deleteContentBackward":_===R&&(O-=1);break;case"deleteContentForward":_===R&&(k+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:M,change:E||"",willCommit:!1,selStart:O,selEnd:k}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class ax extends gs{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class rx extends gs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return fs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s)){const g=d&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue||"Off";l.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class O0 extends gs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof a=="string"&&(a=a!==i.buttonValue,t.setValue(s,{value:a})),a)for(const l of this._getElementsByName(i.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(fs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue;l.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const l=i.buttonValue;o.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const g=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=g&&y.id===s;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class ox extends qh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class lx extends gs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),a=document.createElement("select");fs.add(a),a.setAttribute("data-element-id",i),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",g=>{const y=this.data.defaultFieldValue;for(const b of a.options)b.selected=b.value===y});for(const g of this.data.options){const y=document.createElement("option");y.textContent=g.displayValue,y.value=g.exportValue,s.value.includes(g.exportValue)&&(y.setAttribute("selected",!0),o=!1),a.append(y)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),a.prepend(g),l=()=>{g.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const u=g=>{const y=g?"value":"textContent",{options:b,multiple:A}=a;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let d=u(!1);const f=g=>{const y=g.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",g=>{const y={value(b){l?.();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const x of a.options)x.selected=w.has(x.value);t.setValue(i,{value:u(!0)}),d=u(!1)},multipleSelection(b){a.multiple=!0},remove(b){const A=a.options,w=b.detail.remove;A[w].selected=!1,a.remove(w),A.length>0&&Array.prototype.findIndex.call(A,E=>E.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),d=u(!1)},clear(b){for(;a.length!==0;)a.remove(0);t.setValue(i,{value:null,items:[]}),d=u(!1)},insert(b){const{index:A,displayValue:w,exportValue:x}=b.detail.insert,E=a.children[A],S=document.createElement("option");S.textContent=w,S.value=x,E?E.before(S):a.append(S),t.setValue(i,{value:u(!0),items:f(b)}),d=u(!1)},items(b){const{items:A}=b.detail;for(;a.length!==0;)a.remove(0);for(const w of A){const{displayValue:x,exportValue:E}=w,S=document.createElement("option");S.textContent=x,S.value=E,a.append(S)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),d=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);t.setValue(i,{value:u(!0)}),d=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,g)}),a.addEventListener("input",g=>{const y=u(!0),b=u(!1);t.setValue(i,{value:y}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:d,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):a.addEventListener("input",function(g){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Rh extends ne{constructor(t){const{data:i,elements:s,parent:a}=t,o=!!a._commentManager;if(super(t,{isRenderable:!o&&ne._hasPopupData(i)}),this.elements=s,o&&ne._hasPopupData(i)){const l=this.popup=this.#t();for(const u of s)u.popup=l}else this.popup=null}#t(){return new cx({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=i,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${ua}${a}`).join(",")),this.container}}class cx{#t=null;#e=this.#V.bind(this);#n=this.#P.bind(this);#i=this.#O.bind(this);#a=this.#w.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#p=null;#g=null;#u=null;#m=null;#y=null;#v=null;#b=null;#C=null;#S=null;#x=null;#_=!1;#A=null;#E=null;constructor({container:t,color:i,elements:s,titleObj:a,modificationDate:o,contentsObj:l,richText:u,parent:d,rect:f,parentRect:g,open:y,commentManager:b=null}){this.#s=t,this.#S=a,this.#o=l,this.#C=u,this.#d=d,this.#r=i,this.#b=f,this.#h=g,this.#l=s,this.#t=b,this.#A=s[0],this.#c=Sh.toDateObject(o),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),b||(this.#R(),this.#s.hidden=!0,y&&this.#w())}#R(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#a,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#m){this.#m.parentNode||this.#A.container.after(this.#m);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#g=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#m=this.#A.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#m=document.createElement("button");l.className="annotationCommentButton";const u=this.#A.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#D(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),u.after(l)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#m||this.renderCommentButton();const[t,i]=this.#y,{style:s}=this.#m;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#z(){this.#A.extraPopupElement||(this.#m||this.renderCommentButton(),this.#m.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#m?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}}get elementBeforePopup(){return this.#m}get comment(){return this.#E||=this.#A.commentText,this.#E}set comment(t){t!==this.comment&&(this.#A.commentText=this.#E=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#m&&(this.#m.classList.toggle("selected",t),this.#m.ariaExpanded=i)}setSelectedCommentButton(t){this.#m.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#m.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#A.layer.getBoundingClientRect();return[(t-a)/l,(i+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#m.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:o,y:l,width:u,height:d}=a;this.#t.showDialog(null,this,o+i*u,l+s*d,{...t,parentDimensions:a})}render(){if(this.#p)return;const t=this.#p=document.createElement("div");if(t.className="popup",this.#r){const s=t.style.outlineColor=nt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#S?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#S}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}c0({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#k(){const t=this.#C,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#C.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#j(){return this.#k?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},a={style:{color:this.#j,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:a});return s}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):i&&(i.deleted?this.remove():(this.#z(),this.#E=i.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(s||i?.deleted){this.remove();return}this.#R(),this.#x||={contentsObj:this.#o,richText:this.#C},t&&(this.#u=null),i&&i.text&&(this.#C=this.#B(i.text),this.#c=Sh.toDateObject(i.date),this.#o=null),this.#p?.remove(),this.#p=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#C}=this.#x,this.#x=null,this.#p?.remove(),this.#p=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#p?.remove(),this.#p=null,this.#_=!1,this.#f=!1,this.#m?.remove(),this.#m=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#b;for(const w of this.#l)if(!u||nt.intersect(w.data.rect,u)!==null){u=w.data.rect,l=!0;break}const d=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=l?u[2]-u[0]+5:0,y=d[0]+g,b=d[1];this.#u=[100*(y-a)/i,100*(b-o)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#e)):(this.#P(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#e))}#O(){this.#p||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#P(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#R(),this.#_&&(this.#p||this.#O(),this.#_=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class L0 extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=St.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class ux extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),a.append(o),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class hx extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",i-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class dx extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",i/2),l.setAttribute("cy",s/2),l.setAttribute("rx",i/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class B0 extends ne{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:a},width:o,height:l}=this;if(!i)return this.container;const u=this.svgFactory.create(o,l,!0);let d=[];for(let g=0,y=i.length;g<y;g+=2){const b=i[g]-t[0],A=t[3]-i[g+1];d.push(`${b},${A}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class fx extends B0{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class mx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class $h extends ne{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?St.HIGHLIGHT:St.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:a,popupRef:o}}=this,{transform:l,width:u,height:d}=this.#n(i,t),f=this.svgFactory.create(u,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",a.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let y=0,b=s.length;y<b;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[y].join(",")),g.append(A)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:a}=t,o=this.#t;if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(a){const{transform:l,width:u,height:d}=this.#n(this.data.rotation,a);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class F0 extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=St.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class gx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class px extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class yx extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class z0 extends ne{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=St.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class bx extends ne{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=be.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(a?o.metaKey:o.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Kh{#t=null;#e=null;#n=null;#i=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:a,page:o,viewport:l,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:g}){this.div=t,this.#t=i,this.#e=s,this.#a=u||null,this.#r=f||null,this.#n=g||new Hh,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;ds(s,this.viewport);const a=new Map,o=[],l={data:null,layer:s,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new bl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const d=u.annotationType===ge.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){o.push(u);continue}l.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;l.data=u;const f=ph.create(l);if(!f.isRenderable)continue;if(!d&&(this.#s.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const g=f.render();u.hidden&&(g.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of o){const d=l.elements=a.get(u.id);l.data=u;const f=ph.create(l);if(!f.isRenderable)continue;const g=f.render();f.contentElement.id=`${ua}${u.id}`,u.hidden&&(g.style.visibility="hidden"),d.at(-1).container.after(g)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:a}}of this.#s){const o=s.id=`${ua}${a}`;t.push(this.#a?.getAriaAttributes(o).then(l=>{if(l)for(const[u,d]of l)s.setAttribute(u,d)}))}}this.#s.sort(({data:{rect:[s,a,o,l]}},{data:{rect:[u,d,f,g]}})=>{if(s===o&&a===l)return 1;if(u===f&&d===g)return-1;const y=l,b=a,A=(a+l)/2,w=g,x=d,E=(d+g)/2;if(A>=w&&E<=b)return-1;if(E>=y&&A<=x)return 1;const S=(s+o)/2,M=(u+f)/2;return S-M});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#r,svgFactory:new bl,parent:this};for(const s of t){s.borderStyle||=Kh._defaultBorderStyle,i.data=s;const a=ph.create(i);a.isRenderable&&(a.render(),a.contentElement.id=`${ua}${s.id}`,this.#s.push(a))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,ds(i,{rotation:t.rotation}),this.#l(),i.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${i}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:o}=a;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):a.append(s);const l=this.#i.get(i);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,a.id,s),l._hasNoCanvas=!1):l.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:a}=t,o=new ix({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#n});return o.render(),o.contentElement.id=`${ua}${s}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(t){const i=this.#s.findIndex(a=>a.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return xt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:oa.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ol=/\r\n?|\n/g;class we extends ft{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=we.prototype,i=o=>o.isEmpty(),s=Gn.TRANSLATE_SMALL,a=Gn.TRANSLATE_BIG;return xt(this,"_keyboardManager",new kr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:i}]]))}static _type="freetext";static _editorType=St.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||we._defaultColor||ft._defaultLineColor,this.#i=t.fontSize||we._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){ft.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ot.FREETEXT_SIZE:we._defaultFontSize=i;break;case Ot.FREETEXT_COLOR:we._defaultColor=i;break}}updateParams(t,i){switch(t){case Ot.FREETEXT_SIZE:this.#a(i);break;case Ot.FREETEXT_COLOR:this.#r(i);break}}static get defaultPropertiesToUpdate(){return[[Ot.FREETEXT_SIZE,we._defaultFontSize],[Ot.FREETEXT_COLOR,we._defaultColor||ft._defaultLineColor]]}get propertiesToUpdate(){return[[Ot.FREETEXT_SIZE,this.#i],[Ot.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Mr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ot.FREETEXT_COLOR}#a(t){const i=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#i)*this.parentScale),this.#i=a,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const i=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(we.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",a.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,g]=this.pageDimensions,[y,b]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=t+(l[0]-y)/f,w=i+this.height-(l[1]-b)/g;break;case 90:A=t+(l[0]-y)/f,w=i-(l[1]-b)/g,[u,d]=[d,-u];break;case 180:A=t-this.width+(l[0]-y)/f,w=i-(l[1]-b)/g,[u,d]=[-u,-d];break;case 270:A=t+(l[0]-y-this.height*g)/f,w=i+(l[1]-b-this.width*f)/g,[u,d]=[-d,u];break}this.setAt(A*a,w*o,u,d)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ol,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=we.#h(i.getData("text")||"").replaceAll(ol,`
`);if(!a)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!a.includes(`
`)){l.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:d}=l,f=[],g=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(g.push(u.nodeValue.slice(d).replaceAll(ol,"")),A!==this.editorDiv){let w=f;for(const x of this.editorDiv.childNodes){if(x===A){w=g;continue}w.push(we.#c(x))}}f.push(u.nodeValue.slice(0,d).replaceAll(ol,""))}else if(u===this.editorDiv){let A=f,w=0;for(const x of this.editorDiv.childNodes)w++===d&&(A=g),A.push(we.#c(x))}this.#t=`${f.join(`
`)}${a}${g.join(`
`)}`,this.#l();const y=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(b<=w){y.setStart(A,b),y.setEnd(A,b);break}b-=w}o.removeAllRanges(),o.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=we._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let a=null;if(t instanceof L0){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:g,popupRef:y,richText:b,contentsObj:A,creationDate:w,modificationDate:x},textContent:E,textPosition:S,parent:{page:{pageNumber:M}}}=t;if(!E||E.length===0)return null;a=t={annotationType:St.FREETEXT,color:Array.from(u),fontSize:l,value:E.join(`
`),position:S,pageIndex:M-1,rect:d.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:y,comment:A?.str||null,richText:b,creationDate:w,modificationDate:x}}const o=await super.deserialize(t,i,s);return o.#i=t.fontSize,o.color=nt.makeHexColor(...t.color),o.#t=we.#h(t.value),o._initialData=a,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=ft._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((l,u)=>l!==a[u])||t.pageIndex!==o}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class at{static PRECISION=1e-4;toSVGPath(){It("Abstract method `toSVGPath` must be implemented.")}get box(){It("Abstract getter `box` must be implemented.")}serialize(t,i){It("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=i+t[u]*a,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=i+t[u+1]*a,l[u+1]=s+t[u]*o;return l}static _translate(t,i,s,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=i+t[o],a[o+1]=s+t[o+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,a,o){switch(o){case 90:return[1-i/s,t/a];case 180:return[1-t/s,1-i/a];case 270:return[i/s,1-t/a];default:return[t/s,i/a]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,a,o,l){return[(t+5*s)/6,(i+5*a)/6,(5*s+o)/6,(5*a+l)/6,(s+o)/2,(a+l)/2]}}class ls{#t;#e=[];#n;#i;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#p=8;static#g=2;static#u=ls.#p+ls.#g;constructor({x:t,y:i},s,a,o,l,u=0){this.#t=s,this.#h=o*a,this.#i=l,this.#r.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=ls.#p*a,this.#c=ls.#u*a,this.#d=a,this.#f.push(t,i)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),i=this.#r.subarray(16,18),[s,a,o,l]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/o,(this.#o+(t[1]-i[1])/2-a)/l,(this.#s+(i[0]-t[0])/2-s)/o,(this.#o+(i[1]-t[1])/2-a)/l]}add({x:t,y:i}){this.#s=t,this.#o=i;const[s,a,o,l]=this.#t;let[u,d,f,g]=this.#r.subarray(8,12);const y=t-f,b=i-g,A=Math.hypot(y,b);if(A<this.#c)return!1;const w=A-this.#l,x=w/A,E=x*y,S=x*b;let M=u,_=d;u=f,d=g,f+=E,g+=S,this.#f?.push(t,i);const R=-S/w,O=E/w,k=R*this.#h,F=O*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+k,g+F],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-k,g-F],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([u+k,d+F],2),this.#a.push(NaN,NaN,NaN,NaN,(u+k-s)/o,(d+F-a)/l),this.#r.set([u-k,d-F],14),this.#e.push(NaN,NaN,NaN,NaN,(u-k-s)/o,(d-F-a)/l)),this.#r.set([M,_,u,d,f,g],6),!this.isEmpty()):(this.#r.set([M,_,u,d,f,g],6),Math.abs(Math.atan2(_-d,M-u)-Math.atan2(S,E))<Math.PI/2?([u,d,f,g]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/o,((d+g)/2-a)/l),[u,d,M,_]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-s)/o,((_+d)/2-a)/l),!0):([M,_,u,d,f,g]=this.#r.subarray(0,6),this.#a.push(((M+5*u)/6-s)/o,((_+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+g)/6-a)/l,((u+f)/2-s)/o,((d+g)/2-a)/l),[f,g,u,d,M,_]=this.#r.subarray(12,18),this.#e.push(((M+5*u)/6-s)/o,((_+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+g)/6-a)/l,((u+f)/2-s)/o,((d+g)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,i=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(s);for(let a=i.length-6;a>=6;a-=6)isNaN(i[a])?s.push(`L${i[a+4]} ${i[a+5]}`):s.push(`C${i[a]} ${i[a+1]} ${i[a+2]} ${i[a+3]} ${i[a+4]} ${i[a+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,i,s,a]=this.#t,[o,l,u,d]=this.#m();return`M${(this.#r[2]-t)/s} ${(this.#r[3]-i)/a} L${(this.#r[4]-t)/s} ${(this.#r[5]-i)/a} L${o} ${l} L${u} ${d} L${(this.#r[16]-t)/s} ${(this.#r[17]-i)/a} L${(this.#r[14]-t)/s} ${(this.#r[15]-i)/a} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,s,a,o]=this.#t,l=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,g,y]=this.#m();t.push(`L${(l[0]-i)/a} ${(l[1]-s)/o} L${d} ${f} L${g} ${y} L${(u[0]-i)/a} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,i,s,a,o,l){return new j0(t,i,s,a,o,l)}getOutlines(){const t=this.#a,i=this.#e,s=this.#r,[a,o,l,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=d.length-2;y<b;y+=2)d[y]=(this.#f[y]-a)/l,d[y+1]=(this.#f[y+1]-o)/u;if(d[d.length-2]=(this.#s-a)/l,d[d.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#C(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let y=0;y<g;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}g=this.#x(f,g);for(let y=i.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(i[y+b])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=i[y+b],f[g+1]=i[y+b+1],g+=2}return this.#S(f,g),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#n,this.#i)}#C(t){const i=this.#r,[s,a,o,l]=this.#t,[u,d,f,g]=this.#m(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-a)/l,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-a)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-a)/l,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-a)/l],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#n,this.#i)}#S(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#x(t,i){const s=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[o,l,u,d]=this.#t,[f,g,y,b]=this.#m();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(a[0]-o)/u,(a[1]-l)/d],i),i+=24}}class j0 extends at{#t;#e=new Float32Array(4);#n;#i;#a;#r;#s;constructor(t,i,s,a,o,l){super(),this.#s=t,this.#a=i,this.#t=s,this.#r=a,this.#n=o,this.#i=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,d,f,g]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/g;for(let y=0,b=i.length;y<b;y+=2)i[y]=(i[y]-u)/f,i[y+1]=(i[y+1]-d)/g}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,a],o){const l=s-t,u=a-i;let d,f;switch(o){case 0:d=at._rescale(this.#s,t,a,l,-u),f=at._rescale(this.#a,t,a,l,-u);break;case 90:d=at._rescaleAndSwap(this.#s,t,i,l,u),f=at._rescaleAndSwap(this.#a,t,i,l,u);break;case 180:d=at._rescale(this.#s,s,i,-l,u),f=at._rescale(this.#a,s,i,-l,u);break;case 270:d=at._rescaleAndSwap(this.#s,s,a,-l,-u),f=at._rescaleAndSwap(this.#a,s,a,-l,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const i=this.#s;let s=i[4],a=i[5];const o=[s,a,s,a];let l=s,u=a,d=s,f=a;const g=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,w=i.length;A<w;A+=6){const x=i[A+4],E=i[A+5];isNaN(i[A])?(nt.pointBoundingBox(x,E,o),u>E?(l=x,u=E):u===E&&(l=g(l,x)),f<E?(d=x,f=E):f===E&&(d=g(d,x))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,nt.bezierBoundingBox(s,a,...i.slice(A,A+6),y),nt.rectBoundingBox(y[0],y[1],y[2],y[3],o),u>y[1]?(l=y[0],u=y[1]):u===y[1]&&(l=g(l,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=g(d,y[2]))),s=x,a=E}const b=this.#e;b[0]=o[0]-this.#n,b[1]=o[1]-this.#n,b[2]=o[2]-o[0]+2*this.#n,b[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[l,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,i,s,a,o,l=0){return new ls(t,i,s,a,o,l)}getNewOutline(t,i){const[s,a,o,l]=this.#e,[u,d,f,g]=this.#t,y=o*f,b=l*g,A=s*f+u,w=a*g+d,x=this.newOutliner({x:this.#a[0]*y+A,y:this.#a[1]*b+w},this.#t,this.#r,t,this.#i,i??this.#n);for(let E=2;E<this.#a.length;E+=2)x.add({x:this.#a[E]*y+A,y:this.#a[E+1]*b+w});return x.getOutlines()}}class Nh{#t;#e;#n;#i=[];#a=[];constructor(t,i=0,s=0,a=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x,y:E,width:S,height:M}of t){const _=Math.floor((x-i)/l)*l,R=Math.ceil((x+S+i)/l)*l,O=Math.floor((E-i)/l)*l,k=Math.ceil((E+M+i)/l)*l,F=[_,O,k,!0],j=[R,O,k,!1];this.#i.push(F,j),nt.rectBoundingBox(_,O,R,k,o)}const u=o[2]-o[0]+2*s,d=o[3]-o[1]+2*s,f=o[0]-s,g=o[1]-s;let y=a?-1/0:1/0,b=1/0;const A=this.#i.at(a?-1:-2),w=[A[0],A[2]];for(const x of this.#i){const[E,S,M,_]=x;!_&&a?S<b?(b=S,y=E):S===b&&(y=Math.max(y,E)):_&&!a&&(S<b?(b=S,y=E):S===b&&(y=Math.min(y,E))),x[0]=(E-f)/u,x[1]=(S-g)/d,x[2]=(M-g)/d}this.#t=new Float32Array([f,g,u,d]),this.#e=[y,b],this.#n=w}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#r(t)}#r(t){const i=[],s=new Set;for(const l of t){const[u,d,f]=l;i.push([u,d,l],[u,f,l])}i.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=i.length;l<u;l+=2){const d=i[l][2],f=i[l+1][2];d.push(f),f.push(d),s.add(d),s.add(f)}const a=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,d,f,g,y]=l;s.delete(l);let b=u,A=d;for(o=[u,f],a.push(o);;){let w;if(s.has(g))w=g;else if(s.has(y))w=y;else break;s.delete(w),[u,d,f,g,y]=w,b!==u&&(o.push(b,A,u,A===d?d:f),b=u),A=A===d?f:d}o.push(b,A)}return new vx(a,this.#t,this.#e,this.#n)}#s(t){const i=this.#a;let s=0,a=i.length-1;for(;s<=a;){const o=s+a>>1,l=i[o][0];if(l===t)return o;l<t?s=o+1:a=o-1}return a+1}#o([,t,i]){const s=this.#s(t);this.#a.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let a=s;a<this.#a.length;a++){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===i){this.#a.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===i){this.#a.splice(a,1);return}}}#l(t){const[i,s,a]=t,o=[[i,s,a]],l=this.#s(a);for(let u=0;u<l;u++){const[d,f]=this.#a[u];for(let g=0,y=o.length;g<y;g++){const[,b,A]=o[g];if(!(f<=b||A<=d)){if(b>=d){if(A>f)o[g][1]=f;else{if(y===1)return[];o.splice(g,1),g--,y--}continue}o[g][2]=d,A>f&&o.push([i,f,A])}}}return o}}class vx extends at{#t;#e;constructor(t,i,s,a){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const i of this.#e){let[s,a]=i;t.push(`M${s} ${a}`);for(let o=2;o<i.length;o+=2){const l=i[o],u=i[o+1];l===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,i,s,a],o){const l=[],u=s-t,d=a-i;for(const f of this.#e){const g=new Array(f.length);for(let y=0;y<f.length;y+=2)g[y]=t+f[y]*u,g[y+1]=a-f[y+1]*d;l.push(g)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class kh extends ls{newFreeDrawOutline(t,i,s,a,o,l){return new Ax(t,i,s,a,o,l)}}class Ax extends j0{newOutliner(t,i,s,a,o,l=0){return new kh(t,i,s,a,o,l)}}class ce extends ft{#t=null;#e=0;#n;#i=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#p=null;#g=null;#u="";#m;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=St.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ce.prototype;return xt(this,"_keyboardManager",new kr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ce._defaultColor,this.#m=t.thickness||ce._defaultThickness,this.opacity=t.opacity||ce._defaultOpacity,this.#n=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Nh(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new Nh(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#p=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#m/2+a,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ce.#E(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ce.#E(this.#r.box,y),path:{d:this.#r.toSVGPath()}})}const[o,l,u,d]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=d;break;case 90:{const[y,b]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*b/y,this.height=d*y/b;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=d;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*b/y,this.height=d*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-o)/u,(f[1]-l)/d];const{lastPoint:g}=this.#r;this.#p=[(g[0]-o)/u,(g[1]-l)/d]}static initialize(t,i){ft.initialize(t,i),ce._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Ot.HIGHLIGHT_COLOR:ce._defaultColor=i;break;case Ot.HIGHLIGHT_THICKNESS:ce._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#p}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Ot.HIGHLIGHT_COLOR:this.#C(i);break;case Ot.HIGHLIGHT_THICKNESS:this.#S(i);break}}static get defaultPropertiesToUpdate(){return[[Ot.HIGHLIGHT_COLOR,ce._defaultColor],[Ot.HIGHLIGHT_THICKNESS,ce._defaultThickness]]}get propertiesToUpdate(){return[[Ot.HIGHLIGHT_COLOR,this.color||ce._defaultColor],[Ot.HIGHLIGHT_THICKNESS,this.#m||ce._defaultThickness],[Ot.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#C(t){const i=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:i.bind(this,t,ce._defaultOpacity),undo:i.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const i=this.#m,s=a=>{this.#m=a,this.#x(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ot.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Si({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#_():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#x(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#_(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,i,s,a],o){switch(o){case 90:return[1-i-a,t,a,s];case 180:return[1-t-s,1-i-a,s,a];case 270:return[i,1-t-s,a,s]}return[t,i,s,a]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ce.#E(this.#l.box,t)):s=ce.#E([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:ce.#E(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),h0(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#R(t){ce._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#z(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,a]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:d,y:f,width:g,height:y}of o){const b=d*t+s,A=(1-f)*i+a;l[u]=l[u+4]=b,l[u+1]=l[u+3]=A,l[u+2]=l[u+6]=b+g*t,l[u+5]=l[u+7]=A-y*i,u+=8}return l}#k(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,i,{target:s,x:a,y:o}){const{x:l,y:u,width:d,height:f}=s.getBoundingClientRect(),g=new AbortController,y=t.combinedSignal(g),b=A=>{g.abort(),this.#j(t,A)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",re,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Ei,{signal:y}),s.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new kh({x:a,y:o},[l,u,d,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let a=null;if(t instanceof F0){const{data:{quadPoints:w,rect:x,rotation:E,id:S,color:M,opacity:_,popupRef:R,richText:O,contentsObj:k,creationDate:F,modificationDate:j},parent:{page:{pageNumber:X}}}=t;a=t={annotationType:St.HIGHLIGHT,color:Array.from(M),opacity:_,quadPoints:w,boxes:null,pageIndex:X-1,rect:x.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,popupRef:R,richText:O,comment:k?.str||null,creationDate:F,modificationDate:j}}else if(t instanceof $h){const{data:{inkLists:w,rect:x,rotation:E,id:S,color:M,borderStyle:{rawWidth:_},popupRef:R,richText:O,contentsObj:k,creationDate:F,modificationDate:j},parent:{page:{pageNumber:X}}}=t;a=t={annotationType:St.HIGHLIGHT,color:Array.from(M),thickness:_,inkLists:w,boxes:null,pageIndex:X-1,rect:x.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,popupRef:R,richText:O,comment:k?.str||null,creationDate:F,modificationDate:j}}const{color:o,quadPoints:l,inkLists:u,opacity:d}=t,f=await super.deserialize(t,i,s);f.color=nt.makeHexColor(...o),f.opacity=d||1,u&&(f.#m=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[g,y]=f.pageDimensions,[b,A]=f.pageTranslation;if(l){const w=f.#n=[];for(let x=0;x<l.length;x+=8)w.push({x:(l[x]-b)/g,y:1-(l[x+1]-A)/y,width:(l[x+2]-l[x])/g,height:(l[x+1]-l[x+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const w=u[0],x={x:w[0]-b,y:y-(w[1]-A)},E=new kh(x,[0,0,g,y],1,f.#m/2,!0,.001);for(let _=0,R=w.length;_<R;_+=2)x.x=w[_]-b,x.y=y-(w[_+1]-A),E.add(x);const{id:S,clipPathId:M}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#b({highlightOutlines:E.getOutlines(),highlightId:S,clipPathId:M}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=ft._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#m,quadPoints:this.#z(),outlines:this.#k(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==i[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class P0{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){It("Not implemented")}}class zt extends ft{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(zt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[a,o]of Object.entries(i))s.has(a)?Object.assign(t[a],o):t[a]=o;return t}static getDefaultDrawingOptions(t){It("Not implemented")}static get typesMap(){It("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(zt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,i[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,i[a]]);return t}_updateProperty(t,i,s){const a=this._drawingOptions,o=a[i],l=u=>{a.updateProperty(i,u);const d=this.#t.updateProperty(i,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,i,s,a]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(l/o),a*(o/l)];case 180:return[1-t,1-i,s,a];case 270:return[1-i,t,s*(l/o),a*(o/l)];default:return[t,i,s,a]}}#d(){const{x:t,y:i,width:s,height:a,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(o/l),a*(l/o)];case 180:return[1-t,1-i,s,a];case 270:return[i,1-t,s*(o/l),a*(l/o)];default:return[t,i,s,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:a,rotation:o,parentRotation:l,parentDimensions:[u,d]}=this;switch((o*4+l)/90){case 1:return[1-i-a,t,a,s];case 2:return[1-t-s,1-i-a,s,a];case 3:return[i,1-t-s,a,s];case 4:return[t,i-s*(u/d),a*(d/u),s*(u/d)];case 5:return[1-i,t,s*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-i,a*(d/u),s*(u/d)];case 7:return[i-s*(u/d),1-t-a*(d/u),s*(u/d),a*(d/u)];case 8:return[t-s,i-a,s,a];case 9:return[1-i,t-s,a,s];case 10:return[1-t,1-i,s,a];case 11:return[i-a,1-t,a,s];case 12:return[t-a*(d/u),i,a*(d/u),s*(u/d)];case 13:return[1-i-s*(u/d),t-a*(d/u),s*(u/d),a*(d/u)];case 14:return[1-t,1-i-s*(u/d),a*(d/u),s*(u/d)];case 15:return[i,1-t,s*(u/d),a*(d/u)];default:return[t,i,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,zt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,a,o){It("Not implemented")}static startDrawing(t,i,s,a){const{target:o,offsetX:l,offsetY:u,pointerId:d,pointerType:f}=a;if(Pt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:g}}=t,{width:y,height:b}=o.getBoundingClientRect(),A=zt.#i=new AbortController,w=t.combinedSignal(A);if(Pt.setPointer(f,d),window.addEventListener("pointerup",x=>{Pt.isSamePointerIdOrRemove(x.pointerId)&&this._endDraw(x)},{signal:w}),window.addEventListener("pointercancel",x=>{Pt.isSamePointerIdOrRemove(x.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",x=>{Pt.isSamePointerType(x.pointerType)&&(Pt.initializeAndAddPointerId(x.pointerId),zt.#n.isCancellable()&&(zt.#n.removeLastElement(),zt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ei,{signal:w}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),o.addEventListener("touchmove",x=>{Pt.isSameTimeStamp(x.timeStamp)&&re(x)},{signal:w}),t.toggleDrawing(),i._editorUndoBar?.hide(),zt.#n){t.drawLayer.updateProperties(this._currentDrawId,zt.#n.startNew(l,u,y,b,g));return}i.updateUIForDefaultProperties(this),zt.#n=this.createDrawerInstance(l,u,y,b,g),zt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(zt.#a.toSVGProperties(),zt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Pt.isSameTimeStamp(t.timeStamp),!zt.#n)return;const{offsetX:i,offsetY:s,pointerId:a}=t;if(Pt.isSamePointerId(a)){if(Pt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,zt.#n.add(i,s)),Pt.setTimeStamp(t.timeStamp),re(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,zt.#n=null,zt.#a=null,Pt.clearTimeStamp()),zt.#i&&(zt.#i.abort(),zt.#i=null,Pt.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,zt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=zt.#n,a=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(a,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:Ot.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ot.DRAW_STEP),!zt.#n.isEmpty()){const{pageDimensions:[s,a],scale:o}=i,l=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:zt.#n.getOutlines(s*o,a*o,o,this._INNER_MARGIN),drawingOptions:zt.#a,mustBeCommitted:!t});return this._cleanup(!0),l}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,a,o,l){It("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}=i.viewport,d=this.deserializeDraw(l,u,a,o,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[a,o]=this.pageDimensions;return this.#t.serialize([i,s,a,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class xx{#t=new Float64Array(6);#e;#n;#i;#a;#r;#s="";#o=0;#c=new Or;#l;#d;constructor(t,i,s,a,o,l){this.#l=s,this.#d=a,this.#i=o,this.#a=l,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#r=[t,i],this.#n=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#a=i)}#h(t,i){return at._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,a,o,l]=this.#t.subarray(2,6),u=t-o,d=i-l;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,i),isNaN(s)?(this.#t.set([o,l,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,o,l,t,i],0),this.#e.push(...at.createBezierPoints(s,a,o,l,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,a,o){this.#l=s,this.#d=a,this.#i=o,[t,i]=this.#h(t,i);const l=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#r=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:a}=this.#n[t];this.#e=s,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=at.svgRound(this.#e[4]),i=at.svgRound(this.#e[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#r.length<=6){const a=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,a)} M ${t} ${i}`,this.#o=6}if(this.#r.length===4){const a=at.svgRound(this.#e[10]),o=at.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${a} ${o}`,this.#o=12,this.#s}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let a=this.#o,o=this.#e.length;a<o;a+=6){const[l,u,d,f,g,y]=this.#e.slice(a,a+6).map(at.svgRound);s.push(`C${l} ${u} ${d} ${f} ${g} ${y}`)}return this.#s+=s.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,i,s,a){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,i,s,this.#i,this.#a,a),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Or extends at{#t;#e=0;#n;#i;#a;#r;#s;#o;#c;build(t,i,s,a,o,l,u){this.#a=i,this.#r=s,this.#s=a,this.#o=o,this.#c=l,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${at.svgRound(i[4])} ${at.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${at.svgRound(i[10])} ${at.svgRound(i[11])}`);continue}for(let s=6,a=i.length;s<a;s+=6){const[o,l,u,d,f,g]=i.subarray(s,s+6).map(at.svgRound);t.push(`C${o} ${l} ${u} ${d} ${f} ${g}`)}}return t.join("")}serialize([t,i,s,a],o){const l=[],u=[],[d,f,g,y]=this.#d();let b,A,w,x,E,S,M,_,R;switch(this.#o){case 0:R=at._rescale,b=t,A=i+a,w=s,x=-a,E=t+d*s,S=i+(1-f-y)*a,M=t+(d+g)*s,_=i+(1-f)*a;break;case 90:R=at._rescaleAndSwap,b=t,A=i,w=s,x=a,E=t+f*s,S=i+d*a,M=t+(f+y)*s,_=i+(d+g)*a;break;case 180:R=at._rescale,b=t+s,A=i,w=-s,x=a,E=t+(1-d-g)*s,S=i+f*a,M=t+(1-d)*s,_=i+(f+y)*a;break;case 270:R=at._rescaleAndSwap,b=t+s,A=i+a,w=-s,x=-a,E=t+(1-f-y)*s,S=i+(1-d-g)*a,M=t+(1-f)*s,_=i+(1-d)*a;break}for(const{line:O,points:k}of this.#i)l.push(R(O,b,A,w,x,o?new Array(O.length):null)),u.push(R(k,b,A,w,x,o?new Array(k.length):null));return{lines:l,points:u,rect:[E,S,M,_]}}static deserialize(t,i,s,a,o,{paths:{lines:l,points:u},rotation:d,thickness:f}){const g=[];let y,b,A,w,x;switch(d){case 0:x=at._rescale,y=-t/s,b=i/a+1,A=1/s,w=-1/a;break;case 90:x=at._rescaleAndSwap,y=-i/a,b=-t/s,A=1/a,w=1/s;break;case 180:x=at._rescale,y=t/s+1,b=-i/a,A=-1/s,w=1/a;break;case 270:x=at._rescaleAndSwap,y=i/a+1,b=t/s+1,A=-1/a,w=-1/s;break}if(!l){l=[];for(const S of u){const M=S.length;if(M===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(M===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const _=new Float32Array(3*(M-2));l.push(_);let[R,O,k,F]=S.subarray(0,4);_.set([NaN,NaN,NaN,NaN,R,O],0);for(let j=4;j<M;j+=2){const X=S[j],K=S[j+1];_.set(at.createBezierPoints(R,O,k,F,X,K),(j-2)*3),[R,O,k,F]=[k,F,X,K]}}}for(let S=0,M=l.length;S<M;S++)g.push({line:x(l[S].map(_=>_??NaN),y,b,A,w),points:x(u[S].map(_=>_??NaN),y,b,A,w)});const E=new this.prototype.constructor;return E.build(g,s,a,1,d,f,o),E}#l(t=this.#c){const i=this.#n+t/2*this.#s;return this.#o%180===0?[i/this.#a,i/this.#r]:[i/this.#r,i/this.#a]}#d(){const[t,i,s,a]=this.#t,[o,l]=this.#l(0);return[t+o,i+l,s-2*o,a-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#i){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)nt.pointBoundingBox(a[u],a[u+1],t);continue}let o=a[4],l=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,g,y,b,A,w]=a.subarray(u,u+6);nt.bezierBoundingBox(o,l,f,g,y,b,A,w,t),o=A,l=w}}const[i,s]=this.#l();t[0]=De(t[0]-i,0,1),t[1]=De(t[1]-s,0,1),t[2]=De(t[2]+i,0,1),t[3]=De(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[a,o]=this.#l(),[l,u]=[a-i,o-s],d=this.#t;return d[0]-=l,d[1]-=u,d[2]+=2*l,d[3]+=2*u,d}updateParentDimensions([t,i],s){const[a,o]=this.#l();this.#a=t,this.#r=i,this.#s=s;const[l,u]=this.#l(),d=l-a,f=u-o,g=this.#t;return g[0]-=d,g[1]-=f,g[2]+=2*d,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(at.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,a=0,o=0,l=0,u=0,d=0;switch(this.#e){case 90:a=i/t,o=-t/i,u=t;break;case 180:s=-1,l=-1,u=t,d=i;break;case 270:a=-i/t,o=t/i,d=i;break;default:return""}return`matrix(${s} ${a} ${o} ${l} ${at.svgRound(u)} ${at.svgRound(d)})`}getPathResizingSVGProperties([t,i,s,a]){const[o,l]=this.#l(),[u,d,f,g]=this.#t;if(Math.abs(f-o)<=at.PRECISION||Math.abs(g-l)<=at.PRECISION){const x=t+s/2-(u+f/2),E=i+a/2-(d+g/2);return{path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:`${this.rotationTransform} translate(${x} ${E})`}}}const y=(s-2*o)/(f-2*o),b=(a-2*l)/(g-2*l),A=f/s,w=g/a;return{path:{"transform-origin":`${at.svgRound(u)} ${at.svgRound(d)}`,transform:`${this.rotationTransform} scale(${A} ${w}) translate(${at.svgRound(o)} ${at.svgRound(l)}) scale(${y} ${b}) translate(${at.svgRound(-o)} ${at.svgRound(-l)})`}}}getPathResizedSVGProperties([t,i,s,a]){const[o,l]=this.#l(),u=this.#t,[d,f,g,y]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=a,Math.abs(g-o)<=at.PRECISION||Math.abs(y-l)<=at.PRECISION){const E=t+s/2-(d+g/2),S=i+a/2-(f+y/2);for(const{line:M,points:_}of this.#i)at._translate(M,E,S,M),at._translate(_,E,S,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*o)/(g-2*o),A=(a-2*l)/(y-2*l),w=-b*(d+o)+t+o,x=-A*(f+l)+i+l;if(b!==1||A!==1||w!==0||x!==0)for(const{line:E,points:S}of this.#i)at._rescale(E,w,x,b,A,E),at._rescale(S,w,x,b,A,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[a,o]=s,l=this.#t,u=t-l[0],d=i-l[1];if(this.#a===a&&this.#r===o)for(const{line:f,points:g}of this.#i)at._translate(f,u,d,f),at._translate(g,u,d,g);else{const f=this.#a/a,g=this.#r/o;this.#a=a,this.#r=o;for(const{line:y,points:b}of this.#i)at._rescale(y,u,d,f,g,y),at._rescale(b,u,d,f,g,b);l[2]*=f,l[3]*=g}return l[0]=t,l[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t[0])} ${at.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Ll extends P0{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ft._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new Ll(this._viewParameters);return t.updateAll(this),t}}class Wh extends zt{static _type="ink";static _editorType=St.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){ft.initialize(t,i),this._defaultDrawingOptions=new Ll(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return xt(this,"typesMap",new Map([[Ot.INK_THICKNESS,"stroke-width"],[Ot.INK_COLOR,"stroke"],[Ot.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,a,o){return new xx(t,i,s,a,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,a,o,l){return Or.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){let a=null;if(t instanceof $h){const{data:{inkLists:l,rect:u,rotation:d,id:f,color:g,opacity:y,borderStyle:{rawWidth:b},popupRef:A,richText:w,contentsObj:x,creationDate:E,modificationDate:S},parent:{page:{pageNumber:M}}}=t;a=t={annotationType:St.INK,color:Array.from(g),thickness:b,opacity:y,paths:{points:l},boxes:null,pageIndex:M-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:w,comment:x?.str||null,creationDate:E,modificationDate:S}}const o=await super.deserialize(t,i,s);return o._initialData=a,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new Mr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ot.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Wh.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:ft._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==i[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class Oh extends Or{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ll=8,vr=3;class ca{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,a){return s-=t,a-=i,s===0?a>0?0:4:s===1?a+6:2-a}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const g=(-f+d-u+16)%8,y=this.#n[2*g],b=this.#n[2*g+1];if(t[(s+y)*i+(a+b)]!==0)return g}return-1}static#a(t,i,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const g=(f+d+u+16)%8,y=this.#n[2*g],b=this.#n[2*g+1];if(t[(s+y)*i+(a+b)]!==0)return g}return-1}static#r(t,i,s,a){const o=t.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=t[g]<=a?1:0;for(let g=1;g<s-1;g++)l[g*i]=l[g*i+i-1]=0;for(let g=0;g<i;g++)l[g]=l[i*s-1-g]=0;let u=1,d;const f=[];for(let g=1;g<s-1;g++){d=1;for(let y=1;y<i-1;y++){const b=g*i+y,A=l[b];if(A===0)continue;let w=g,x=y;if(A===1&&l[b-1]===0)u+=1,x-=1;else if(A>=1&&l[b+1]===0)u+=1,x+=1,A>1&&(d=A);else{A!==1&&(d=Math.abs(A));continue}const E=[y,g],S=x===y+1,M={isHole:S,points:E,id:u,parent:0};f.push(M);let _;for(const Q of f)if(Q.id===d){_=Q;break}_?_.isHole?M.parent=S?_.parent:d:M.parent=S?d:_.parent:M.parent=S?d:0;const R=this.#i(l,i,g,y,w,x,0);if(R===-1){l[b]=-u,l[b]!==1&&(d=Math.abs(l[b]));continue}let O=this.#n[2*R],k=this.#n[2*R+1];const F=g+O,j=y+k;w=F,x=j;let X=g,K=y;for(;;){const Q=this.#a(l,i,X,K,w,x,1);O=this.#n[2*Q],k=this.#n[2*Q+1];const et=X+O,ot=K+k;E.push(ot,et);const J=X*i+K;if(l[J+1]===0?l[J]=-u:l[J]===1&&(l[J]=u),et===g&&ot===y&&X===F&&K===j){l[b]!==1&&(d=Math.abs(l[b]));break}else w=X,x=K,X=et,K=ot}}}return f}static#s(t,i,s,a){if(s-i<=4){for(let F=i;F<s-2;F+=2)a.push(t[F],t[F+1]);return}const o=t[i],l=t[i+1],u=t[s-4]-o,d=t[s-3]-l,f=Math.hypot(u,d),g=u/f,y=d/f,b=g*l-y*o,A=d/u,w=1/f,x=Math.atan(A),E=Math.cos(x),S=Math.sin(x),M=w*(Math.abs(E)+Math.abs(S)),_=w*(1-M+M**2),R=Math.max(Math.atan(Math.abs(S+E)*_),Math.atan(Math.abs(S-E)*_));let O=0,k=i;for(let F=i+2;F<s-2;F+=2){const j=Math.abs(b-g*t[F+1]+y*t[F]);j>O&&(k=F,O=j)}O>(f*R)**2?(this.#s(t,i,k+2,a),this.#s(t,k,s,a)):a.push(o,l)}static#o(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,a,o,l){const u=new Float32Array(l**2),d=-2*a**2,f=l>>1;for(let x=0;x<l;x++){const E=(x-f)**2;for(let S=0;S<l;S++)u[x*l+S]=Math.exp((E+(S-f)**2)/d)}const g=new Float32Array(256),y=-2*o**2;for(let x=0;x<256;x++)g[x]=Math.exp(x**2/y);const b=t.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let x=0;x<s;x++)for(let E=0;E<i;E++){const S=x*i+E,M=t[S];let _=0,R=0;for(let k=0;k<l;k++){const F=x+k-f;if(!(F<0||F>=s))for(let j=0;j<l;j++){const X=E+j-f;if(X<0||X>=i)continue;const K=t[F*i+X],Q=u[k*l+j]*g[Math.abs(K-M)];_+=K*Q,R+=Q}}const O=A[S]=Math.round(_/R);w[O]++}return[A,w]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let a=-1/0,o=1/0;for(let u=0,d=s.length;u<d;u++){const f=s[u]=t[u<<2];a=Math.max(a,f),o=Math.min(o,f)}const l=255/(a-o);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-o)*l;return s}static#h(t){let i,s=-1/0,a=-1/0;const o=t.findIndex(d=>d!==0);let l=o,u=o;for(i=o;i<256;i++){const d=t[i];d>s&&(i-l>a&&(a=i-l,u=i-1),s=d,l=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:a}=t,{maxDim:o}=this.#t;let l=s,u=a;if(s>o||a>o){let b=s,A=a,w=Math.log2(Math.max(s,a)/o);const x=Math.floor(w);w=w===x?x-1:x;for(let S=0;S<w;S++){l=Math.ceil(b/2),u=Math.ceil(A/2);const M=new OffscreenCanvas(l,u);M.getContext("2d").drawImage(t,0,0,b,A,0,0,l,u),b=l,A=u,t!==i&&t.close(),t=M.transferToImageBitmap()}const E=Math.min(o/l,o/u);l=Math.round(l*E),u=Math.round(u*E)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const g=f.getImageData(0,0,l,u).data;return[this.#d(g),l,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:a},o,l,u,d){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const y=200,b=g.font=`${s} ${a} ${y}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:x,actualBoundingBoxDescent:E,fontBoundingBoxAscent:S,fontBoundingBoxDescent:M,width:_}=g.measureText(t),R=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,_)*R),k=Math.ceil(Math.max(Math.abs(x)+Math.abs(E)||y,Math.abs(S)+Math.abs(M)||y)*R);f=new OffscreenCanvas(O,k),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,k),g.fillStyle="black",g.fillText(t,O*(R-1)/2,k*(3-R)/2);const F=this.#d(g.getImageData(0,0,O,k).data),j=this.#l(F),X=this.#h(j),K=this.#r(F,O,k,X);return this.processDrawnLines({lines:{curves:K,width:O,height:k},pageWidth:o,pageHeight:l,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,i,s,a,o){const[l,u,d]=this.#f(t),[f,g]=this.#c(l,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(g),b=this.#r(f,u,d,y);return this.processDrawnLines({lines:{curves:b,width:u,height:d},pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:l,areContours:u}){a%180!==0&&([i,s]=[s,i]);const{curves:d,width:f,height:g}=t,y=t.thickness??0,b=[],A=Math.min(i/f,s/g),w=A/i,x=A/s,E=[];for(const{points:M}of d){const _=l?this.#o(M):M;if(!_)continue;E.push(_);const R=_.length,O=new Float32Array(R),k=new Float32Array(3*(R===2?2:R-2));if(b.push({line:k,points:O}),R===2){O[0]=_[0]*w,O[1]=_[1]*x,k.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[F,j,X,K]=_;F*=w,j*=x,X*=w,K*=x,O.set([F,j,X,K],0),k.set([NaN,NaN,NaN,NaN,F,j],0);for(let Q=4;Q<R;Q+=2){const et=O[Q]=_[Q]*w,ot=O[Q+1]=_[Q+1]*x;k.set(at.createBezierPoints(F,j,X,K,et,ot),(Q-2)*3),[F,j,X,K]=[X,K,et,ot]}}if(b.length===0)return null;const S=u?new Oh:new Or;return S.build(b,i,s,1,a,u?0:y,o),{outline:S,newCurves:E,areContours:u,thickness:y,width:f,height:g}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:a,height:o}){let l=1/0,u=-1/0,d=0;for(const _ of t){d+=_.length;for(let R=2,O=_.length;R<O;R++){const k=_[R]-_[R-2];l=Math.min(l,k),u=Math.max(u,k)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const g=t.length,y=ll+vr*g,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*g)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=a,b[A++]=o,b[A++]=i?0:1,b[A++]=Math.max(0,Math.floor(s??0)),b[A++]=g,b[A++]=f.BYTES_PER_ELEMENT;for(const _ of t)b[A++]=_.length-2,b[A++]=_[0],b[A++]=_[1];const w=new CompressionStream("deflate-raw"),x=w.writable.getWriter();await x.ready,x.write(b);const E=f.prototype.constructor;for(const _ of t){const R=new E(_.length-2);for(let O=2,k=_.length;O<k;O++)R[O-2]=_[O]-_[O-2];x.write(R)}x.close();const S=await new Response(w.readable).arrayBuffer();return new Uint8Array(S).toBase64()}static async decompressSignature(t){try{const i=Uint8Array.fromBase64(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),o=a.getWriter();await o.ready,o.write(i).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const _ of s)l||=new Uint8Array(new Uint32Array(_.buffer,0,4)[0]),l.set(_,u),u+=_.length;const d=new Uint32Array(l.buffer,0,l.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=d[2],y=d[3],b=d[4]===0,A=d[5],w=d[6],x=d[7],E=[],S=(ll+vr*w)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(x){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(l.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(l.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(l.buffer,S);break}u=0;for(let _=0;_<w;_++){const R=d[vr*_+ll],O=new Float32Array(R+2);E.push(O);for(let k=0;k<vr-1;k++)O[k]=d[vr*_+ll+k+1];for(let k=0;k<R;k++)O[k+2]=O[k]+M[u++]}return{areContours:b,thickness:A,outlines:E,width:g,height:y}}catch(i){return At(`decompressSignature: ${i}`),null}}}class Qh extends P0{constructor(){super(),super.updateProperties({fill:ft._defaultLineColor,"stroke-width":0})}clone(){const t=new Qh;return t.updateAll(this),t}}class Zh extends Ll{constructor(t){super(t),super.updateProperties({stroke:ft._defaultLineColor,"stroke-width":1})}clone(){const t=new Zh(this._viewParameters);return t.updateAll(this),t}}class Ui extends zt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=St.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){ft.initialize(t,i),this._defaultDrawingOptions=new Qh,this._defaultDrawnSignatureOptions=new Zh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return xt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:a,mustSmooth:o,areContours:l,description:u,uuid:d,heightInPage:f}=this.#n,{rawDims:{pageWidth:g,pageHeight:y},rotation:b}=this.parent.viewport,A=ca.processDrawnLines({lines:a,pageWidth:g,pageHeight:y,rotation:b,innerMargin:Ui._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(A,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:a,height:o}=this.#n,l=Math.max(a,o),u=ca.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:s,width:a,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,a){const{x:o,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof Oh,this.description=s;let d;this.#t?d=Ui.getDefaultDrawingOptions():(d=Ui._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let g=i/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return ca.process(t,i,s,a,Ui._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:a},rotation:o}=this.parent.viewport;return ca.extractContoursFromText(t,i,s,a,o,Ui._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return ca.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:Ui._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Ui.getDefaultDrawingOptions():(this._drawingOptions=Ui._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(o),t?(o.paths={lines:i,points:s},o.uuid=this.#i,o.isCopy=!0):o.lines=i,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,i,s,a,o,l){return l.areContours?Oh.deserialize(t,i,s,a,o,l):Or.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){const a=await super.deserialize(t,i,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#i=t.uuid,a}}class wx extends ft{#t=null;#e=null;#n=null;#i=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=St.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){ft.initialize(t,i)}static isHandlingMimeForPasting(t){return Eh.includes(t)}static paste(t,i){i.pasteEditor({mode:St.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:o,height:l,channels:a.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),i&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#p(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#a){const s=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Eh.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#p();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#p()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#m()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[a,o]=this.pageDimensions,l=.75;if(this.width)i=this.width*a,s=this.height*o;else if(i>l*a||s>l*o){const d=Math.min(l*a/i,l*o/s);i*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/a,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:a,height:o}=this.#t,l=new Hi;let u=this.#t,d=a,f=o,g=null;if(i){if(a>i||o>i){const k=Math.min(i/a,i/o);d=Math.floor(a*k),f=Math.floor(o*k)}g=document.createElement("canvas");const b=g.width=Math.ceil(d*l.sx),A=g.height=Math.ceil(f*l.sy);this.#l||(u=this.#u(b,A));const w=g.getContext("2d");w.filter=this._uiManager.hcmFilter;let x="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":GA.isDarkMode&&(x="#8f8f9d",E="#42414d");const S=15,M=S*l.sx,_=S*l.sy,R=new OffscreenCanvas(M*2,_*2),O=R.getContext("2d");O.fillStyle=x,O.fillRect(0,0,M*2,_*2),O.fillStyle=E,O.fillRect(0,0,M,_),O.fillRect(M,_,M,_),w.fillStyle=w.createPattern(R,"repeat"),w.fillRect(0,0,b,A),w.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let y=null;if(s){let b,A;if(l.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,a>t||o>t){const E=Math.min(t/a,t/o);b=Math.floor(a*E),A=Math.floor(o*E),this.#l||(u=this.#u(b,A))}const x=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});x.drawImage(u,0,0,u.width,u.height,0,0,b,A),y={width:b,height:A,data:x.getImageData(0,0,b,A).data}}return{canvas:g,width:d,height:f,imageData:y}}#u(t,i){const{width:s,height:a}=this.#t;let o=s,l=a,u=this.#t;for(;o>2*t||l>2*i;){const d=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(u,0,0,d,f,0,0,o,l),u=g.transferToImageBitmap()}return u}#m(){const[t,i]=this.parentDimensions,{width:s,height:a}=this,o=new Hi,l=Math.ceil(s*t*o.sx),u=Math.ceil(a*i*o.sy),d=this.#s;if(!d||d.width===l&&d.height===u)return;d.width=l,d.height=u;const f=this.#l?this.#t:this.#u(l,u),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,a=Math.round(this.width*i*va.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*va.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(a,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let a=null,o=!1;if(t instanceof z0){const{data:{rect:x,rotation:E,id:S,structParent:M,popupRef:_,richText:R,contentsObj:O,creationDate:k,modificationDate:F},container:j,parent:{page:{pageNumber:X}},canvas:K}=t;let Q,et;K?(delete t.canvas,{id:Q,bitmap:et}=s.imageManager.getFromCanvas(j.id,K),K.remove()):(o=!0,t._hasNoCanvas=!0);const ot=(await i._structTree.getAriaAttributes(`${ua}${S}`))?.get("aria-label")||"";a=t={annotationType:St.STAMP,bitmapId:Q,bitmap:et,pageIndex:X-1,rect:x.slice(0),rotation:E,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:ot},isSvg:!1,structParent:M,popupRef:_,richText:R,comment:O?.str||null,creationDate:k,modificationDate:F}}const l=await super.deserialize(t,i,s),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:g,isSvg:y,accessibilityData:b}=t;o?(s.addMissingCanvas(t.id,l),l.#o=!0):g&&s.imageManager.isValidId(g)?(l.#e=g,d&&(l.#t=d)):l.#i=f,l.#l=y;const[A,w]=l.pageDimensions;return l.width=(u[2]-u[0])/A,l.height=(u[3]-u[1])/w,b&&(l.altTextData=b),l._initialData=a,t.comment&&l.setCommentData(t),l.#d=!!a,l}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:o}=this.serializeAltText(!1);if(!a&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const l=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=i.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===i,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class un{#t;#e=!1;#n=null;#i=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#p=null;#g=-1;#u;static _initialized=!1;static#m=new Map([we,Wh,wx,ce,Ui].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:a,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:d,viewport:f,l10n:g}){const y=[...un.#m.values()];if(!un._initialized){un._initialized=!0;for(const b of y)b.initialize(g,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=i,this.div=s,this.#t=o,this.#n=l,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===St.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#x(),t){case St.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case St.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case St.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===St.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of un.#m.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#p?.abort(),this.#p=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#p){this.#p=new AbortController;const a=this.#u.combinedSignal(this.#p);this.#h.div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:d,timeStamp:f}=o,g=this.#g;if(f-g>500){this.#g=f;return}this.#g=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${Er}[0-9]+$`);for(const E of b)if(w.test(E.id)){A=E.id;break}if(!A)return;const x=this.#r.get(A);x?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),x.dblclick(o))},{signal:a,capture:!0})}const t=this.#n,i=[];if(t){const a=new Map,o=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else o.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const l=t.getEditableAnnotations();for(const u of l){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=o.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const a of un.#m.values())s.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=be.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ce.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),ft.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#r.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return un.#m.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#C(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#S(),o=this.getNextId(),l=this.#C({parent:this,id:o,x:s,y:a,uiManager:this.#u,isCentered:!0,...i});l&&this.add(l)}async deserialize(t){return await un.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const a=this.getNextId(),o=this.#C({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:i,width:s,height:a}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,i),u=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,i+a),f=(o+u)/2-t,g=(l+d)/2-i,[y,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=be.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===St.STAMP||s===St.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===St.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=be.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,s){const a=this.#u.findParent(i,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#x(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ds(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#x();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ds(this.div,{rotation:s}),i!==s)for(const a of this.#r.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Me{#t=null;#e=new Map;#n=new Map;static#i=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return xt(this,"_svgFactory",new bl)}static#a(t,[i,s,a,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*i}%`,l.width=`${100*a}%`,l.height=`${100*o}%`}#r(){const t=Me._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Me._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${i}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const o=Me._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),a}#o(t,i){for(const[s,a]of Object.entries(i))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,i=!1,s=!1){const a=Me.#i++,o=this.#r(),l=Me._svgFactory.createElement("defs");o.append(l);const u=Me._svgFactory.createElement("path");l.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(a,u);const f=s?this.#s(l,d):null,g=Me._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(o,t),this.#e.set(a,o),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Me.#i++,a=this.#r(),o=Me._svgFactory.createElement("defs");a.append(o);const l=Me._svgFactory.createElement("path");o.append(l);const u=`path_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(i){const y=Me._svgFactory.createElement("mask");o.append(y),d=`mask_${s}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const b=Me._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=Me._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Me._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const g=f.cloneNode();return a.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:a,rootClass:o,path:l}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&Me.#a(u,a),o){const{classList:d}=u;for(const[f,g]of Object.entries(o))d.toggle(f,g)}if(l){const f=u.firstElementChild.firstElementChild;this.#o(f,l)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Nh};globalThis.pdfjsLib={AbortException:Hn,AnnotationEditorLayer:un,AnnotationEditorParamsType:Ot,AnnotationEditorType:St,AnnotationEditorUIManager:Gn,AnnotationLayer:Kh,AnnotationMode:Pn,AnnotationType:ge,applyOpacity:XA,build:Z1,ColorPicker:Si,createValidAbsoluteUrl:a0,CSSConstants:VA,DOMSVGFactory:bl,DrawLayer:Me,FeatureTest:be,fetchData:Dr,findContrastColor:YA,getDocument:D0,getFilenameFromUrl:jA,getPdfFilenameFromUrl:PA,getRGB:Nr,getUuid:o0,getXfaPageViewport:IA,GlobalWorkerOptions:ya,ImageKind:hl,InvalidPDFException:wh,isDataScheme:_l,isPdfFile:Ph,isValidExplicitDest:n1,MathClamp:De,noContextMenu:Ei,normalizeUnicode:FA,OPS:Cr,OutputScale:Hi,PagesMapper:jt,PasswordResponses:TA,PDFDataRangeTransport:R0,PDFDateString:Sh,PDFWorker:_r,PermissionFlag:CA,PixelsPerInch:va,RenderingCancelledException:jh,renderRichText:c0,ResponseException:pl,setLayerDimensions:ds,shadow:xt,SignatureExtractor:ca,stopEvent:re,SupportedImageMimeTypes:Eh,TextLayer:li,TouchManager:Ml,updateUrlHash:r0,Util:nt,VerbosityLevel:Sl,version:Q1,XfaLayer:l0};const Sx=({isOpen:h,onClose:t,onConfirm:i})=>{const[s,a]=ct.useState(!1);return h?T.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl relative overflow-hidden flex flex-col max-h-[90vh]",children:[T.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-6 md:p-8 flex flex-col h-full overflow-hidden",children:[T.jsx("h2",{className:"text-lg md:text-xl font-bold text-[#007db5] text-center uppercase tracking-wider mb-6 leading-tight",children:"In order to proceed, please review and accept the following:"}),T.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 mb-6 text-sm text-gray-600 leading-relaxed space-y-4 custom-scrollbar",children:[T.jsx("p",{children:'Befit Coolers, LLC ("Befit", "Our") provides our customizer services to you through our website(s) located at Befit.com (the "Site") and related technologies (the "Service"). As a condition to the access and use of the Service you agree to the terms and conditions below:'}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:"Representation and Warranties"}),T.jsx("p",{children:'You represent and warrant that you: a) are of legal age to enter and agree to these terms and conditions; b) if you are using the Services on behalf of a company or other organization, then you are entering into this agreement on behalf of yourself and such organization, and you represent that you have the legal authority to bind such organization to these terms of service; c) you are solely responsible for, images, information, photographs, graphics, messages, and other materials ("content") that you make available to Befit by uploading, posting, publishing, or displaying via the Service (collectively, "User Content"); d) you own all right, title and interest in and to such User Content; e) the User Content is not unlawful, harmful, threatening, tortious, defamatory, vulgar, obscene, libelous, invasive of anothers privacy, hateful, or racially, ethnically or otherwise objectionable, is not connected to any political affiliations, associations or candidates, does not infringe on any patent, trademark, copyright, trade secret, or other proprietary rights of any third party (this includes, but is not limited to, sport teams and collegiate licensed logos or phrases), and does not otherwise violate anyones rights or other categories listed in our FAQ.'}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:"Limitation of Liability"}),T.jsx("p",{className:"uppercase",children:"You expressly understand and agree that Befit will not be liable for any indirect, incidental, special, consequential, exemplary damages, or damages for loss of profits including damages for loss of goodwill, use, or other intangible losses (even if Befit has been advised of the possibility of such damages), whether based on contract, tort, negligence, strict liability, or otherwise, resulting from: (a) the products or the use or the inability to use the service; or (b) the user content. Some jurisdictions do not allow the limitation or exclusion of liability for incidental or consequential damages, so some of the above may not apply to you. In such jurisdictions, liability is limited to the fullest extent permitted by law."}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:"Indemnification"}),T.jsx("p",{children:'You agree to defend, indemnify, and hold harmless Befit, its affiliates, and its and their respective officers, employees, directors, service providers, licensors, and agents (collectively, the "Befit Parties") from any and all losses, damages, expenses, including reasonable attorneys fees, rights, claims, actions of any kind, and injury arising out of or relating to your use of the Service, any User Content, your connection to the Service, your violation of these this agreement, or your violation of any rights of another.'})]}),T.jsxs("label",{className:"flex items-start space-x-3 mb-8 cursor-pointer group flex-shrink-0",children:[T.jsx("div",{className:"flex items-center h-5 mt-0.5",children:T.jsx("input",{type:"checkbox",checked:s,onChange:o=>a(o.target.checked),className:"w-5 h-5 rounded border-gray-300 text-[#007db5] focus:ring-[#007db5] cursor-pointer transition-colors"})}),T.jsx("span",{className:"text-sm font-semibold text-gray-800 group-hover:text-black transition-colors",children:"I agree to these terms and conditions"})]}),T.jsxs("div",{className:"flex space-x-4 flex-shrink-0",children:[T.jsx("button",{onClick:t,className:"flex-1 py-3 bg-[#007db5] text-white font-bold uppercase tracking-widest text-xs hover:bg-[#006da0] transition-colors rounded shadow-md",children:"Cancel"}),T.jsx("button",{onClick:i,disabled:!s,className:`flex-1 py-3 font-bold uppercase tracking-widest text-xs rounded transition-all shadow-md ${s?"bg-[#007db5] text-white hover:bg-[#006da0]":"bg-[#9CA3AF] text-white cursor-not-allowed"}`,children:"Submit"})]})]})]})}):null};ya.workerSrc=new URL("./pdf.worker.min.js",import.meta.url).toString();const Ex=1024,cl=(h,t,i,s,a,o)=>{let l=0,u=0,d=0,f=0;const g=Math.max(0,s),y=Math.max(0,a),b=Math.min(t,g+o),A=Math.min(i,y+o);for(let w=y;w<A;w++)for(let x=g;x<b;x++){const E=(w*t+x)*4;l+=h[E],u+=h[E+1],d+=h[E+2],f++}return f?{r:l/f,g:u/f,b:d/f}:{r:0,g:0,b:0}},qp=(h,t)=>{const i=h.r-t.r,s=h.g-t.g,a=h.b-t.b;return Math.sqrt(i*i+s*s+a*a)},Cx=(h,t={})=>{const{invert:i=!1,threshold:s=170,softness:a=40,gamma:o=.7}=t;for(let l=0;l<h.length;l+=4){const u=h[l],d=h[l+1],f=h[l+2],g=.299*u+.587*d+.114*f;let b=(i?g-s:s-g)/a*255;b<0&&(b=0),b>255&&(b=255),o!==1&&b>0&&(b=Math.pow(b/255,o)*255),b<25?b=0:b>230&&(b=255),h[l]=0,h[l+1]=0,h[l+2]=0,h[l+3]=Math.round(b)}},Tx=h=>{const t=h.naturalWidth||h.width,i=h.naturalHeight||h.height;if(!t||!i)return null;const s=Math.min(1,Ex/Math.max(t,i)),a=Math.max(1,Math.round(t*s)),o=Math.max(1,Math.round(i*s)),l=document.createElement("canvas");l.width=a,l.height=o;const u=l.getContext("2d",{willReadFrequently:!0});if(!u)return null;u.drawImage(h,0,0,a,o);let d;try{d=u.getImageData(0,0,a,o)}catch(y){return console.warn("Failed to read image data for metal mask:",y),null}const f=d.data;let g=!1;for(let y=3;y<f.length;y+=4)if(f[y]<250){g=!0;break}if(g)for(let y=0;y<f.length;y+=4){const b=f[y+3];f[y]=0,f[y+1]=0,f[y+2]=0,f[y+3]=b}else{const y=Math.max(2,Math.round(Math.min(a,o)*.04)),b=[cl(f,a,o,0,0,y),cl(f,a,o,a-y,0,y),cl(f,a,o,0,o-y,y),cl(f,a,o,a-y,o-y,y)],A=b.reduce((j,X)=>({r:j.r+X.r/b.length,g:j.g+X.g/b.length,b:j.b+X.b/b.length}),{r:0,g:0,b:0});let w=0;for(const j of b)w=Math.max(w,qp(j,A));const x=.299*A.r+.587*A.g+.114*A.b,E=x<130,S=E?Math.min(230,x+45):Math.max(25,x-45),M=45,_=Math.min(100,Math.max(14,w*2.2)),R=18;let O=0;const k=a*o;for(let j=0;j<f.length;j+=4){const X=f[j],K=f[j+1],Q=f[j+2];if(f[j+3]<10){f[j]=0,f[j+1]=0,f[j+2]=0,f[j+3]=0;continue}const ot=qp({r:X,g:K,b:Q},A);let J=0;ot>_&&(ot<_+R?J=Math.round((ot-_)/R*255):J=255);const mt=.299*X+.587*K+.114*Q;let G=(E?mt-S:S-mt)/M*255;G<0&&(G=0),G>255&&(G=255);let Z=Math.max(J,G);Z>0&&Z<255&&(Z=Math.pow(Z/255,.65)*255),Z<20?Z=0:Z>230&&(Z=255),Z>0&&O++,f[j]=0,f[j+1]=0,f[j+2]=0,f[j+3]=Z}const F=O/Math.max(1,k);(F>.95||F<.01)&&Cx(f,{invert:E,threshold:S,softness:M,gamma:.7})}return u.putImageData(d,0,0),l.toDataURL("image/png")},_x=({setView:h,setGraphic:t,graphicInput:i,activeTab:s,selectedColor:a})=>{const o=ct.useRef(null),[l,u]=ct.useState(!1),[d,f]=ct.useState(!1),[g,y]=ct.useState(null),[b,A]=ct.useState(null),w=.67,x=1.5,E=async X=>{const K=X.target.files[0];if(!K)return;y(null),f(!0),u(!1),A(null);const Q=K.type,et=K.name.toLowerCase();try{let ot="";if(Q==="application/pdf"||et.endsWith(".pdf"))try{ot=await R(K)}catch(mt){console.error("PDF Render error:",mt),y("Failed to render PDF preview. File may be corrupted or password protected."),f(!1);return}else ot=await _(K);const J=new Image;J.onload=()=>{const mt=(J.naturalWidth||J.width)/(J.naturalHeight||J.height);if(mt<w||mt>x){y(`Image aspect ratio (${mt.toFixed(2)}) is outside the allowed range. Please use an image closer to square (between 2:3 and 3:2).`),f(!1),o.current&&(o.current.value="");return}let B=null;try{B=Tx(J)}catch(G){console.warn("Failed to generate metal mask:",G)}A({src:ot,name:K.name,isUpload:!0,scale:.5,fileType:et.split(".").pop(),maskSrc:B}),f(!1),u(!0)},J.onerror=()=>{y("Failed to load image. Please check the file."),f(!1)},J.src=ot}catch(ot){console.error(ot),y("Error processing file."),f(!1)}},S=()=>{b&&(t(b),A(null),u(!1))},M=()=>{A(null),u(!1),o.current&&(o.current.value="")},_=X=>new Promise((K,Q)=>{const et=new FileReader;et.onload=ot=>K(ot.target.result),et.onerror=ot=>Q(ot),et.readAsDataURL(X)}),R=async X=>{const K=await X.arrayBuffer(),et=await(await D0({data:K,disableWorker:!0}).promise).getPage(1),ot=et.getViewport({scale:2}),J=document.createElement("canvas");J.width=ot.width,J.height=ot.height;const mt=J.getContext("2d");return await et.render({canvasContext:mt,viewport:ot}).promise,J.toDataURL("image/png")},O=()=>{t(null),o.current&&(o.current.value="")},F=s==="FRONT"?"FRONT":"BACK",j=a==="white"?"linear-gradient(90deg, #b8b7b7ff 0%, #9e9e9e 50%, #656565 100%)":"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)";return T.jsxs("div",{className:"w-full h-full flex flex-col p-4 md:p-8 overflow-y-auto pb-32",children:[T.jsx("input",{type:"file",ref:o,onChange:E,accept:"image/png, image/jpeg, image/jpg, image/bmp, image/svg+xml, application/pdf",className:"hidden"}),T.jsx(wl,{setView:h,activeView:"upload",activeTab:s}),T.jsx("div",{className:"mb-6",children:T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-[#002C5F] font-bold text-sm tracking-widest uppercase hover:text-brand-blue transition-colors group",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 transform group-hover:-translate-x-1 transition-transform",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),F]})}),g&&T.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-3",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-xs font-bold text-red-700 uppercase tracking-wide mb-1",children:"Upload Failed"}),T.jsx("p",{className:"text-xs text-red-600",children:g})]})]}),d?T.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[T.jsx("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Processing..."})]}):i?T.jsxs("div",{className:"flex flex-col items-center w-full animate-fade-in-up",children:[T.jsx("div",{className:"w-full aspect-square max-w-[200px] border-2 border-dashed border-gray-300 rounded bg-gray-50 flex items-center justify-center p-4 mb-6 relative overflow-hidden",children:i.maskSrc?T.jsx("div",{className:"w-full h-full",style:{maskImage:`url(${i.maskSrc})`,WebkitMaskImage:`url(${i.maskSrc})`,maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:j,filter:"contrast(1.1) brightness(1.1)",opacity:.95}}):T.jsx("img",{src:i.src,alt:"Preview",className:"max-w-full max-h-full object-contain",style:{filter:"grayscale(100%) contrast(1.2) brightness(1.2)"}})}),T.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 w-full",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:"SIZE"}),T.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[Math.round((i.scale||.5)*100),"%"]})]}),T.jsx("input",{type:"range",min:"0.2",max:"1.0",step:"0.05",value:i.scale||.5,onChange:X=>t({...i,scale:parseFloat(X.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#002C5F]"})]}),T.jsx("button",{onClick:O,className:"text-xs font-bold text-red-500 underline hover:text-red-700 uppercase tracking-wider mb-2",children:"Remove Image"}),T.jsx("p",{className:"text-[10px] text-gray-400 text-center",children:"Review your placement on the bottle preview to the left."})]}):T.jsxs("div",{className:"flex flex-col w-full animate-fade-in-up",children:[T.jsx("button",{onClick:()=>o.current.click(),className:"w-full py-4 bg-white border-2 border-[#002C5F] text-[#002C5F] font-bold text-sm tracking-widest uppercase rounded hover:bg-gray-50 transition-colors mb-6 shadow-sm",children:"UPLOAD DESIGN"}),T.jsx("p",{className:"text-center text-xs text-gray-700 font-semibold mb-8 uppercase tracking-wide",children:"Accepted file types: PNG, JPG,SVG and PDF"}),T.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-8",children:[T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsx("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),T.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),T.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),T.jsxs("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:["Image must be 300 px",T.jsx("br",{}),"(W or H)"]})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsx("span",{className:"font-serif font-bold text-2xl",children:"TM"}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:"No trademark infringement"})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsx("span",{className:"font-sans font-bold text-3xl",children:""}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:"No copyright infringement"})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),T.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:"No photos"})]})]}),T.jsx("div",{className:"w-full h-px bg-gray-200 mb-6"}),T.jsxs("div",{className:"mb-4 space-y-4",children:[T.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-widest mb-4 text-center",children:"INSTRUCTIONS"}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:"Orders containing offensive, inappropriate, or copyrighted content may be cancelled without further notice."}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:"Please verify your preview carefully: check for any unwanted lines or spots and crop them out."}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:"For best results, commence with a sketch on white paper using a thick dark marker. Keep it simple and take a photo in a well-lit area without shadows."}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:"Photographs will be converted to black and white, and results may vary. Proceed with high-contrast images for optimal engraving quality."})]})]}),T.jsx(Sx,{isOpen:l,onClose:M,onConfirm:S})]})},Ne=[{name:"ITC Modern",style:{fontFamily:"ITC Modern",fontSize:"1.8em"},maxLength:1,frontSize:"1em",backSize:"5em",frontSizeMobile:"0.7em",backSizeMobile:"3.5em"},{name:"Nexa Script",style:{fontFamily:"Nexa Script",fontSize:"1.8em"},maxLength:1,frontSize:"1em",backSize:"5em",frontSizeMobile:"0.7em",backSizeMobile:"3.5em"},{name:"Roman",style:{fontFamily:"Roman",fontSize:"1.2em"},middleLarger:!0,frontSize:"0.8em",backSize:"2.2em",frontSizeMobile:"0.55em",backSizeMobile:"1.5em"},{name:"rJ#",style:{fontFamily:"Two Character Circle",fontSize:"1.2em"},frontSize:"1em",backSize:"5em",frontSizeMobile:"0.6em",backSizeMobile:"3.5em",useCircleGlyphs:!0},{name:"N-Gram",style:{fontFamily:"Two Character N-Gram",fontSize:"1.2em",marginLeft:"0.1em"},frontSize:"1em",backSize:"4em",frontSizeMobile:"0.6em",backSizeMobile:"2.7em",useNGramGlyphs:!0},{name:"Vine",style:{fontFamily:"Vine",fontSize:"1.2em",letterSpacing:".55em",marginLeft:"0.6em"},frontSize:"0.8em",backSize:"1.5em",frontSizeMobile:"0.5em",backSizeMobile:"1em"}],U0={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"0",K:"!",L:"@",M:"#",N:"$",O:"%",P:"^",Q:"&",R:"*",S:"(",T:")",U:"-",V:"+",W:"[",X:"]",Y:"\\",Z:":"},Bl=(h,t)=>{if(!h)return"";const i=h.toUpperCase();if(h.length===2)return i[0].toLowerCase()+i[1];if(h.length===3){const s=i[0].toLowerCase(),a=i[1],o=U0[i[2]]||i[2];return s+a+o}return h},Fl=h=>h===2?"Two Character Circle":h===3?"Three Character Circle":"Two Character Circle",zl=h=>{if(!h)return"";const t=h.toUpperCase();if(h.length===2)return"?"+t[0].toLowerCase()+t[1];if(h.length===3){const i=t[0].toLowerCase(),s=t[1],a=U0[t[2]]||t[2];return"?"+i+s+a}return h},jl=h=>h===2?"Two Character N-Gram":h===3?"Three Character N-Gram":"Two Character N-Gram",Pl=h=>Ne.find(i=>i.name===h)?.useNGramGlyphs===!0,Ul=h=>Ne.find(i=>i.name===h)?.useCircleGlyphs===!0,fa=(h,t,i,s=!1)=>{const a=Ne.find(u=>u.name===h),o=s?`max(4px, min(${150/Math.max(1,i)}cqi, 14cqi))`:`max(4px, min(${150/Math.max(1,i)}cqi, 17cqi))`;if(!a)return o;let l;return s?l=t==="FRONT"?a.frontSizeMobile:a.backSizeMobile:l=t==="FRONT"?a.frontSize:a.backSize,l||o},Lr=(h,t)=>{const i=Ne.find(s=>s.name===h);return i?i.useCircleGlyphs||i.useNGramGlyphs?t===2||t===3:(i.maxLength===1,t>=1):!1},I0={FRONT:{text:{top:"32.4%",left:"36%",right:"36%",bottom:"62%"},monogram:{top:"32.4%",left:"36%",right:"36%",bottom:"61%"},graphic:{top:"33%",left:"36%",right:"36%",bottom:"62%"},boundary:{top:"32.5%",left:"35%",right:"34%",bottom:"61%"}},BACK:{text:{top:"39%",left:"36%",right:"36%",bottom:"31%"},textVertical:{top:"40%",left:"36%",right:"36%",bottom:"25%"},monogram:{top:"33%",left:"36%",right:"36%",bottom:"31%"},graphic:{top:"33%",left:"36%",right:"36%",bottom:"31%"},boundary:{top:"40.5%",left:"35.5%",right:"36%",bottom:"31%"},boundaryVertical:{top:"39%",left:"35.5%",right:"36%",bottom:"25%"}}},H0={FRONT:{text:{top:"32.4%",left:"36%",right:"36%",bottom:"62%"},monogram:{top:"31%",left:"36%",right:"36%",bottom:"60%"},graphic:{top:"27.5%",left:"36%",right:"36%",bottom:"56.6%"},boundary:{top:"32.5%",left:"35%",right:"34%",bottom:"61%"}},BACK:{text:{top:"38%",left:"36%",right:"36%",bottom:"31%"},textVertical:{top:"40.5%",left:"38%",right:"38%",bottom:"27%"},monogram:{top:"37%",left:"36%",right:"36%",bottom:"31%"},graphic:{top:"33%",left:"22%",right:"22%",bottom:"31%"},boundary:{top:"39.5%",left:"36%",right:"36%",bottom:"31%"},boundaryVertical:{top:"38%",left:"36%",right:"36%",bottom:"21%"}}},vl={mobile:{FRONT:.32,BACK:.45},test:{FRONT:.2,BACK:.4},desktop:{FRONT:.65,BACK:.75}},yh=({side:h,customization:t,selectedColor:i,selectedFont:s,selectedMonogram:a,fonts:o,isMobile:l,isImageLoading:u,setIsImageLoading:d,view:f})=>{const g=f==="capture",y=h==="BACK"&&t.BACK?.isVertical,b=gt=>{const tt=gt[h];return{...tt,text:y&&tt.textVertical?tt.textVertical:tt.text,boundary:y&&tt.boundaryVertical?tt.boundaryVertical:tt.boundary}},w={FRONT:{text:"top-[30%] md:top-[32.4%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[62%] md:bottom-[62%]",monogram:"top-[25.2%] md:top-[32.4%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[60%] md:bottom-[61%]",graphic:"top-[26%] md:top-[33%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[61%] md:bottom-[62%]",boundary:"top-[31%] md:top-[32.5%] left-[35%] md:left-[35%] right-[34%] md:right-[34%] bottom-[63%] md:bottom-[61%]",zoom:"scale-[1.7] translate-y-[25%] md:scale-[2.5] md:translate-y-[25%]"},BACK:{text:h==="BACK"&&t.BACK?.isVertical?"top-[38%] md:top-[40%] left-[38%] md:left-[36%] right-[38%] md:right-[36%] bottom-[25%] md:bottom-[25%]":"top-[38%] md:top-[39%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[31%] md:bottom-[31%]",monogram:"top-[37%] md:top-[33%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[31%] md:bottom-[31%]",graphic:"top-[33%] md:top-[33%] left-[20%] md:left-[36%] right-[20%] md:right-[36%] bottom-[31%] md:bottom-[31%]",boundary:h==="BACK"&&t.BACK?.isVertical?"top-[38%] md:top-[39%] left-[36%] md:left-[35.5%] right-[36%] md:right-[36%] bottom-[21%] md:bottom-[25%]":"top-[39.5%] md:top-[40.5%] left-[36%] md:left-[35.5%] right-[36%] md:right-[36%] bottom-[31%] md:bottom-[31%]",zoom:"scale-[1.4] translate-y-[1%] md:scale-[2.5] md:translate-y-[-4%]"}}[h],x=b(g&&l?H0:I0),E=t[h],S=E.text,M=E.monogram,_=E.graphic,R=_?.isUpload?_.maskSrc||_.src:_?.src,[O,k]=ct.useState(!1),[F,j]=ct.useState(null);ct.useEffect(()=>{if(R){if(g){j(R);return}if(R===F)return;k(!0);const gt=new Image;gt.onload=()=>{j(R),k(!1)},gt.onerror=()=>{j(R),k(!1)},gt.src=R}else j(null),k(!1)},[R,g]);const X=()=>{d&&d(!1)},K=gt=>{console.warn("Image load error",gt.target.src),d&&d(!1)},Q=gt=>g?{position:"absolute",...x[gt]}:{},et=gt=>g?"absolute":`absolute ${w[gt]}`,ot=g?{width:"300px",height:"500px",transform:"none",marginBottom:0,position:"relative"}:{},J=g?"":`relative mb-4 md:mb-2 transition-transform duration-300 ease-in-out w-[240px] h-[360px] md:w-[420px] md:h-[700px] ${f&&f!=="main"?w.zoom:""}`,B=`${(l?vl.mobile:vl.desktop)[h]*100}%`,G="linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",Z=_&&(!_.isUpload||_.maskSrc)?F:null,bt=ct.useRef(null),vt=ct.useRef(null),[D,H]=ct.useState({width:0,height:0}),[W,it]=ct.useState(null),[ht,yt]=ct.useState(0),ut=o.find(gt=>gt.name===s)?.style||{},Ht=ut.fontFamily||"sans-serif";ut.fontWeight,ut.fontStyle,ct.useEffect(()=>{let gt=!1;return(async()=>{try{document?.fonts?.load&&await document.fonts.load(`16px ${Ht}`),document?.fonts?.ready&&await document.fonts.ready}finally{gt||yt(st=>st+1)}})(),()=>{gt=!0}},[Ht]),ct.useLayoutEffect(()=>{const gt=bt.current;if(!gt)return;const tt=()=>{H({width:gt.offsetWidth||0,height:gt.offsetHeight||0})};tt();let st;return typeof ResizeObserver<"u"&&(st=new ResizeObserver(tt),st.observe(gt)),window.addEventListener("resize",tt),()=>{window.removeEventListener("resize",tt),st&&st.disconnect()}},[h,g,l,i,E?.isVertical,!!S]);const Nt=ct.useMemo(()=>D.width?Math.max(1,(h==="FRONT"?.18:.54)*D.width):null,[D.width,h]),ui=ct.useMemo(()=>{if(!(h==="BACK"&&E?.isVertical)||!S||!D.height)return null;const tt=D.height/100,st=Math.max(1,S.length),Tt=Math.max(8,Math.min(150/st*tt,54*tt)),Wt=Math.max(1,...String(S).split(`
`).map(Ri=>Math.max(1,Ri.length))),Le=1.2;if(Wt>3)return Tt;const Pe=l?.9:.92,dn=D.height*Pe/(Wt*Le);let Di=Math.min(Tt,dn);if(Wt<=2&&D.width){const Ri=l?.86:.9,fn=D.width*Ri/Le;Di=Math.min(Di,fn)}return Math.max(8,Di)},[h,E?.isVertical,S,D.height,D.width,l]);return ct.useLayoutEffect(()=>{const gt=h==="BACK"&&E?.isVertical;if(!S||gt){it(null);return}if(!Nt||!D.width||!D.height)return;const tt=D.width,st=D.height,Tt=vt.current;if(!Tt)return;const Wt=l?.91:.92,Le=tt*Wt,Pe=st*Wt,dn=Ni=>{Tt.style.fontSize=`${Ni}px`;const Gi=Tt.offsetWidth||0,Br=Tt.offsetHeight||0;return Gi<=Le&&Br<=Pe};let Di=1,Ri=Nt,fn=1;for(let Ni=0;Ni<16;Ni++){const Gi=(Di+Ri)/2;dn(Gi)?(fn=Gi,Di=Gi):Ri=Gi}const Il=l?.92:.9,Hl=!g&&!l&&f&&f!=="main"?.95:1,ke=Math.max(1,fn*Il*Hl);it(Ni=>Ni&&Math.abs(Ni-ke)<.05?Ni:ke)},[S,h,E?.isVertical,Nt,D.width,D.height,ht,l,g,f]),T.jsx("div",{className:"flex flex-col items-center",children:T.jsxs("div",{className:J,style:ot,children:[T.jsx("img",{src:`bottle/${h==="FRONT"?"front":"back"}/${i}${h==="BACK"?"back":""}.webp`,alt:`Yeti Bottle ${h}`,loading:"eager",className:`w-full h-full object-contain mix-blend-multiply drop-shadow-2xl transition-opacity duration-300 ${u?"opacity-0":"opacity-100"}`,onLoad:X,onError:K}),u&&!g&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-10 h-10 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin"})}),S&&T.jsxs("div",{ref:bt,className:`${et("text")} flex items-center justify-center z-20 pointer-events-none overflow-hidden`,style:{containerType:"inline-size",...Q("text"),writingMode:h==="BACK"&&E.isVertical?"vertical-rl":void 0,textOrientation:h==="BACK"&&E.isVertical?"sideways":void 0,glyphOrientationVertical:h==="BACK"&&E.isVertical?"90deg":void 0},children:[!(h==="BACK"&&E.isVertical)&&Nt&&T.jsx("span",{ref:vt,"aria-hidden":"true",style:{position:"absolute",left:-99999,top:-99999,visibility:"hidden",pointerEvents:"none",...o.find(gt=>gt.name===s)?.style,fontSize:`${Nt}px`,letterSpacing:"0.5px",whiteSpace:"pre",wordBreak:"normal",overflowWrap:"normal",lineHeight:1.2,display:"inline-block"},children:S}),T.jsx("span",{className:"text-center block",style:{...o.find(gt=>gt.name===s)?.style,fontSize:h==="BACK"&&E.isVertical?ui?`${ui}px`:`max(8px, min(${150/Math.max(1,S.length)}cqi, 54cqi))`:W?`${W}px`:h==="FRONT"?`max(4px, min(${100/Math.max(1,S.length)}cqi, 18cqi))`:`max(8px, min(${150/Math.max(1,S.length)}cqi, 54cqi))`,letterSpacing:"0.5px",...h==="BACK"&&E.isVertical?{wordBreak:"break-word",whiteSpace:"pre-wrap"}:{wordBreak:"normal",overflowWrap:"normal",whiteSpace:"pre"},lineHeight:1.2,fontVariantEmoji:"text",verticalAlign:"middle",textRendering:"geometricPrecision",boxSizing:"border-box",width:h==="BACK"&&E.isVertical?"fit-content":"100%",height:h==="BACK"&&E.isVertical?"100%":void 0,maxWidth:"100%",display:h==="BACK"&&E.isVertical?"inline-block":"block",marginInline:h==="BACK"&&E.isVertical?"auto":void 0,background:"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",WebkitTextFillColor:"transparent"},children:S})]},`text-${i}`),_&&T.jsxs("div",{className:`${et("graphic")} flex items-center justify-center z-20 pointer-events-none overflow-hidden`,style:{containerType:"inline-size",transform:_.scale?`scale(${_.scale})`:"none",transformOrigin:"center center",...Q("graphic")},children:[O&&!g&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-[#002C5F] rounded-full animate-spin"})}),F&&!O&&T.jsx(T.Fragment,{children:Z?T.jsx("div",{className:"w-full h-full transition-opacity duration-200",style:{maskImage:`url(${Z})`,WebkitMaskImage:`url(${Z})`,maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:G,filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",opacity:.95,maxHeight:B,maxWidth:B}}):T.jsx("img",{src:_.src,alt:_.name||"Uploaded image",className:"w-full h-full object-contain transition-opacity duration-200",style:{filter:"grayscale(100%) contrast(1.2) brightness(1.2)",maxHeight:B,maxWidth:B}})})]},`graphic-${i}-${F}`),M&&Lr(a,M.length)&&T.jsx("div",{className:`${et("monogram")} flex items-center justify-center z-20 pointer-events-none`,style:{containerType:"inline-size",...Q("monogram")},children:Ul(a)?T.jsx("span",{className:"text-center whitespace-nowrap block",style:{fontFamily:Fl(M.length),fontSize:fa(a,h,M.length,g?!1:l),lineHeight:1.4,background:"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:Bl(M)}):Pl(a)?T.jsx("span",{className:"text-center whitespace-nowrap block",style:{...Ne.find(gt=>gt.name===a)?.style,fontFamily:jl(M.length),fontSize:fa(a,h,M.length,g?!1:l),lineHeight:1.4,background:"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:zl(M)}):Ne.find(gt=>gt.name===a)?.middleLarger&&M.length===3?T.jsxs("span",{className:"text-center whitespace-nowrap block",style:{...Ne.find(gt=>gt.name===a)?.style,fontSize:fa(a,h,M.length,g?!1:l),display:"inline-flex",alignItems:"center",lineHeight:1.4,background:"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:[T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"0.2em":"0.75em"},children:M[0]}),T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"1.3em":"1em"},children:M[1]}),T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"0.2em":"0.75em"},children:M[2]})]}):T.jsx("span",{className:"text-center whitespace-nowrap block",style:{...Ne.find(gt=>gt.name===a)?.style,fontSize:fa(a,h,M.length,g?!1:l),lineHeight:a==="Vine"?2.4:1.4,marginLeft:a==="Vine"?0:void 0,paddingLeft:a==="Vine"?"0.6em":void 0,paddingTop:a==="Vine"?"0.3em":void 0,paddingBottom:a==="Vine"?"0.3em":void 0,background:"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:Ne.find(gt=>gt.name===a)?.maxLength===1?M.charAt(0):M})},`monogram-${i}-${a}`),f&&f!=="main"&&!g&&T.jsx("div",{className:`absolute ${w.boundary} border border-dashed border-gray-400/60 rounded-sm pointer-events-none transition-opacity duration-300 ${u?"opacity-0":"opacity-100"}`})]})})},$p=({side:h,customization:t,selectedColor:i,selectedFont:s,selectedMonogram:a,fonts:o})=>{const l=t[h],u=l.text,d=l.monogram,f=l.graphic,g=i==="white"?"linear-gradient(90deg, #b8b7b7ff 0%, #9e9e9e 50%, #656565 100%)":"linear-gradient(90deg, #e6e5e5ff 0%, #9e9e9e 50%, #656565 100%)",y=f?f.isUpload?f.maskSrc:f.src:null,b=ct.useRef(null),A=ct.useRef(null),[w,x]=ct.useState({width:0,height:0}),[E,S]=ct.useState(null),[M,_]=ct.useState(0),R=o.find(j=>j.name===s)?.style||{},O=R.fontFamily||"sans-serif";R.fontWeight,R.fontStyle,ct.useEffect(()=>{let j=!1;return(async()=>{try{document?.fonts?.load&&await document.fonts.load(`16px ${O}`),document?.fonts?.ready&&await document.fonts.ready}finally{j||_(K=>K+1)}})(),()=>{j=!0}},[O]),ct.useLayoutEffect(()=>{const j=b.current;if(!j)return;const X=()=>{x({width:j.offsetWidth||0,height:j.offsetHeight||0})};X();let K;return typeof ResizeObserver<"u"&&(K=new ResizeObserver(X),K.observe(j)),window.addEventListener("resize",X),()=>{window.removeEventListener("resize",X),K&&K.disconnect()}},[h,l?.isVertical]);const k=ct.useMemo(()=>72,[]);ct.useLayoutEffect(()=>{const j=h==="BACK"&&l?.isVertical;if(!u||j){S(null);return}if(!w.width||!w.height)return;const X=Math.max(0,w.width-20),K=Math.max(0,w.height-20),Q=A.current;if(!Q)return;const et=.92,ot=X*et,J=K*et,mt=D=>{Q.style.fontSize=`${D}px`;const H=Q.offsetWidth||0,W=Q.offsetHeight||0;return H<=ot&&W<=J};let B=1,G=k,Z=1;for(let D=0;D<16;D++){const H=(B+G)/2;mt(H)?(Z=H,B=H):G=H}const vt=Math.max(1,Z*.9);S(D=>D&&Math.abs(D-vt)<.05?D:vt)},[u,h,l?.isVertical,w.width,w.height,k,M]);const F={width:"300px",height:"300px",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"};return T.jsxs("div",{style:F,children:[u&&T.jsxs("div",{ref:b,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"10px",boxSizing:"border-box",writingMode:h==="BACK"&&l.isVertical?"vertical-rl":void 0},children:[!(h==="BACK"&&l.isVertical)&&T.jsx("span",{ref:A,"aria-hidden":"true",style:{position:"absolute",left:-99999,top:-99999,visibility:"hidden",pointerEvents:"none",...o.find(j=>j.name===s)?.style,fontSize:`${k}px`,letterSpacing:"0.5px",whiteSpace:"pre",wordBreak:"normal",overflowWrap:"normal",lineHeight:1.2,display:"inline-block"},children:u}),T.jsx("span",{style:{...o.find(j=>j.name===s)?.style,color:"#333333",fontSize:h==="BACK"&&l.isVertical?`max(16px, min(${100/Math.max(1,u.length)}cqi, 72px))`:E?`${E}px`:`max(16px, min(${100/Math.max(1,u.length)}cqi, 72px))`,letterSpacing:"0.5px",...h==="BACK"&&l.isVertical?{wordBreak:"break-word",whiteSpace:"pre-wrap"}:{wordBreak:"normal",overflowWrap:"normal",whiteSpace:"pre"},lineHeight:1.2,fontVariantEmoji:"text",textAlign:"center",verticalAlign:"middle",textRendering:"geometricPrecision",display:"block",width:"100%",containerType:"inline-size"},children:u})]}),f&&T.jsx("div",{style:{width:"80%",height:"80%",display:"flex",alignItems:"center",justifyContent:"center"},children:y?T.jsx("div",{style:{width:"100%",height:"100%",maskImage:`url(${y})`,WebkitMaskImage:`url(${y})`,maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:g,filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",opacity:.95}}):T.jsx("img",{src:f.src,alt:f.name,style:{width:"100%",height:"100%",objectFit:"contain",filter:"grayscale(100%) contrast(1.2) brightness(1.2)"}})}),d&&Lr(a,d.length)&&T.jsx("div",{style:{width:"80%",height:"80%",display:"flex",alignItems:"center",justifyContent:"center"},children:Ul(a)?T.jsx("span",{style:{fontFamily:Fl(d.length),color:"#333333",fontSize:"180px",lineHeight:1},children:Bl(d)}):Pl(a)?T.jsx("span",{style:{...Ne.find(j=>j.name===a)?.style,fontFamily:jl(d.length),color:"#333333",fontSize:"180px",lineHeight:1},children:zl(d)}):Ne.find(j=>j.name===a)?.middleLarger&&d.length===3?T.jsxs("span",{style:{...Ne.find(j=>j.name===a)?.style,color:"#333333",fontSize:"180px",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center"},children:[T.jsx("span",{style:{fontSize:"0.75em"},children:d[0]}),T.jsx("span",{style:{fontSize:"1em"},children:d[1]}),T.jsx("span",{style:{fontSize:"0.75em"},children:d[2]})]}):T.jsx("span",{style:{...Ne.find(j=>j.name===a)?.style,color:"#333333",fontSize:"180px",lineHeight:1},children:Ne.find(j=>j.name===a)?.maxLength===1?d.charAt(0):d})})]})},Lh=()=>{if(typeof window>"u"||typeof navigator>"u")return!1;const h=navigator.userAgent||"",t=navigator.platform||"";return!!(/iPad|iPhone|iPod/.test(h)&&!window.MSStream||t==="MacIntel"&&navigator.maxTouchPoints>1||/Safari/.test(h)&&/Apple/.test(navigator.vendor)&&"ontouchstart"in window&&navigator.maxTouchPoints>1&&(!/Macintosh/.test(h)||navigator.maxTouchPoints>1))},G0=h=>new Promise((t,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>t(s),s.onerror=a=>i(a),s.src=h}),ze=3,sa=300*ze,aa=500*ze,ra=300*ze,Mx=16*ze,bh=(h,t,i)=>{const s=parseFloat(h.top)/100,a=parseFloat(h.bottom)/100,o=parseFloat(h.left)/100,l=parseFloat(h.right)/100,u=o*t,d=s*i,f=t-o*t-l*t,g=i-s*i-a*i;return{x:u,y:d,width:f,height:g}},V0=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontFamily?i.style.fontFamily:"sans-serif"},X0=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontWeight?i.style.fontWeight:"normal"},Y0=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontStyle?i.style.fontStyle:"normal"},Dx=(h,t,i,s,a,o)=>{const l=t.naturalWidth||t.width,u=t.naturalHeight||t.height;if(!l||!u)return;const d=Math.min(a/l,o/u),f=l*d,g=u*d,y=i+(a-f)/2,b=s+(o-g)/2;h.drawImage(t,y,b,f,g)},Jh=(h,t,i)=>{const s=h.createLinearGradient(t.x,t.y+t.height/2,t.x+t.width,t.y+t.height/2);return i==="white"?(s.addColorStop(0,"#cac9c9"),s.addColorStop(.5,"#aeaeae"),s.addColorStop(1,"#717171")):(s.addColorStop(0,"#f5f4f4"),s.addColorStop(.5,"#aeaeae"),s.addColorStop(1,"#717171")),s},Rx=(h,t,i)=>{const s=Math.max(1,h.length),a=t/100;if(i==="FRONT"){const o=100/s*a,l=18*a;return Math.max(4*ze,Math.min(o,l))}else{const o=150/s*a,l=54*a;return Math.max(8*ze,Math.min(o,l))}},q0=(h,t,i,s,a,o,l,u,d=!1)=>{if(!t)return;h.save(),h.shadowColor="rgba(0, 0, 0, 0.3)",h.shadowBlur=2*ze,h.shadowOffsetX=0,h.shadowOffsetY=1*ze,h.textAlign="center",h.textBaseline="middle";const f=i.x+i.width/2,g=i.y+i.height/2,y=String(t).replace(/\r\n/g,`
`).split(`
`),b=.5*ze,A=1.2,w=.82,x=(S,M)=>{h.font=`${o} ${a} ${M}px ${s}`;const _=h.measureText(S).width,R=(S?.length||0)*b;return _+R},E=()=>{const S=1*ze,M=Math.max(S,(u==="FRONT"?.18:.54)*i.width),_=F=>{const j=Math.max(0,...y.map(K=>x(K,F))),X=y.length*F*A;return j<=i.width*w&&X<=i.height*w};let R=S,O=M,k=S;for(let F=0;F<16;F++){const j=(R+O)/2;_(j)?(k=j,R=j):O=j}return k};if(d){const S=Rx(t,i.height,u),M=Math.max(1,...String(t).split(`
`).map(J=>Math.max(1,J.length))),_=i.height*.92/(M*A);let R=M<=3?Math.min(S,_):S;if(M<=2){const J=i.width*.9/A;R=Math.min(R,J)}const O=Math.max(8*ze,R);h.font=`${o} ${a} ${O}px ${s}`,h.translate(f,g),h.rotate(Math.PI/2);const k=h.createLinearGradient(0,i.width/2,0,-i.width/2);l==="white"?(k.addColorStop(0,"#cac9c9"),k.addColorStop(.5,"#aeaeae"),k.addColorStop(1,"#717171")):(k.addColorStop(0,"#f5f4f4"),k.addColorStop(.5,"#aeaeae"),k.addColorStop(1,"#717171")),h.fillStyle=k;const F=O*1.05,j=i.height,X=[];let K="";const Q=()=>{const J=K.replace(/^\s+/,"");J&&X.push(J),K=""};for(const J of String(t)){if(J===`
`){Q();continue}if(!K&&(J===" "||J==="	"))continue;const mt=K+J,B=h.measureText(mt).width;if(K&&B>j){if(Q(),J===" "||J==="	")continue;K=J}else K=mt}Q(),X.length||X.push("");const ot=-((X.length-1)*F)/2;X.forEach((J,mt)=>{const B=ot+mt*F;h.fillText(J,0,B)})}else{const S=E();h.font=`${o} ${a} ${S}px ${s}`;const M=Jh(h,i,l);h.fillStyle=M;const _=y.length*S*A,R=g-_/2+S*A/2;y.forEach((O,k)=>{const F=R+k*S*A;h.fillText(O,f,F)})}h.restore()},Nx=(h,t,i=Mx)=>{if(!h)return i;const s=String(h).trim();if(/^[\d.]+em$/i.test(s))return parseFloat(s)*i;if(/^[\d.]+cqi$/i.test(s)){const a=parseFloat(s);return t/100*a}if(/^[\d.]+px$/i.test(s))return parseFloat(s)*ze;if(s.startsWith("max(")||s.startsWith("min(")){const a=t/100;let o=s.replace(/([\d.]+)cqi/g,(l,u)=>String(parseFloat(u)*a));o=o.replace(/([\d.]+)px/g,(l,u)=>String(parseFloat(u)*ze)),o=o.replace(/([\d.]+)em/g,(l,u)=>String(parseFloat(u)*i));try{const l=o.replace(/max/g,"Math.max").replace(/min/g,"Math.min");return new Function("return "+l)()}catch(l){return console.warn("Failed to parse CSS font size:",h,l),i}}return(parseFloat(s)||16)*ze},$0=(h,t,i,s,a,o)=>{if(!t||!Lr(i,t.length))return;h.save();const l=Jh(h,s,a);h.fillStyle=l,h.textAlign="center",h.textBaseline="middle";const u=s.x+s.width/2,d=s.y+s.height/2;let f=t,g="sans-serif",y=0;const b=Ne.find(x=>x.name===i),A=fa(i,o,t.length,!1),w=Nx(A,s.width);if(Ul(i)?(f=Bl(t),g=Fl(t.length)):Pl(i)?(f=zl(t),g=jl(t.length),o==="BACK"&&(y=w*.05)):b&&(g=b.style?.fontFamily||"sans-serif",b.maxLength===1&&(f=t.charAt(0))),h.font=`normal normal ${w}px ${g}`,b?.middleLarger&&t.length===3){const x=w*.75,E=w;h.font=`normal normal ${x}px ${g}`;const S=h.measureText(t[0]);h.font=`normal normal ${E}px ${g}`;const M=h.measureText(t[1]);h.font=`normal normal ${x}px ${g}`;const _=h.measureText(t[2]),R=S.width+M.width+_.width;let O=u-R/2;h.font=`normal normal ${x}px ${g}`,h.fillText(t[0],O+S.width/2,d),O+=S.width,h.font=`normal normal ${E}px ${g}`,h.fillText(t[1],O+M.width/2,d),O+=M.width,h.font=`normal normal ${x}px ${g}`,h.fillText(t[2],O+_.width/2,d)}else if(i==="Vine"){const x=w*.55;let E=0;const S=[];for(let _=0;_<f.length;_++){const R=h.measureText(f[_]).width;S.push(R),E+=R,_<f.length-1&&(E+=x)}let M=u-E/2;for(let _=0;_<f.length;_++)h.fillText(f[_],M+S[_]/2,d),M+=S[_]+x}else h.fillText(f,u+y,d);h.restore()},K0=async(h,t,i,s,a=.75)=>{if(!(!t||!t.src))try{const l=(t.isUpload?t.maskSrc:t.src)||t.src,u=await G0(l),d=t.scale||.5,f=Math.min(i.width,i.height)*a,g=u.width/u.height;let y,b;g>1?(y=f*d,b=y/g):(b=f*d,y=b*g);const A=i.x+(i.width-y)/2,w=i.y+(i.height-b)/2;if(h.save(),!t.isUpload||!!t.maskSrc){const E=document.createElement("canvas");E.width=y,E.height=b;const S=E.getContext("2d"),_=Jh(S,{x:0,y:0,width:y,height:b},s);S.fillStyle=_,S.fillRect(0,0,y,b),S.globalCompositeOperation="destination-in",S.drawImage(u,0,0,y,b),h.globalAlpha=.95,h.filter="contrast(1.1) brightness(1.1) drop-shadow(0px 1px 1px rgba(0,0,0,0.3))",h.drawImage(E,A,w)}else h.filter="grayscale(100%) contrast(1.2) brightness(1.2)",h.globalCompositeOperation="source-over",h.globalAlpha=.9,h.drawImage(u,A,w,y,b);h.restore()}catch(o){console.warn("Failed to load graphic for canvas capture:",o)}},ul=async(h,t,i,s,a,o)=>{const l=document.createElement("canvas");l.width=sa,l.height=aa;const u=l.getContext("2d");document.fonts&&document.fonts.ready&&await document.fonts.ready;const d=h==="FRONT"?`bottle/front/${i}.webp`:`bottle/back/${i}back.webp`;try{const E=await G0(d);Dx(u,E,0,0,sa,aa)}catch(E){console.warn("Failed to load bottle image:",E),u.fillStyle="#f3f4f6",u.fillRect(0,0,sa,aa)}const f=t[h],g=f?.text||"",y=f?.monogram||"",b=f?.graphic||null,A=h==="BACK"&&f?.isVertical,w=Lh(),x=w?H0[h]:I0[h];if(g){const E=A?x.textVertical:x.text,S=bh(E,sa,aa),M=V0(s,o),_=X0(s,o),R=Y0(s,o);q0(u,g,S,M,_,R,i,h,A)}if(y){const E=bh(x.monogram,sa,aa);$0(u,y,a,E,i,h)}if(b){const S=(w?vl.test:vl.desktop)[h],M=bh(x.graphic,sa,aa);await K0(u,b,M,i,S)}return l.toDataURL("image/png")},Kp=async(h,t,i,s,a,o)=>{const l=t[h],u=l?.text||"",d=l?.monogram||"",f=l?.graphic||null;if(!u&&!d&&!f)return null;const g=document.createElement("canvas");g.width=ra,g.height=ra;const y=g.getContext("2d");document.fonts&&document.fonts.ready&&await document.fonts.ready,y.clearRect(0,0,ra,ra);const b=20*ze,A={x:b,y:b,width:ra-b*2,height:ra-b*2},w=h==="BACK"&&l?.isVertical;if(u){const x=V0(s,o),E=X0(s,o),S=Y0(s,o);q0(y,u,A,x,E,S,"white",h,w)}return d&&Lr(a,d.length)&&$0(y,d,a,A,"white",h),f&&await K0(y,f,A,"white"),g.toDataURL("image/png")},kx=()=>{const[h,t]=ct.useState("FRONT"),i=ct.useRef(null),s=ct.useRef(null),a=ct.useRef(null),o=ct.useRef(null),l=ct.useRef(null),[u,d]=ct.useState("black"),[f,g]=ct.useState("main"),[y,b]=ct.useState(!1),[A,w]=ct.useState(!1),[x,E]=ct.useState(!1),S=tt=>{w(tt),!tt&&!x&&E(!0)},[M,_]=ct.useState(!1);ct.useEffect(()=>{const tt=()=>b(window.innerWidth<768);return tt(),window.addEventListener("resize",tt),window.takeSnapshot=async()=>{if(i.current)try{const st=await ia(i.current,{cacheBust:!0}),Tt=document.createElement("a");Tt.download=`bottle-snapshot-${Date.now()}.png`,Tt.href=st,Tt.click(),console.log("Snapshot taken with html-to-image!")}catch(st){console.error("Snapshot failed:",st)}else console.warn("Bottle preview ref not found")},()=>{window.removeEventListener("resize",tt),delete window.takeSnapshot}},[]),ct.useEffect(()=>{w(!0)},[u,h]),ct.useEffect(()=>(window.setForceCanvasCapture=tt=>{_(!!tt),console.log(`[Customizer] Force canvas capture: ${!!tt}`)},window.getForceCanvasCapture=()=>M,()=>{delete window.setForceCanvasCapture,delete window.getForceCanvasCapture}),[M]);const[R,O]=ct.useState({FRONT:{text:"",monogram:""},BACK:{text:"",monogram:"",isVertical:!1}}),[k,F]=ct.useState("BeFit"),[j,X]=ct.useState({FRONT:"Roman",BACK:"Roman"}),K=j[h],Q=tt=>{X(st=>({...st,[h]:tt}))},et=[{name:"BeFit",css:"font-sans",style:{fontFamily:'BeFit, "Noto Emoji", sans-serif'}},{name:"BeFit Slim",css:"font-sans",style:{fontFamily:'BeFit Slim, "Noto Emoji", sans-serif'}},{name:"BeFit Bold Italic",css:"font-sans font-bold italic",style:{fontFamily:'BeFit, "Noto Emoji", sans-serif',fontWeight:"bold",fontStyle:"italic"}},{name:"Sackers Gothic",css:"font-sans uppercase tracking-widest",style:{fontFamily:'Oswald, "Noto Emoji", sans-serif'}},{name:"Yearbook Solid",css:"font-serif uppercase font-black",style:{fontFamily:'Bebas Neue, "Noto Emoji", sans-serif'}},{name:"VAG Rounded Next",css:"font-sans",style:{fontFamily:'Nunito, "Noto Emoji", sans-serif'}},{name:"Samantha Script",css:"font-cursive",style:{fontFamily:'Dancing Script, "Noto Emoji", cursive'}},{name:"Nexa Script",css:"font-cursive",style:{fontFamily:'Nexa Script, "Noto Emoji", cursive'}},{name:"Cotford",css:"font-serif",style:{fontFamily:'Merriweather, "Noto Emoji", serif'}},{name:"Arial Bold",css:"font-sans font-bold",style:{fontFamily:'Arial, "Noto Emoji", sans-serif',fontWeight:"bold"}},{name:"ITC Modern No 216",css:"font-serif font-bold",style:{fontFamily:'Bodoni Moda, "Noto Emoji", serif'}},{name:"Benguiat Pro ITC Bold",css:"font-serif font-bold",style:{fontFamily:'Playfair Display, "Noto Emoji", serif',fontWeight:"bold"}},{name:"Rockwell Bold",css:"font-serif font-bold",style:{fontFamily:'Alfa Slab One, "Noto Emoji", serif'}},{name:"WHIPHAND",css:"font-display uppercase",style:{fontFamily:'Permanent Marker, "Noto Emoji", cursive',fontStyle:"italic"}},{name:"WOOD TYPE",css:"font-display uppercase tracking-wide",style:{fontFamily:'Bungee, "Noto Emoji", sans-serif'}}],[ot,J]=ct.useState(!1),[mt,B]=ct.useState(!1),[G,Z]=ct.useState({front:null,back:null,frontDesign:null,backDesign:null}),bt=()=>typeof window<"u"&&window.parent&&window.parent!==window?(window.parent.postMessage({type:"BOTTLE_CUSTOMIZER_CLOSE"},"*"),!0):!1,vt=R[h].text,D=R[h].monogram,H=R[h].graphic,W=tt=>{O(st=>({...st,[h]:{...st[h],text:tt,monogram:tt?"":st[h].monogram,graphic:tt?null:st[h].graphic}}))},it=tt=>{O(st=>({...st,[h]:{...st[h],monogram:tt,text:tt?"":st[h].text,graphic:tt?null:st[h].graphic}}))},ht=tt=>{O(st=>({...st,[h]:{...st[h],graphic:tt,text:tt?"":st[h].text,monogram:tt?"":st[h].monogram}}))},yt=tt=>{O(st=>({...st,[h]:{...st[h],isVertical:tt}}))},ut=()=>{O(tt=>({...tt,[h]:{text:"",monogram:"",graphic:null}}))},Ht=tt=>new Promise(st=>{if(!tt.current){st();return}const Tt=tt.current.querySelectorAll("img");if(Tt.length===0){st();return}let Wt=0;const Le=()=>{Wt++,Wt>=Tt.length&&st()};Tt.forEach(Pe=>{Pe.complete?Le():(Pe.addEventListener("load",Le),Pe.addEventListener("error",Le))}),setTimeout(st,2e3)});ct.useEffect(()=>(window.takeSnapshotCanvas=async(tt="FRONT")=>{const st=tt.toUpperCase();if(st!=="FRONT"&&st!=="BACK"){console.error('[takeSnapshotCanvas] Invalid side. Use "FRONT" or "BACK".');return}console.log(`[takeSnapshotCanvas] Capturing ${st} with canvas compositor...`);try{document.fonts&&document.fonts.ready&&await document.fonts.ready;const Tt=await ul(st,R,u,k,j[st],et),Wt=document.createElement("a");Wt.download=`bottle-canvas-${st.toLowerCase()}-${Date.now()}.png`,Wt.href=Tt,Wt.click(),console.log(`[takeSnapshotCanvas] ${st} snapshot saved!`)}catch(Tt){console.error("[takeSnapshotCanvas] Failed:",Tt)}},window.compareSnapshots=async(tt="FRONT")=>{const st=tt.toUpperCase();if(st!=="FRONT"&&st!=="BACK"){console.error('[compareSnapshots] Invalid side. Use "FRONT" or "BACK".');return}const Tt=st==="FRONT"?s:a;console.log(`[compareSnapshots] Capturing ${st} with both methods...`);try{await Ht(Tt),document.fonts&&document.fonts.ready&&await document.fonts.ready,await new Promise(dn=>setTimeout(dn,100));let Wt=null;Tt.current&&(Wt=await ia(Tt.current,{cacheBust:!0,skipAutoScale:!0}));const Le=await ul(st,R,u,k,j[st],et);window.open("","_blank","width=700,height=600").document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head><title>Snapshot Comparison - ${st}</title></head>
                    <body style="margin:0;padding:20px;background:#f0f0f0;font-family:sans-serif;">
                        <h3 style="margin:0 0 10px;">Snapshot Comparison: ${st}</h3>
                        <div style="display:flex;gap:20px;">
                            <div style="text-align:center;">
                                <p style="margin:0 0 5px;font-weight:bold;">html-to-image</p>
                                <img src="${Wt}" style="border:1px solid #ccc;max-width:300px;" />
                            </div>
                            <div style="text-align:center;">
                                <p style="margin:0 0 5px;font-weight:bold;">Canvas Compositor</p>
                                <img src="${Le}" style="border:1px solid #ccc;max-width:300px;" />
                            </div>
                        </div>
                        <p style="margin-top:20px;font-size:12px;color:#666;">
                            Canvas should match html-to-image. If text/position differs, adjust canvasCapture.js
                        </p>
                    </body>
                    </html>
                `),console.log("[compareSnapshots] Comparison window opened!")}catch(Wt){console.error("[compareSnapshots] Failed:",Wt)}},()=>{delete window.takeSnapshotCanvas,delete window.compareSnapshots}),[R,u,k,j]);const Nt=async()=>{try{B(!0),w(!0);let tt=null,st=null,Tt=null,Wt=null;Lh()||M?(console.log(`[Customizer] Using canvas capture (iOS: ${Lh()}, forced: ${M})`),document.fonts&&document.fonts.ready&&await document.fonts.ready,tt=await ul("FRONT",R,u,k,j.FRONT,et),st=await ul("BACK",R,u,k,j.BACK,et),Tt=await Kp("FRONT",R,u,k,j.FRONT,et),Wt=await Kp("BACK",R,u,k,j.BACK,et)):(console.log("[Customizer] Using html-to-image capture"),await new Promise(Pe=>requestAnimationFrame(()=>requestAnimationFrame(Pe))),await Promise.all([Ht(s),Ht(a),Ht(o),Ht(l)]),await new Promise(Pe=>setTimeout(Pe,100)),s.current&&(tt=await ia(s.current,{cacheBust:!0,skipAutoScale:!0})),a.current&&(st=await ia(a.current,{cacheBust:!0,skipAutoScale:!0})),o.current&&(R.FRONT.text||R.FRONT.monogram||R.FRONT.graphic)&&(Tt=await ia(o.current,{cacheBust:!0,backgroundColor:null})),l.current&&(R.BACK.text||R.BACK.monogram||R.BACK.graphic)&&(Wt=await ia(l.current,{cacheBust:!0,backgroundColor:null}))),Z({front:tt,back:st,frontDesign:Tt,backDesign:Wt}),w(!1),B(!1),J(!0)}catch(tt){console.error("Failed to capture review images",tt),w(!1),B(!1),J(!0)}},ui=vt||D||H,gt=[{id:"black",name:"BLACK",bg:"bg-black",text:"text-white"},{id:"white",name:"WHITE",bg:"bg-white",text:"text-black",border:"border-gray-200"},{id:"aqua",name:"BLUE",bg:"bg-[#2ea5d1]",text:"text-white"},{id:"red",name:"RED",bg:"bg-[#C8102E]",text:"text-white"}];return T.jsxs("div",{className:"flex flex-col h-screen bg-gray-100 font-sans text-slate-900 overflow-y-auto",children:[T.jsx("header",{id:"app-header",className:"bg-white border-b border-gray-200 z-10 relative",children:T.jsxs("div",{className:"max-w-[1920px] mx-auto px-4 md:px-6 h-14 md:h-16 flex items-center justify-between",children:[T.jsx("div",{className:"flex-shrink-0",children:T.jsx("img",{src:"logo.png",alt:"YETI",loading:"lazy",className:"h-8 md:h-10 w-auto object-contain"})}),T.jsx("nav",{className:"flex space-x-4 md:space-x-8 h-full",children:["FRONT","BACK"].map(tt=>T.jsx("button",{onClick:()=>t(tt),className:`relative h-full px-1 text-xs md:text-sm font-bold tracking-widest uppercase transition-colors
                  ${h===tt?"text-black border-b-4 border-brand-blue":"text-gray-400 hover:text-gray-600"}`,children:tt},tt))}),T.jsx("button",{onClick:bt,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[#002C5F]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),T.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-y-auto md:overflow-hidden relative",children:[T.jsxs("div",{id:"bottle-canvas",className:"w-full md:w-[65%] flex items-center justify-center bg-[#f3f4f6] relative py-6 md:py-0 overflow-hidden min-h-[200px] md:min-h-0",children:[T.jsxs("div",{ref:i,className:"flex flex-col items-center md:mb-[100px]",children:[T.jsx(yh,{side:h,customization:R,selectedColor:u,selectedFont:k,selectedMonogram:K,fonts:et,isMobile:y,isImageLoading:A,setIsImageLoading:S,view:f}),T.jsxs("div",{className:`text-center space-y-1 md:space-y-2 hidden md:block transition-opacity duration-300 md:mb-12 md:-mt-8 ${f!=="main"?"opacity-0 pointer-events-none":"opacity-100"}`,children:[T.jsx("h2",{className:"text-xs md:text-sm font-bold text-[#002C5F] tracking-wider uppercase",children:"RAMBLER 16 OZ TRAVEL BOTTLE"}),T.jsx("div",{className:"flex items-center justify-center space-x-3",children:gt.map(tt=>T.jsx("button",{onClick:()=>d(tt.id),className:`w-8 h-8 rounded-full ${tt.bg} ${tt.border||""} 
                                     ring-2 ring-offset-2 transition-all duration-200
                                     ${u===tt.id?"ring-[#002C5F]":"ring-transparent hover:ring-gray-300"}
                                 `,"aria-label":`Select ${tt.name} color`},tt.id))}),T.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:["PRODUCT COLOR: ",T.jsx("span",{className:"text-black",children:gt.find(tt=>tt.id===u)?.name})]})]})]}),T.jsx(xA,{colors:gt,selectedColor:u,setSelectedColor:d,isMobile:y})]}),T.jsxs("div",{className:`w-full md:w-[35%] p-4 md:p-12 flex flex-col items-center justify-start flex-1 md:mb-0 md:overflow-y-auto md:pb-32 min-h-[60vh] md:min-h-0 pb-24 bg-[#f3f4f6] ${f!=="main"?"md:pb-36":""}`,children:[f==="main"&&T.jsx(yA,{setView:g,activeTab:h}),f==="text"&&T.jsx(bA,{setView:g,textInput:vt,setTextInput:W,fonts:et,selectedFont:k,setSelectedFont:F,activeTab:h,isVertical:R[h].isVertical,setIsVertical:yt}),f==="monogram"&&T.jsx(vA,{setView:g,monogramInput:D,setMonogramInput:it,monogramStyles:Ne,selectedMonogram:K,setSelectedMonogram:Q,activeTab:h}),f==="gallery"&&T.jsx(AA,{setView:g,setGraphic:ht,selectedGraphic:H,activeTab:h}),f==="upload"&&T.jsx(_x,{setView:g,setGraphic:ht,graphicInput:H,activeTab:h,selectedColor:u})]}),f!=="main"&&T.jsx(wA,{onRemove:ut,onReview:Nt,isDisabled:!ui,isPreparing:mt})]}),x&&T.jsxs("div",{style:{position:"fixed",top:0,left:"-9999px",pointerEvents:"none",zIndex:-1},children:[T.jsx("div",{ref:s,children:T.jsx(yh,{side:"FRONT",customization:R,selectedColor:u,selectedFont:k,selectedMonogram:j.FRONT,fonts:et,isMobile:!1,view:"capture"})}),T.jsx("div",{ref:a,children:T.jsx(yh,{side:"BACK",customization:R,selectedColor:u,selectedFont:k,selectedMonogram:j.BACK,fonts:et,isMobile:!1,view:"capture"})}),T.jsx("div",{ref:o,children:T.jsx($p,{side:"FRONT",customization:R,selectedColor:u,selectedFont:k,selectedMonogram:j.FRONT,fonts:et})}),T.jsx("div",{ref:l,children:T.jsx($p,{side:"BACK",customization:R,selectedColor:u,selectedFont:k,selectedMonogram:j.BACK,fonts:et})})]}),mt&&T.jsxs("div",{className:"fixed inset-0 z-[60] bg-white/95 flex flex-col items-center justify-center",children:[T.jsx("div",{className:"w-14 h-14 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("p",{className:"text-lg font-semibold text-[#002C5F]",children:"Preparing your design..."})]}),ot&&T.jsx(EA,{onClose:()=>J(!1),onRequestClose:bt,customization:R,selectedColor:u,selectedFont:k,selectedMonogramBySide:j,fonts:et,monogramStyles:Ne,convertToCircleGlyphs:Bl,getCircleFontFamily:Fl,usesCircleGlyphs:Ul,convertToNGramGlyphs:zl,getNGramFontFamily:jl,usesNGramGlyphs:Pl,getMonogramFontSize:fa,shouldDisplayMonogram:Lr,setActiveTab:t,setView:g,frontImage:G.front,backImage:G.back,frontDesignImage:G.frontDesign,backDesignImage:G.backDesign})]})};function Ox(){return T.jsx(kx,{})}Ev.createRoot(document.getElementById("root")).render(T.jsx(ct.StrictMode,{children:T.jsx(Ox,{})}));
