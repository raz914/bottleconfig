var sp=h=>{throw TypeError(h)};var sh=(h,t,i)=>t.has(h)||sp("Cannot "+i);var ee=(h,t,i)=>(sh(h,t,"read from private field"),i?i.call(h):t.get(h)),Ui=(h,t,i)=>t.has(h)?sp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,i),Ze=(h,t,i,s)=>(sh(h,t,"write to private field"),s?s.call(h,i):t.set(h,i),i),Hi=(h,t,i)=>(sh(h,t,"access private method"),i);var ap=(h,t,i,s)=>({set _(a){Ze(h,t,a,i)},get _(){return ee(h,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();var ah={exports:{}},br={};var rp;function Sv(){if(rp)return br;rp=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:h,type:s,key:l,ref:a!==void 0?a:null,props:o}}return br.Fragment=t,br.jsx=i,br.jsxs=i,br}var op;function Ev(){return op||(op=1,ah.exports=Sv()),ah.exports}var T=Ev(),rh={exports:{}},St={};var lp;function Tv(){if(lp)return St;lp=1;var h=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),y=Symbol.iterator;function A(L){return L===null||typeof L!="object"?null:(L=y&&L[y]||L["@@iterator"],typeof L=="function"?L:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,C={};function S(L,G,q){this.props=L,this.context=G,this.refs=C,this.updater=q||x}S.prototype.isReactComponent={},S.prototype.setState=function(L,G){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,G,"setState")},S.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function M(){}M.prototype=S.prototype;function _(L,G,q){this.props=L,this.context=G,this.refs=C,this.updater=q||x}var D=_.prototype=new M;D.constructor=_,w(D,S.prototype),D.isPureReactComponent=!0;var R=Array.isArray;function k(){}var F={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function Y(L,G,q){var tt=q.ref;return{$$typeof:h,type:L,key:G,ref:tt!==void 0?tt:null,props:q}}function X(L,G){return Y(L.type,G,L.props)}function Q(L){return typeof L=="object"&&L!==null&&L.$$typeof===h}function it(L){var G={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(q){return G[q]})}var lt=/\/+/g;function et(L,G){return typeof L=="object"&&L!==null&&L.key!=null?it(""+L.key):G.toString(36)}function st(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(k,k):(L.status="pending",L.then(function(G){L.status==="pending"&&(L.status="fulfilled",L.value=G)},function(G){L.status==="pending"&&(L.status="rejected",L.reason=G)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function B(L,G,q,tt,ht){var bt=typeof L;(bt==="undefined"||bt==="boolean")&&(L=null);var mt=!1;if(L===null)mt=!0;else switch(bt){case"bigint":case"string":case"number":mt=!0;break;case"object":switch(L.$$typeof){case h:case t:mt=!0;break;case g:return mt=L._init,B(mt(L._payload),G,q,tt,ht)}}if(mt)return ht=ht(L),mt=tt===""?"."+et(L,0):tt,R(ht)?(q="",mt!=null&&(q=mt.replace(lt,"$&/")+"/"),B(ht,G,q,"",function(gi){return gi})):ht!=null&&(Q(ht)&&(ht=X(ht,q+(ht.key==null||L&&L.key===ht.key?"":(""+ht.key).replace(lt,"$&/")+"/")+mt)),G.push(ht)),1;mt=0;var Qt=tt===""?".":tt+":";if(R(L))for(var Ot=0;Ot<L.length;Ot++)tt=L[Ot],bt=Qt+et(tt,Ot),mt+=B(tt,G,q,bt,ht);else if(Ot=A(L),typeof Ot=="function")for(L=Ot.call(L),Ot=0;!(tt=L.next()).done;)tt=tt.value,bt=Qt+et(tt,Ot++),mt+=B(tt,G,q,bt,ht);else if(bt==="object"){if(typeof L.then=="function")return B(st(L),G,q,tt,ht);throw G=String(L),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return mt}function H(L,G,q){if(L==null)return L;var tt=[],ht=0;return B(L,tt,"","",function(bt){return G.call(q,bt,ht++)}),tt}function J(L){if(L._status===-1){var G=L._result;G=G(),G.then(function(q){(L._status===0||L._status===-1)&&(L._status=1,L._result=q)},function(q){(L._status===0||L._status===-1)&&(L._status=2,L._result=q)}),L._status===-1&&(L._status=0,L._result=G)}if(L._status===1)return L._result.default;throw L._result}var ft=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},At={map:H,forEach:function(L,G,q){H(L,function(){G.apply(this,arguments)},q)},count:function(L){var G=0;return H(L,function(){G++}),G},toArray:function(L){return H(L,function(G){return G})||[]},only:function(L){if(!Q(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return St.Activity=b,St.Children=At,St.Component=S,St.Fragment=i,St.Profiler=a,St.PureComponent=_,St.StrictMode=s,St.Suspense=d,St.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,St.__COMPILER_RUNTIME={__proto__:null,c:function(L){return F.H.useMemoCache(L)}},St.cache=function(L){return function(){return L.apply(null,arguments)}},St.cacheSignal=function(){return null},St.cloneElement=function(L,G,q){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var tt=w({},L.props),ht=L.key;if(G!=null)for(bt in G.key!==void 0&&(ht=""+G.key),G)!j.call(G,bt)||bt==="key"||bt==="__self"||bt==="__source"||bt==="ref"&&G.ref===void 0||(tt[bt]=G[bt]);var bt=arguments.length-2;if(bt===1)tt.children=q;else if(1<bt){for(var mt=Array(bt),Qt=0;Qt<bt;Qt++)mt[Qt]=arguments[Qt+2];tt.children=mt}return Y(L.type,ht,tt)},St.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:o,_context:L},L},St.createElement=function(L,G,q){var tt,ht={},bt=null;if(G!=null)for(tt in G.key!==void 0&&(bt=""+G.key),G)j.call(G,tt)&&tt!=="key"&&tt!=="__self"&&tt!=="__source"&&(ht[tt]=G[tt]);var mt=arguments.length-2;if(mt===1)ht.children=q;else if(1<mt){for(var Qt=Array(mt),Ot=0;Ot<mt;Ot++)Qt[Ot]=arguments[Ot+2];ht.children=Qt}if(L&&L.defaultProps)for(tt in mt=L.defaultProps,mt)ht[tt]===void 0&&(ht[tt]=mt[tt]);return Y(L,bt,ht)},St.createRef=function(){return{current:null}},St.forwardRef=function(L){return{$$typeof:u,render:L}},St.isValidElement=Q,St.lazy=function(L){return{$$typeof:g,_payload:{_status:-1,_result:L},_init:J}},St.memo=function(L,G){return{$$typeof:f,type:L,compare:G===void 0?null:G}},St.startTransition=function(L){var G=F.T,q={};F.T=q;try{var tt=L(),ht=F.S;ht!==null&&ht(q,tt),typeof tt=="object"&&tt!==null&&typeof tt.then=="function"&&tt.then(k,ft)}catch(bt){ft(bt)}finally{G!==null&&q.types!==null&&(G.types=q.types),F.T=G}},St.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},St.use=function(L){return F.H.use(L)},St.useActionState=function(L,G,q){return F.H.useActionState(L,G,q)},St.useCallback=function(L,G){return F.H.useCallback(L,G)},St.useContext=function(L){return F.H.useContext(L)},St.useDebugValue=function(){},St.useDeferredValue=function(L,G){return F.H.useDeferredValue(L,G)},St.useEffect=function(L,G){return F.H.useEffect(L,G)},St.useEffectEvent=function(L){return F.H.useEffectEvent(L)},St.useId=function(){return F.H.useId()},St.useImperativeHandle=function(L,G,q){return F.H.useImperativeHandle(L,G,q)},St.useInsertionEffect=function(L,G){return F.H.useInsertionEffect(L,G)},St.useLayoutEffect=function(L,G){return F.H.useLayoutEffect(L,G)},St.useMemo=function(L,G){return F.H.useMemo(L,G)},St.useOptimistic=function(L,G){return F.H.useOptimistic(L,G)},St.useReducer=function(L,G,q){return F.H.useReducer(L,G,q)},St.useRef=function(L){return F.H.useRef(L)},St.useState=function(L){return F.H.useState(L)},St.useSyncExternalStore=function(L,G,q){return F.H.useSyncExternalStore(L,G,q)},St.useTransition=function(){return F.H.useTransition()},St.version="19.2.4",St}var cp;function Ih(){return cp||(cp=1,rh.exports=Tv()),rh.exports}var ct=Ih(),oh={exports:{}},yr={},lh={exports:{}},ch={};var up;function Cv(){return up||(up=1,(function(h){function t(B,H){var J=B.length;B.push(H);t:for(;0<J;){var ft=J-1>>>1,At=B[ft];if(0<a(At,H))B[ft]=H,B[J]=At,J=ft;else break t}}function i(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var H=B[0],J=B.pop();if(J!==H){B[0]=J;t:for(var ft=0,At=B.length,L=At>>>1;ft<L;){var G=2*(ft+1)-1,q=B[G],tt=G+1,ht=B[tt];if(0>a(q,J))tt<At&&0>a(ht,q)?(B[ft]=ht,B[tt]=J,ft=tt):(B[ft]=q,B[G]=J,ft=G);else if(tt<At&&0>a(ht,J))B[ft]=ht,B[tt]=J,ft=tt;else break t}}return H}function a(B,H){var J=B.sortIndex-H.sortIndex;return J!==0?J:B.id-H.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;h.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();h.unstable_now=function(){return l.now()-u}}var d=[],f=[],g=1,b=null,y=3,A=!1,x=!1,w=!1,C=!1,S=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function D(B){for(var H=i(f);H!==null;){if(H.callback===null)s(f);else if(H.startTime<=B)s(f),H.sortIndex=H.expirationTime,t(d,H);else break;H=i(f)}}function R(B){if(w=!1,D(B),!x)if(i(d)!==null)x=!0,k||(k=!0,it());else{var H=i(f);H!==null&&st(R,H.startTime-B)}}var k=!1,F=-1,j=5,Y=-1;function X(){return C?!0:!(h.unstable_now()-Y<j)}function Q(){if(C=!1,k){var B=h.unstable_now();Y=B;var H=!0;try{t:{x=!1,w&&(w=!1,M(F),F=-1),A=!0;var J=y;try{e:{for(D(B),b=i(d);b!==null&&!(b.expirationTime>B&&X());){var ft=b.callback;if(typeof ft=="function"){b.callback=null,y=b.priorityLevel;var At=ft(b.expirationTime<=B);if(B=h.unstable_now(),typeof At=="function"){b.callback=At,D(B),H=!0;break e}b===i(d)&&s(d),D(B)}else s(d);b=i(d)}if(b!==null)H=!0;else{var L=i(f);L!==null&&st(R,L.startTime-B),H=!1}}break t}finally{b=null,y=J,A=!1}H=void 0}}finally{H?it():k=!1}}}var it;if(typeof _=="function")it=function(){_(Q)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,et=lt.port2;lt.port1.onmessage=Q,it=function(){et.postMessage(null)}}else it=function(){S(Q,0)};function st(B,H){F=S(function(){B(h.unstable_now())},H)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(B){B.callback=null},h.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<B?Math.floor(1e3/B):5},h.unstable_getCurrentPriorityLevel=function(){return y},h.unstable_next=function(B){switch(y){case 1:case 2:case 3:var H=3;break;default:H=y}var J=y;y=H;try{return B()}finally{y=J}},h.unstable_requestPaint=function(){C=!0},h.unstable_runWithPriority=function(B,H){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var J=y;y=B;try{return H()}finally{y=J}},h.unstable_scheduleCallback=function(B,H,J){var ft=h.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ft+J:ft):J=ft,B){case 1:var At=-1;break;case 2:At=250;break;case 5:At=1073741823;break;case 4:At=1e4;break;default:At=5e3}return At=J+At,B={id:g++,callback:H,priorityLevel:B,startTime:J,expirationTime:At,sortIndex:-1},J>ft?(B.sortIndex=J,t(f,B),i(d)===null&&B===i(f)&&(w?(M(F),F=-1):w=!0,st(R,J-ft))):(B.sortIndex=At,t(d,B),x||A||(x=!0,k||(k=!0,it()))),B},h.unstable_shouldYield=X,h.unstable_wrapCallback=function(B){var H=y;return function(){var J=y;y=H;try{return B.apply(this,arguments)}finally{y=J}}}})(ch)),ch}var hp;function _v(){return hp||(hp=1,lh.exports=Cv()),lh.exports}var uh={exports:{}},je={};var dp;function Mv(){if(dp)return je;dp=1;var h=Ih();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,f,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:d,containerInfo:f,implementation:g}}var l=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return je.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,je.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(d,f,null,g)},je.flushSync=function(d){var f=l.T,g=s.p;try{if(l.T=null,s.p=2,d)return d()}finally{l.T=f,s.p=g,s.d.f()}},je.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(d,f))},je.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},je.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,b=u(g,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?s.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:y,fetchPriority:A}):g==="script"&&s.d.X(d,{crossOrigin:b,integrity:y,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},je.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=u(f.as,f.crossOrigin);s.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(d)},je.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,b=u(g,f.crossOrigin);s.d.L(d,g,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},je.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=u(f.as,f.crossOrigin);s.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(d)},je.requestFormReset=function(d){s.d.r(d)},je.unstable_batchedUpdates=function(d,f){return d(f)},je.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},je.useFormStatus=function(){return l.H.useHostTransitionStatus()},je.version="19.2.4",je}var fp;function kv(){if(fp)return uh.exports;fp=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),uh.exports=Mv(),uh.exports}var mp;function Dv(){if(mp)return yr;mp=1;var h=_v(),t=Ih(),i=kv();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var n=e,r=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(r=n.return),e=n.return;while(e)}return n.tag===3?r:null}function l(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function d(e){if(o(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=o(e),n===null)throw Error(s(188));return n!==e?null:e}for(var r=e,c=n;;){var m=r.return;if(m===null)break;var p=m.alternate;if(p===null){if(c=m.return,c!==null){r=c;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===r)return d(m),e;if(p===c)return d(m),n;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=m,c=p;else{for(var v=!1,E=m.child;E;){if(E===r){v=!0,r=m,c=p;break}if(E===c){v=!0,c=m,r=p;break}E=E.sibling}if(!v){for(E=p.child;E;){if(E===r){v=!0,r=p,c=m;break}if(E===c){v=!0,c=p,r=m;break}E=E.sibling}if(!v)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?e:n}function g(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=g(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,y=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),_=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function it(e){return e===null||typeof e!="object"?null:(e=Q&&e[Q]||e["@@iterator"],typeof e=="function"?e:null)}var lt=Symbol.for("react.client.reference");function et(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===lt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case S:return"Profiler";case C:return"StrictMode";case R:return"Suspense";case k:return"SuspenseList";case Y:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case _:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case D:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case F:return n=e.displayName||null,n!==null?n:et(e.type)||"Memo";case j:n=e._payload,e=e._init;try{return et(e(n))}catch{}}return null}var st=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ft=[],At=-1;function L(e){return{current:e}}function G(e){0>At||(e.current=ft[At],ft[At]=null,At--)}function q(e,n){At++,ft[At]=e.current,e.current=n}var tt=L(null),ht=L(null),bt=L(null),mt=L(null);function Qt(e,n){switch(q(bt,n),q(ht,e),q(tt,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?_g(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=_g(n),e=Mg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}G(tt),q(tt,e)}function Ot(){G(tt),G(ht),G(bt)}function gi(e){e.memoizedState!==null&&q(mt,e);var n=tt.current,r=Mg(n,e.type);n!==r&&(q(ht,e),q(tt,r))}function de(e){ht.current===e&&(G(tt),G(ht)),mt.current===e&&(G(mt),fr._currentValue=J)}var pi,yt;function Lt(e){if(pi===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);pi=n&&n[1]||"",yt=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pi+e+yt}var ze=!1;function Pe(e,n){if(!e||ze)return"";ze=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(V){var U=V}Reflect.construct(e,[],W)}else{try{W.call()}catch(V){U=V}e.call(W.prototype)}}else{try{throw Error()}catch(V){U=V}(W=e())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(V){if(V&&U&&typeof V.stack=="string")return[V.stack,U.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),v=p[0],E=p[1];if(v&&E){var N=v.split(`
`),I=E.split(`
`);for(m=c=0;c<N.length&&!N[c].includes("DetermineComponentFrameRoot");)c++;for(;m<I.length&&!I[m].includes("DetermineComponentFrameRoot");)m++;if(c===N.length||m===I.length)for(c=N.length-1,m=I.length-1;1<=c&&0<=m&&N[c]!==I[m];)m--;for(;1<=c&&0<=m;c--,m--)if(N[c]!==I[m]){if(c!==1||m!==1)do if(c--,m--,0>m||N[c]!==I[m]){var $=`
`+N[c].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=c&&0<=m);break}}}finally{ze=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Lt(r):""}function rt(e,n){switch(e.tag){case 26:case 27:case 5:return Lt(e.type);case 16:return Lt("Lazy");case 13:return e.child!==n&&n!==null?Lt("Suspense Fallback"):Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 15:return Pe(e.type,!1);case 11:return Pe(e.type.render,!1);case 1:return Pe(e.type,!0);case 31:return Lt("Activity");default:return""}}function dt(e){try{var n="",r=null;do n+=rt(e,r),r=e,e=e.return;while(e);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Kt=Object.prototype.hasOwnProperty,ne=h.unstable_scheduleCallback,Ce=h.unstable_cancelCallback,_e=h.unstable_shouldYield,pn=h.unstable_requestPaint,Ie=h.unstable_now,Vl=h.unstable_getCurrentPriorityLevel,Ea=h.unstable_ImmediatePriority,Ni=h.unstable_UserBlockingPriority,Ri=h.unstable_NormalPriority,Xl=h.unstable_LowPriority,rd=h.unstable_IdlePriority,ay=h.log,ry=h.unstable_setDisableYieldValue,Ta=null,ii=null;function bn(e){if(typeof ay=="function"&&ry(e),ii&&typeof ii.setStrictMode=="function")try{ii.setStrictMode(Ta,e)}catch{}}var ni=Math.clz32?Math.clz32:cy,oy=Math.log,ly=Math.LN2;function cy(e){return e>>>=0,e===0?32:31-(oy(e)/ly|0)|0}var Ir=256,Ur=262144,Hr=4194304;function qn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Gr(e,n,r){var c=e.pendingLanes;if(c===0)return 0;var m=0,p=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var E=c&134217727;return E!==0?(c=E&~p,c!==0?m=qn(c):(v&=E,v!==0?m=qn(v):r||(r=E&~e,r!==0&&(m=qn(r))))):(E=c&~p,E!==0?m=qn(E):v!==0?m=qn(v):r||(r=c&~e,r!==0&&(m=qn(r)))),m===0?0:n!==0&&n!==m&&(n&p)===0&&(p=m&-m,r=n&-n,p>=r||p===32&&(r&4194048)!==0)?n:m}function Ca(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function uy(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function od(){var e=Hr;return Hr<<=1,(Hr&62914560)===0&&(Hr=4194304),e}function Yl(e){for(var n=[],r=0;31>r;r++)n.push(e);return n}function _a(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function hy(e,n,r,c,m,p){var v=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var E=e.entanglements,N=e.expirationTimes,I=e.hiddenUpdates;for(r=v&~r;0<r;){var $=31-ni(r),W=1<<$;E[$]=0,N[$]=-1;var U=I[$];if(U!==null)for(I[$]=null,$=0;$<U.length;$++){var V=U[$];V!==null&&(V.lane&=-536870913)}r&=~W}c!==0&&ld(e,c,0),p!==0&&m===0&&e.tag!==0&&(e.suspendedLanes|=p&~(v&~n))}function ld(e,n,r){e.pendingLanes|=n,e.suspendedLanes&=~n;var c=31-ni(n);e.entangledLanes|=n,e.entanglements[c]=e.entanglements[c]|1073741824|r&261930}function cd(e,n){var r=e.entangledLanes|=n;for(e=e.entanglements;r;){var c=31-ni(r),m=1<<c;m&n|e[c]&n&&(e[c]|=n),r&=~m}}function ud(e,n){var r=n&-n;return r=(r&42)!==0?1:ql(r),(r&(e.suspendedLanes|n))!==0?0:r}function ql(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function $l(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function hd(){var e=H.p;return e!==0?e:(e=window.event,e===void 0?32:Qg(e.type))}function dd(e,n){var r=H.p;try{return H.p=e,n()}finally{H.p=r}}var yn=Math.random().toString(36).slice(2),Me="__reactFiber$"+yn,Xe="__reactProps$"+yn,vs="__reactContainer$"+yn,Kl="__reactEvents$"+yn,dy="__reactListeners$"+yn,fy="__reactHandles$"+yn,fd="__reactResources$"+yn,Ma="__reactMarker$"+yn;function Wl(e){delete e[Me],delete e[Xe],delete e[Kl],delete e[dy],delete e[fy]}function As(e){var n=e[Me];if(n)return n;for(var r=e.parentNode;r;){if(n=r[vs]||r[Me]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(e=Bg(e);e!==null;){if(r=e[Me])return r;e=Bg(e)}return n}e=r,r=e.parentNode}return null}function ws(e){if(e=e[Me]||e[vs]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function ka(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function xs(e){var n=e[fd];return n||(n=e[fd]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function xe(e){e[Ma]=!0}var md=new Set,gd={};function $n(e,n){Ss(e,n),Ss(e+"Capture",n)}function Ss(e,n){for(gd[e]=n,e=0;e<n.length;e++)md.add(n[e])}var my=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),pd={},bd={};function gy(e){return Kt.call(bd,e)?!0:Kt.call(pd,e)?!1:my.test(e)?bd[e]=!0:(pd[e]=!0,!1)}function Vr(e,n,r){if(gy(n))if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+r)}}function Xr(e,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+r)}}function $i(e,n,r,c){if(c===null)e.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(n,r,""+c)}}function bi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yd(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function py(e,n,r){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,p=c.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return m.call(this)},set:function(v){r=""+v,p.call(this,v)}}),Object.defineProperty(e,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(v){r=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Ql(e){if(!e._valueTracker){var n=yd(e)?"checked":"value";e._valueTracker=py(e,n,""+e[n])}}function vd(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return e&&(c=yd(e)?e.checked?"true":"false":e.value),e=c,e!==r?(n.setValue(e),!0):!1}function Yr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var by=/[\n"\\]/g;function yi(e){return e.replace(by,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Zl(e,n,r,c,m,p,v,E){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+bi(n)):e.value!==""+bi(n)&&(e.value=""+bi(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?Jl(e,v,bi(n)):r!=null?Jl(e,v,bi(r)):c!=null&&e.removeAttribute("value"),m==null&&p!=null&&(e.defaultChecked=!!p),m!=null&&(e.checked=m&&typeof m!="function"&&typeof m!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+bi(E):e.removeAttribute("name")}function Ad(e,n,r,c,m,p,v,E){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),n!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||n!=null)){Ql(e);return}r=r!=null?""+bi(r):"",n=n!=null?""+bi(n):r,E||n===e.value||(e.value=n),e.defaultValue=n}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=E?e.checked:!!c,e.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),Ql(e)}function Jl(e,n,r){n==="number"&&Yr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function Es(e,n,r,c){if(e=e.options,n){n={};for(var m=0;m<r.length;m++)n["$"+r[m]]=!0;for(r=0;r<e.length;r++)m=n.hasOwnProperty("$"+e[r].value),e[r].selected!==m&&(e[r].selected=m),m&&c&&(e[r].defaultSelected=!0)}else{for(r=""+bi(r),n=null,m=0;m<e.length;m++){if(e[m].value===r){e[m].selected=!0,c&&(e[m].defaultSelected=!0);return}n!==null||e[m].disabled||(n=e[m])}n!==null&&(n.selected=!0)}}function wd(e,n,r){if(n!=null&&(n=""+bi(n),n!==e.value&&(e.value=n),r==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=r!=null?""+bi(r):""}function xd(e,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(st(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=bi(n),e.defaultValue=r,c=e.textContent,c===r&&c!==""&&c!==null&&(e.value=c),Ql(e)}function Ts(e,n){if(n){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=n;return}}e.textContent=n}var yy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sd(e,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":c?e.setProperty(n,r):typeof r!="number"||r===0||yy.has(n)?n==="float"?e.cssFloat=r:e[n]=(""+r).trim():e[n]=r+"px"}function Ed(e,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var m in n)c=n[m],n.hasOwnProperty(m)&&r[m]!==c&&Sd(e,m,c)}else for(var p in n)n.hasOwnProperty(p)&&Sd(e,p,n[p])}function tc(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ay=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qr(e){return Ay.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ki(){}var ec=null;function ic(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cs=null,_s=null;function Td(e){var n=ws(e);if(n&&(e=n.stateNode)){var r=e[Xe]||null;t:switch(e=n.stateNode,n.type){case"input":if(Zl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+yi(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==e&&c.form===e.form){var m=c[Xe]||null;if(!m)throw Error(s(90));Zl(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===e.form&&vd(c)}break t;case"textarea":wd(e,r.value,r.defaultValue);break t;case"select":n=r.value,n!=null&&Es(e,!!r.multiple,n,!1)}}}var nc=!1;function Cd(e,n,r){if(nc)return e(n,r);nc=!0;try{var c=e(n);return c}finally{if(nc=!1,(Cs!==null||_s!==null)&&(Bo(),Cs&&(n=Cs,e=_s,_s=Cs=null,Td(n),e)))for(n=0;n<e.length;n++)Td(e[n])}}function Da(e,n){var r=e.stateNode;if(r===null)return null;var c=r[Xe]||null;if(c===null)return null;r=c[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sc=!1;if(Wi)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){sc=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{sc=!1}var vn=null,ac=null,$r=null;function _d(){if($r)return $r;var e,n=ac,r=n.length,c,m="value"in vn?vn.value:vn.textContent,p=m.length;for(e=0;e<r&&n[e]===m[e];e++);var v=r-e;for(c=1;c<=v&&n[r-c]===m[p-c];c++);return $r=m.slice(e,1<c?1-c:void 0)}function Kr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Wr(){return!0}function Md(){return!1}function Ye(e){function n(r,c,m,p,v){this._reactName=r,this._targetInst=m,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(r=e[E],this[E]=r?r(p):p[E]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Wr:Md,this.isPropagationStopped=Md,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),n}var Kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qr=Ye(Kn),Ra=b({},Kn,{view:0,detail:0}),wy=Ye(Ra),rc,oc,La,Zr=b({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==La&&(La&&e.type==="mousemove"?(rc=e.screenX-La.screenX,oc=e.screenY-La.screenY):oc=rc=0,La=e),rc)},movementY:function(e){return"movementY"in e?e.movementY:oc}}),kd=Ye(Zr),xy=b({},Zr,{dataTransfer:0}),Sy=Ye(xy),Ey=b({},Ra,{relatedTarget:0}),lc=Ye(Ey),Ty=b({},Kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Cy=Ye(Ty),_y=b({},Kn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),My=Ye(_y),ky=b({},Kn,{data:0}),Dd=Ye(ky),Dy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ny={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ry={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ly(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Ry[e])?!!n[e]:!1}function cc(){return Ly}var Oy=b({},Ra,{key:function(e){if(e.key){var n=Dy[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Kr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ny[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cc,charCode:function(e){return e.type==="keypress"?Kr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),By=Ye(Oy),Fy=b({},Zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nd=Ye(Fy),zy=b({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cc}),jy=Ye(zy),Py=b({},Kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Iy=Ye(Py),Uy=b({},Zr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hy=Ye(Uy),Gy=b({},Kn,{newState:0,oldState:0}),Vy=Ye(Gy),Xy=[9,13,27,32],uc=Wi&&"CompositionEvent"in window,Oa=null;Wi&&"documentMode"in document&&(Oa=document.documentMode);var Yy=Wi&&"TextEvent"in window&&!Oa,Rd=Wi&&(!uc||Oa&&8<Oa&&11>=Oa),Ld=" ",Od=!1;function Bd(e,n){switch(e){case"keyup":return Xy.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ms=!1;function qy(e,n){switch(e){case"compositionend":return Fd(n);case"keypress":return n.which!==32?null:(Od=!0,Ld);case"textInput":return e=n.data,e===Ld&&Od?null:e;default:return null}}function $y(e,n){if(Ms)return e==="compositionend"||!uc&&Bd(e,n)?(e=_d(),$r=ac=vn=null,Ms=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Rd&&n.locale!=="ko"?null:n.data;default:return null}}var Ky={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zd(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Ky[e.type]:n==="textarea"}function jd(e,n,r,c){Cs?_s?_s.push(c):_s=[c]:Cs=c,n=Ho(n,"onChange"),0<n.length&&(r=new Qr("onChange","change",null,r,c),e.push({event:r,listeners:n}))}var Ba=null,Fa=null;function Wy(e){wg(e,0)}function Jr(e){var n=ka(e);if(vd(n))return e}function Pd(e,n){if(e==="change")return n}var Id=!1;if(Wi){var hc;if(Wi){var dc="oninput"in document;if(!dc){var Ud=document.createElement("div");Ud.setAttribute("oninput","return;"),dc=typeof Ud.oninput=="function"}hc=dc}else hc=!1;Id=hc&&(!document.documentMode||9<document.documentMode)}function Hd(){Ba&&(Ba.detachEvent("onpropertychange",Gd),Fa=Ba=null)}function Gd(e){if(e.propertyName==="value"&&Jr(Fa)){var n=[];jd(n,Fa,e,ic(e)),Cd(Wy,n)}}function Qy(e,n,r){e==="focusin"?(Hd(),Ba=n,Fa=r,Ba.attachEvent("onpropertychange",Gd)):e==="focusout"&&Hd()}function Zy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jr(Fa)}function Jy(e,n){if(e==="click")return Jr(n)}function t0(e,n){if(e==="input"||e==="change")return Jr(n)}function e0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var si=typeof Object.is=="function"?Object.is:e0;function za(e,n){if(si(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var r=Object.keys(e),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var m=r[c];if(!Kt.call(n,m)||!si(e[m],n[m]))return!1}return!0}function Vd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xd(e,n){var r=Vd(e);e=0;for(var c;r;){if(r.nodeType===3){if(c=e+r.textContent.length,e<=n&&c>=n)return{node:r,offset:n-e};e=c}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Vd(r)}}function Yd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Yd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function qd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Yr(e.document);n instanceof e.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)e=n.contentWindow;else break;n=Yr(e.document)}return n}function fc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var i0=Wi&&"documentMode"in document&&11>=document.documentMode,ks=null,mc=null,ja=null,gc=!1;function $d(e,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;gc||ks==null||ks!==Yr(c)||(c=ks,"selectionStart"in c&&fc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ja&&za(ja,c)||(ja=c,c=Ho(mc,"onSelect"),0<c.length&&(n=new Qr("onSelect","select",null,n,r),e.push({event:n,listeners:c}),n.target=ks)))}function Wn(e,n){var r={};return r[e.toLowerCase()]=n.toLowerCase(),r["Webkit"+e]="webkit"+n,r["Moz"+e]="moz"+n,r}var Ds={animationend:Wn("Animation","AnimationEnd"),animationiteration:Wn("Animation","AnimationIteration"),animationstart:Wn("Animation","AnimationStart"),transitionrun:Wn("Transition","TransitionRun"),transitionstart:Wn("Transition","TransitionStart"),transitioncancel:Wn("Transition","TransitionCancel"),transitionend:Wn("Transition","TransitionEnd")},pc={},Kd={};Wi&&(Kd=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function Qn(e){if(pc[e])return pc[e];if(!Ds[e])return e;var n=Ds[e],r;for(r in n)if(n.hasOwnProperty(r)&&r in Kd)return pc[e]=n[r];return e}var Wd=Qn("animationend"),Qd=Qn("animationiteration"),Zd=Qn("animationstart"),n0=Qn("transitionrun"),s0=Qn("transitionstart"),a0=Qn("transitioncancel"),Jd=Qn("transitionend"),tf=new Map,bc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bc.push("scrollEnd");function Li(e,n){tf.set(e,n),$n(n,[e])}var to=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},vi=[],Ns=0,yc=0;function eo(){for(var e=Ns,n=yc=Ns=0;n<e;){var r=vi[n];vi[n++]=null;var c=vi[n];vi[n++]=null;var m=vi[n];vi[n++]=null;var p=vi[n];if(vi[n++]=null,c!==null&&m!==null){var v=c.pending;v===null?m.next=m:(m.next=v.next,v.next=m),c.pending=m}p!==0&&ef(r,m,p)}}function io(e,n,r,c){vi[Ns++]=e,vi[Ns++]=n,vi[Ns++]=r,vi[Ns++]=c,yc|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function vc(e,n,r,c){return io(e,n,r,c),no(e)}function Zn(e,n){return io(e,null,null,n),no(e)}function ef(e,n,r){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r);for(var m=!1,p=e.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(m=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,m&&n!==null&&(m=31-ni(r),e=p.hiddenUpdates,c=e[m],c===null?e[m]=[n]:c.push(n),n.lane=r|536870912),p):null}function no(e){if(50<rr)throw rr=0,Mu=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Rs={};function r0(e,n,r,c){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(e,n,r,c){return new r0(e,n,r,c)}function Ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qi(e,n){var r=e.alternate;return r===null?(r=ai(e.tag,n,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function nf(e,n){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,n=r.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function so(e,n,r,c,m,p){var v=0;if(c=e,typeof e=="function")Ac(e)&&(v=1);else if(typeof e=="string")v=hv(e,r,tt.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case Y:return e=ai(31,r,n,m),e.elementType=Y,e.lanes=p,e;case w:return Jn(r.children,m,p,n);case C:v=8,m|=24;break;case S:return e=ai(12,r,n,m|2),e.elementType=S,e.lanes=p,e;case R:return e=ai(13,r,n,m),e.elementType=R,e.lanes=p,e;case k:return e=ai(19,r,n,m),e.elementType=k,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _:v=10;break t;case M:v=9;break t;case D:v=11;break t;case F:v=14;break t;case j:v=16,c=null;break t}v=29,r=Error(s(130,e===null?"null":typeof e,"")),c=null}return n=ai(v,r,n,m),n.elementType=e,n.type=c,n.lanes=p,n}function Jn(e,n,r,c){return e=ai(7,e,c,n),e.lanes=r,e}function wc(e,n,r){return e=ai(6,e,null,n),e.lanes=r,e}function sf(e){var n=ai(18,null,null,0);return n.stateNode=e,n}function xc(e,n,r){return n=ai(4,e.children!==null?e.children:[],e.key,n),n.lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var af=new WeakMap;function Ai(e,n){if(typeof e=="object"&&e!==null){var r=af.get(e);return r!==void 0?r:(n={value:e,source:n,stack:dt(n)},af.set(e,n),n)}return{value:e,source:n,stack:dt(n)}}var Ls=[],Os=0,ao=null,Pa=0,wi=[],xi=0,An=null,zi=1,ji="";function Zi(e,n){Ls[Os++]=Pa,Ls[Os++]=ao,ao=e,Pa=n}function rf(e,n,r){wi[xi++]=zi,wi[xi++]=ji,wi[xi++]=An,An=e;var c=zi;e=ji;var m=32-ni(c)-1;c&=~(1<<m),r+=1;var p=32-ni(n)+m;if(30<p){var v=m-m%5;p=(c&(1<<v)-1).toString(32),c>>=v,m-=v,zi=1<<32-ni(n)+m|r<<m|c,ji=p+e}else zi=1<<p|r<<m|c,ji=e}function Sc(e){e.return!==null&&(Zi(e,1),rf(e,1,0))}function Ec(e){for(;e===ao;)ao=Ls[--Os],Ls[Os]=null,Pa=Ls[--Os],Ls[Os]=null;for(;e===An;)An=wi[--xi],wi[xi]=null,ji=wi[--xi],wi[xi]=null,zi=wi[--xi],wi[xi]=null}function of(e,n){wi[xi++]=zi,wi[xi++]=ji,wi[xi++]=An,zi=n.id,ji=n.overflow,An=e}var ke=null,Zt=null,Nt=!1,wn=null,Si=!1,Tc=Error(s(519));function xn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ia(Ai(n,e)),Tc}function lf(e){var n=e.stateNode,r=e.type,c=e.memoizedProps;switch(n[Me]=e,n[Xe]=c,r){case"dialog":Mt("cancel",n),Mt("close",n);break;case"iframe":case"object":case"embed":Mt("load",n);break;case"video":case"audio":for(r=0;r<lr.length;r++)Mt(lr[r],n);break;case"source":Mt("error",n);break;case"img":case"image":case"link":Mt("error",n),Mt("load",n);break;case"details":Mt("toggle",n);break;case"input":Mt("invalid",n),Ad(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Mt("invalid",n);break;case"textarea":Mt("invalid",n),xd(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||Tg(n.textContent,r)?(c.popover!=null&&(Mt("beforetoggle",n),Mt("toggle",n)),c.onScroll!=null&&Mt("scroll",n),c.onScrollEnd!=null&&Mt("scrollend",n),c.onClick!=null&&(n.onclick=Ki),n=!0):n=!1,n||xn(e,!0)}function cf(e){for(ke=e.return;ke;)switch(ke.tag){case 5:case 31:case 13:Si=!1;return;case 27:case 3:Si=!0;return;default:ke=ke.return}}function Bs(e){if(e!==ke)return!1;if(!Nt)return cf(e),Nt=!0,!1;var n=e.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Gu(e.type,e.memoizedProps)),r=!r),r&&Zt&&xn(e),cf(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Zt=Og(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Zt=Og(e)}else n===27?(n=Zt,Fn(e.type)?(e=$u,$u=null,Zt=e):Zt=n):Zt=ke?Ti(e.stateNode.nextSibling):null;return!0}function ts(){Zt=ke=null,Nt=!1}function Cc(){var e=wn;return e!==null&&(We===null?We=e:We.push.apply(We,e),wn=null),e}function Ia(e){wn===null?wn=[e]:wn.push(e)}var _c=L(null),es=null,Ji=null;function Sn(e,n,r){q(_c,n._currentValue),n._currentValue=r}function tn(e){e._currentValue=_c.current,G(_c)}function Mc(e,n,r){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===r)break;e=e.return}}function kc(e,n,r,c){var m=e.child;for(m!==null&&(m.return=e);m!==null;){var p=m.dependencies;if(p!==null){var v=m.child;p=p.firstContext;t:for(;p!==null;){var E=p;p=m;for(var N=0;N<n.length;N++)if(E.context===n[N]){p.lanes|=r,E=p.alternate,E!==null&&(E.lanes|=r),Mc(p.return,r,e),c||(v=null);break t}p=E.next}}else if(m.tag===18){if(v=m.return,v===null)throw Error(s(341));v.lanes|=r,p=v.alternate,p!==null&&(p.lanes|=r),Mc(v,r,e),v=null}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===e){v=null;break}if(m=v.sibling,m!==null){m.return=v.return,v=m;break}v=v.return}m=v}}function Fs(e,n,r,c){e=null;for(var m=n,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var v=m.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var E=m.type;si(m.pendingProps.value,v.value)||(e!==null?e.push(E):e=[E])}}else if(m===mt.current){if(v=m.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(e!==null?e.push(fr):e=[fr])}m=m.return}e!==null&&kc(n,e,r,c),n.flags|=262144}function ro(e){for(e=e.firstContext;e!==null;){if(!si(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function is(e){es=e,Ji=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function De(e){return uf(es,e)}function oo(e,n){return es===null&&is(e),uf(e,n)}function uf(e,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Ji===null){if(e===null)throw Error(s(308));Ji=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Ji=Ji.next=n;return r}var o0=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(r,c){e.push(c)}};this.abort=function(){n.aborted=!0,e.forEach(function(r){return r()})}},l0=h.unstable_scheduleCallback,c0=h.unstable_NormalPriority,fe={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dc(){return{controller:new o0,data:new Map,refCount:0}}function Ua(e){e.refCount--,e.refCount===0&&l0(c0,function(){e.controller.abort()})}var Ha=null,Nc=0,zs=0,js=null;function u0(e,n){if(Ha===null){var r=Ha=[];Nc=0,zs=Ou(),js={status:"pending",value:void 0,then:function(c){r.push(c)}}}return Nc++,n.then(hf,hf),n}function hf(){if(--Nc===0&&Ha!==null){js!==null&&(js.status="fulfilled");var e=Ha;Ha=null,zs=0,js=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function h0(e,n){var r=[],c={status:"pending",value:null,reason:null,then:function(m){r.push(m)}};return e.then(function(){c.status="fulfilled",c.value=n;for(var m=0;m<r.length;m++)(0,r[m])(n)},function(m){for(c.status="rejected",c.reason=m,m=0;m<r.length;m++)(0,r[m])(void 0)}),c}var df=B.S;B.S=function(e,n){Km=Ie(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&u0(e,n),df!==null&&df(e,n)};var ns=L(null);function Rc(){var e=ns.current;return e!==null?e:Wt.pooledCache}function lo(e,n){n===null?q(ns,ns.current):q(ns,n.pool)}function ff(){var e=Rc();return e===null?null:{parent:fe._currentValue,pool:e}}var Ps=Error(s(460)),Lc=Error(s(474)),co=Error(s(542)),uo={then:function(){}};function mf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function gf(e,n,r){switch(r=e[r],r===void 0?e.push(n):r!==n&&(n.then(Ki,Ki),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,bf(e),e;default:if(typeof n.status=="string")n.then(Ki,Ki);else{if(e=Wt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(c){if(n.status==="pending"){var m=n;m.status="fulfilled",m.value=c}},function(c){if(n.status==="pending"){var m=n;m.status="rejected",m.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,bf(e),e}throw as=n,Ps}}function ss(e){try{var n=e._init;return n(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(as=r,Ps):r}}var as=null;function pf(){if(as===null)throw Error(s(459));var e=as;return as=null,e}function bf(e){if(e===Ps||e===co)throw Error(s(483))}var Is=null,Ga=0;function ho(e){var n=Ga;return Ga+=1,Is===null&&(Is=[]),gf(Is,e,n)}function Va(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function fo(e,n){throw n.$$typeof===y?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function yf(e){function n(z,O){if(e){var P=z.deletions;P===null?(z.deletions=[O],z.flags|=16):P.push(O)}}function r(z,O){if(!e)return null;for(;O!==null;)n(z,O),O=O.sibling;return null}function c(z){for(var O=new Map;z!==null;)z.key!==null?O.set(z.key,z):O.set(z.index,z),z=z.sibling;return O}function m(z,O){return z=Qi(z,O),z.index=0,z.sibling=null,z}function p(z,O,P){return z.index=P,e?(P=z.alternate,P!==null?(P=P.index,P<O?(z.flags|=67108866,O):P):(z.flags|=67108866,O)):(z.flags|=1048576,O)}function v(z){return e&&z.alternate===null&&(z.flags|=67108866),z}function E(z,O,P,K){return O===null||O.tag!==6?(O=wc(P,z.mode,K),O.return=z,O):(O=m(O,P),O.return=z,O)}function N(z,O,P,K){var gt=P.type;return gt===w?$(z,O,P.props.children,K,P.key):O!==null&&(O.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===j&&ss(gt)===O.type)?(O=m(O,P.props),Va(O,P),O.return=z,O):(O=so(P.type,P.key,P.props,null,z.mode,K),Va(O,P),O.return=z,O)}function I(z,O,P,K){return O===null||O.tag!==4||O.stateNode.containerInfo!==P.containerInfo||O.stateNode.implementation!==P.implementation?(O=xc(P,z.mode,K),O.return=z,O):(O=m(O,P.children||[]),O.return=z,O)}function $(z,O,P,K,gt){return O===null||O.tag!==7?(O=Jn(P,z.mode,K,gt),O.return=z,O):(O=m(O,P),O.return=z,O)}function W(z,O,P){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=wc(""+O,z.mode,P),O.return=z,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case A:return P=so(O.type,O.key,O.props,null,z.mode,P),Va(P,O),P.return=z,P;case x:return O=xc(O,z.mode,P),O.return=z,O;case j:return O=ss(O),W(z,O,P)}if(st(O)||it(O))return O=Jn(O,z.mode,P,null),O.return=z,O;if(typeof O.then=="function")return W(z,ho(O),P);if(O.$$typeof===_)return W(z,oo(z,O),P);fo(z,O)}return null}function U(z,O,P,K){var gt=O!==null?O.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return gt!==null?null:E(z,O,""+P,K);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case A:return P.key===gt?N(z,O,P,K):null;case x:return P.key===gt?I(z,O,P,K):null;case j:return P=ss(P),U(z,O,P,K)}if(st(P)||it(P))return gt!==null?null:$(z,O,P,K,null);if(typeof P.then=="function")return U(z,O,ho(P),K);if(P.$$typeof===_)return U(z,O,oo(z,P),K);fo(z,P)}return null}function V(z,O,P,K,gt){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return z=z.get(P)||null,E(O,z,""+K,gt);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case A:return z=z.get(K.key===null?P:K.key)||null,N(O,z,K,gt);case x:return z=z.get(K.key===null?P:K.key)||null,I(O,z,K,gt);case j:return K=ss(K),V(z,O,P,K,gt)}if(st(K)||it(K))return z=z.get(P)||null,$(O,z,K,gt,null);if(typeof K.then=="function")return V(z,O,P,ho(K),gt);if(K.$$typeof===_)return V(z,O,P,oo(O,K),gt);fo(O,K)}return null}function ot(z,O,P,K){for(var gt=null,Bt=null,ut=O,Ct=O=0,Dt=null;ut!==null&&Ct<P.length;Ct++){ut.index>Ct?(Dt=ut,ut=null):Dt=ut.sibling;var Ft=U(z,ut,P[Ct],K);if(Ft===null){ut===null&&(ut=Dt);break}e&&ut&&Ft.alternate===null&&n(z,ut),O=p(Ft,O,Ct),Bt===null?gt=Ft:Bt.sibling=Ft,Bt=Ft,ut=Dt}if(Ct===P.length)return r(z,ut),Nt&&Zi(z,Ct),gt;if(ut===null){for(;Ct<P.length;Ct++)ut=W(z,P[Ct],K),ut!==null&&(O=p(ut,O,Ct),Bt===null?gt=ut:Bt.sibling=ut,Bt=ut);return Nt&&Zi(z,Ct),gt}for(ut=c(ut);Ct<P.length;Ct++)Dt=V(ut,z,Ct,P[Ct],K),Dt!==null&&(e&&Dt.alternate!==null&&ut.delete(Dt.key===null?Ct:Dt.key),O=p(Dt,O,Ct),Bt===null?gt=Dt:Bt.sibling=Dt,Bt=Dt);return e&&ut.forEach(function(Un){return n(z,Un)}),Nt&&Zi(z,Ct),gt}function vt(z,O,P,K){if(P==null)throw Error(s(151));for(var gt=null,Bt=null,ut=O,Ct=O=0,Dt=null,Ft=P.next();ut!==null&&!Ft.done;Ct++,Ft=P.next()){ut.index>Ct?(Dt=ut,ut=null):Dt=ut.sibling;var Un=U(z,ut,Ft.value,K);if(Un===null){ut===null&&(ut=Dt);break}e&&ut&&Un.alternate===null&&n(z,ut),O=p(Un,O,Ct),Bt===null?gt=Un:Bt.sibling=Un,Bt=Un,ut=Dt}if(Ft.done)return r(z,ut),Nt&&Zi(z,Ct),gt;if(ut===null){for(;!Ft.done;Ct++,Ft=P.next())Ft=W(z,Ft.value,K),Ft!==null&&(O=p(Ft,O,Ct),Bt===null?gt=Ft:Bt.sibling=Ft,Bt=Ft);return Nt&&Zi(z,Ct),gt}for(ut=c(ut);!Ft.done;Ct++,Ft=P.next())Ft=V(ut,z,Ct,Ft.value,K),Ft!==null&&(e&&Ft.alternate!==null&&ut.delete(Ft.key===null?Ct:Ft.key),O=p(Ft,O,Ct),Bt===null?gt=Ft:Bt.sibling=Ft,Bt=Ft);return e&&ut.forEach(function(xv){return n(z,xv)}),Nt&&Zi(z,Ct),gt}function qt(z,O,P,K){if(typeof P=="object"&&P!==null&&P.type===w&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case A:t:{for(var gt=P.key;O!==null;){if(O.key===gt){if(gt=P.type,gt===w){if(O.tag===7){r(z,O.sibling),K=m(O,P.props.children),K.return=z,z=K;break t}}else if(O.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===j&&ss(gt)===O.type){r(z,O.sibling),K=m(O,P.props),Va(K,P),K.return=z,z=K;break t}r(z,O);break}else n(z,O);O=O.sibling}P.type===w?(K=Jn(P.props.children,z.mode,K,P.key),K.return=z,z=K):(K=so(P.type,P.key,P.props,null,z.mode,K),Va(K,P),K.return=z,z=K)}return v(z);case x:t:{for(gt=P.key;O!==null;){if(O.key===gt)if(O.tag===4&&O.stateNode.containerInfo===P.containerInfo&&O.stateNode.implementation===P.implementation){r(z,O.sibling),K=m(O,P.children||[]),K.return=z,z=K;break t}else{r(z,O);break}else n(z,O);O=O.sibling}K=xc(P,z.mode,K),K.return=z,z=K}return v(z);case j:return P=ss(P),qt(z,O,P,K)}if(st(P))return ot(z,O,P,K);if(it(P)){if(gt=it(P),typeof gt!="function")throw Error(s(150));return P=gt.call(P),vt(z,O,P,K)}if(typeof P.then=="function")return qt(z,O,ho(P),K);if(P.$$typeof===_)return qt(z,O,oo(z,P),K);fo(z,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,O!==null&&O.tag===6?(r(z,O.sibling),K=m(O,P),K.return=z,z=K):(r(z,O),K=wc(P,z.mode,K),K.return=z,z=K),v(z)):r(z,O)}return function(z,O,P,K){try{Ga=0;var gt=qt(z,O,P,K);return Is=null,gt}catch(ut){if(ut===Ps||ut===co)throw ut;var Bt=ai(29,ut,null,z.mode);return Bt.lanes=K,Bt.return=z,Bt}}}var rs=yf(!0),vf=yf(!1),En=!1;function Oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Tn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Cn(e,n,r){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(zt&2)!==0){var m=c.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),c.pending=n,n=no(e),ef(e,null,r),n}return io(e,c,n,r),no(e)}function Xa(e,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,cd(e,r)}}function Fc(e,n){var r=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var m=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var v={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?m=p=v:p=p.next=v,r=r.next}while(r!==null);p===null?m=p=n:p=p.next=n}else m=p=n;r={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=n:e.next=n,r.lastBaseUpdate=n}var zc=!1;function Ya(){if(zc){var e=js;if(e!==null)throw e}}function qa(e,n,r,c){zc=!1;var m=e.updateQueue;En=!1;var p=m.firstBaseUpdate,v=m.lastBaseUpdate,E=m.shared.pending;if(E!==null){m.shared.pending=null;var N=E,I=N.next;N.next=null,v===null?p=I:v.next=I,v=N;var $=e.alternate;$!==null&&($=$.updateQueue,E=$.lastBaseUpdate,E!==v&&(E===null?$.firstBaseUpdate=I:E.next=I,$.lastBaseUpdate=N))}if(p!==null){var W=m.baseState;v=0,$=I=N=null,E=p;do{var U=E.lane&-536870913,V=U!==E.lane;if(V?(kt&U)===U:(c&U)===U){U!==0&&U===zs&&(zc=!0),$!==null&&($=$.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});t:{var ot=e,vt=E;U=n;var qt=r;switch(vt.tag){case 1:if(ot=vt.payload,typeof ot=="function"){W=ot.call(qt,W,U);break t}W=ot;break t;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=vt.payload,U=typeof ot=="function"?ot.call(qt,W,U):ot,U==null)break t;W=b({},W,U);break t;case 2:En=!0}}U=E.callback,U!==null&&(e.flags|=64,V&&(e.flags|=8192),V=m.callbacks,V===null?m.callbacks=[U]:V.push(U))}else V={lane:U,tag:E.tag,payload:E.payload,callback:E.callback,next:null},$===null?(I=$=V,N=W):$=$.next=V,v|=U;if(E=E.next,E===null){if(E=m.shared.pending,E===null)break;V=E,E=V.next,V.next=null,m.lastBaseUpdate=V,m.shared.pending=null}}while(!0);$===null&&(N=W),m.baseState=N,m.firstBaseUpdate=I,m.lastBaseUpdate=$,p===null&&(m.shared.lanes=0),Nn|=v,e.lanes=v,e.memoizedState=W}}function Af(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function wf(e,n){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Af(r[e],n)}var Us=L(null),mo=L(0);function xf(e,n){e=un,q(mo,e),q(Us,n),un=e|n.baseLanes}function jc(){q(mo,un),q(Us,Us.current)}function Pc(){un=mo.current,G(Us),G(mo)}var ri=L(null),Ei=null;function _n(e){var n=e.alternate;q(ce,ce.current&1),q(ri,e),Ei===null&&(n===null||Us.current!==null||n.memoizedState!==null)&&(Ei=e)}function Ic(e){q(ce,ce.current),q(ri,e),Ei===null&&(Ei=e)}function Sf(e){e.tag===22?(q(ce,ce.current),q(ri,e),Ei===null&&(Ei=e)):Mn()}function Mn(){q(ce,ce.current),q(ri,ri.current)}function oi(e){G(ri),Ei===e&&(Ei=null),G(ce)}var ce=L(0);function go(e){for(var n=e;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Yu(r)||qu(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var en=0,Tt=null,Xt=null,me=null,po=!1,Hs=!1,os=!1,bo=0,$a=0,Gs=null,d0=0;function re(){throw Error(s(321))}function Uc(e,n){if(n===null)return!1;for(var r=0;r<n.length&&r<e.length;r++)if(!si(e[r],n[r]))return!1;return!0}function Hc(e,n,r,c,m,p){return en=p,Tt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,B.H=e===null||e.memoizedState===null?rm:nu,os=!1,p=r(c,m),os=!1,Hs&&(p=Tf(n,r,c,m)),Ef(e),p}function Ef(e){B.H=Qa;var n=Xt!==null&&Xt.next!==null;if(en=0,me=Xt=Tt=null,po=!1,$a=0,Gs=null,n)throw Error(s(300));e===null||ge||(e=e.dependencies,e!==null&&ro(e)&&(ge=!0))}function Tf(e,n,r,c){Tt=e;var m=0;do{if(Hs&&(Gs=null),$a=0,Hs=!1,25<=m)throw Error(s(301));if(m+=1,me=Xt=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}B.H=om,p=n(r,c)}while(Hs);return p}function f0(){var e=B.H,n=e.useState()[0];return n=typeof n.then=="function"?Ka(n):n,e=e.useState()[0],(Xt!==null?Xt.memoizedState:null)!==e&&(Tt.flags|=1024),n}function Gc(){var e=bo!==0;return bo=0,e}function Vc(e,n,r){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r}function Xc(e){if(po){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}po=!1}en=0,me=Xt=Tt=null,Hs=!1,$a=bo=0,Gs=null}function Ue(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return me===null?Tt.memoizedState=me=e:me=me.next=e,me}function ue(){if(Xt===null){var e=Tt.alternate;e=e!==null?e.memoizedState:null}else e=Xt.next;var n=me===null?Tt.memoizedState:me.next;if(n!==null)me=n,Xt=e;else{if(e===null)throw Tt.alternate===null?Error(s(467)):Error(s(310));Xt=e,e={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},me===null?Tt.memoizedState=me=e:me=me.next=e}return me}function yo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ka(e){var n=$a;return $a+=1,Gs===null&&(Gs=[]),e=gf(Gs,e,n),n=Tt,(me===null?n.memoizedState:me.next)===null&&(n=n.alternate,B.H=n===null||n.memoizedState===null?rm:nu),e}function vo(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ka(e);if(e.$$typeof===_)return De(e)}throw Error(s(438,String(e)))}function Yc(e){var n=null,r=Tt.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=Tt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(m){return m.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=yo(),Tt.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(e),c=0;c<e;c++)r[c]=X;return n.index++,r}function nn(e,n){return typeof n=="function"?n(e):n}function Ao(e){var n=ue();return qc(n,Xt,e)}function qc(e,n,r){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var m=e.baseQueue,p=c.pending;if(p!==null){if(m!==null){var v=m.next;m.next=p.next,p.next=v}n.baseQueue=m=p,c.pending=null}if(p=e.baseState,m===null)e.memoizedState=p;else{n=m.next;var E=v=null,N=null,I=n,$=!1;do{var W=I.lane&-536870913;if(W!==I.lane?(kt&W)===W:(en&W)===W){var U=I.revertLane;if(U===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),W===zs&&($=!0);else if((en&U)===U){I=I.next,U===zs&&($=!0);continue}else W={lane:0,revertLane:I.revertLane,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},N===null?(E=N=W,v=p):N=N.next=W,Tt.lanes|=U,Nn|=U;W=I.action,os&&r(p,W),p=I.hasEagerState?I.eagerState:r(p,W)}else U={lane:W,revertLane:I.revertLane,gesture:I.gesture,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},N===null?(E=N=U,v=p):N=N.next=U,Tt.lanes|=W,Nn|=W;I=I.next}while(I!==null&&I!==n);if(N===null?v=p:N.next=E,!si(p,e.memoizedState)&&(ge=!0,$&&(r=js,r!==null)))throw r;e.memoizedState=p,e.baseState=v,e.baseQueue=N,c.lastRenderedState=p}return m===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function $c(e){var n=ue(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=e;var c=r.dispatch,m=r.pending,p=n.memoizedState;if(m!==null){r.pending=null;var v=m=m.next;do p=e(p,v.action),v=v.next;while(v!==m);si(p,n.memoizedState)||(ge=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),r.lastRenderedState=p}return[p,c]}function Cf(e,n,r){var c=Tt,m=ue(),p=Nt;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=n();var v=!si((Xt||m).memoizedState,r);if(v&&(m.memoizedState=r,ge=!0),m=m.queue,Qc(kf.bind(null,c,m,e),[e]),m.getSnapshot!==n||v||me!==null&&me.memoizedState.tag&1){if(c.flags|=2048,Vs(9,{destroy:void 0},Mf.bind(null,c,m,r,n),null),Wt===null)throw Error(s(349));p||(en&127)!==0||_f(c,n,r)}return r}function _f(e,n,r){e.flags|=16384,e={getSnapshot:n,value:r},n=Tt.updateQueue,n===null?(n=yo(),Tt.updateQueue=n,n.stores=[e]):(r=n.stores,r===null?n.stores=[e]:r.push(e))}function Mf(e,n,r,c){n.value=r,n.getSnapshot=c,Df(n)&&Nf(e)}function kf(e,n,r){return r(function(){Df(n)&&Nf(e)})}function Df(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!si(e,r)}catch{return!0}}function Nf(e){var n=Zn(e,2);n!==null&&Qe(n,e,2)}function Kc(e){var n=Ue();if(typeof e=="function"){var r=e;if(e=r(),os){bn(!0);try{r()}finally{bn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nn,lastRenderedState:e},n}function Rf(e,n,r,c){return e.baseState=r,qc(e,Xt,typeof c=="function"?c:nn)}function m0(e,n,r,c,m){if(So(e))throw Error(s(485));if(e=n.action,e!==null){var p={payload:m,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};B.T!==null?r(!0):p.isTransition=!1,c(p),r=n.pending,r===null?(p.next=n.pending=p,Lf(n,p)):(p.next=r.next,n.pending=r.next=p)}}function Lf(e,n){var r=n.action,c=n.payload,m=e.state;if(n.isTransition){var p=B.T,v={};B.T=v;try{var E=r(m,c),N=B.S;N!==null&&N(v,E),Of(e,n,E)}catch(I){Wc(e,n,I)}finally{p!==null&&v.types!==null&&(p.types=v.types),B.T=p}}else try{p=r(m,c),Of(e,n,p)}catch(I){Wc(e,n,I)}}function Of(e,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){Bf(e,n,c)},function(c){return Wc(e,n,c)}):Bf(e,n,r)}function Bf(e,n,r){n.status="fulfilled",n.value=r,Ff(n),e.state=r,n=e.pending,n!==null&&(r=n.next,r===n?e.pending=null:(r=r.next,n.next=r,Lf(e,r)))}function Wc(e,n,r){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,Ff(n),n=n.next;while(n!==c)}e.action=null}function Ff(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function zf(e,n){return n}function jf(e,n){if(Nt){var r=Wt.formState;if(r!==null){t:{var c=Tt;if(Nt){if(Zt){e:{for(var m=Zt,p=Si;m.nodeType!==8;){if(!p){m=null;break e}if(m=Ti(m.nextSibling),m===null){m=null;break e}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){Zt=Ti(m.nextSibling),c=m.data==="F!";break t}}xn(c)}c=!1}c&&(n=r[0])}}return r=Ue(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zf,lastRenderedState:n},r.queue=c,r=nm.bind(null,Tt,c),c.dispatch=r,c=Kc(!1),p=iu.bind(null,Tt,!1,c.queue),c=Ue(),m={state:n,dispatch:null,action:e,pending:null},c.queue=m,r=m0.bind(null,Tt,m,p,r),m.dispatch=r,c.memoizedState=e,[n,r,!1]}function Pf(e){var n=ue();return If(n,Xt,e)}function If(e,n,r){if(n=qc(e,n,zf)[0],e=Ao(nn)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=Ka(n)}catch(v){throw v===Ps?co:v}else c=n;n=ue();var m=n.queue,p=m.dispatch;return r!==n.memoizedState&&(Tt.flags|=2048,Vs(9,{destroy:void 0},g0.bind(null,m,r),null)),[c,p,e]}function g0(e,n){e.action=n}function Uf(e){var n=ue(),r=Xt;if(r!==null)return If(n,r,e);ue(),n=n.memoizedState,r=ue();var c=r.queue.dispatch;return r.memoizedState=e,[n,c,!1]}function Vs(e,n,r,c){return e={tag:e,create:r,deps:c,inst:n,next:null},n=Tt.updateQueue,n===null&&(n=yo(),Tt.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=e.next=e:(c=r.next,r.next=e,e.next=c,n.lastEffect=e),e}function Hf(){return ue().memoizedState}function wo(e,n,r,c){var m=Ue();Tt.flags|=e,m.memoizedState=Vs(1|n,{destroy:void 0},r,c===void 0?null:c)}function xo(e,n,r,c){var m=ue();c=c===void 0?null:c;var p=m.memoizedState.inst;Xt!==null&&c!==null&&Uc(c,Xt.memoizedState.deps)?m.memoizedState=Vs(n,p,r,c):(Tt.flags|=e,m.memoizedState=Vs(1|n,p,r,c))}function Gf(e,n){wo(8390656,8,e,n)}function Qc(e,n){xo(2048,8,e,n)}function p0(e){Tt.flags|=4;var n=Tt.updateQueue;if(n===null)n=yo(),Tt.updateQueue=n,n.events=[e];else{var r=n.events;r===null?n.events=[e]:r.push(e)}}function Vf(e){var n=ue().memoizedState;return p0({ref:n,nextImpl:e}),function(){if((zt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function Xf(e,n){return xo(4,2,e,n)}function Yf(e,n){return xo(4,4,e,n)}function qf(e,n){if(typeof n=="function"){e=e();var r=n(e);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function $f(e,n,r){r=r!=null?r.concat([e]):null,xo(4,4,qf.bind(null,n,e),r)}function Zc(){}function Kf(e,n){var r=ue();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Uc(n,c[1])?c[0]:(r.memoizedState=[e,n],e)}function Wf(e,n){var r=ue();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Uc(n,c[1]))return c[0];if(c=e(),os){bn(!0);try{e()}finally{bn(!1)}}return r.memoizedState=[c,n],c}function Jc(e,n,r){return r===void 0||(en&1073741824)!==0&&(kt&261930)===0?e.memoizedState=n:(e.memoizedState=r,e=Qm(),Tt.lanes|=e,Nn|=e,r)}function Qf(e,n,r,c){return si(r,n)?r:Us.current!==null?(e=Jc(e,r,c),si(e,n)||(ge=!0),e):(en&42)===0||(en&1073741824)!==0&&(kt&261930)===0?(ge=!0,e.memoizedState=r):(e=Qm(),Tt.lanes|=e,Nn|=e,n)}function Zf(e,n,r,c,m){var p=H.p;H.p=p!==0&&8>p?p:8;var v=B.T,E={};B.T=E,iu(e,!1,n,r);try{var N=m(),I=B.S;if(I!==null&&I(E,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var $=h0(N,c);Wa(e,n,$,ui(e))}else Wa(e,n,c,ui(e))}catch(W){Wa(e,n,{then:function(){},status:"rejected",reason:W},ui())}finally{H.p=p,v!==null&&E.types!==null&&(v.types=E.types),B.T=v}}function b0(){}function tu(e,n,r,c){if(e.tag!==5)throw Error(s(476));var m=Jf(e).queue;Zf(e,m,n,J,r===null?b0:function(){return tm(e),r(c)})}function Jf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nn,lastRenderedState:J},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nn,lastRenderedState:r},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function tm(e){var n=Jf(e);n.next===null&&(n=e.alternate.memoizedState),Wa(e,n.next.queue,{},ui())}function eu(){return De(fr)}function em(){return ue().memoizedState}function im(){return ue().memoizedState}function y0(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var r=ui();e=Tn(r);var c=Cn(n,e,r);c!==null&&(Qe(c,n,r),Xa(c,n,r)),n={cache:Dc()},e.payload=n;return}n=n.return}}function v0(e,n,r){var c=ui();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},So(e)?sm(n,r):(r=vc(e,n,r,c),r!==null&&(Qe(r,e,c),am(r,n,c)))}function nm(e,n,r){var c=ui();Wa(e,n,r,c)}function Wa(e,n,r,c){var m={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(So(e))sm(n,m);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var v=n.lastRenderedState,E=p(v,r);if(m.hasEagerState=!0,m.eagerState=E,si(E,v))return io(e,n,m,0),Wt===null&&eo(),!1}catch{}if(r=vc(e,n,m,c),r!==null)return Qe(r,e,c),am(r,n,c),!0}return!1}function iu(e,n,r,c){if(c={lane:2,revertLane:Ou(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},So(e)){if(n)throw Error(s(479))}else n=vc(e,r,c,2),n!==null&&Qe(n,e,2)}function So(e){var n=e.alternate;return e===Tt||n!==null&&n===Tt}function sm(e,n){Hs=po=!0;var r=e.pending;r===null?n.next=n:(n.next=r.next,r.next=n),e.pending=n}function am(e,n,r){if((r&4194048)!==0){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,cd(e,r)}}var Qa={readContext:De,use:vo,useCallback:re,useContext:re,useEffect:re,useImperativeHandle:re,useLayoutEffect:re,useInsertionEffect:re,useMemo:re,useReducer:re,useRef:re,useState:re,useDebugValue:re,useDeferredValue:re,useTransition:re,useSyncExternalStore:re,useId:re,useHostTransitionStatus:re,useFormState:re,useActionState:re,useOptimistic:re,useMemoCache:re,useCacheRefresh:re};Qa.useEffectEvent=re;var rm={readContext:De,use:vo,useCallback:function(e,n){return Ue().memoizedState=[e,n===void 0?null:n],e},useContext:De,useEffect:Gf,useImperativeHandle:function(e,n,r){r=r!=null?r.concat([e]):null,wo(4194308,4,qf.bind(null,n,e),r)},useLayoutEffect:function(e,n){return wo(4194308,4,e,n)},useInsertionEffect:function(e,n){wo(4,2,e,n)},useMemo:function(e,n){var r=Ue();n=n===void 0?null:n;var c=e();if(os){bn(!0);try{e()}finally{bn(!1)}}return r.memoizedState=[c,n],c},useReducer:function(e,n,r){var c=Ue();if(r!==void 0){var m=r(n);if(os){bn(!0);try{r(n)}finally{bn(!1)}}}else m=n;return c.memoizedState=c.baseState=m,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:m},c.queue=e,e=e.dispatch=v0.bind(null,Tt,e),[c.memoizedState,e]},useRef:function(e){var n=Ue();return e={current:e},n.memoizedState=e},useState:function(e){e=Kc(e);var n=e.queue,r=nm.bind(null,Tt,n);return n.dispatch=r,[e.memoizedState,r]},useDebugValue:Zc,useDeferredValue:function(e,n){var r=Ue();return Jc(r,e,n)},useTransition:function(){var e=Kc(!1);return e=Zf.bind(null,Tt,e.queue,!0,!1),Ue().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,r){var c=Tt,m=Ue();if(Nt){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),Wt===null)throw Error(s(349));(kt&127)!==0||_f(c,n,r)}m.memoizedState=r;var p={value:r,getSnapshot:n};return m.queue=p,Gf(kf.bind(null,c,p,e),[e]),c.flags|=2048,Vs(9,{destroy:void 0},Mf.bind(null,c,p,r,n),null),r},useId:function(){var e=Ue(),n=Wt.identifierPrefix;if(Nt){var r=ji,c=zi;r=(c&~(1<<32-ni(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=bo++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=d0++,n="_"+n+"r_"+r.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:eu,useFormState:jf,useActionState:jf,useOptimistic:function(e){var n=Ue();n.memoizedState=n.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=iu.bind(null,Tt,!0,r),r.dispatch=n,[e,n]},useMemoCache:Yc,useCacheRefresh:function(){return Ue().memoizedState=y0.bind(null,Tt)},useEffectEvent:function(e){var n=Ue(),r={impl:e};return n.memoizedState=r,function(){if((zt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},nu={readContext:De,use:vo,useCallback:Kf,useContext:De,useEffect:Qc,useImperativeHandle:$f,useInsertionEffect:Xf,useLayoutEffect:Yf,useMemo:Wf,useReducer:Ao,useRef:Hf,useState:function(){return Ao(nn)},useDebugValue:Zc,useDeferredValue:function(e,n){var r=ue();return Qf(r,Xt.memoizedState,e,n)},useTransition:function(){var e=Ao(nn)[0],n=ue().memoizedState;return[typeof e=="boolean"?e:Ka(e),n]},useSyncExternalStore:Cf,useId:em,useHostTransitionStatus:eu,useFormState:Pf,useActionState:Pf,useOptimistic:function(e,n){var r=ue();return Rf(r,Xt,e,n)},useMemoCache:Yc,useCacheRefresh:im};nu.useEffectEvent=Vf;var om={readContext:De,use:vo,useCallback:Kf,useContext:De,useEffect:Qc,useImperativeHandle:$f,useInsertionEffect:Xf,useLayoutEffect:Yf,useMemo:Wf,useReducer:$c,useRef:Hf,useState:function(){return $c(nn)},useDebugValue:Zc,useDeferredValue:function(e,n){var r=ue();return Xt===null?Jc(r,e,n):Qf(r,Xt.memoizedState,e,n)},useTransition:function(){var e=$c(nn)[0],n=ue().memoizedState;return[typeof e=="boolean"?e:Ka(e),n]},useSyncExternalStore:Cf,useId:em,useHostTransitionStatus:eu,useFormState:Uf,useActionState:Uf,useOptimistic:function(e,n){var r=ue();return Xt!==null?Rf(r,Xt,e,n):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Yc,useCacheRefresh:im};om.useEffectEvent=Vf;function su(e,n,r,c){n=e.memoizedState,r=r(c,n),r=r==null?n:b({},n,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var au={enqueueSetState:function(e,n,r){e=e._reactInternals;var c=ui(),m=Tn(c);m.payload=n,r!=null&&(m.callback=r),n=Cn(e,m,c),n!==null&&(Qe(n,e,c),Xa(n,e,c))},enqueueReplaceState:function(e,n,r){e=e._reactInternals;var c=ui(),m=Tn(c);m.tag=1,m.payload=n,r!=null&&(m.callback=r),n=Cn(e,m,c),n!==null&&(Qe(n,e,c),Xa(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var r=ui(),c=Tn(r);c.tag=2,n!=null&&(c.callback=n),n=Cn(e,c,r),n!==null&&(Qe(n,e,r),Xa(n,e,r))}};function lm(e,n,r,c,m,p,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,p,v):n.prototype&&n.prototype.isPureReactComponent?!za(r,c)||!za(m,p):!0}function cm(e,n,r,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==e&&au.enqueueReplaceState(n,n.state,null)}function ls(e,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(e=e.defaultProps){r===n&&(r=b({},r));for(var m in e)r[m]===void 0&&(r[m]=e[m])}return r}function um(e){to(e)}function hm(e){console.error(e)}function dm(e){to(e)}function Eo(e,n){try{var r=e.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function fm(e,n,r){try{var c=e.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ru(e,n,r){return r=Tn(r),r.tag=3,r.payload={element:null},r.callback=function(){Eo(e,n)},r}function mm(e){return e=Tn(e),e.tag=3,e}function gm(e,n,r,c){var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var p=c.value;e.payload=function(){return m(p)},e.callback=function(){fm(n,r,c)}}var v=r.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){fm(n,r,c),typeof m!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function A0(e,n,r,c,m){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Fs(n,r,m,!0),r=ri.current,r!==null){switch(r.tag){case 31:case 13:return Ei===null?Fo():r.alternate===null&&oe===0&&(oe=3),r.flags&=-257,r.flags|=65536,r.lanes=m,c===uo?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),Nu(e,c,m)),!1;case 22:return r.flags|=65536,c===uo?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),Nu(e,c,m)),!1}throw Error(s(435,r.tag))}return Nu(e,c,m),Fo(),!1}if(Nt)return n=ri.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=m,c!==Tc&&(e=Error(s(422),{cause:c}),Ia(Ai(e,r)))):(c!==Tc&&(n=Error(s(423),{cause:c}),Ia(Ai(n,r))),e=e.current.alternate,e.flags|=65536,m&=-m,e.lanes|=m,c=Ai(c,r),m=ru(e.stateNode,c,m),Fc(e,m),oe!==4&&(oe=2)),!1;var p=Error(s(520),{cause:c});if(p=Ai(p,r),ar===null?ar=[p]:ar.push(p),oe!==4&&(oe=2),n===null)return!0;c=Ai(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,e=m&-m,r.lanes|=e,e=ru(r.stateNode,c,e),Fc(r,e),!1;case 1:if(n=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Rn===null||!Rn.has(p))))return r.flags|=65536,m&=-m,r.lanes|=m,m=mm(m),gm(m,e,r,c),Fc(r,m),!1}r=r.return}while(r!==null);return!1}var ou=Error(s(461)),ge=!1;function Ne(e,n,r,c){n.child=e===null?vf(n,null,r,c):rs(n,e.child,r,c)}function pm(e,n,r,c,m){r=r.render;var p=n.ref;if("ref"in c){var v={};for(var E in c)E!=="ref"&&(v[E]=c[E])}else v=c;return is(n),c=Hc(e,n,r,v,p,m),E=Gc(),e!==null&&!ge?(Vc(e,n,m),sn(e,n,m)):(Nt&&E&&Sc(n),n.flags|=1,Ne(e,n,c,m),n.child)}function bm(e,n,r,c,m){if(e===null){var p=r.type;return typeof p=="function"&&!Ac(p)&&p.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=p,ym(e,n,p,c,m)):(e=so(r.type,null,c,n,n.mode,m),e.ref=n.ref,e.return=n,n.child=e)}if(p=e.child,!gu(e,m)){var v=p.memoizedProps;if(r=r.compare,r=r!==null?r:za,r(v,c)&&e.ref===n.ref)return sn(e,n,m)}return n.flags|=1,e=Qi(p,c),e.ref=n.ref,e.return=n,n.child=e}function ym(e,n,r,c,m){if(e!==null){var p=e.memoizedProps;if(za(p,c)&&e.ref===n.ref)if(ge=!1,n.pendingProps=c=p,gu(e,m))(e.flags&131072)!==0&&(ge=!0);else return n.lanes=e.lanes,sn(e,n,m)}return lu(e,n,r,c,m)}function vm(e,n,r,c){var m=c.children,p=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(p=p!==null?p.baseLanes|r:r,e!==null){for(c=n.child=e.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~p}else c=0,n.child=null;return Am(e,n,p,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&lo(n,p!==null?p.cachePool:null),p!==null?xf(n,p):jc(),Sf(n);else return c=n.lanes=536870912,Am(e,n,p!==null?p.baseLanes|r:r,r,c)}else p!==null?(lo(n,p.cachePool),xf(n,p),Mn(),n.memoizedState=null):(e!==null&&lo(n,null),jc(),Mn());return Ne(e,n,m,r),n.child}function Za(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Am(e,n,r,c,m){var p=Rc();return p=p===null?null:{parent:fe._currentValue,pool:p},n.memoizedState={baseLanes:r,cachePool:p},e!==null&&lo(n,null),jc(),Sf(n),e!==null&&Fs(e,n,c,!0),n.childLanes=m,null}function To(e,n){return n=_o({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function wm(e,n,r){return rs(n,e.child,null,r),e=To(n,n.pendingProps),e.flags|=2,oi(n),n.memoizedState=null,e}function w0(e,n,r){var c=n.pendingProps,m=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Nt){if(c.mode==="hidden")return e=To(n,c),n.lanes=536870912,Za(null,e);if(Ic(n),(e=Zt)?(e=Lg(e,Si),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:zi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},r=sf(e),r.return=n,n.child=r,ke=n,Zt=null)):e=null,e===null)throw xn(n);return n.lanes=536870912,null}return To(n,c)}var p=e.memoizedState;if(p!==null){var v=p.dehydrated;if(Ic(n),m)if(n.flags&256)n.flags&=-257,n=wm(e,n,r);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(ge||Fs(e,n,r,!1),m=(r&e.childLanes)!==0,ge||m){if(c=Wt,c!==null&&(v=ud(c,r),v!==0&&v!==p.retryLane))throw p.retryLane=v,Zn(e,v),Qe(c,e,v),ou;Fo(),n=wm(e,n,r)}else e=p.treeContext,Zt=Ti(v.nextSibling),ke=n,Nt=!0,wn=null,Si=!1,e!==null&&of(n,e),n=To(n,c),n.flags|=4096;return n}return e=Qi(e.child,{mode:c.mode,children:c.children}),e.ref=n.ref,n.child=e,e.return=n,e}function Co(e,n){var r=n.ref;if(r===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(e===null||e.ref!==r)&&(n.flags|=4194816)}}function lu(e,n,r,c,m){return is(n),r=Hc(e,n,r,c,void 0,m),c=Gc(),e!==null&&!ge?(Vc(e,n,m),sn(e,n,m)):(Nt&&c&&Sc(n),n.flags|=1,Ne(e,n,r,m),n.child)}function xm(e,n,r,c,m,p){return is(n),n.updateQueue=null,r=Tf(n,c,r,m),Ef(e),c=Gc(),e!==null&&!ge?(Vc(e,n,p),sn(e,n,p)):(Nt&&c&&Sc(n),n.flags|=1,Ne(e,n,r,p),n.child)}function Sm(e,n,r,c,m){if(is(n),n.stateNode===null){var p=Rs,v=r.contextType;typeof v=="object"&&v!==null&&(p=De(v)),p=new r(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=au,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},Oc(n),v=r.contextType,p.context=typeof v=="object"&&v!==null?De(v):Rs,p.state=n.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(su(n,r,v,c),p.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&au.enqueueReplaceState(p,p.state,null),qa(n,c,p,m),Ya(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(e===null){p=n.stateNode;var E=n.memoizedProps,N=ls(r,E);p.props=N;var I=p.context,$=r.contextType;v=Rs,typeof $=="object"&&$!==null&&(v=De($));var W=r.getDerivedStateFromProps;$=typeof W=="function"||typeof p.getSnapshotBeforeUpdate=="function",E=n.pendingProps!==E,$||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(E||I!==v)&&cm(n,p,c,v),En=!1;var U=n.memoizedState;p.state=U,qa(n,c,p,m),Ya(),I=n.memoizedState,E||U!==I||En?(typeof W=="function"&&(su(n,r,W,c),I=n.memoizedState),(N=En||lm(n,r,N,c,U,I,v))?($||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=I),p.props=c,p.state=I,p.context=v,c=N):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,Bc(e,n),v=n.memoizedProps,$=ls(r,v),p.props=$,W=n.pendingProps,U=p.context,I=r.contextType,N=Rs,typeof I=="object"&&I!==null&&(N=De(I)),E=r.getDerivedStateFromProps,(I=typeof E=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==W||U!==N)&&cm(n,p,c,N),En=!1,U=n.memoizedState,p.state=U,qa(n,c,p,m),Ya();var V=n.memoizedState;v!==W||U!==V||En||e!==null&&e.dependencies!==null&&ro(e.dependencies)?(typeof E=="function"&&(su(n,r,E,c),V=n.memoizedState),($=En||lm(n,r,$,c,U,V,N)||e!==null&&e.dependencies!==null&&ro(e.dependencies))?(I||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,V,N),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,V,N)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=V),p.props=c,p.state=V,p.context=N,c=$):(typeof p.componentDidUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&U===e.memoizedState||(n.flags|=1024),c=!1)}return p=c,Co(e,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,e!==null&&c?(n.child=rs(n,e.child,null,m),n.child=rs(n,null,r,m)):Ne(e,n,r,m),n.memoizedState=p.state,e=n.child):e=sn(e,n,m),e}function Em(e,n,r,c){return ts(),n.flags|=256,Ne(e,n,r,c),n.child}var cu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function uu(e){return{baseLanes:e,cachePool:ff()}}function hu(e,n,r){return e=e!==null?e.childLanes&~r:0,n&&(e|=ci),e}function Tm(e,n,r){var c=n.pendingProps,m=!1,p=(n.flags&128)!==0,v;if((v=p)||(v=e!==null&&e.memoizedState===null?!1:(ce.current&2)!==0),v&&(m=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Nt){if(m?_n(n):Mn(),(e=Zt)?(e=Lg(e,Si),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:An!==null?{id:zi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},r=sf(e),r.return=n,n.child=r,ke=n,Zt=null)):e=null,e===null)throw xn(n);return qu(e)?n.lanes=32:n.lanes=536870912,null}var E=c.children;return c=c.fallback,m?(Mn(),m=n.mode,E=_o({mode:"hidden",children:E},m),c=Jn(c,m,r,null),E.return=n,c.return=n,E.sibling=c,n.child=E,c=n.child,c.memoizedState=uu(r),c.childLanes=hu(e,v,r),n.memoizedState=cu,Za(null,c)):(_n(n),du(n,E))}var N=e.memoizedState;if(N!==null&&(E=N.dehydrated,E!==null)){if(p)n.flags&256?(_n(n),n.flags&=-257,n=fu(e,n,r)):n.memoizedState!==null?(Mn(),n.child=e.child,n.flags|=128,n=null):(Mn(),E=c.fallback,m=n.mode,c=_o({mode:"visible",children:c.children},m),E=Jn(E,m,r,null),E.flags|=2,c.return=n,E.return=n,c.sibling=E,n.child=c,rs(n,e.child,null,r),c=n.child,c.memoizedState=uu(r),c.childLanes=hu(e,v,r),n.memoizedState=cu,n=Za(null,c));else if(_n(n),qu(E)){if(v=E.nextSibling&&E.nextSibling.dataset,v)var I=v.dgst;v=I,c=Error(s(419)),c.stack="",c.digest=v,Ia({value:c,source:null,stack:null}),n=fu(e,n,r)}else if(ge||Fs(e,n,r,!1),v=(r&e.childLanes)!==0,ge||v){if(v=Wt,v!==null&&(c=ud(v,r),c!==0&&c!==N.retryLane))throw N.retryLane=c,Zn(e,c),Qe(v,e,c),ou;Yu(E)||Fo(),n=fu(e,n,r)}else Yu(E)?(n.flags|=192,n.child=e.child,n=null):(e=N.treeContext,Zt=Ti(E.nextSibling),ke=n,Nt=!0,wn=null,Si=!1,e!==null&&of(n,e),n=du(n,c.children),n.flags|=4096);return n}return m?(Mn(),E=c.fallback,m=n.mode,N=e.child,I=N.sibling,c=Qi(N,{mode:"hidden",children:c.children}),c.subtreeFlags=N.subtreeFlags&65011712,I!==null?E=Qi(I,E):(E=Jn(E,m,r,null),E.flags|=2),E.return=n,c.return=n,c.sibling=E,n.child=c,Za(null,c),c=n.child,E=e.child.memoizedState,E===null?E=uu(r):(m=E.cachePool,m!==null?(N=fe._currentValue,m=m.parent!==N?{parent:N,pool:N}:m):m=ff(),E={baseLanes:E.baseLanes|r,cachePool:m}),c.memoizedState=E,c.childLanes=hu(e,v,r),n.memoizedState=cu,Za(e.child,c)):(_n(n),r=e.child,e=r.sibling,r=Qi(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=r,n.memoizedState=null,r)}function du(e,n){return n=_o({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function _o(e,n){return e=ai(22,e,null,n),e.lanes=0,e}function fu(e,n,r){return rs(n,e.child,null,r),e=du(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Cm(e,n,r){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),Mc(e.return,n,r)}function mu(e,n,r,c,m,p){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:m,treeForkCount:p}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=r,v.tailMode=m,v.treeForkCount=p)}function _m(e,n,r){var c=n.pendingProps,m=c.revealOrder,p=c.tail;c=c.children;var v=ce.current,E=(v&2)!==0;if(E?(v=v&1|2,n.flags|=128):v&=1,q(ce,v),Ne(e,n,c,r),c=Nt?Pa:0,!E&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cm(e,r,n);else if(e.tag===19)Cm(e,r,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(m){case"forwards":for(r=n.child,m=null;r!==null;)e=r.alternate,e!==null&&go(e)===null&&(m=r),r=r.sibling;r=m,r===null?(m=n.child,n.child=null):(m=r.sibling,r.sibling=null),mu(n,!1,m,r,p,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,m=n.child,n.child=null;m!==null;){if(e=m.alternate,e!==null&&go(e)===null){n.child=m;break}e=m.sibling,m.sibling=r,r=m,m=e}mu(n,!0,r,null,p,c);break;case"together":mu(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function sn(e,n,r){if(e!==null&&(n.dependencies=e.dependencies),Nn|=n.lanes,(r&n.childLanes)===0)if(e!==null){if(Fs(e,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,r=Qi(e,e.pendingProps),n.child=r,r.return=n;e.sibling!==null;)e=e.sibling,r=r.sibling=Qi(e,e.pendingProps),r.return=n;r.sibling=null}return n.child}function gu(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&ro(e)))}function x0(e,n,r){switch(n.tag){case 3:Qt(n,n.stateNode.containerInfo),Sn(n,fe,e.memoizedState.cache),ts();break;case 27:case 5:gi(n);break;case 4:Qt(n,n.stateNode.containerInfo);break;case 10:Sn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Ic(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(_n(n),n.flags|=128,null):(r&n.child.childLanes)!==0?Tm(e,n,r):(_n(n),e=sn(e,n,r),e!==null?e.sibling:null);_n(n);break;case 19:var m=(e.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Fs(e,n,r,!1),c=(r&n.childLanes)!==0),m){if(c)return _m(e,n,r);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),q(ce,ce.current),c)break;return null;case 22:return n.lanes=0,vm(e,n,r,n.pendingProps);case 24:Sn(n,fe,e.memoizedState.cache)}return sn(e,n,r)}function Mm(e,n,r){if(e!==null)if(e.memoizedProps!==n.pendingProps)ge=!0;else{if(!gu(e,r)&&(n.flags&128)===0)return ge=!1,x0(e,n,r);ge=(e.flags&131072)!==0}else ge=!1,Nt&&(n.flags&1048576)!==0&&rf(n,Pa,n.index);switch(n.lanes=0,n.tag){case 16:t:{var c=n.pendingProps;if(e=ss(n.elementType),n.type=e,typeof e=="function")Ac(e)?(c=ls(e,c),n.tag=1,n=Sm(null,n,e,c,r)):(n.tag=0,n=lu(null,n,e,c,r));else{if(e!=null){var m=e.$$typeof;if(m===D){n.tag=11,n=pm(null,n,e,c,r);break t}else if(m===F){n.tag=14,n=bm(null,n,e,c,r);break t}}throw n=et(e)||e,Error(s(306,n,""))}}return n;case 0:return lu(e,n,n.type,n.pendingProps,r);case 1:return c=n.type,m=ls(c,n.pendingProps),Sm(e,n,c,m,r);case 3:t:{if(Qt(n,n.stateNode.containerInfo),e===null)throw Error(s(387));c=n.pendingProps;var p=n.memoizedState;m=p.element,Bc(e,n),qa(n,c,null,r);var v=n.memoizedState;if(c=v.cache,Sn(n,fe,c),c!==p.cache&&kc(n,[fe],r,!0),Ya(),c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=Em(e,n,c,r);break t}else if(c!==m){m=Ai(Error(s(424)),n),Ia(m),n=Em(e,n,c,r);break t}else for(e=n.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Zt=Ti(e.firstChild),ke=n,Nt=!0,wn=null,Si=!0,r=vf(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ts(),c===m){n=sn(e,n,r);break t}Ne(e,n,c,r)}n=n.child}return n;case 26:return Co(e,n),e===null?(r=Pg(n.type,null,n.pendingProps,null))?n.memoizedState=r:Nt||(r=n.type,e=n.pendingProps,c=Go(bt.current).createElement(r),c[Me]=n,c[Xe]=e,Re(c,r,e),xe(c),n.stateNode=c):n.memoizedState=Pg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return gi(n),e===null&&Nt&&(c=n.stateNode=Fg(n.type,n.pendingProps,bt.current),ke=n,Si=!0,m=Zt,Fn(n.type)?($u=m,Zt=Ti(c.firstChild)):Zt=m),Ne(e,n,n.pendingProps.children,r),Co(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Nt&&((m=c=Zt)&&(c=Z0(c,n.type,n.pendingProps,Si),c!==null?(n.stateNode=c,ke=n,Zt=Ti(c.firstChild),Si=!1,m=!0):m=!1),m||xn(n)),gi(n),m=n.type,p=n.pendingProps,v=e!==null?e.memoizedProps:null,c=p.children,Gu(m,p)?c=null:v!==null&&Gu(m,v)&&(n.flags|=32),n.memoizedState!==null&&(m=Hc(e,n,f0,null,null,r),fr._currentValue=m),Co(e,n),Ne(e,n,c,r),n.child;case 6:return e===null&&Nt&&((e=r=Zt)&&(r=J0(r,n.pendingProps,Si),r!==null?(n.stateNode=r,ke=n,Zt=null,e=!0):e=!1),e||xn(n)),null;case 13:return Tm(e,n,r);case 4:return Qt(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=rs(n,null,c,r):Ne(e,n,c,r),n.child;case 11:return pm(e,n,n.type,n.pendingProps,r);case 7:return Ne(e,n,n.pendingProps,r),n.child;case 8:return Ne(e,n,n.pendingProps.children,r),n.child;case 12:return Ne(e,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,Sn(n,n.type,c.value),Ne(e,n,c.children,r),n.child;case 9:return m=n.type._context,c=n.pendingProps.children,is(n),m=De(m),c=c(m),n.flags|=1,Ne(e,n,c,r),n.child;case 14:return bm(e,n,n.type,n.pendingProps,r);case 15:return ym(e,n,n.type,n.pendingProps,r);case 19:return _m(e,n,r);case 31:return w0(e,n,r);case 22:return vm(e,n,r,n.pendingProps);case 24:return is(n),c=De(fe),e===null?(m=Rc(),m===null&&(m=Wt,p=Dc(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=r),m=p),n.memoizedState={parent:c,cache:m},Oc(n),Sn(n,fe,m)):((e.lanes&r)!==0&&(Bc(e,n),qa(n,null,null,r),Ya()),m=e.memoizedState,p=n.memoizedState,m.parent!==c?(m={parent:c,cache:c},n.memoizedState=m,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=m),Sn(n,fe,c)):(c=p.cache,Sn(n,fe,c),c!==m.cache&&kc(n,[fe],r,!0))),Ne(e,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function an(e){e.flags|=4}function pu(e,n,r,c,m){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(m&335544128)===m)if(e.stateNode.complete)e.flags|=8192;else if(eg())e.flags|=8192;else throw as=uo,Lc}else e.flags&=-16777217}function km(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Vg(n))if(eg())e.flags|=8192;else throw as=uo,Lc}function Mo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?od():536870912,e.lanes|=n,$s|=n)}function Ja(e,n){if(!Nt)switch(e.tailMode){case"hidden":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Jt(e){var n=e.alternate!==null&&e.alternate.child===e.child,r=0,c=0;if(n)for(var m=e.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=e,m=m.sibling;else for(m=e.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=e,m=m.sibling;return e.subtreeFlags|=c,e.childLanes=r,n}function S0(e,n,r){var c=n.pendingProps;switch(Ec(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(n),null;case 1:return Jt(n),null;case 3:return r=n.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),tn(fe),Ot(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Bs(n)?an(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Cc())),Jt(n),null;case 26:var m=n.type,p=n.memoizedState;return e===null?(an(n),p!==null?(Jt(n),km(n,p)):(Jt(n),pu(n,m,null,c,r))):p?p!==e.memoizedState?(an(n),Jt(n),km(n,p)):(Jt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==c&&an(n),Jt(n),pu(n,m,e,c,r)),null;case 27:if(de(n),r=bt.current,m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&an(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Jt(n),null}e=tt.current,Bs(n)?lf(n):(e=Fg(m,c,r),n.stateNode=e,an(n))}return Jt(n),null;case 5:if(de(n),m=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&an(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Jt(n),null}if(p=tt.current,Bs(n))lf(n);else{var v=Go(bt.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?v.createElement(m,{is:c.is}):v.createElement(m)}}p[Me]=n,p[Xe]=c;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=p;t:switch(Re(p,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&an(n)}}return Jt(n),pu(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,r),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==c&&an(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(e=bt.current,Bs(n)){if(e=n.stateNode,r=n.memoizedProps,c=null,m=ke,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}e[Me]=n,e=!!(e.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||Tg(e.nodeValue,r)),e||xn(n,!0)}else e=Go(e).createTextNode(c),e[Me]=n,n.stateNode=e}return Jt(n),null;case 31:if(r=n.memoizedState,e===null||e.memoizedState!==null){if(c=Bs(n),r!==null){if(e===null){if(!c)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Me]=n}else ts(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Jt(n),e=!1}else r=Cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return n.flags&256?(oi(n),n):(oi(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Jt(n),null;case 13:if(c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(m=Bs(n),c!==null&&c.dehydrated!==null){if(e===null){if(!m)throw Error(s(318));if(m=n.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[Me]=n}else ts(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Jt(n),m=!1}else m=Cc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=m),m=!0;if(!m)return n.flags&256?(oi(n),n):(oi(n),null)}return oi(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,e=e!==null&&e.memoizedState!==null,r&&(c=n.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==m&&(c.flags|=2048)),r!==e&&r&&(n.child.flags|=8192),Mo(n,n.updateQueue),Jt(n),null);case 4:return Ot(),e===null&&ju(n.stateNode.containerInfo),Jt(n),null;case 10:return tn(n.type),Jt(n),null;case 19:if(G(ce),c=n.memoizedState,c===null)return Jt(n),null;if(m=(n.flags&128)!==0,p=c.rendering,p===null)if(m)Ja(c,!1);else{if(oe!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(p=go(e),p!==null){for(n.flags|=128,Ja(c,!1),e=p.updateQueue,n.updateQueue=e,Mo(n,e),n.subtreeFlags=0,e=r,r=n.child;r!==null;)nf(r,e),r=r.sibling;return q(ce,ce.current&1|2),Nt&&Zi(n,c.treeForkCount),n.child}e=e.sibling}c.tail!==null&&Ie()>Lo&&(n.flags|=128,m=!0,Ja(c,!1),n.lanes=4194304)}else{if(!m)if(e=go(p),e!==null){if(n.flags|=128,m=!0,e=e.updateQueue,n.updateQueue=e,Mo(n,e),Ja(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Nt)return Jt(n),null}else 2*Ie()-c.renderingStartTime>Lo&&r!==536870912&&(n.flags|=128,m=!0,Ja(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(e=c.last,e!==null?e.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Ie(),e.sibling=null,r=ce.current,q(ce,m?r&1|2:r&1),Nt&&Zi(n,c.treeForkCount),e):(Jt(n),null);case 22:case 23:return oi(n),Pc(),c=n.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Jt(n),n.subtreeFlags&6&&(n.flags|=8192)):Jt(n),r=n.updateQueue,r!==null&&Mo(n,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),e!==null&&G(ns),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),tn(fe),Jt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function E0(e,n){switch(Ec(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return tn(fe),Ot(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return de(n),null;case 31:if(n.memoizedState!==null){if(oi(n),n.alternate===null)throw Error(s(340));ts()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(oi(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ts()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return G(ce),null;case 4:return Ot(),null;case 10:return tn(n.type),null;case 22:case 23:return oi(n),Pc(),e!==null&&G(ns),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return tn(fe),null;case 25:return null;default:return null}}function Dm(e,n){switch(Ec(n),n.tag){case 3:tn(fe),Ot();break;case 26:case 27:case 5:de(n);break;case 4:Ot();break;case 31:n.memoizedState!==null&&oi(n);break;case 13:oi(n);break;case 19:G(ce);break;case 10:tn(n.type);break;case 22:case 23:oi(n),Pc(),e!==null&&G(ns);break;case 24:tn(fe)}}function tr(e,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var m=c.next;r=m;do{if((r.tag&e)===e){c=void 0;var p=r.create,v=r.inst;c=p(),v.destroy=c}r=r.next}while(r!==m)}}catch(E){Vt(n,n.return,E)}}function kn(e,n,r){try{var c=n.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var p=m.next;c=p;do{if((c.tag&e)===e){var v=c.inst,E=v.destroy;if(E!==void 0){v.destroy=void 0,m=n;var N=r,I=E;try{I()}catch($){Vt(m,N,$)}}}c=c.next}while(c!==p)}}catch($){Vt(n,n.return,$)}}function Nm(e){var n=e.updateQueue;if(n!==null){var r=e.stateNode;try{wf(n,r)}catch(c){Vt(e,e.return,c)}}}function Rm(e,n,r){r.props=ls(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(c){Vt(e,n,c)}}function er(e,n){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof r=="function"?e.refCleanup=r(c):r.current=c}}catch(m){Vt(e,n,m)}}function Pi(e,n){var r=e.ref,c=e.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(m){Vt(e,n,m)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(m){Vt(e,n,m)}else r.current=null}function Lm(e){var n=e.type,r=e.memoizedProps,c=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break t;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(m){Vt(e,e.return,m)}}function bu(e,n,r){try{var c=e.stateNode;Y0(c,e.type,r,n),c[Xe]=n}catch(m){Vt(e,e.return,m)}}function Om(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Fn(e.type)||e.tag===4}function yu(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Om(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Fn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vu(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(e),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Ki));else if(c!==4&&(c===27&&Fn(e.type)&&(r=e.stateNode,n=null),e=e.child,e!==null))for(vu(e,n,r),e=e.sibling;e!==null;)vu(e,n,r),e=e.sibling}function ko(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?r.insertBefore(e,n):r.appendChild(e);else if(c!==4&&(c===27&&Fn(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(ko(e,n,r),e=e.sibling;e!==null;)ko(e,n,r),e=e.sibling}function Bm(e){var n=e.stateNode,r=e.memoizedProps;try{for(var c=e.type,m=n.attributes;m.length;)n.removeAttributeNode(m[0]);Re(n,c,r),n[Me]=e,n[Xe]=r}catch(p){Vt(e,e.return,p)}}var rn=!1,pe=!1,Au=!1,Fm=typeof WeakSet=="function"?WeakSet:Set,Se=null;function T0(e,n){if(e=e.containerInfo,Uu=Wo,e=qd(e),fc(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var m=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break t}var v=0,E=-1,N=-1,I=0,$=0,W=e,U=null;e:for(;;){for(var V;W!==r||m!==0&&W.nodeType!==3||(E=v+m),W!==p||c!==0&&W.nodeType!==3||(N=v+c),W.nodeType===3&&(v+=W.nodeValue.length),(V=W.firstChild)!==null;)U=W,W=V;for(;;){if(W===e)break e;if(U===r&&++I===m&&(E=v),U===p&&++$===c&&(N=v),(V=W.nextSibling)!==null)break;W=U,U=W.parentNode}W=V}r=E===-1||N===-1?null:{start:E,end:N}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hu={focusedElem:e,selectionRange:r},Wo=!1,Se=n;Se!==null;)if(n=Se,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Se=e;else for(;Se!==null;){switch(n=Se,p=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)m=e[r],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,r=n,m=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var ot=ls(r.type,m);e=c.getSnapshotBeforeUpdate(ot,p),c.__reactInternalSnapshotBeforeUpdate=e}catch(vt){Vt(r,r.return,vt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,r=e.nodeType,r===9)Xu(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Xu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,Se=e;break}Se=n.return}}function zm(e,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:ln(e,r),c&4&&tr(5,r);break;case 1:if(ln(e,r),c&4)if(e=r.stateNode,n===null)try{e.componentDidMount()}catch(v){Vt(r,r.return,v)}else{var m=ls(r.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(m,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Vt(r,r.return,v)}}c&64&&Nm(r),c&512&&er(r,r.return);break;case 3:if(ln(e,r),c&64&&(e=r.updateQueue,e!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{wf(e,n)}catch(v){Vt(r,r.return,v)}}break;case 27:n===null&&c&4&&Bm(r);case 26:case 5:ln(e,r),n===null&&c&4&&Lm(r),c&512&&er(r,r.return);break;case 12:ln(e,r);break;case 31:ln(e,r),c&4&&Im(e,r);break;case 13:ln(e,r),c&4&&Um(e,r),c&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=O0.bind(null,r),tv(e,r))));break;case 22:if(c=r.memoizedState!==null||rn,!c){n=n!==null&&n.memoizedState!==null||pe,m=rn;var p=pe;rn=c,(pe=n)&&!p?cn(e,r,(r.subtreeFlags&8772)!==0):ln(e,r),rn=m,pe=p}break;case 30:break;default:ln(e,r)}}function jm(e){var n=e.alternate;n!==null&&(e.alternate=null,jm(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Wl(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var te=null,qe=!1;function on(e,n,r){for(r=r.child;r!==null;)Pm(e,n,r),r=r.sibling}function Pm(e,n,r){if(ii&&typeof ii.onCommitFiberUnmount=="function")try{ii.onCommitFiberUnmount(Ta,r)}catch{}switch(r.tag){case 26:pe||Pi(r,n),on(e,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:pe||Pi(r,n);var c=te,m=qe;Fn(r.type)&&(te=r.stateNode,qe=!1),on(e,n,r),ur(r.stateNode),te=c,qe=m;break;case 5:pe||Pi(r,n);case 6:if(c=te,m=qe,te=null,on(e,n,r),te=c,qe=m,te!==null)if(qe)try{(te.nodeType===9?te.body:te.nodeName==="HTML"?te.ownerDocument.body:te).removeChild(r.stateNode)}catch(p){Vt(r,n,p)}else try{te.removeChild(r.stateNode)}catch(p){Vt(r,n,p)}break;case 18:te!==null&&(qe?(e=te,Ng(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),ia(e)):Ng(te,r.stateNode));break;case 4:c=te,m=qe,te=r.stateNode.containerInfo,qe=!0,on(e,n,r),te=c,qe=m;break;case 0:case 11:case 14:case 15:kn(2,r,n),pe||kn(4,r,n),on(e,n,r);break;case 1:pe||(Pi(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Rm(r,n,c)),on(e,n,r);break;case 21:on(e,n,r);break;case 22:pe=(c=pe)||r.memoizedState!==null,on(e,n,r),pe=c;break;default:on(e,n,r)}}function Im(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{ia(e)}catch(r){Vt(n,n.return,r)}}}function Um(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ia(e)}catch(r){Vt(n,n.return,r)}}function C0(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Fm),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Fm),n;default:throw Error(s(435,e.tag))}}function Do(e,n){var r=C0(e);n.forEach(function(c){if(!r.has(c)){r.add(c);var m=B0.bind(null,e,c);c.then(m,m)}})}function $e(e,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var m=r[c],p=e,v=n,E=v;t:for(;E!==null;){switch(E.tag){case 27:if(Fn(E.type)){te=E.stateNode,qe=!1;break t}break;case 5:te=E.stateNode,qe=!1;break t;case 3:case 4:te=E.stateNode.containerInfo,qe=!0;break t}E=E.return}if(te===null)throw Error(s(160));Pm(p,v,m),te=null,qe=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)Hm(n,e),n=n.sibling}var Oi=null;function Hm(e,n){var r=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:$e(n,e),Ke(e),c&4&&(kn(3,e,e.return),tr(3,e),kn(5,e,e.return));break;case 1:$e(n,e),Ke(e),c&512&&(pe||r===null||Pi(r,r.return)),c&64&&rn&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var m=Oi;if($e(n,e),Ke(e),c&512&&(pe||r===null||Pi(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=e.memoizedState,r===null)if(c===null)if(e.stateNode===null){t:{c=e.type,r=e.memoizedProps,m=m.ownerDocument||m;e:switch(c){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Ma]||p[Me]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(c),m.head.insertBefore(p,m.querySelector("head > title"))),Re(p,c,r),p[Me]=e,xe(p),c=p;break t;case"link":var v=Hg("link","href",m).get(c+(r.href||""));if(v){for(var E=0;E<v.length;E++)if(p=v[E],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){v.splice(E,1);break e}}p=m.createElement(c),Re(p,c,r),m.head.appendChild(p);break;case"meta":if(v=Hg("meta","content",m).get(c+(r.content||""))){for(E=0;E<v.length;E++)if(p=v[E],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){v.splice(E,1);break e}}p=m.createElement(c),Re(p,c,r),m.head.appendChild(p);break;default:throw Error(s(468,c))}p[Me]=e,xe(p),c=p}e.stateNode=c}else Gg(m,e.type,e.stateNode);else e.stateNode=Ug(m,c,e.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?Gg(m,e.type,e.stateNode):Ug(m,c,e.memoizedProps)):c===null&&e.stateNode!==null&&bu(e,e.memoizedProps,r.memoizedProps)}break;case 27:$e(n,e),Ke(e),c&512&&(pe||r===null||Pi(r,r.return)),r!==null&&c&4&&bu(e,e.memoizedProps,r.memoizedProps);break;case 5:if($e(n,e),Ke(e),c&512&&(pe||r===null||Pi(r,r.return)),e.flags&32){m=e.stateNode;try{Ts(m,"")}catch(ot){Vt(e,e.return,ot)}}c&4&&e.stateNode!=null&&(m=e.memoizedProps,bu(e,m,r!==null?r.memoizedProps:m)),c&1024&&(Au=!0);break;case 6:if($e(n,e),Ke(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,r=e.stateNode;try{r.nodeValue=c}catch(ot){Vt(e,e.return,ot)}}break;case 3:if(Yo=null,m=Oi,Oi=Vo(n.containerInfo),$e(n,e),Oi=m,Ke(e),c&4&&r!==null&&r.memoizedState.isDehydrated)try{ia(n.containerInfo)}catch(ot){Vt(e,e.return,ot)}Au&&(Au=!1,Gm(e));break;case 4:c=Oi,Oi=Vo(e.stateNode.containerInfo),$e(n,e),Ke(e),Oi=c;break;case 12:$e(n,e),Ke(e);break;case 31:$e(n,e),Ke(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Do(e,c)));break;case 13:$e(n,e),Ke(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Ro=Ie()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Do(e,c)));break;case 22:m=e.memoizedState!==null;var N=r!==null&&r.memoizedState!==null,I=rn,$=pe;if(rn=I||m,pe=$||N,$e(n,e),pe=$,rn=I,Ke(e),c&8192)t:for(n=e.stateNode,n._visibility=m?n._visibility&-2:n._visibility|1,m&&(r===null||N||rn||pe||cs(e)),r=null,n=e;;){if(n.tag===5||n.tag===26){if(r===null){N=r=n;try{if(p=N.stateNode,m)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{E=N.stateNode;var W=N.memoizedProps.style,U=W!=null&&W.hasOwnProperty("display")?W.display:null;E.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(ot){Vt(N,N.return,ot)}}}else if(n.tag===6){if(r===null){N=n;try{N.stateNode.nodeValue=m?"":N.memoizedProps}catch(ot){Vt(N,N.return,ot)}}}else if(n.tag===18){if(r===null){N=n;try{var V=N.stateNode;m?Rg(V,!0):Rg(N.stateNode,!1)}catch(ot){Vt(N,N.return,ot)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=e.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,Do(e,r))));break;case 19:$e(n,e),Ke(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Do(e,c)));break;case 30:break;case 21:break;default:$e(n,e),Ke(e)}}function Ke(e){var n=e.flags;if(n&2){try{for(var r,c=e.return;c!==null;){if(Om(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var m=r.stateNode,p=yu(e);ko(e,p,m);break;case 5:var v=r.stateNode;r.flags&32&&(Ts(v,""),r.flags&=-33);var E=yu(e);ko(e,E,v);break;case 3:case 4:var N=r.stateNode.containerInfo,I=yu(e);vu(e,I,N);break;default:throw Error(s(161))}}catch($){Vt(e,e.return,$)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Gm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Gm(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function ln(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)zm(e,n.alternate,n),n=n.sibling}function cs(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:kn(4,n,n.return),cs(n);break;case 1:Pi(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&Rm(n,n.return,r),cs(n);break;case 27:ur(n.stateNode);case 26:case 5:Pi(n,n.return),cs(n);break;case 22:n.memoizedState===null&&cs(n);break;case 30:cs(n);break;default:cs(n)}e=e.sibling}}function cn(e,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,m=e,p=n,v=p.flags;switch(p.tag){case 0:case 11:case 15:cn(m,p,r),tr(4,p);break;case 1:if(cn(m,p,r),c=p,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(I){Vt(c,c.return,I)}if(c=p,m=c.updateQueue,m!==null){var E=c.stateNode;try{var N=m.shared.hiddenCallbacks;if(N!==null)for(m.shared.hiddenCallbacks=null,m=0;m<N.length;m++)Af(N[m],E)}catch(I){Vt(c,c.return,I)}}r&&v&64&&Nm(p),er(p,p.return);break;case 27:Bm(p);case 26:case 5:cn(m,p,r),r&&c===null&&v&4&&Lm(p),er(p,p.return);break;case 12:cn(m,p,r);break;case 31:cn(m,p,r),r&&v&4&&Im(m,p);break;case 13:cn(m,p,r),r&&v&4&&Um(m,p);break;case 22:p.memoizedState===null&&cn(m,p,r),er(p,p.return);break;case 30:break;default:cn(m,p,r)}n=n.sibling}}function wu(e,n){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Ua(r))}function xu(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ua(e))}function Bi(e,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Vm(e,n,r,c),n=n.sibling}function Vm(e,n,r,c){var m=n.flags;switch(n.tag){case 0:case 11:case 15:Bi(e,n,r,c),m&2048&&tr(9,n);break;case 1:Bi(e,n,r,c);break;case 3:Bi(e,n,r,c),m&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ua(e)));break;case 12:if(m&2048){Bi(e,n,r,c),e=n.stateNode;try{var p=n.memoizedProps,v=p.id,E=p.onPostCommit;typeof E=="function"&&E(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){Vt(n,n.return,N)}}else Bi(e,n,r,c);break;case 31:Bi(e,n,r,c);break;case 13:Bi(e,n,r,c);break;case 23:break;case 22:p=n.stateNode,v=n.alternate,n.memoizedState!==null?p._visibility&2?Bi(e,n,r,c):ir(e,n):p._visibility&2?Bi(e,n,r,c):(p._visibility|=2,Xs(e,n,r,c,(n.subtreeFlags&10256)!==0||!1)),m&2048&&wu(v,n);break;case 24:Bi(e,n,r,c),m&2048&&xu(n.alternate,n);break;default:Bi(e,n,r,c)}}function Xs(e,n,r,c,m){for(m=m&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var p=e,v=n,E=r,N=c,I=v.flags;switch(v.tag){case 0:case 11:case 15:Xs(p,v,E,N,m),tr(8,v);break;case 23:break;case 22:var $=v.stateNode;v.memoizedState!==null?$._visibility&2?Xs(p,v,E,N,m):ir(p,v):($._visibility|=2,Xs(p,v,E,N,m)),m&&I&2048&&wu(v.alternate,v);break;case 24:Xs(p,v,E,N,m),m&&I&2048&&xu(v.alternate,v);break;default:Xs(p,v,E,N,m)}n=n.sibling}}function ir(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=e,c=n,m=c.flags;switch(c.tag){case 22:ir(r,c),m&2048&&wu(c.alternate,c);break;case 24:ir(r,c),m&2048&&xu(c.alternate,c);break;default:ir(r,c)}n=n.sibling}}var nr=8192;function Ys(e,n,r){if(e.subtreeFlags&nr)for(e=e.child;e!==null;)Xm(e,n,r),e=e.sibling}function Xm(e,n,r){switch(e.tag){case 26:Ys(e,n,r),e.flags&nr&&e.memoizedState!==null&&dv(r,Oi,e.memoizedState,e.memoizedProps);break;case 5:Ys(e,n,r);break;case 3:case 4:var c=Oi;Oi=Vo(e.stateNode.containerInfo),Ys(e,n,r),Oi=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=nr,nr=16777216,Ys(e,n,r),nr=c):Ys(e,n,r));break;default:Ys(e,n,r)}}function Ym(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function sr(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Se=c,$m(c,e)}Ym(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)qm(e),e=e.sibling}function qm(e){switch(e.tag){case 0:case 11:case 15:sr(e),e.flags&2048&&kn(9,e,e.return);break;case 3:sr(e);break;case 12:sr(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,No(e)):sr(e);break;default:sr(e)}}function No(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];Se=c,$m(c,e)}Ym(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:kn(8,n,n.return),No(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,No(n));break;default:No(n)}e=e.sibling}}function $m(e,n){for(;Se!==null;){var r=Se;switch(r.tag){case 0:case 11:case 15:kn(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ua(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,Se=c;else t:for(r=e;Se!==null;){c=Se;var m=c.sibling,p=c.return;if(jm(c),c===r){Se=null;break t}if(m!==null){m.return=p,Se=m;break t}Se=p}}}var _0={getCacheForType:function(e){var n=De(fe),r=n.data.get(e);return r===void 0&&(r=e(),n.data.set(e,r)),r},cacheSignal:function(){return De(fe).controller.signal}},M0=typeof WeakMap=="function"?WeakMap:Map,zt=0,Wt=null,_t=null,kt=0,Gt=0,li=null,Dn=!1,qs=!1,Su=!1,un=0,oe=0,Nn=0,us=0,Eu=0,ci=0,$s=0,ar=null,We=null,Tu=!1,Ro=0,Km=0,Lo=1/0,Oo=null,Rn=null,ve=0,Ln=null,Ks=null,hn=0,Cu=0,_u=null,Wm=null,rr=0,Mu=null;function ui(){return(zt&2)!==0&&kt!==0?kt&-kt:B.T!==null?Ou():hd()}function Qm(){if(ci===0)if((kt&536870912)===0||Nt){var e=Ur;Ur<<=1,(Ur&3932160)===0&&(Ur=262144),ci=e}else ci=536870912;return e=ri.current,e!==null&&(e.flags|=32),ci}function Qe(e,n,r){(e===Wt&&(Gt===2||Gt===9)||e.cancelPendingCommit!==null)&&(Ws(e,0),On(e,kt,ci,!1)),_a(e,r),((zt&2)===0||e!==Wt)&&(e===Wt&&((zt&2)===0&&(us|=r),oe===4&&On(e,kt,ci,!1)),Ii(e))}function Zm(e,n,r){if((zt&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&e.expiredLanes)===0||Ca(e,n),m=c?N0(e,n):Du(e,n,!0),p=c;do{if(m===0){qs&&!c&&On(e,n,0,!1);break}else{if(r=e.current.alternate,p&&!k0(r)){m=Du(e,n,!1),p=!1;continue}if(m===2){if(p=n,e.errorRecoveryDisabledLanes&p)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var E=e;m=ar;var N=E.current.memoizedState.isDehydrated;if(N&&(Ws(E,v).flags|=256),v=Du(E,v,!1),v!==2){if(Su&&!N){E.errorRecoveryDisabledLanes|=p,us|=p,m=4;break t}p=We,We=m,p!==null&&(We===null?We=p:We.push.apply(We,p))}m=v}if(p=!1,m!==2)continue}}if(m===1){Ws(e,0),On(e,n,0,!0);break}t:{switch(c=e,p=m,p){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:On(c,n,ci,!Dn);break t;case 2:We=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(m=Ro+300-Ie(),10<m)){if(On(c,n,ci,!Dn),Gr(c,0,!0)!==0)break t;hn=n,c.timeoutHandle=kg(Jm.bind(null,c,r,We,Oo,Tu,n,ci,us,$s,Dn,p,"Throttled",-0,0),m);break t}Jm(c,r,We,Oo,Tu,n,ci,us,$s,Dn,p,null,-0,0)}}break}while(!0);Ii(e)}function Jm(e,n,r,c,m,p,v,E,N,I,$,W,U,V){if(e.timeoutHandle=-1,W=n.subtreeFlags,W&8192||(W&16785408)===16785408){W={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ki},Xm(n,p,W);var ot=(p&62914560)===p?Ro-Ie():(p&4194048)===p?Km-Ie():0;if(ot=fv(W,ot),ot!==null){hn=p,e.cancelPendingCommit=ot(og.bind(null,e,n,p,r,c,m,v,E,N,$,W,null,U,V)),On(e,p,v,!I);return}}og(e,n,p,r,c,m,v,E,N)}function k0(e){for(var n=e;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var m=r[c],p=m.getSnapshot;m=m.value;try{if(!si(p(),m))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function On(e,n,r,c){n&=~Eu,n&=~us,e.suspendedLanes|=n,e.pingedLanes&=~n,c&&(e.warmLanes|=n),c=e.expirationTimes;for(var m=n;0<m;){var p=31-ni(m),v=1<<p;c[p]=-1,m&=~v}r!==0&&ld(e,r,n)}function Bo(){return(zt&6)===0?(or(0),!1):!0}function ku(){if(_t!==null){if(Gt===0)var e=_t.return;else e=_t,Ji=es=null,Xc(e),Is=null,Ga=0,e=_t;for(;e!==null;)Dm(e.alternate,e),e=e.return;_t=null}}function Ws(e,n){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,K0(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),hn=0,ku(),Wt=e,_t=r=Qi(e.current,null),kt=n,Gt=0,li=null,Dn=!1,qs=Ca(e,n),Su=!1,$s=ci=Eu=us=Nn=oe=0,We=ar=null,Tu=!1,(n&8)!==0&&(n|=n&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=n;0<c;){var m=31-ni(c),p=1<<m;n|=e[m],c&=~p}return un=n,eo(),r}function tg(e,n){Tt=null,B.H=Qa,n===Ps||n===co?(n=pf(),Gt=3):n===Lc?(n=pf(),Gt=4):Gt=n===ou?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,li=n,_t===null&&(oe=1,Eo(e,Ai(n,e.current)))}function eg(){var e=ri.current;return e===null?!0:(kt&4194048)===kt?Ei===null:(kt&62914560)===kt||(kt&536870912)!==0?e===Ei:!1}function ig(){var e=B.H;return B.H=Qa,e===null?Qa:e}function ng(){var e=B.A;return B.A=_0,e}function Fo(){oe=4,Dn||(kt&4194048)!==kt&&ri.current!==null||(qs=!0),(Nn&134217727)===0&&(us&134217727)===0||Wt===null||On(Wt,kt,ci,!1)}function Du(e,n,r){var c=zt;zt|=2;var m=ig(),p=ng();(Wt!==e||kt!==n)&&(Oo=null,Ws(e,n)),n=!1;var v=oe;t:do try{if(Gt!==0&&_t!==null){var E=_t,N=li;switch(Gt){case 8:ku(),v=6;break t;case 3:case 2:case 9:case 6:ri.current===null&&(n=!0);var I=Gt;if(Gt=0,li=null,Qs(e,E,N,I),r&&qs){v=0;break t}break;default:I=Gt,Gt=0,li=null,Qs(e,E,N,I)}}D0(),v=oe;break}catch($){tg(e,$)}while(!0);return n&&e.shellSuspendCounter++,Ji=es=null,zt=c,B.H=m,B.A=p,_t===null&&(Wt=null,kt=0,eo()),v}function D0(){for(;_t!==null;)sg(_t)}function N0(e,n){var r=zt;zt|=2;var c=ig(),m=ng();Wt!==e||kt!==n?(Oo=null,Lo=Ie()+500,Ws(e,n)):qs=Ca(e,n);t:do try{if(Gt!==0&&_t!==null){n=_t;var p=li;e:switch(Gt){case 1:Gt=0,li=null,Qs(e,n,p,1);break;case 2:case 9:if(mf(p)){Gt=0,li=null,ag(n);break}n=function(){Gt!==2&&Gt!==9||Wt!==e||(Gt=7),Ii(e)},p.then(n,n);break t;case 3:Gt=7;break t;case 4:Gt=5;break t;case 7:mf(p)?(Gt=0,li=null,ag(n)):(Gt=0,li=null,Qs(e,n,p,7));break;case 5:var v=null;switch(_t.tag){case 26:v=_t.memoizedState;case 5:case 27:var E=_t;if(v?Vg(v):E.stateNode.complete){Gt=0,li=null;var N=E.sibling;if(N!==null)_t=N;else{var I=E.return;I!==null?(_t=I,zo(I)):_t=null}break e}}Gt=0,li=null,Qs(e,n,p,5);break;case 6:Gt=0,li=null,Qs(e,n,p,6);break;case 8:ku(),oe=6;break t;default:throw Error(s(462))}}R0();break}catch($){tg(e,$)}while(!0);return Ji=es=null,B.H=c,B.A=m,zt=r,_t!==null?0:(Wt=null,kt=0,eo(),oe)}function R0(){for(;_t!==null&&!_e();)sg(_t)}function sg(e){var n=Mm(e.alternate,e,un);e.memoizedProps=e.pendingProps,n===null?zo(e):_t=n}function ag(e){var n=e,r=n.alternate;switch(n.tag){case 15:case 0:n=xm(r,n,n.pendingProps,n.type,void 0,kt);break;case 11:n=xm(r,n,n.pendingProps,n.type.render,n.ref,kt);break;case 5:Xc(n);default:Dm(r,n),n=_t=nf(n,un),n=Mm(r,n,un)}e.memoizedProps=e.pendingProps,n===null?zo(e):_t=n}function Qs(e,n,r,c){Ji=es=null,Xc(n),Is=null,Ga=0;var m=n.return;try{if(A0(e,m,n,r,kt)){oe=1,Eo(e,Ai(r,e.current)),_t=null;return}}catch(p){if(m!==null)throw _t=m,p;oe=1,Eo(e,Ai(r,e.current)),_t=null;return}n.flags&32768?(Nt||c===1?e=!0:qs||(kt&536870912)!==0?e=!1:(Dn=e=!0,(c===2||c===9||c===3||c===6)&&(c=ri.current,c!==null&&c.tag===13&&(c.flags|=16384))),rg(n,e)):zo(n)}function zo(e){var n=e;do{if((n.flags&32768)!==0){rg(n,Dn);return}e=n.return;var r=S0(n.alternate,n,un);if(r!==null){_t=r;return}if(n=n.sibling,n!==null){_t=n;return}_t=n=e}while(n!==null);oe===0&&(oe=5)}function rg(e,n){do{var r=E0(e.alternate,e);if(r!==null){r.flags&=32767,_t=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(e=e.sibling,e!==null)){_t=e;return}_t=e=r}while(e!==null);oe=6,_t=null}function og(e,n,r,c,m,p,v,E,N){e.cancelPendingCommit=null;do jo();while(ve!==0);if((zt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(p=n.lanes|n.childLanes,p|=yc,hy(e,r,p,v,E,N),e===Wt&&(_t=Wt=null,kt=0),Ks=n,Ln=e,hn=r,Cu=p,_u=m,Wm=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,F0(Ri,function(){return dg(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,m=H.p,H.p=2,v=zt,zt|=4;try{T0(e,n,r)}finally{zt=v,H.p=m,B.T=c}}ve=1,lg(),cg(),ug()}}function lg(){if(ve===1){ve=0;var e=Ln,n=Ks,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=B.T,B.T=null;var c=H.p;H.p=2;var m=zt;zt|=4;try{Hm(n,e);var p=Hu,v=qd(e.containerInfo),E=p.focusedElem,N=p.selectionRange;if(v!==E&&E&&E.ownerDocument&&Yd(E.ownerDocument.documentElement,E)){if(N!==null&&fc(E)){var I=N.start,$=N.end;if($===void 0&&($=I),"selectionStart"in E)E.selectionStart=I,E.selectionEnd=Math.min($,E.value.length);else{var W=E.ownerDocument||document,U=W&&W.defaultView||window;if(U.getSelection){var V=U.getSelection(),ot=E.textContent.length,vt=Math.min(N.start,ot),qt=N.end===void 0?vt:Math.min(N.end,ot);!V.extend&&vt>qt&&(v=qt,qt=vt,vt=v);var z=Xd(E,vt),O=Xd(E,qt);if(z&&O&&(V.rangeCount!==1||V.anchorNode!==z.node||V.anchorOffset!==z.offset||V.focusNode!==O.node||V.focusOffset!==O.offset)){var P=W.createRange();P.setStart(z.node,z.offset),V.removeAllRanges(),vt>qt?(V.addRange(P),V.extend(O.node,O.offset)):(P.setEnd(O.node,O.offset),V.addRange(P))}}}}for(W=[],V=E;V=V.parentNode;)V.nodeType===1&&W.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<W.length;E++){var K=W[E];K.element.scrollLeft=K.left,K.element.scrollTop=K.top}}Wo=!!Uu,Hu=Uu=null}finally{zt=m,H.p=c,B.T=r}}e.current=n,ve=2}}function cg(){if(ve===2){ve=0;var e=Ln,n=Ks,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=B.T,B.T=null;var c=H.p;H.p=2;var m=zt;zt|=4;try{zm(e,n.alternate,n)}finally{zt=m,H.p=c,B.T=r}}ve=3}}function ug(){if(ve===4||ve===3){ve=0,pn();var e=Ln,n=Ks,r=hn,c=Wm;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ve=5:(ve=0,Ks=Ln=null,hg(e,e.pendingLanes));var m=e.pendingLanes;if(m===0&&(Rn=null),$l(r),n=n.stateNode,ii&&typeof ii.onCommitFiberRoot=="function")try{ii.onCommitFiberRoot(Ta,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=B.T,m=H.p,H.p=2,B.T=null;try{for(var p=e.onRecoverableError,v=0;v<c.length;v++){var E=c[v];p(E.value,{componentStack:E.stack})}}finally{B.T=n,H.p=m}}(hn&3)!==0&&jo(),Ii(e),m=e.pendingLanes,(r&261930)!==0&&(m&42)!==0?e===Mu?rr++:(rr=0,Mu=e):rr=0,or(0)}}function hg(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Ua(n)))}function jo(){return lg(),cg(),ug(),dg()}function dg(){if(ve!==5)return!1;var e=Ln,n=Cu;Cu=0;var r=$l(hn),c=B.T,m=H.p;try{H.p=32>r?32:r,B.T=null,r=_u,_u=null;var p=Ln,v=hn;if(ve=0,Ks=Ln=null,hn=0,(zt&6)!==0)throw Error(s(331));var E=zt;if(zt|=4,qm(p.current),Vm(p,p.current,v,r),zt=E,or(0,!1),ii&&typeof ii.onPostCommitFiberRoot=="function")try{ii.onPostCommitFiberRoot(Ta,p)}catch{}return!0}finally{H.p=m,B.T=c,hg(e,n)}}function fg(e,n,r){n=Ai(r,n),n=ru(e.stateNode,n,2),e=Cn(e,n,2),e!==null&&(_a(e,2),Ii(e))}function Vt(e,n,r){if(e.tag===3)fg(e,e,r);else for(;n!==null;){if(n.tag===3){fg(n,e,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Rn===null||!Rn.has(c))){e=Ai(r,e),r=mm(2),c=Cn(n,r,2),c!==null&&(gm(r,c,n,e),_a(c,2),Ii(c));break}}n=n.return}}function Nu(e,n,r){var c=e.pingCache;if(c===null){c=e.pingCache=new M0;var m=new Set;c.set(n,m)}else m=c.get(n),m===void 0&&(m=new Set,c.set(n,m));m.has(r)||(Su=!0,m.add(r),e=L0.bind(null,e,n,r),n.then(e,e))}function L0(e,n,r){var c=e.pingCache;c!==null&&c.delete(n),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Wt===e&&(kt&r)===r&&(oe===4||oe===3&&(kt&62914560)===kt&&300>Ie()-Ro?(zt&2)===0&&Ws(e,0):Eu|=r,$s===kt&&($s=0)),Ii(e)}function mg(e,n){n===0&&(n=od()),e=Zn(e,n),e!==null&&(_a(e,n),Ii(e))}function O0(e){var n=e.memoizedState,r=0;n!==null&&(r=n.retryLane),mg(e,r)}function B0(e,n){var r=0;switch(e.tag){case 31:case 13:var c=e.stateNode,m=e.memoizedState;m!==null&&(r=m.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),mg(e,r)}function F0(e,n){return ne(e,n)}var Po=null,Zs=null,Ru=!1,Io=!1,Lu=!1,Bn=0;function Ii(e){e!==Zs&&e.next===null&&(Zs===null?Po=Zs=e:Zs=Zs.next=e),Io=!0,Ru||(Ru=!0,j0())}function or(e,n){if(!Lu&&Io){Lu=!0;do for(var r=!1,c=Po;c!==null;){if(e!==0){var m=c.pendingLanes;if(m===0)var p=0;else{var v=c.suspendedLanes,E=c.pingedLanes;p=(1<<31-ni(42|e)+1)-1,p&=m&~(v&~E),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,yg(c,p))}else p=kt,p=Gr(c,c===Wt?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Ca(c,p)||(r=!0,yg(c,p));c=c.next}while(r);Lu=!1}}function z0(){gg()}function gg(){Io=Ru=!1;var e=0;Bn!==0&&$0()&&(e=Bn);for(var n=Ie(),r=null,c=Po;c!==null;){var m=c.next,p=pg(c,n);p===0?(c.next=null,r===null?Po=m:r.next=m,m===null&&(Zs=r)):(r=c,(e!==0||(p&3)!==0)&&(Io=!0)),c=m}ve!==0&&ve!==5||or(e),Bn!==0&&(Bn=0)}function pg(e,n){for(var r=e.suspendedLanes,c=e.pingedLanes,m=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var v=31-ni(p),E=1<<v,N=m[v];N===-1?((E&r)===0||(E&c)!==0)&&(m[v]=uy(E,n)):N<=n&&(e.expiredLanes|=E),p&=~E}if(n=Wt,r=kt,r=Gr(e,e===n?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,r===0||e===n&&(Gt===2||Gt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&Ce(c),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Ca(e,r)){if(n=r&-r,n===e.callbackPriority)return n;switch(c!==null&&Ce(c),$l(r)){case 2:case 8:r=Ni;break;case 32:r=Ri;break;case 268435456:r=rd;break;default:r=Ri}return c=bg.bind(null,e),r=ne(r,c),e.callbackPriority=n,e.callbackNode=r,n}return c!==null&&c!==null&&Ce(c),e.callbackPriority=2,e.callbackNode=null,2}function bg(e,n){if(ve!==0&&ve!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(jo()&&e.callbackNode!==r)return null;var c=kt;return c=Gr(e,e===Wt?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(Zm(e,c,n),pg(e,Ie()),e.callbackNode!=null&&e.callbackNode===r?bg.bind(null,e):null)}function yg(e,n){if(jo())return null;Zm(e,n,!0)}function j0(){W0(function(){(zt&6)!==0?ne(Ea,z0):gg()})}function Ou(){if(Bn===0){var e=zs;e===0&&(e=Ir,Ir<<=1,(Ir&261888)===0&&(Ir=256)),Bn=e}return Bn}function vg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:qr(""+e)}function Ag(e,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,e.id&&r.setAttribute("form",e.id),n.parentNode.insertBefore(r,n),e=new FormData(e),r.parentNode.removeChild(r),e}function P0(e,n,r,c,m){if(n==="submit"&&r&&r.stateNode===m){var p=vg((m[Xe]||null).action),v=c.submitter;v&&(n=(n=v[Xe]||null)?vg(n.formAction):v.getAttribute("formAction"),n!==null&&(p=n,v=null));var E=new Qr("action","action",null,c,m);e.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Bn!==0){var N=v?Ag(m,v):new FormData(m);tu(r,{pending:!0,data:N,method:m.method,action:p},null,N)}}else typeof p=="function"&&(E.preventDefault(),N=v?Ag(m,v):new FormData(m),tu(r,{pending:!0,data:N,method:m.method,action:p},p,N))},currentTarget:m}]})}}for(var Bu=0;Bu<bc.length;Bu++){var Fu=bc[Bu],I0=Fu.toLowerCase(),U0=Fu[0].toUpperCase()+Fu.slice(1);Li(I0,"on"+U0)}Li(Wd,"onAnimationEnd"),Li(Qd,"onAnimationIteration"),Li(Zd,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(n0,"onTransitionRun"),Li(s0,"onTransitionStart"),Li(a0,"onTransitionCancel"),Li(Jd,"onTransitionEnd"),Ss("onMouseEnter",["mouseout","mouseover"]),Ss("onMouseLeave",["mouseout","mouseover"]),Ss("onPointerEnter",["pointerout","pointerover"]),Ss("onPointerLeave",["pointerout","pointerover"]),$n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$n("onBeforeInput",["compositionend","keypress","textInput","paste"]),$n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lr));function wg(e,n){n=(n&4)!==0;for(var r=0;r<e.length;r++){var c=e[r],m=c.event;c=c.listeners;t:{var p=void 0;if(n)for(var v=c.length-1;0<=v;v--){var E=c[v],N=E.instance,I=E.currentTarget;if(E=E.listener,N!==p&&m.isPropagationStopped())break t;p=E,m.currentTarget=I;try{p(m)}catch($){to($)}m.currentTarget=null,p=N}else for(v=0;v<c.length;v++){if(E=c[v],N=E.instance,I=E.currentTarget,E=E.listener,N!==p&&m.isPropagationStopped())break t;p=E,m.currentTarget=I;try{p(m)}catch($){to($)}m.currentTarget=null,p=N}}}}function Mt(e,n){var r=n[Kl];r===void 0&&(r=n[Kl]=new Set);var c=e+"__bubble";r.has(c)||(xg(n,e,2,!1),r.add(c))}function zu(e,n,r){var c=0;n&&(c|=4),xg(r,e,c,n)}var Uo="_reactListening"+Math.random().toString(36).slice(2);function ju(e){if(!e[Uo]){e[Uo]=!0,md.forEach(function(r){r!=="selectionchange"&&(H0.has(r)||zu(r,!1,e),zu(r,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Uo]||(n[Uo]=!0,zu("selectionchange",!1,n))}}function xg(e,n,r,c){switch(Qg(n)){case 2:var m=pv;break;case 8:m=bv;break;default:m=Ju}r=m.bind(null,n,r,e),m=void 0,!sc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),c?m!==void 0?e.addEventListener(n,r,{capture:!0,passive:m}):e.addEventListener(n,r,!0):m!==void 0?e.addEventListener(n,r,{passive:m}):e.addEventListener(n,r,!1)}function Pu(e,n,r,c,m){var p=c;if((n&1)===0&&(n&2)===0&&c!==null)t:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var E=c.stateNode.containerInfo;if(E===m)break;if(v===4)for(v=c.return;v!==null;){var N=v.tag;if((N===3||N===4)&&v.stateNode.containerInfo===m)return;v=v.return}for(;E!==null;){if(v=As(E),v===null)return;if(N=v.tag,N===5||N===6||N===26||N===27){c=p=v;continue t}E=E.parentNode}}c=c.return}Cd(function(){var I=p,$=ic(r),W=[];t:{var U=tf.get(e);if(U!==void 0){var V=Qr,ot=e;switch(e){case"keypress":if(Kr(r)===0)break t;case"keydown":case"keyup":V=By;break;case"focusin":ot="focus",V=lc;break;case"focusout":ot="blur",V=lc;break;case"beforeblur":case"afterblur":V=lc;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=kd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=Sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=jy;break;case Wd:case Qd:case Zd:V=Cy;break;case Jd:V=Iy;break;case"scroll":case"scrollend":V=wy;break;case"wheel":V=Hy;break;case"copy":case"cut":case"paste":V=My;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=Nd;break;case"toggle":case"beforetoggle":V=Vy}var vt=(n&4)!==0,qt=!vt&&(e==="scroll"||e==="scrollend"),z=vt?U!==null?U+"Capture":null:U;vt=[];for(var O=I,P;O!==null;){var K=O;if(P=K.stateNode,K=K.tag,K!==5&&K!==26&&K!==27||P===null||z===null||(K=Da(O,z),K!=null&&vt.push(cr(O,K,P))),qt)break;O=O.return}0<vt.length&&(U=new V(U,ot,null,r,$),W.push({event:U,listeners:vt}))}}if((n&7)===0){t:{if(U=e==="mouseover"||e==="pointerover",V=e==="mouseout"||e==="pointerout",U&&r!==ec&&(ot=r.relatedTarget||r.fromElement)&&(As(ot)||ot[vs]))break t;if((V||U)&&(U=$.window===$?$:(U=$.ownerDocument)?U.defaultView||U.parentWindow:window,V?(ot=r.relatedTarget||r.toElement,V=I,ot=ot?As(ot):null,ot!==null&&(qt=o(ot),vt=ot.tag,ot!==qt||vt!==5&&vt!==27&&vt!==6)&&(ot=null)):(V=null,ot=I),V!==ot)){if(vt=kd,K="onMouseLeave",z="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(vt=Nd,K="onPointerLeave",z="onPointerEnter",O="pointer"),qt=V==null?U:ka(V),P=ot==null?U:ka(ot),U=new vt(K,O+"leave",V,r,$),U.target=qt,U.relatedTarget=P,K=null,As($)===I&&(vt=new vt(z,O+"enter",ot,r,$),vt.target=P,vt.relatedTarget=qt,K=vt),qt=K,V&&ot)e:{for(vt=G0,z=V,O=ot,P=0,K=z;K;K=vt(K))P++;K=0;for(var gt=O;gt;gt=vt(gt))K++;for(;0<P-K;)z=vt(z),P--;for(;0<K-P;)O=vt(O),K--;for(;P--;){if(z===O||O!==null&&z===O.alternate){vt=z;break e}z=vt(z),O=vt(O)}vt=null}else vt=null;V!==null&&Sg(W,U,V,vt,!1),ot!==null&&qt!==null&&Sg(W,qt,ot,vt,!0)}}t:{if(U=I?ka(I):window,V=U.nodeName&&U.nodeName.toLowerCase(),V==="select"||V==="input"&&U.type==="file")var Bt=Pd;else if(zd(U))if(Id)Bt=t0;else{Bt=Zy;var ut=Qy}else V=U.nodeName,!V||V.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?I&&tc(I.elementType)&&(Bt=Pd):Bt=Jy;if(Bt&&(Bt=Bt(e,I))){jd(W,Bt,r,$);break t}ut&&ut(e,U,I),e==="focusout"&&I&&U.type==="number"&&I.memoizedProps.value!=null&&Jl(U,"number",U.value)}switch(ut=I?ka(I):window,e){case"focusin":(zd(ut)||ut.contentEditable==="true")&&(ks=ut,mc=I,ja=null);break;case"focusout":ja=mc=ks=null;break;case"mousedown":gc=!0;break;case"contextmenu":case"mouseup":case"dragend":gc=!1,$d(W,r,$);break;case"selectionchange":if(i0)break;case"keydown":case"keyup":$d(W,r,$)}var Ct;if(uc)t:{switch(e){case"compositionstart":var Dt="onCompositionStart";break t;case"compositionend":Dt="onCompositionEnd";break t;case"compositionupdate":Dt="onCompositionUpdate";break t}Dt=void 0}else Ms?Bd(e,r)&&(Dt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Dt="onCompositionStart");Dt&&(Rd&&r.locale!=="ko"&&(Ms||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&Ms&&(Ct=_d()):(vn=$,ac="value"in vn?vn.value:vn.textContent,Ms=!0)),ut=Ho(I,Dt),0<ut.length&&(Dt=new Dd(Dt,e,null,r,$),W.push({event:Dt,listeners:ut}),Ct?Dt.data=Ct:(Ct=Fd(r),Ct!==null&&(Dt.data=Ct)))),(Ct=Yy?qy(e,r):$y(e,r))&&(Dt=Ho(I,"onBeforeInput"),0<Dt.length&&(ut=new Dd("onBeforeInput","beforeinput",null,r,$),W.push({event:ut,listeners:Dt}),ut.data=Ct)),P0(W,e,I,r,$)}wg(W,n)})}function cr(e,n,r){return{instance:e,listener:n,currentTarget:r}}function Ho(e,n){for(var r=n+"Capture",c=[];e!==null;){var m=e,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Da(e,r),m!=null&&c.unshift(cr(e,m,p)),m=Da(e,n),m!=null&&c.push(cr(e,m,p))),e.tag===3)return c;e=e.return}return[]}function G0(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Sg(e,n,r,c,m){for(var p=n._reactName,v=[];r!==null&&r!==c;){var E=r,N=E.alternate,I=E.stateNode;if(E=E.tag,N!==null&&N===c)break;E!==5&&E!==26&&E!==27||I===null||(N=I,m?(I=Da(r,p),I!=null&&v.unshift(cr(r,I,N))):m||(I=Da(r,p),I!=null&&v.push(cr(r,I,N)))),r=r.return}v.length!==0&&e.push({event:n,listeners:v})}var V0=/\r\n?/g,X0=/\u0000|\uFFFD/g;function Eg(e){return(typeof e=="string"?e:""+e).replace(V0,`
`).replace(X0,"")}function Tg(e,n){return n=Eg(n),Eg(e)===n}function Yt(e,n,r,c,m,p){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||Ts(e,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&Ts(e,""+c);break;case"className":Xr(e,"class",c);break;case"tabIndex":Xr(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Xr(e,r,c);break;case"style":Ed(e,c,p);break;case"data":if(n!=="object"){Xr(e,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){e.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=qr(""+c),e.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(n!=="input"&&Yt(e,n,"name",m.name,m,null),Yt(e,n,"formEncType",m.formEncType,m,null),Yt(e,n,"formMethod",m.formMethod,m,null),Yt(e,n,"formTarget",m.formTarget,m,null)):(Yt(e,n,"encType",m.encType,m,null),Yt(e,n,"method",m.method,m,null),Yt(e,n,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=qr(""+c),e.setAttribute(r,c);break;case"onClick":c!=null&&(e.onclick=Ki);break;case"onScroll":c!=null&&Mt("scroll",e);break;case"onScrollEnd":c!=null&&Mt("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}r=qr(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""+c):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":c===!0?e.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,c):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(r,c):e.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(r):e.setAttribute(r,c);break;case"popover":Mt("beforetoggle",e),Mt("toggle",e),Vr(e,"popover",c);break;case"xlinkActuate":$i(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":$i(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":$i(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":$i(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":$i(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":$i(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":$i(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":$i(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":$i(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Vr(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=vy.get(r)||r,Vr(e,r,c))}}function Iu(e,n,r,c,m,p){switch(r){case"style":Ed(e,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"children":typeof c=="string"?Ts(e,c):(typeof c=="number"||typeof c=="bigint")&&Ts(e,""+c);break;case"onScroll":c!=null&&Mt("scroll",e);break;case"onScrollEnd":c!=null&&Mt("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Ki);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gd.hasOwnProperty(r))t:{if(r[0]==="o"&&r[1]==="n"&&(m=r.endsWith("Capture"),n=r.slice(2,m?r.length-7:void 0),p=e[Xe]||null,p=p!=null?p[r]:null,typeof p=="function"&&e.removeEventListener(n,p,m),typeof c=="function")){typeof p!="function"&&p!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(n,c,m);break t}r in e?e[r]=c:c===!0?e.setAttribute(r,""):Vr(e,r,c)}}}function Re(e,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mt("error",e),Mt("load",e);var c=!1,m=!1,p;for(p in r)if(r.hasOwnProperty(p)){var v=r[p];if(v!=null)switch(p){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Yt(e,n,p,v,r,null)}}m&&Yt(e,n,"srcSet",r.srcSet,r,null),c&&Yt(e,n,"src",r.src,r,null);return;case"input":Mt("invalid",e);var E=p=v=m=null,N=null,I=null;for(c in r)if(r.hasOwnProperty(c)){var $=r[c];if($!=null)switch(c){case"name":m=$;break;case"type":v=$;break;case"checked":N=$;break;case"defaultChecked":I=$;break;case"value":p=$;break;case"defaultValue":E=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(s(137,n));break;default:Yt(e,n,c,$,r,null)}}Ad(e,p,E,N,I,v,m,!1);return;case"select":Mt("invalid",e),c=v=p=null;for(m in r)if(r.hasOwnProperty(m)&&(E=r[m],E!=null))switch(m){case"value":p=E;break;case"defaultValue":v=E;break;case"multiple":c=E;default:Yt(e,n,m,E,r,null)}n=p,r=v,e.multiple=!!c,n!=null?Es(e,!!c,n,!1):r!=null&&Es(e,!!c,r,!0);return;case"textarea":Mt("invalid",e),p=m=c=null;for(v in r)if(r.hasOwnProperty(v)&&(E=r[v],E!=null))switch(v){case"value":c=E;break;case"defaultValue":m=E;break;case"children":p=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(s(91));break;default:Yt(e,n,v,E,r,null)}xd(e,c,m,p);return;case"option":for(N in r)r.hasOwnProperty(N)&&(c=r[N],c!=null)&&(N==="selected"?e.selected=c&&typeof c!="function"&&typeof c!="symbol":Yt(e,n,N,c,r,null));return;case"dialog":Mt("beforetoggle",e),Mt("toggle",e),Mt("cancel",e),Mt("close",e);break;case"iframe":case"object":Mt("load",e);break;case"video":case"audio":for(c=0;c<lr.length;c++)Mt(lr[c],e);break;case"image":Mt("error",e),Mt("load",e);break;case"details":Mt("toggle",e);break;case"embed":case"source":case"link":Mt("error",e),Mt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(I in r)if(r.hasOwnProperty(I)&&(c=r[I],c!=null))switch(I){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Yt(e,n,I,c,r,null)}return;default:if(tc(n)){for($ in r)r.hasOwnProperty($)&&(c=r[$],c!==void 0&&Iu(e,n,$,c,r,void 0));return}}for(E in r)r.hasOwnProperty(E)&&(c=r[E],c!=null&&Yt(e,n,E,c,r,null))}function Y0(e,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,v=null,E=null,N=null,I=null,$=null;for(V in r){var W=r[V];if(r.hasOwnProperty(V)&&W!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":N=W;default:c.hasOwnProperty(V)||Yt(e,n,V,null,c,W)}}for(var U in c){var V=c[U];if(W=r[U],c.hasOwnProperty(U)&&(V!=null||W!=null))switch(U){case"type":p=V;break;case"name":m=V;break;case"checked":I=V;break;case"defaultChecked":$=V;break;case"value":v=V;break;case"defaultValue":E=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:V!==W&&Yt(e,n,U,V,c,W)}}Zl(e,v,E,N,I,$,p,m);return;case"select":V=v=E=U=null;for(p in r)if(N=r[p],r.hasOwnProperty(p)&&N!=null)switch(p){case"value":break;case"multiple":V=N;default:c.hasOwnProperty(p)||Yt(e,n,p,null,c,N)}for(m in c)if(p=c[m],N=r[m],c.hasOwnProperty(m)&&(p!=null||N!=null))switch(m){case"value":U=p;break;case"defaultValue":E=p;break;case"multiple":v=p;default:p!==N&&Yt(e,n,m,p,c,N)}n=E,r=v,c=V,U!=null?Es(e,!!r,U,!1):!!c!=!!r&&(n!=null?Es(e,!!r,n,!0):Es(e,!!r,r?[]:"",!1));return;case"textarea":V=U=null;for(E in r)if(m=r[E],r.hasOwnProperty(E)&&m!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Yt(e,n,E,null,c,m)}for(v in c)if(m=c[v],p=r[v],c.hasOwnProperty(v)&&(m!=null||p!=null))switch(v){case"value":U=m;break;case"defaultValue":V=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==p&&Yt(e,n,v,m,c,p)}wd(e,U,V);return;case"option":for(var ot in r)U=r[ot],r.hasOwnProperty(ot)&&U!=null&&!c.hasOwnProperty(ot)&&(ot==="selected"?e.selected=!1:Yt(e,n,ot,null,c,U));for(N in c)U=c[N],V=r[N],c.hasOwnProperty(N)&&U!==V&&(U!=null||V!=null)&&(N==="selected"?e.selected=U&&typeof U!="function"&&typeof U!="symbol":Yt(e,n,N,U,c,V));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vt in r)U=r[vt],r.hasOwnProperty(vt)&&U!=null&&!c.hasOwnProperty(vt)&&Yt(e,n,vt,null,c,U);for(I in c)if(U=c[I],V=r[I],c.hasOwnProperty(I)&&U!==V&&(U!=null||V!=null))switch(I){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(137,n));break;default:Yt(e,n,I,U,c,V)}return;default:if(tc(n)){for(var qt in r)U=r[qt],r.hasOwnProperty(qt)&&U!==void 0&&!c.hasOwnProperty(qt)&&Iu(e,n,qt,void 0,c,U);for($ in c)U=c[$],V=r[$],!c.hasOwnProperty($)||U===V||U===void 0&&V===void 0||Iu(e,n,$,U,c,V);return}}for(var z in r)U=r[z],r.hasOwnProperty(z)&&U!=null&&!c.hasOwnProperty(z)&&Yt(e,n,z,null,c,U);for(W in c)U=c[W],V=r[W],!c.hasOwnProperty(W)||U===V||U==null&&V==null||Yt(e,n,W,U,c,V)}function Cg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function q0(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var m=r[c],p=m.transferSize,v=m.initiatorType,E=m.duration;if(p&&E&&Cg(v)){for(v=0,E=m.responseEnd,c+=1;c<r.length;c++){var N=r[c],I=N.startTime;if(I>E)break;var $=N.transferSize,W=N.initiatorType;$&&Cg(W)&&(N=N.responseEnd,v+=$*(N<E?1:(E-I)/(N-I)))}if(--c,n+=8*(p+v)/(m.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Uu=null,Hu=null;function Go(e){return e.nodeType===9?e:e.ownerDocument}function _g(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Gu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Vu=null;function $0(){var e=window.event;return e&&e.type==="popstate"?e===Vu?!1:(Vu=e,!0):(Vu=null,!1)}var kg=typeof setTimeout=="function"?setTimeout:void 0,K0=typeof clearTimeout=="function"?clearTimeout:void 0,Dg=typeof Promise=="function"?Promise:void 0,W0=typeof queueMicrotask=="function"?queueMicrotask:typeof Dg<"u"?function(e){return Dg.resolve(null).then(e).catch(Q0)}:kg;function Q0(e){setTimeout(function(){throw e})}function Fn(e){return e==="head"}function Ng(e,n){var r=n,c=0;do{var m=r.nextSibling;if(e.removeChild(r),m&&m.nodeType===8)if(r=m.data,r==="/$"||r==="/&"){if(c===0){e.removeChild(m),ia(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")ur(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,ur(r);for(var p=r.firstChild;p;){var v=p.nextSibling,E=p.nodeName;p[Ma]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&p.rel.toLowerCase()==="stylesheet"||r.removeChild(p),p=v}}else r==="body"&&ur(e.ownerDocument.body);r=m}while(r);ia(n)}function Rg(e,n){var r=e;e=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=c}while(r)}function Xu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Xu(r),Wl(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Z0(e,n,r,c){for(;e.nodeType===1;){var m=r;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[Ma])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==m.rel||e.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||e.getAttribute("title")!==(m.title==null?null:m.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(m.src==null?null:m.src)||e.getAttribute("type")!==(m.type==null?null:m.type)||e.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=Ti(e.nextSibling),e===null)break}return null}function J0(e,n,r){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Ti(e.nextSibling),e===null))return null;return e}function Lg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Ti(e.nextSibling),e===null))return null;return e}function Yu(e){return e.data==="$?"||e.data==="$~"}function qu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function tv(e,n){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Ti(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var $u=null;function Og(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(n===0)return Ti(e.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}e=e.nextSibling}return null}function Bg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return e;n--}else r!=="/$"&&r!=="/&"||n++}e=e.previousSibling}return null}function Fg(e,n,r){switch(n=Go(r),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function ur(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Wl(e)}var Ci=new Map,zg=new Set;function Vo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var dn=H.d;H.d={f:ev,r:iv,D:nv,C:sv,L:av,m:rv,X:lv,S:ov,M:cv};function ev(){var e=dn.f(),n=Bo();return e||n}function iv(e){var n=ws(e);n!==null&&n.tag===5&&n.type==="form"?tm(n):dn.r(e)}var Js=typeof document>"u"?null:document;function jg(e,n,r){var c=Js;if(c&&typeof n=="string"&&n){var m=yi(n);m='link[rel="'+e+'"][href="'+m+'"]',typeof r=="string"&&(m+='[crossorigin="'+r+'"]'),zg.has(m)||(zg.add(m),e={rel:e,crossOrigin:r,href:n},c.querySelector(m)===null&&(n=c.createElement("link"),Re(n,"link",e),xe(n),c.head.appendChild(n)))}}function nv(e){dn.D(e),jg("dns-prefetch",e,null)}function sv(e,n){dn.C(e,n),jg("preconnect",e,n)}function av(e,n,r){dn.L(e,n,r);var c=Js;if(c&&e&&n){var m='link[rel="preload"][as="'+yi(n)+'"]';n==="image"&&r&&r.imageSrcSet?(m+='[imagesrcset="'+yi(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(m+='[imagesizes="'+yi(r.imageSizes)+'"]')):m+='[href="'+yi(e)+'"]';var p=m;switch(n){case"style":p=ta(e);break;case"script":p=ea(e)}Ci.has(p)||(e=b({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:e,as:n},r),Ci.set(p,e),c.querySelector(m)!==null||n==="style"&&c.querySelector(hr(p))||n==="script"&&c.querySelector(dr(p))||(n=c.createElement("link"),Re(n,"link",e),xe(n),c.head.appendChild(n)))}}function rv(e,n){dn.m(e,n);var r=Js;if(r&&e){var c=n&&typeof n.as=="string"?n.as:"script",m='link[rel="modulepreload"][as="'+yi(c)+'"][href="'+yi(e)+'"]',p=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ea(e)}if(!Ci.has(p)&&(e=b({rel:"modulepreload",href:e},n),Ci.set(p,e),r.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(dr(p)))return}c=r.createElement("link"),Re(c,"link",e),xe(c),r.head.appendChild(c)}}}function ov(e,n,r){dn.S(e,n,r);var c=Js;if(c&&e){var m=xs(c).hoistableStyles,p=ta(e);n=n||"default";var v=m.get(p);if(!v){var E={loading:0,preload:null};if(v=c.querySelector(hr(p)))E.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},r),(r=Ci.get(p))&&Ku(e,r);var N=v=c.createElement("link");xe(N),Re(N,"link",e),N._p=new Promise(function(I,$){N.onload=I,N.onerror=$}),N.addEventListener("load",function(){E.loading|=1}),N.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Xo(v,n,c)}v={type:"stylesheet",instance:v,count:1,state:E},m.set(p,v)}}}function lv(e,n){dn.X(e,n);var r=Js;if(r&&e){var c=xs(r).hoistableScripts,m=ea(e),p=c.get(m);p||(p=r.querySelector(dr(m)),p||(e=b({src:e,async:!0},n),(n=Ci.get(m))&&Wu(e,n),p=r.createElement("script"),xe(p),Re(p,"link",e),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function cv(e,n){dn.M(e,n);var r=Js;if(r&&e){var c=xs(r).hoistableScripts,m=ea(e),p=c.get(m);p||(p=r.querySelector(dr(m)),p||(e=b({src:e,async:!0,type:"module"},n),(n=Ci.get(m))&&Wu(e,n),p=r.createElement("script"),xe(p),Re(p,"link",e),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(m,p))}}function Pg(e,n,r,c){var m=(m=bt.current)?Vo(m):null;if(!m)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=ta(r.href),r=xs(m).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=ta(r.href);var p=xs(m).hoistableStyles,v=p.get(e);if(v||(m=m.ownerDocument||m,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,v),(p=m.querySelector(hr(e)))&&!p._p&&(v.instance=p,v.state.loading=5),Ci.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Ci.set(e,r),p||uv(m,e,r,v.state))),n&&c===null)throw Error(s(528,""));return v}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ea(r),r=xs(m).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function ta(e){return'href="'+yi(e)+'"'}function hr(e){return'link[rel="stylesheet"]['+e+"]"}function Ig(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function uv(e,n,r,c){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=e.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),Re(n,"link",r),xe(n),e.head.appendChild(n))}function ea(e){return'[src="'+yi(e)+'"]'}function dr(e){return"script[async]"+e}function Ug(e,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=e.querySelector('style[data-href~="'+yi(r.href)+'"]');if(c)return n.instance=c,xe(c),c;var m=b({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),xe(c),Re(c,"style",m),Xo(c,r.precedence,e),n.instance=c;case"stylesheet":m=ta(r.href);var p=e.querySelector(hr(m));if(p)return n.state.loading|=4,n.instance=p,xe(p),p;c=Ig(r),(m=Ci.get(m))&&Ku(c,m),p=(e.ownerDocument||e).createElement("link"),xe(p);var v=p;return v._p=new Promise(function(E,N){v.onload=E,v.onerror=N}),Re(p,"link",c),n.state.loading|=4,Xo(p,r.precedence,e),n.instance=p;case"script":return p=ea(r.src),(m=e.querySelector(dr(p)))?(n.instance=m,xe(m),m):(c=r,(m=Ci.get(p))&&(c=b({},r),Wu(c,m)),e=e.ownerDocument||e,m=e.createElement("script"),xe(m),Re(m,"link",c),e.head.appendChild(m),n.instance=m);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Xo(c,r.precedence,e));return n.instance}function Xo(e,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,p=m,v=0;v<c.length;v++){var E=c[v];if(E.dataset.precedence===n)p=E;else if(p!==m)break}p?p.parentNode.insertBefore(e,p.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(e,n.firstChild))}function Ku(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function Wu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Yo=null;function Hg(e,n,r){if(Yo===null){var c=new Map,m=Yo=new Map;m.set(r,c)}else m=Yo,c=m.get(r),c||(c=new Map,m.set(r,c));if(c.has(e))return c;for(c.set(e,null),r=r.getElementsByTagName(e),m=0;m<r.length;m++){var p=r[m];if(!(p[Ma]||p[Me]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(n)||"";v=e+v;var E=c.get(v);E?E.push(p):c.set(v,[p])}}return c}function Gg(e,n,r){e=e.ownerDocument||e,e.head.insertBefore(r,n==="title"?e.querySelector("head > title"):null)}function hv(e,n,r){if(r===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(e=n.disabled,typeof n.precedence=="string"&&e==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Vg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function dv(e,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=ta(c.href),p=n.querySelector(hr(m));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=qo.bind(e),n.then(e,e)),r.state.loading|=4,r.instance=p,xe(p);return}p=n.ownerDocument||n,c=Ig(c),(m=Ci.get(m))&&Ku(c,m),p=p.createElement("link"),xe(p);var v=p;v._p=new Promise(function(E,N){v.onload=E,v.onerror=N}),Re(p,"link",c),r.instance=p}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=qo.bind(e),n.addEventListener("load",r),n.addEventListener("error",r))}}var Qu=0;function fv(e,n){return e.stylesheets&&e.count===0&&Ko(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var c=setTimeout(function(){if(e.stylesheets&&Ko(e,e.stylesheets),e.unsuspend){var p=e.unsuspend;e.unsuspend=null,p()}},6e4+n);0<e.imgBytes&&Qu===0&&(Qu=62500*q0());var m=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Ko(e,e.stylesheets),e.unsuspend)){var p=e.unsuspend;e.unsuspend=null,p()}},(e.imgBytes>Qu?50:800)+n);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function qo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ko(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var $o=null;function Ko(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,$o=new Map,n.forEach(mv,e),$o=null,qo.call(e))}function mv(e,n){if(!(n.state.loading&4)){var r=$o.get(e);if(r)var c=r.get(null);else{r=new Map,$o.set(e,r);for(var m=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var v=m[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(r.set(v.dataset.precedence,v),c=v)}c&&r.set(null,c)}m=n.instance,v=m.getAttribute("data-precedence"),p=r.get(v)||c,p===c&&r.set(null,m),r.set(v,m),this.count++,c=qo.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),p?p.parentNode.insertBefore(m,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(m,e.firstChild)),n.state.loading|=4}}var fr={$$typeof:_,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function gv(e,n,r,c,m,p,v,E,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yl(0),this.hiddenUpdates=Yl(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function Xg(e,n,r,c,m,p,v,E,N,I,$,W){return e=new gv(e,n,r,v,N,I,$,W,E),n=1,p===!0&&(n|=24),p=ai(3,null,null,n),e.current=p,p.stateNode=e,n=Dc(),n.refCount++,e.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:n},Oc(p),e}function Yg(e){return e?(e=Rs,e):Rs}function qg(e,n,r,c,m,p){m=Yg(m),c.context===null?c.context=m:c.pendingContext=m,c=Tn(n),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=Cn(e,c,n),r!==null&&(Qe(r,e,n),Xa(r,e,n))}function $g(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<n?r:n}}function Zu(e,n){$g(e,n),(e=e.alternate)&&$g(e,n)}function Kg(e){if(e.tag===13||e.tag===31){var n=Zn(e,67108864);n!==null&&Qe(n,e,67108864),Zu(e,67108864)}}function Wg(e){if(e.tag===13||e.tag===31){var n=ui();n=ql(n);var r=Zn(e,n);r!==null&&Qe(r,e,n),Zu(e,n)}}var Wo=!0;function pv(e,n,r,c){var m=B.T;B.T=null;var p=H.p;try{H.p=2,Ju(e,n,r,c)}finally{H.p=p,B.T=m}}function bv(e,n,r,c){var m=B.T;B.T=null;var p=H.p;try{H.p=8,Ju(e,n,r,c)}finally{H.p=p,B.T=m}}function Ju(e,n,r,c){if(Wo){var m=th(c);if(m===null)Pu(e,n,c,Qo,r),Zg(e,c);else if(vv(m,e,n,r,c))c.stopPropagation();else if(Zg(e,c),n&4&&-1<yv.indexOf(e)){for(;m!==null;){var p=ws(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=qn(p.pendingLanes);if(v!==0){var E=p;for(E.pendingLanes|=2,E.entangledLanes|=2;v;){var N=1<<31-ni(v);E.entanglements[1]|=N,v&=~N}Ii(p),(zt&6)===0&&(Lo=Ie()+500,or(0))}}break;case 31:case 13:E=Zn(p,2),E!==null&&Qe(E,p,2),Bo(),Zu(p,2)}if(p=th(c),p===null&&Pu(e,n,c,Qo,r),p===m)break;m=p}m!==null&&c.stopPropagation()}else Pu(e,n,c,null,r)}}function th(e){return e=ic(e),eh(e)}var Qo=null;function eh(e){if(Qo=null,e=As(e),e!==null){var n=o(e);if(n===null)e=null;else{var r=n.tag;if(r===13){if(e=l(n),e!==null)return e;e=null}else if(r===31){if(e=u(n),e!==null)return e;e=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Qo=e,null}function Qg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vl()){case Ea:return 2;case Ni:return 8;case Ri:case Xl:return 32;case rd:return 268435456;default:return 32}default:return 32}}var ih=!1,zn=null,jn=null,Pn=null,mr=new Map,gr=new Map,In=[],yv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zg(e,n){switch(e){case"focusin":case"focusout":zn=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Pn=null;break;case"pointerover":case"pointerout":mr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":gr.delete(n.pointerId)}}function pr(e,n,r,c,m,p){return e===null||e.nativeEvent!==p?(e={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[m]},n!==null&&(n=ws(n),n!==null&&Kg(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),e)}function vv(e,n,r,c,m){switch(n){case"focusin":return zn=pr(zn,e,n,r,c,m),!0;case"dragenter":return jn=pr(jn,e,n,r,c,m),!0;case"mouseover":return Pn=pr(Pn,e,n,r,c,m),!0;case"pointerover":var p=m.pointerId;return mr.set(p,pr(mr.get(p)||null,e,n,r,c,m)),!0;case"gotpointercapture":return p=m.pointerId,gr.set(p,pr(gr.get(p)||null,e,n,r,c,m)),!0}return!1}function Jg(e){var n=As(e.target);if(n!==null){var r=o(n);if(r!==null){if(n=r.tag,n===13){if(n=l(r),n!==null){e.blockedOn=n,dd(e.priority,function(){Wg(r)});return}}else if(n===31){if(n=u(r),n!==null){e.blockedOn=n,dd(e.priority,function(){Wg(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var r=th(e.nativeEvent);if(r===null){r=e.nativeEvent;var c=new r.constructor(r.type,r);ec=c,r.target.dispatchEvent(c),ec=null}else return n=ws(r),n!==null&&Kg(n),e.blockedOn=r,!1;n.shift()}return!0}function tp(e,n,r){Zo(e)&&r.delete(n)}function Av(){ih=!1,zn!==null&&Zo(zn)&&(zn=null),jn!==null&&Zo(jn)&&(jn=null),Pn!==null&&Zo(Pn)&&(Pn=null),mr.forEach(tp),gr.forEach(tp)}function Jo(e,n){e.blockedOn===n&&(e.blockedOn=null,ih||(ih=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,Av)))}var tl=null;function ep(e){tl!==e&&(tl=e,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){tl===e&&(tl=null);for(var n=0;n<e.length;n+=3){var r=e[n],c=e[n+1],m=e[n+2];if(typeof c!="function"){if(eh(c||r)===null)continue;break}var p=ws(r);p!==null&&(e.splice(n,3),n-=3,tu(p,{pending:!0,data:m,method:r.method,action:c},c,m))}}))}function ia(e){function n(N){return Jo(N,e)}zn!==null&&Jo(zn,e),jn!==null&&Jo(jn,e),Pn!==null&&Jo(Pn,e),mr.forEach(n),gr.forEach(n);for(var r=0;r<In.length;r++){var c=In[r];c.blockedOn===e&&(c.blockedOn=null)}for(;0<In.length&&(r=In[0],r.blockedOn===null);)Jg(r),r.blockedOn===null&&In.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var m=r[c],p=r[c+1],v=m[Xe]||null;if(typeof p=="function")v||ep(r);else if(v){var E=null;if(p&&p.hasAttribute("formAction")){if(m=p,v=p[Xe]||null)E=v.formAction;else if(eh(m)!==null)continue}else E=v.action;typeof E=="function"?r[c+1]=E:(r.splice(c,3),c-=3),ep(r)}}}function ip(){function e(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return m=v})},focusReset:"manual",scroll:"manual"})}function n(){m!==null&&(m(),m=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),m!==null&&(m(),m=null)}}}function nh(e){this._internalRoot=e}el.prototype.render=nh.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=ui();qg(r,c,e,n,null,null)},el.prototype.unmount=nh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;qg(e.current,2,null,e,null,null),Bo(),n[vs]=null}};function el(e){this._internalRoot=e}el.prototype.unstable_scheduleHydration=function(e){if(e){var n=hd();e={blockedOn:null,target:e,priority:n};for(var r=0;r<In.length&&n!==0&&n<In[r].priority;r++);In.splice(r,0,e),r===0&&Jg(e)}};var np=t.version;if(np!=="19.2.4")throw Error(s(527,np,"19.2.4"));H.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var wv={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{Ta=il.inject(wv),ii=il}catch{}}return yr.createRoot=function(e,n){if(!a(e))throw Error(s(299));var r=!1,c="",m=um,p=hm,v=dm;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(m=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=Xg(e,1,!1,null,null,r,c,null,m,p,v,ip),e[vs]=n.current,ju(e),new nh(n)},yr.hydrateRoot=function(e,n,r){if(!a(e))throw Error(s(299));var c=!1,m="",p=um,v=hm,E=dm,N=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(m=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError),r.formState!==void 0&&(N=r.formState)),n=Xg(e,1,!0,n,r??null,c,m,N,p,v,E,ip),n.context=Yg(null),r=n.current,c=ui(),c=ql(c),m=Tn(c),m.callback=null,Cn(r,m,c),r=c,n.current.lanes=r,_a(n,r),Ii(n),e[vs]=n.current,ju(e),new el(n)},yr.version="19.2.4",yr}var gp;function Nv(){if(gp)return oh.exports;gp=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(t){console.error(t)}}return h(),oh.exports=Dv(),oh.exports}var Rv=Nv();function Lv(h,t){if(h.match(/^[a-z]+:\/\//i))return h;if(h.match(/^\/\//))return window.location.protocol+h;if(h.match(/^[a-z]+:/i))return h;const i=document.implementation.createHTMLDocument(),s=i.createElement("base"),a=i.createElement("a");return i.head.appendChild(s),i.body.appendChild(a),t&&(s.href=t),a.href=h,a.href}const Ov=(()=>{let h=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(h+=1,`u${t()}${h}`)})();function Vn(h){const t=[];for(let i=0,s=h.length;i<s;i++)t.push(h[i]);return t}let na=null;function sb(h={}){return na||(h.includeStyleProperties?(na=h.includeStyleProperties,na):(na=Vn(window.getComputedStyle(document.documentElement)),na))}function bl(h,t){const s=(h.ownerDocument.defaultView||window).getComputedStyle(h).getPropertyValue(t);return s?parseFloat(s.replace("px","")):0}function Bv(h){const t=bl(h,"border-left-width"),i=bl(h,"border-right-width");return h.clientWidth+t+i}function Fv(h){const t=bl(h,"border-top-width"),i=bl(h,"border-bottom-width");return h.clientHeight+t+i}function ab(h,t={}){const i=t.width||Bv(h),s=t.height||Fv(h);return{width:i,height:s}}function zv(){let h,t;try{t=process}catch{}const i=t&&t.env?t.env.devicePixelRatio:null;return i&&(h=parseInt(i,10),Number.isNaN(h)&&(h=1)),h||window.devicePixelRatio||1}const hi=16384;function jv(h){(h.width>hi||h.height>hi)&&(h.width>hi&&h.height>hi?h.width>h.height?(h.height*=hi/h.width,h.width=hi):(h.width*=hi/h.height,h.height=hi):h.width>hi?(h.height*=hi/h.width,h.width=hi):(h.width*=hi/h.height,h.height=hi))}function yl(h){return new Promise((t,i)=>{const s=new Image;s.onload=()=>{s.decode().then(()=>{requestAnimationFrame(()=>t(s))})},s.onerror=i,s.crossOrigin="anonymous",s.decoding="async",s.src=h})}async function Pv(h){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(h)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function Iv(h,t,i){const s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"svg"),o=document.createElementNS(s,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${i}`),a.setAttribute("viewBox",`0 0 ${t} ${i}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),a.appendChild(o),o.appendChild(h),Pv(a)}const ei=(h,t)=>{if(h instanceof t)return!0;const i=Object.getPrototypeOf(h);return i===null?!1:i.constructor.name===t.name||ei(i,t)};function Uv(h){const t=h.getPropertyValue("content");return`${h.cssText} content: '${t.replace(/'|"/g,"")}';`}function Hv(h,t){return sb(t).map(i=>{const s=h.getPropertyValue(i),a=h.getPropertyPriority(i);return`${i}: ${s}${a?" !important":""};`}).join(" ")}function Gv(h,t,i,s){const a=`.${h}:${t}`,o=i.cssText?Uv(i):Hv(i,s);return document.createTextNode(`${a}{${o}}`)}function pp(h,t,i,s){const a=window.getComputedStyle(h,i),o=a.getPropertyValue("content");if(o===""||o==="none")return;const l=Ov();try{t.className=`${t.className} ${l}`}catch{return}const u=document.createElement("style");u.appendChild(Gv(l,i,a,s)),t.appendChild(u)}function Vv(h,t,i){pp(h,t,":before",i),pp(h,t,":after",i)}const bp="application/font-woff",yp="image/jpeg",Xv={woff:bp,woff2:bp,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:yp,jpeg:yp,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function Yv(h){const t=/\.([^./]*?)$/g.exec(h);return t?t[1]:""}function Uh(h){const t=Yv(h).toLowerCase();return Xv[t]||""}function qv(h){return h.split(/,/)[1]}function Eh(h){return h.search(/^(data:)/)!==-1}function $v(h,t){return`data:${t};base64,${h}`}async function rb(h,t,i){const s=await fetch(h,t);if(s.status===404)throw new Error(`Resource "${s.url}" not found`);const a=await s.blob();return new Promise((o,l)=>{const u=new FileReader;u.onerror=l,u.onloadend=()=>{try{o(i({res:s,result:u.result}))}catch(d){l(d)}},u.readAsDataURL(a)})}const hh={};function Kv(h,t,i){let s=h.replace(/\?.*/,"");return i&&(s=h),/ttf|otf|eot|woff2?/i.test(s)&&(s=s.replace(/.*\//,"")),t?`[${t}]${s}`:s}async function Hh(h,t,i){const s=Kv(h,t,i.includeQueryParams);if(hh[s]!=null)return hh[s];i.cacheBust&&(h+=(/\?/.test(h)?"&":"?")+new Date().getTime());let a;try{const o=await rb(h,i.fetchRequestInit,({res:l,result:u})=>(t||(t=l.headers.get("Content-Type")||""),qv(u)));a=$v(o,t)}catch(o){a=i.imagePlaceholder||"";let l=`Failed to fetch resource: ${h}`;o&&(l=typeof o=="string"?o:o.message),l&&console.warn(l)}return hh[s]=a,a}async function Wv(h){const t=h.toDataURL();return t==="data:,"?h.cloneNode(!1):yl(t)}async function Qv(h,t){if(h.currentSrc){const o=document.createElement("canvas"),l=o.getContext("2d");o.width=h.clientWidth,o.height=h.clientHeight,l?.drawImage(h,0,0,o.width,o.height);const u=o.toDataURL();return yl(u)}const i=h.poster,s=Uh(i),a=await Hh(i,s,t);return yl(a)}async function Zv(h,t){var i;try{if(!((i=h?.contentDocument)===null||i===void 0)&&i.body)return await El(h.contentDocument.body,t,!0)}catch{}return h.cloneNode(!1)}async function Jv(h,t){return ei(h,HTMLCanvasElement)?Wv(h):ei(h,HTMLVideoElement)?Qv(h,t):ei(h,HTMLIFrameElement)?Zv(h,t):h.cloneNode(ob(h))}const tA=h=>h.tagName!=null&&h.tagName.toUpperCase()==="SLOT",ob=h=>h.tagName!=null&&h.tagName.toUpperCase()==="SVG";async function eA(h,t,i){var s,a;if(ob(t))return t;let o=[];return tA(h)&&h.assignedNodes?o=Vn(h.assignedNodes()):ei(h,HTMLIFrameElement)&&(!((s=h.contentDocument)===null||s===void 0)&&s.body)?o=Vn(h.contentDocument.body.childNodes):o=Vn(((a=h.shadowRoot)!==null&&a!==void 0?a:h).childNodes),o.length===0||ei(h,HTMLVideoElement)||await o.reduce((l,u)=>l.then(()=>El(u,i)).then(d=>{d&&t.appendChild(d)}),Promise.resolve()),t}function iA(h,t,i){const s=t.style;if(!s)return;const a=window.getComputedStyle(h);a.cssText?(s.cssText=a.cssText,s.transformOrigin=a.transformOrigin):sb(i).forEach(o=>{let l=a.getPropertyValue(o);o==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),ei(h,HTMLIFrameElement)&&o==="display"&&l==="inline"&&(l="block"),o==="d"&&t.getAttribute("d")&&(l=`path(${t.getAttribute("d")})`),s.setProperty(o,l,a.getPropertyPriority(o))})}function nA(h,t){ei(h,HTMLTextAreaElement)&&(t.innerHTML=h.value),ei(h,HTMLInputElement)&&t.setAttribute("value",h.value)}function sA(h,t){if(ei(h,HTMLSelectElement)){const s=Array.from(t.children).find(a=>h.value===a.getAttribute("value"));s&&s.setAttribute("selected","")}}function aA(h,t,i){return ei(t,Element)&&(iA(h,t,i),Vv(h,t,i),nA(h,t),sA(h,t)),t}async function rA(h,t){const i=h.querySelectorAll?h.querySelectorAll("use"):[];if(i.length===0)return h;const s={};for(let o=0;o<i.length;o++){const u=i[o].getAttribute("xlink:href");if(u){const d=h.querySelector(u),f=document.querySelector(u);!d&&f&&!s[u]&&(s[u]=await El(f,t,!0))}}const a=Object.values(s);if(a.length){const o="http://www.w3.org/1999/xhtml",l=document.createElementNS(o,"svg");l.setAttribute("xmlns",o),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const u=document.createElementNS(o,"defs");l.appendChild(u);for(let d=0;d<a.length;d++)u.appendChild(a[d]);h.appendChild(l)}return h}async function El(h,t,i){return!i&&t.filter&&!t.filter(h)?null:Promise.resolve(h).then(s=>Jv(s,t)).then(s=>eA(h,s,t)).then(s=>aA(h,s,t)).then(s=>rA(s,t))}const lb=/url\((['"]?)([^'"]+?)\1\)/g,oA=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,lA=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function cA(h){const t=h.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function uA(h){const t=[];return h.replace(lb,(i,s,a)=>(t.push(a),i)),t.filter(i=>!Eh(i))}async function hA(h,t,i,s,a){try{const o=i?Lv(t,i):t,l=Uh(t);let u;return a||(u=await Hh(o,l,s)),h.replace(cA(t),`$1${u}$3`)}catch{}return h}function dA(h,{preferredFontFormat:t}){return t?h.replace(lA,i=>{for(;;){const[s,,a]=oA.exec(i)||[];if(!a)return"";if(a===t)return`src: ${s};`}}):h}function cb(h){return h.search(lb)!==-1}async function ub(h,t,i){if(!cb(h))return h;const s=dA(h,i);return uA(s).reduce((o,l)=>o.then(u=>hA(u,l,t,i)),Promise.resolve(s))}async function sa(h,t,i){var s;const a=(s=t.style)===null||s===void 0?void 0:s.getPropertyValue(h);if(a){const o=await ub(a,null,i);return t.style.setProperty(h,o,t.style.getPropertyPriority(h)),!0}return!1}async function fA(h,t){await sa("background",h,t)||await sa("background-image",h,t),await sa("mask",h,t)||await sa("-webkit-mask",h,t)||await sa("mask-image",h,t)||await sa("-webkit-mask-image",h,t)}async function mA(h,t){const i=ei(h,HTMLImageElement);if(!(i&&!Eh(h.src))&&!(ei(h,SVGImageElement)&&!Eh(h.href.baseVal)))return;const s=i?h.src:h.href.baseVal,a=await Hh(s,Uh(s),t);await new Promise((o,l)=>{h.onload=o,h.onerror=t.onImageErrorHandler?(...d)=>{try{o(t.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const u=h;u.decode&&(u.decode=o),u.loading==="lazy"&&(u.loading="eager"),i?(h.srcset="",h.src=a):h.href.baseVal=a})}async function gA(h,t){const s=Vn(h.childNodes).map(a=>hb(a,t));await Promise.all(s).then(()=>h)}async function hb(h,t){ei(h,Element)&&(await fA(h,t),await mA(h,t),await gA(h,t))}function pA(h,t){const{style:i}=h;t.backgroundColor&&(i.backgroundColor=t.backgroundColor),t.width&&(i.width=`${t.width}px`),t.height&&(i.height=`${t.height}px`);const s=t.style;return s!=null&&Object.keys(s).forEach(a=>{i[a]=s[a]}),h}const vp={};async function Ap(h){let t=vp[h];if(t!=null)return t;const s=await(await fetch(h)).text();return t={url:h,cssText:s},vp[h]=t,t}async function wp(h,t){let i=h.cssText;const s=/url\(["']?([^"')]+)["']?\)/g,o=(i.match(/url\([^)]+\)/g)||[]).map(async l=>{let u=l.replace(s,"$1");return u.startsWith("https://")||(u=new URL(u,h.url).href),rb(u,t.fetchRequestInit,({result:d})=>(i=i.replace(l,`url(${d})`),[l,d]))});return Promise.all(o).then(()=>i)}function xp(h){if(h==null)return[];const t=[],i=/(\/\*[\s\S]*?\*\/)/gi;let s=h.replace(i,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(s);if(d===null)break;t.push(d[0])}s=s.replace(a,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(l,"gi");for(;;){let d=o.exec(s);if(d===null){if(d=u.exec(s),d===null)break;o.lastIndex=u.lastIndex}else u.lastIndex=o.lastIndex;t.push(d[0])}return t}async function bA(h,t){const i=[],s=[];return h.forEach(a=>{if("cssRules"in a)try{Vn(a.cssRules||[]).forEach((o,l)=>{if(o.type===CSSRule.IMPORT_RULE){let u=l+1;const d=o.href,f=Ap(d).then(g=>wp(g,t)).then(g=>xp(g).forEach(b=>{try{a.insertRule(b,b.startsWith("@import")?u+=1:a.cssRules.length)}catch(y){console.error("Error inserting rule from remote css",{rule:b,error:y})}})).catch(g=>{console.error("Error loading remote css",g.toString())});s.push(f)}})}catch(o){const l=h.find(u=>u.href==null)||document.styleSheets[0];a.href!=null&&s.push(Ap(a.href).then(u=>wp(u,t)).then(u=>xp(u).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",o)}}),Promise.all(s).then(()=>(h.forEach(a=>{if("cssRules"in a)try{Vn(a.cssRules||[]).forEach(o=>{i.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${a.href}`,o)}}),i))}function yA(h){return h.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>cb(t.style.getPropertyValue("src")))}async function vA(h,t){if(h.ownerDocument==null)throw new Error("Provided element is not within a Document");const i=Vn(h.ownerDocument.styleSheets),s=await bA(i,t);return yA(s)}function db(h){return h.trim().replace(/["']/g,"")}function AA(h){const t=new Set;function i(s){(s.style.fontFamily||getComputedStyle(s).fontFamily).split(",").forEach(o=>{t.add(db(o))}),Array.from(s.children).forEach(o=>{o instanceof HTMLElement&&i(o)})}return i(h),t}async function wA(h,t){const i=await vA(h,t),s=AA(h);return(await Promise.all(i.filter(o=>s.has(db(o.style.fontFamily))).map(o=>{const l=o.parentStyleSheet?o.parentStyleSheet.href:null;return ub(o.cssText,l,t)}))).join(`
`)}async function xA(h,t){const i=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await wA(h,t);if(i){const s=document.createElement("style"),a=document.createTextNode(i);s.appendChild(a),h.firstChild?h.insertBefore(s,h.firstChild):h.appendChild(s)}}async function SA(h,t={}){const{width:i,height:s}=ab(h,t),a=await El(h,t,!0);return await xA(a,t),await hb(a,t),pA(a,t),await Iv(a,i,s)}async function EA(h,t={}){const{width:i,height:s}=ab(h,t),a=await SA(h,t),o=await yl(a),l=document.createElement("canvas"),u=l.getContext("2d"),d=t.pixelRatio||zv(),f=t.canvasWidth||i,g=t.canvasHeight||s;return l.width=f*d,l.height=g*d,t.skipAutoScale||jv(l),l.style.width=`${f}`,l.style.height=`${g}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,l.width,l.height)),u.drawImage(o,0,0,l.width,l.height),l}async function aa(h,t={}){return(await EA(h,t)).toDataURL()}const vr=({icon:h,label:t,onClick:i,isImage:s=!1})=>T.jsxs("button",{onClick:i,className:"group flex flex-col items-center gap-3 w-full",children:[T.jsx("div",{className:"flex items-center justify-center w-full aspect-square bg-white rounded-xl shadow-sm group-hover:shadow-md transition-all duration-200 border border-transparent group-hover:border-gray-200 p-3 md:p-6",children:T.jsx("div",{className:"h-10 w-10 md:h-16 md:w-16 flex items-center justify-center",children:s?T.jsx("img",{src:h,alt:t,className:"max-h-full max-w-full object-contain"}):T.jsx("img",{src:h,alt:t,className:"max-h-full max-w-full object-contain"})})}),T.jsx("span",{className:"text-[10px] md:text-xs font-bold tracking-wider text-gray-900 uppercase text-center group-hover:text-black leading-tight",children:t})]}),dh={en:{"tab.front":"FRONT","tab.back":"BACK","product.heading":"RAMBLER 16 OZ TRAVEL BOTTLE","product.colorLabel":"PRODUCT COLOR:","product.colorLabelShort":"COLOR:","color.black":"BLACK","color.white":"WHITE","color.blue":"BLUE","color.red":"RED","color.selectAria":"Select {color} color","color.update":"UPDATE","main.heading":"CUSTOMIZE IT YOUR WAY","main.uploadOwn":"UPLOAD YOUR OWN IMAGE","main.text":"TEXT","main.monogram":"MONOGRAM","main.valentines":"VALENTINES DESIGNS","main.gallery":"GALLERY","bottomBar.remove":"REMOVE","bottomBar.review":"REVIEW","bottomBar.preparing":"PREPARING...","text.back":"BACK","text.placeholder":"TYPE TEXT HERE","text.orientationLabel":"Orientation:","text.vertical":"Vertical","text.horizontal":"Horizontal","text.verticalAria":"Vertical Text","text.horizontalAria":"Horizontal Text","monogram.back":"BACK","monogram.placeholderSingle":"ONE LETTER ONLY","monogram.placeholderMinTwo":"AT LEAST 2 LETTERS","monogram.placeholderDefault":"ENTER YOUR INITIALS","monogram.warnSingleLetter":"ONLY FIRST LETTER WILL BE SHOWN","monogram.warnMinTwo":"PLEASE ENTER AT LEAST 2 LETTERS","monogram.noteLabel":"Note:","monogram.noteText":"Monograms with three initials display the last name initial in the center.","gallery.back":"BACK","gallery.backToCategories":"BACK TO CATEGORIES","gallery.selectedLabel":"SELECTED: {name}","gallery.cat.nature":"NATURE","gallery.cat.animals":"ANIMALS","gallery.cat.symbols":"SYMBOLS","gallery.cat.celebration":"CELEBRATION","gallery.cat.family":"FAMILY","gallery.cat.fan_favorites":"FAN FAVORITES","gallery.cat.valentines":"VALENTINES","gallery.cat.zodiac":"ZODIAC","upload.back":"{side}","upload.uploadFailed":"Upload Failed","upload.errorPdf":"Failed to render PDF preview. File may be corrupted or password protected.","upload.errorAspectRatio":"Image aspect ratio ({ratio}) is outside the allowed range. Please use an image closer to square (between 2:3 and 3:2).","upload.errorLoadImage":"Failed to load image. Please check the file.","upload.errorProcessing":"Error processing file.","upload.processing":"Processing...","upload.uploadDesign":"UPLOAD DESIGN","upload.acceptedTypes":"Accepted file types: PNG, JPG, SVG and PDF","upload.iconImageSize":`Image must be 300 px
(W or H)`,"upload.iconNoTrademark":"No trademark infringement","upload.iconNoCopyright":"No copyright infringement","upload.iconNoPhotos":"No photos","upload.instructionsHeading":"INSTRUCTIONS","upload.instruction1":"Orders containing offensive, inappropriate, or copyrighted content may be cancelled without further notice.","upload.instruction2":"Please verify your preview carefully: check for any unwanted lines or spots and crop them out.","upload.instruction3":"For best results, commence with a sketch on white paper using a thick dark marker. Keep it simple and take a photo in a well-lit area without shadows.","upload.instruction4":"Photographs will be converted to black and white, and results may vary. Proceed with high-contrast images for optimal engraving quality.","upload.sizeLabel":"SIZE","upload.removeImage":"Remove Image","upload.placementHint":"Review your placement on the bottle preview to the left.","upload.previewAlt":"Preview","review.addingToCart":"Adding to cart...","review.logoAlt":"Logo","review.frontPreviewAlt":"Front Preview","review.backPreviewAlt":"Back Preview","review.closeAria":"Close Review","review.heading":"Review Your Design","review.deliveryNotice":"Please allow 7 business days for personalization and 2-3 days for delivery. Delivery dates cannot be guaranteed. ALL PURCHASES ARE FINAL.","review.noPreview":"No Preview Available","review.editFront":"Edit Front","review.editBack":"Edit Back","review.footerNotice":"Please review your spelling and design. Custom products cannot be returned.","review.backButton":"Back","review.addToCart":"Add to Cart","review.adding":"Adding...","review.errorDefault":"Failed to add to cart. Please try again.","confirm.heading":"Confirm This","confirm.body1":"The submitted image and/or text is not unlawful, harmful, threatening, tortious, defamatory, vulgar, obscene, libelous, invasive of another's privacy, hateful, or racially, ethnically, or otherwise objectionable, does not infringe upon any patent, trademark, copyright, trade secret, or other proprietary rights of any third party (this includes but is not limited to sports teams and licensed university logos or slogans), and does not otherwise violate any of the rights or other categories listed in our FAQs. All personalized orders are subject to review. If any of the above conditions are violated, the entire order will be canceled.","confirm.body2":"Once you submit your order, you cannot edit or modify it. Any changes to the imprint of your order must be made before the order ships.","confirm.body3":"Personalized items are non-refundable and cannot be canceled after you place your order. All sales of personalized products are final.","confirm.body4":"We do not offer personalization of our stainless steel drinkware or Yonder bottles.","confirm.body5":"If you need assistance ordering custom drinkware, for example, if you want to place an order for products with a trademarked or copyrighted image for which you have permission, or if you have any questions, please contact our Outfitter team before placing your order.","confirm.body6":"For company logos, please visit our Corporate Sales page for information and quotes.","confirm.agreeLabel":"I agree to these terms and conditions","confirm.cancel":"Cancel","confirm.accept":"Accept","uploadConfirm.heading":"In order to proceed, please review and accept the following:","uploadConfirm.body1":'Befit Coolers, LLC ("Befit", "Our") provides our customizer services to you through our website(s) located at Befit.com (the "Site") and related technologies (the "Service"). As a condition to the access and use of the Service you agree to the terms and conditions below:',"uploadConfirm.repWarrantiesHeading":"Representation and Warranties","uploadConfirm.repWarrantiesBody":`You represent and warrant that you: a) are of legal age to enter and agree to these terms and conditions; b) if you are using the Services on behalf of a company or other organization, then you are entering into this agreement on behalf of yourself and such organization, and you represent that you have the legal authority to bind such organization to these terms of service; c) you are solely responsible for, images, information, photographs, graphics, messages, and other materials ("content") that you make available to Befit by uploading, posting, publishing, or displaying via the Service (collectively, "User Content"); d) you own all right, title and interest in and to such User Content; e) the User Content is not unlawful, harmful, threatening, tortious, defamatory, vulgar, obscene, libelous, invasive of another's privacy, hateful, or racially, ethnically or otherwise objectionable, is not connected to any political affiliations, associations or candidates, does not infringe on any patent, trademark, copyright, trade secret, or other proprietary rights of any third party (this includes, but is not limited to, sport teams and collegiate licensed logos or phrases), and does not otherwise violate anyone's rights or other categories listed in our FAQ.`,"uploadConfirm.liabilityHeading":"Limitation of Liability","uploadConfirm.liabilityBody":"You expressly understand and agree that Befit will not be liable for any indirect, incidental, special, consequential, exemplary damages, or damages for loss of profits including damages for loss of goodwill, use, or other intangible losses (even if Befit has been advised of the possibility of such damages), whether based on contract, tort, negligence, strict liability, or otherwise, resulting from: (a) the products or the use or the inability to use the service; or (b) the user content. Some jurisdictions do not allow the limitation or exclusion of liability for incidental or consequential damages, so some of the above may not apply to you. In such jurisdictions, liability is limited to the fullest extent permitted by law.","uploadConfirm.indemnificationHeading":"Indemnification","uploadConfirm.indemnificationBody":`You agree to defend, indemnify, and hold harmless Befit, its affiliates, and its and their respective officers, employees, directors, service providers, licensors, and agents (collectively, the "Befit Parties") from any and all losses, damages, expenses, including reasonable attorneys' fees, rights, claims, actions of any kind, and injury arising out of or relating to your use of the Service, any User Content, your connection to the Service, your violation of these this agreement, or your violation of any rights of another.`,"uploadConfirm.agreeLabel":"I agree to these terms and conditions","uploadConfirm.cancel":"Cancel","uploadConfirm.submit":"Submit","miniNav.upload":"UPLOAD","miniNav.text":"TEXT","miniNav.monogram":"MONOGRAM","miniNav.gallery":"GALLERY","bottlePreview.alt":"Yeti Bottle {side}","bottlePreview.uploadedImageAlt":"Uploaded image","loader.preparingDesign":"Preparing your design..."},nl:{"tab.front":"VOORKANT","tab.back":"ACHTERKANT","product.heading":"RAMBLER 16 OZ REISFLES","product.colorLabel":"PRODUCTKLEUR:","product.colorLabelShort":"KLEUR:","color.black":"ZWART","color.white":"WIT","color.blue":"BLAUW","color.red":"ROOD","color.selectAria":"Selecteer kleur {color}","color.update":"BIJWERKEN","main.heading":"PERSONALISEER OP JOUW MANIER","main.uploadOwn":"UPLOAD JE EIGEN AFBEELDING","main.text":"TEKST","main.monogram":"MONOGRAM","main.valentines":"VALENTIJNSONTWERPEN","main.gallery":"GALERIJ","bottomBar.remove":"VERWIJDEREN","bottomBar.review":"BEKIJKEN","bottomBar.preparing":"VOORBEREIDEN...","text.back":"TERUG","text.placeholder":"TYP HIER TEKST","text.orientationLabel":"Orintatie:","text.vertical":"Verticaal","text.horizontal":"Horizontaal","text.verticalAria":"Verticale tekst","text.horizontalAria":"Horizontale tekst","monogram.back":"TERUG","monogram.placeholderSingle":"SLECHTS N LETTER","monogram.placeholderMinTwo":"MINIMAAL 2 LETTERS","monogram.placeholderDefault":"VOER JE INITIALEN IN","monogram.warnSingleLetter":"ALLEEN DE EERSTE LETTER WORDT GETOOND","monogram.warnMinTwo":"VOER MINIMAAL 2 LETTERS IN","monogram.noteLabel":"Opmerking:","monogram.noteText":"Monogrammen met drie initialen tonen de achternaam-initiaal in het midden.","gallery.back":"TERUG","gallery.backToCategories":"TERUG NAAR CATEGORIEN","gallery.selectedLabel":"GESELECTEERD: {name}","gallery.cat.nature":"NATUUR","gallery.cat.animals":"DIEREN","gallery.cat.symbols":"SYMBOLEN","gallery.cat.celebration":"FEEST","gallery.cat.family":"FAMILIE","gallery.cat.fan_favorites":"FAVORIETEN","gallery.cat.valentines":"VALENTIJN","gallery.cat.zodiac":"STERRENBEELD","upload.back":"{side}","upload.uploadFailed":"Upload mislukt","upload.errorPdf":"Kan PDF-voorbeeld niet weergeven. Het bestand is mogelijk beschadigd of beveiligd met een wachtwoord.","upload.errorAspectRatio":"De beeldverhouding ({ratio}) valt buiten het toegestane bereik. Gebruik een afbeelding die dichter bij vierkant is (tussen 2:3 en 3:2).","upload.errorLoadImage":"Kan afbeelding niet laden. Controleer het bestand.","upload.errorProcessing":"Fout bij het verwerken van het bestand.","upload.processing":"Verwerken...","upload.uploadDesign":"ONTWERP UPLOADEN","upload.acceptedTypes":"Toegestane bestandstypen: PNG, JPG, SVG en PDF","upload.iconImageSize":`Afbeelding moet
300 px zijn (B of H)`,"upload.iconNoTrademark":"Geen inbreuk op handelsmerken","upload.iconNoCopyright":"Geen inbreuk op auteursrechten","upload.iconNoPhotos":"Geen foto's","upload.instructionsHeading":"INSTRUCTIES","upload.instruction1":"Bestellingen met aanstootgevende, ongepaste of auteursrechtelijk beschermde inhoud kunnen zonder verdere kennisgeving worden geannuleerd.","upload.instruction2":"Controleer je voorbeeld zorgvuldig: kijk of er ongewenste lijnen of vlekken zijn en snijd deze bij.","upload.instruction3":"Voor het beste resultaat begin je met een schets op wit papier met een dikke donkere stift. Houd het simpel en maak een foto in een goed verlichte ruimte zonder schaduwen.","upload.instruction4":"Foto's worden omgezet naar zwart-wit en het resultaat kan variren. Gebruik afbeeldingen met hoog contrast voor optimale graveerkwaliteit.","upload.sizeLabel":"GROOTTE","upload.removeImage":"Afbeelding verwijderen","upload.placementHint":"Bekijk de plaatsing op het flesvoorbeeld aan de linkerkant.","upload.previewAlt":"Voorbeeld","review.addingToCart":"Wordt toegevoegd aan winkelwagen...","review.logoAlt":"Logo","review.frontPreviewAlt":"Voorbeeld voorkant","review.backPreviewAlt":"Voorbeeld achterkant","review.closeAria":"Beoordeling sluiten","review.heading":"Controleer je ontwerp","review.deliveryNotice":"Reken op 7 werkdagen voor personalisatie en 2-3 dagen voor levering. Leverdata kunnen niet worden gegarandeerd. ALLE AANKOPEN ZIJN DEFINITIEF.","review.noPreview":"Geen voorbeeld beschikbaar","review.editFront":"Voorkant bewerken","review.editBack":"Achterkant bewerken","review.footerNotice":"Controleer je spelling en ontwerp. Gepersonaliseerde producten kunnen niet worden geretourneerd.","review.backButton":"Terug","review.addToCart":"In winkelwagen","review.adding":"Toevoegen...","review.errorDefault":"Kon niet aan winkelwagen toevoegen. Probeer het opnieuw.","confirm.heading":"Bevestig dit","confirm.body1":"De ingediende afbeelding en/of tekst is niet onwettig, schadelijk, bedreigend, onrechtmatig, lasterlijk, vulgair, obsceen, smadelijk, een inbreuk op de privacy van een ander, haatdragend, of racistisch, etnisch of anderszins aanstootgevend, maakt geen inbreuk op enig octrooi, handelsmerk, auteursrecht, bedrijfsgeheim of ander eigendomsrecht van een derde partij (dit omvat maar is niet beperkt tot sportteams en gelicentieerde universiteitslogo's of slogans), en schendt niet anderszins enig recht of andere categorien vermeld in onze FAQ. Alle gepersonaliseerde bestellingen worden beoordeeld. Als een van de bovenstaande voorwaarden wordt geschonden, wordt de volledige bestelling geannuleerd.","confirm.body2":"Nadat je je bestelling hebt ingediend, kun je deze niet meer bewerken of wijzigen. Eventuele wijzigingen aan de opdruk van je bestelling moeten worden aangebracht voordat de bestelling wordt verzonden.","confirm.body3":"Gepersonaliseerde artikelen zijn niet-restitueerbaar en kunnen niet worden geannuleerd nadat je je bestelling hebt geplaatst. Alle verkopen van gepersonaliseerde producten zijn definitief.","confirm.body4":"Wij bieden geen personalisatie aan van onze roestvrijstalen drinkwaren of Yonder-flessen.","confirm.body5":"Als je hulp nodig hebt bij het bestellen van gepersonaliseerde drinkwaren, bijvoorbeeld als je een bestelling wilt plaatsen voor producten met een geregistreerd handelsmerk of auteursrechtelijk beschermde afbeelding waarvoor je toestemming hebt, of als je vragen hebt, neem dan contact op met ons Outfitter-team voordat je je bestelling plaatst.","confirm.body6":"Voor bedrijfslogo's kun je onze pagina Zakelijke Verkoop bezoeken voor informatie en offertes.","confirm.agreeLabel":"Ik ga akkoord met deze voorwaarden","confirm.cancel":"Annuleren","confirm.accept":"Accepteren","uploadConfirm.heading":"Om verder te gaan, lees en accepteer het volgende:","uploadConfirm.body1":'Befit Coolers, LLC ("Befit", "Ons") biedt onze configuratiediensten aan via onze website(s) op Befit.com (de "Site") en gerelateerde technologien (de "Dienst"). Als voorwaarde voor toegang tot en gebruik van de Dienst ga je akkoord met de onderstaande voorwaarden:',"uploadConfirm.repWarrantiesHeading":"Verklaringen en garanties","uploadConfirm.repWarrantiesBody":`Je verklaart en garandeert dat je: a) de wettelijke leeftijd hebt om deze voorwaarden te aanvaarden; b) als je de Diensten namens een bedrijf of andere organisatie gebruikt, je deze overeenkomst aangaat namens jezelf en die organisatie, en je verklaart dat je de wettelijke bevoegdheid hebt om die organisatie aan deze servicevoorwaarden te binden; c) je bent als enige verantwoordelijk voor afbeeldingen, informatie, foto's, grafische elementen, berichten en andere materialen ("inhoud") die je beschikbaar stelt aan Befit door te uploaden, posten, publiceren of weer te geven via de Dienst (gezamenlijk "Gebruikersinhoud"); d) je bezit alle rechten, titels en belangen in en op dergelijke Gebruikersinhoud; e) de Gebruikersinhoud is niet onwettig, schadelijk, bedreigend, onrechtmatig, lasterlijk, vulgair, obsceen, smadelijk, een inbreuk op de privacy van een ander, haatdragend, of racistisch, etnisch of anderszins aanstootgevend, is niet verbonden met politieke affiliaties, verenigingen of kandidaten, maakt geen inbreuk op enig octrooi, handelsmerk, auteursrecht, bedrijfsgeheim of ander eigendomsrecht van een derde partij (dit omvat maar is niet beperkt tot sportteams en universitair gelicentieerde logo's of uitdrukkingen), en schendt niet anderszins de rechten van anderen of andere categorien vermeld in onze FAQ.`,"uploadConfirm.liabilityHeading":"Beperking van aansprakelijkheid","uploadConfirm.liabilityBody":"Je begrijpt en gaat er uitdrukkelijk mee akkoord dat Befit niet aansprakelijk is voor indirecte, incidentele, speciale, gevolgschade, exemplarische schade of schade door winstderving, inclusief schade door verlies van goodwill, gebruik of andere immaterile verliezen (zelfs als Befit op de hoogte is gesteld van de mogelijkheid van dergelijke schade), ongeacht of deze is gebaseerd op contract, onrechtmatige daad, nalatigheid, strikte aansprakelijkheid of anderszins, voortvloeiend uit: (a) de producten of het gebruik of het onvermogen om de dienst te gebruiken; of (b) de gebruikersinhoud. Sommige rechtsgebieden staan de beperking of uitsluiting van aansprakelijkheid voor incidentele schade of gevolgschade niet toe, dus sommige van het bovenstaande is mogelijk niet op jou van toepassing. In dergelijke rechtsgebieden is de aansprakelijkheid beperkt tot het maximaal wettelijk toegestane.","uploadConfirm.indemnificationHeading":"Vrijwaring","uploadConfirm.indemnificationBody":'Je gaat ermee akkoord Befit, haar gelieerde ondernemingen en hun respectievelijke functionarissen, werknemers, directeuren, dienstverleners, licentiegevers en agenten (gezamenlijk de "Befit-partijen") te verdedigen, schadeloos te stellen en te vrijwaren tegen alle verliezen, schade, kosten, inclusief redelijke advocaatkosten, rechten, claims, acties van welke aard dan ook, en letsel voortvloeiend uit of verband houdend met jouw gebruik van de Dienst, enige Gebruikersinhoud, jouw verbinding met de Dienst, jouw schending van deze overeenkomst, of jouw schending van enig recht van een ander.',"uploadConfirm.agreeLabel":"Ik ga akkoord met deze voorwaarden","uploadConfirm.cancel":"Annuleren","uploadConfirm.submit":"Verzenden","miniNav.upload":"UPLOADEN","miniNav.text":"TEKST","miniNav.monogram":"MONOGRAM","miniNav.gallery":"GALERIJ","bottlePreview.alt":"Yeti Fles {side}","bottlePreview.uploadedImageAlt":"Geploade afbeelding","loader.preparingDesign":"Je ontwerp wordt voorbereid..."}},TA=()=>typeof window<"u"&&window.BOTTLE_CUSTOMIZER_LOCALE?window.BOTTLE_CUSTOMIZER_LOCALE:"nl";let Sp=TA();const Z=(h,t)=>{let s=(dh[Sp]||dh.en||{})[h];return s===void 0&&Sp!=="en"&&(s=(dh.en||{})[h]),s===void 0?h:(t&&Object.entries(t).forEach(([a,o])=>{s=s.replace(new RegExp(`\\{${a}\\}`,"g"),o)}),s)},CA=({setView:h,activeTab:t,openGallery:i,openGalleryCategory:s})=>T.jsxs("div",{className:"w-full max-w-2xl mt-4 md:mt-12",children:[T.jsx("h3",{className:"text-center text-xs md:text-sm font-bold text-gray-700 tracking-wider mb-6 md:mb-12 uppercase",children:Z("main.heading")}),T.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6",children:[t==="BACK"&&T.jsx(vr,{icon:"UI/icons/upload.svg",label:Z("main.uploadOwn"),onClick:()=>h("upload")}),T.jsx(vr,{icon:"UI/icons/text.png",label:Z("main.text"),isImage:!0,onClick:()=>h("text")}),t==="BACK"&&T.jsxs(T.Fragment,{children:[T.jsx(vr,{icon:"UI/icons/monogram.svg",label:Z("main.monogram"),onClick:()=>h("monogram")}),T.jsx(vr,{icon:"gallery/Valentine's Day/heart-hooks.svg",label:Z("main.valentines"),onClick:()=>s("valentines")}),T.jsx(vr,{icon:"UI/icons/gallery.svg",label:Z("main.gallery"),onClick:i})]})]})]}),Tl=({setView:h,activeView:t,activeTab:i})=>{const s=[{id:"upload",label:Z("miniNav.upload"),icon:"UI/icons/upload.svg"},{id:"text",label:Z("miniNav.text"),icon:"UI/icons/text.png"},{id:"monogram",label:Z("miniNav.monogram"),icon:"UI/icons/monogram.svg"},{id:"gallery",label:Z("miniNav.gallery"),icon:"UI/icons/gallery.svg"}],a=i==="FRONT"?s.filter(o=>o.id==="text"):s;return T.jsx("div",{className:"hidden md:flex items-start justify-center space-x-6 mb-8 transform -translate-x-2",children:a.map(o=>{const l=t===o.id;return T.jsxs("button",{onClick:l?void 0:()=>h(o.id),className:`group flex flex-col items-center gap-2 ${l?"cursor-default":""}`,children:[T.jsx("div",{className:`w-16 h-16 rounded-xl flex items-center justify-center transition-colors
                                ${l?"bg-white shadow-md border-2 border-brand-blue":"bg-white shadow-sm group-hover:bg-gray-50"}
                            `,children:T.jsx("img",{src:o.icon,className:"w-8 h-8 object-contain",alt:o.label})}),T.jsx("span",{className:"text-[10px] font-bold text-gray-900 uppercase tracking-wider",children:o.label})]},o.id)})})},_A=({setView:h,textInput:t,setTextInput:i,fonts:s,selectedFont:a,setSelectedFont:o,activeTab:l,isVertical:u,setIsVertical:d})=>T.jsxs("div",{className:"flex flex-col h-full w-full max-w-2xl",children:[T.jsx(Tl,{setView:h,activeView:"text",activeTab:l}),T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-black font-bold text-xs md:text-sm tracking-widest uppercase mb-2 md:mb-6 hover:text-gray-600 transition-colors",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),Z("text.back")]}),T.jsxs("div",{className:"bg-white rounded-lg shadow-sm  mb-3 border border-gray-200 flex items-center flex-shrink-0",children:[T.jsx("textarea",{value:t,onChange:y=>{let x=String(y.target.value||"").replace(/\r\n/g,`
`).split(`
`).map(w=>w.slice(0,20));l==="FRONT"&&(x=x.slice(0,4)),i(x.join(`
`))},placeholder:Z("text.placeholder"),maxLength:l==="FRONT"?83:150,rows:1,wrap:"off",className:"flex-1 w-full px-2 md:px-4 py-2 text-center text-sm md:text-base text-gray-700 placeholder-gray-300 focus:outline-none resize-none min-h-[44px] md:min-h-[48px]",onFocus:()=>{setTimeout(()=>{const y=document.getElementById("mobile-color-trigger");y&&window.innerWidth<768&&y.scrollIntoView({behavior:"smooth",block:"start"})},350)},style:s.find(y=>y.name===a)?.style}),T.jsx("div",{className:"text-green-500 px-2 pt-2",children:t&&T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),l==="BACK"&&T.jsxs("div",{className:"mb-6 flex flex-col items-start w-full px-1",children:[T.jsxs("span",{className:"text-sm font-bold text-gray-800 mb-2",children:[Z("text.orientationLabel")," ",T.jsx("span",{className:"font-normal",children:Z(u?"text.vertical":"text.horizontal")})]}),T.jsxs("div",{className:"flex space-x-3",children:[T.jsx("button",{onClick:()=>d(!0),className:`w-12 h-12 rounded flex items-center justify-center transition-all bg-white
                                ${u?"border-2 border-black shadow-sm":"border border-gray-300 hover:border-gray-400"}
                            `,"aria-label":Z("text.verticalAria"),children:T.jsx("span",{className:"text-xs font-medium text-gray-800 transform rotate-90 leading-none",children:"Aaa"})}),T.jsx("button",{onClick:()=>d(!1),className:`w-12 h-12 rounded flex items-center justify-center transition-all bg-white
                                ${u?"border border-gray-300 hover:border-gray-400":"border-2 border-black shadow-sm"}
                            `,"aria-label":Z("text.horizontalAria"),children:T.jsx("span",{className:"text-xs font-medium text-gray-800 leading-none",children:"Aaa"})})]})]}),T.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:T.jsx("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:s.map(y=>T.jsx("button",{onClick:()=>o(y.name),className:`p-3 md:p-2 bg-white rounded-lg border transition-all duration-200 flex items-center justify-center h-14 md:h-12 shadow-md
                                ${a===y.name?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-transparent hover:shadow-lg hover:border-brand-blue text-gray-400 hover:text-brand-blue"}
                            `,children:T.jsx("span",{className:`text-xs md:text-sm ${a===y.name?"text-brand-blue":""}`,style:y.style,children:y.name})},y.name))})}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]}),MA=({setView:h,monogramInput:t,setMonogramInput:i,monogramStyles:s,selectedMonogram:a,setSelectedMonogram:o,activeTab:l})=>T.jsxs("div",{className:"flex flex-col h-full w-full max-w-2xl",children:[T.jsx(Tl,{setView:h,activeView:"monogram",activeTab:l}),T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-black font-bold text-xs md:text-sm tracking-widest uppercase mb-2 md:mb-6 hover:text-gray-600 transition-colors",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),Z("monogram.back")]}),T.jsxs("div",{className:"bg-white rounded-lg shadow-sm  mb-3 border border-gray-200 flex items-center flex-shrink-0",children:[T.jsx("input",{type:"text",value:t,onChange:u=>i(u.target.value.toUpperCase()),placeholder:s.find(u=>u.name===a)?.maxLength===1?Z("monogram.placeholderSingle"):s.find(u=>u.name===a)?.useCircleGlyphs||s.find(u=>u.name===a)?.useNGramGlyphs?Z("monogram.placeholderMinTwo"):Z("monogram.placeholderDefault"),maxLength:s.find(u=>u.name===a)?.maxLength||3,onFocus:()=>{setTimeout(()=>{const u=document.getElementById("mobile-color-trigger");u&&window.innerWidth<768&&u.scrollIntoView({behavior:"smooth",block:"start"})},350)},className:"flex-1 w-full px-2 md:px-4 py-2 text-center text-sm md:text-base text-gray-700 font-bold placeholder-gray-300 focus:outline-none uppercase"}),T.jsx("div",{className:"text-green-500 px-2",children:t&&T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),s.find(u=>u.name===a)?.maxLength===1&&t.length>1&&T.jsx("div",{className:"text-red-500 text-xs font-bold text-center mt-2 mb-2 flex-shrink-0",children:Z("monogram.warnSingleLetter")}),(s.find(u=>u.name===a)?.useCircleGlyphs||s.find(u=>u.name===a)?.useNGramGlyphs)&&t.length===1&&T.jsx("div",{className:"text-red-500 text-xs font-bold text-center mt-2 mb-2 flex-shrink-0",children:Z("monogram.warnMinTwo")}),T.jsxs("div",{className:"bg-gray-100 rounded p-2 md:p-3 mb-4 md:mb-6 text-[10px] md:text-xs text-gray-600 flex-shrink-0",children:[T.jsx("span",{className:"font-bold",children:Z("monogram.noteLabel")})," ",Z("monogram.noteText")]}),T.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:T.jsx("div",{className:"grid grid-cols-3 gap-3 md:gap-4",children:s.map(u=>{const d=u.useCircleGlyphs,f=u.useNGramGlyphs,g=u.maxLength===1;let b="RJM",y=u.style?.fontFamily;return d?(b="rJ#",y="Three Character Circle"):f?(b="?rJ#",y="Three Character N-Gram"):g&&(b="J"),T.jsx("button",{onClick:()=>o(u.name),className:`p-4 md:p-3 bg-white rounded-lg border transition-all duration-200 flex items-center justify-center h-24 md:h-18 shadow-md
                                    ${a===u.name?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-transparent hover:shadow-lg hover:border-brand-blue text-gray-400 hover:text-brand-blue"}
                                `,children:T.jsx("span",{className:`text-4xl md:text-2xl lg:text-3xl ${a===u.name?"text-brand-blue":""}`,style:{...(({fontSize:A,...x})=>x)(u.style),fontFamily:y},children:b})},u.name)})})}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]}),Ep=[{id:"nature",name:"NATURE",icon:"Tree"},{id:"animals",name:"ANIMALS",icon:"Bear"},{id:"symbols",name:"SYMBOLS",icon:"Star"},{id:"celebration",name:"CELEBRATION",icon:"Celebration"},{id:"family",name:"FAMILY",icon:"Family"},{id:"fan_favorites",name:"FAN FAVORITES",icon:"Star"},{id:"valentines",name:"VALENTINES",icon:"Heart Hooks"},{id:"zodiac",name:"ZODIAC",icon:"Zodiac"}],fh={nature:[{id:"cat_nature",name:"Cat",src:"gallery/nature/Cat.svg"},{id:"forest",name:"Forest",src:"gallery/nature/forest-svgrepo-com.svg"},{id:"grass",name:"Grass Patch",src:"gallery/nature/grass-patch-svgrepo-com.svg"},{id:"moon",name:"Misty Moon",src:"gallery/nature/misty-moon-svgrepo-com.svg"},{id:"mountains",name:"Mountains",src:"gallery/nature/mountains-svgrepo-com.svg"},{id:"woods-badge",name:"Woods Badge",src:"gallery/nature/nature-badge-woods-svgrepo-com.svg"},{id:"rainbow",name:"Rainbow",src:"gallery/nature/nature-rainbow-svgrepo-com.svg"},{id:"nature",name:"Nature",src:"gallery/nature/nature-svgrepo-com.svg"},{id:"bird",name:"Bird",src:"gallery/nature/Bird.svg"},{id:"butterfly",name:"Butterfly",src:"gallery/nature/Butterfly.svg"},{id:"charity_water",name:"Charity Water",src:"gallery/nature/CharityWater.svg"},{id:"comet",name:"Comet",src:"gallery/nature/Comet.svg"},{id:"mountains_2",name:"Mountains II",src:"gallery/nature/Mountains.svg"},{id:"paw",name:"Paw",src:"gallery/nature/paw.svg"}],animals:[{id:"pawprint",name:"Pawprint",src:"gallery/animals/canine-pawprint-svgrepo-com.svg"},{id:"chicken",name:"Chicken",src:"gallery/animals/chicken-svgrepo-com.svg"},{id:"grasshopper",name:"Grasshopper",src:"gallery/animals/grasshopper-sitting-svgrepo-com.svg"},{id:"pig",name:"Pig",src:"gallery/animals/pig-with-round-tail-svgrepo-com.svg"},{id:"cobra",name:"Cobra",src:"gallery/animals/poisonous-cobra-svgrepo-com.svg"},{id:"spider",name:"Spider",src:"gallery/animals/poisonous-spider-svgrepo-com.svg"},{id:"anteater",name:"Anteater",src:"gallery/animals/sitting-anteater-svgrepo-com.svg"},{id:"cat",name:"Cat",src:"gallery/animals/sitting-cat-svgrepo-com.svg"},{id:"rabbit",name:"Rabbit",src:"gallery/animals/sitting-rabbit-svgrepo-com.svg"},{id:"armadillo",name:"Armadillo",src:"gallery/animals/armadillo.svg"},{id:"al_pet_lovers_bird",name:"Pet Lovers Bird",src:"gallery/animals/al-pet-lovers-bird.svg"},{id:"best_bud",name:"Best Bud",src:"gallery/animals/best-bud.svg"},{id:"black_lab",name:"Black Lab",src:"gallery/animals/black-lab.svg"},{id:"bone_fish",name:"Bone Fish",src:"gallery/animals/bone-fish.svg"},{id:"deer_love_animals",name:"Deer Love",src:"gallery/animals/deer-love.svg"},{id:"dorado",name:"Dorado",src:"gallery/animals/dorado.svg"},{id:"dorado_fish",name:"Dorado Fish",src:"gallery/animals/dorado-fish.svg"},{id:"duck_hunt",name:"Duck Hunt",src:"gallery/animals/duck-hunt.svg"},{id:"english_bulldog",name:"English Bulldog",src:"gallery/animals/english-bulldog.svg"},{id:"flamingos",name:"Flamingos",src:"gallery/animals/flamingos.svg"},{id:"fly",name:"Fly",src:"gallery/animals/fly.svg"},{id:"german_shepherd",name:"German Shepherd",src:"gallery/animals/german-shepherd.svg"},{id:"golden_retriever",name:"Golden Retriever",src:"gallery/animals/golden-retriever.svg"},{id:"husky",name:"Husky",src:"gallery/animals/husky.svg"},{id:"lucky_dog",name:"Lucky Dog",src:"gallery/animals/lucky-dog.svg"},{id:"pheasant_hunt",name:"Pheasant Hunt",src:"gallery/animals/pheasant-hunt.svg"},{id:"pointer",name:"Pointer",src:"gallery/animals/pointer.svg"},{id:"rattlesnake",name:"Rattlesnake",src:"gallery/animals/rattlesnake.svg"},{id:"redfish",name:"Redfish",src:"gallery/animals/redfish.svg"},{id:"sailfish",name:"Sailfish",src:"gallery/animals/sailfish.svg"},{id:"tail_redfish",name:"Tail Redfish",src:"gallery/animals/tail-redfish.svg"},{id:"tarpon",name:"Tarpon",src:"gallery/animals/tarpon.svg"},{id:"wahoo",name:"Wahoo",src:"gallery/animals/wahoo.svg"}],symbols:[{id:"heart",name:"Heart",src:"gallery/symbols/heart-love-romance-svgrepo-com.svg"},{id:"money",name:"Money Bag",src:"gallery/symbols/money-bag-change-money-capital-svgrepo-com.svg"},{id:"network",name:"Network",src:"gallery/symbols/network-internet-web-svgrepo-com.svg"},{id:"ai",name:"AI",src:"gallery/symbols/smart-work-artificial-intelligence-ai-svgrepo-com.svg"},{id:"thumbsup",name:"Thumbs Up",src:"gallery/symbols/thumbs-up-up-yes-approve-svgrepo-com.svg"},{id:"yinyang",name:"Yin Yang",src:"gallery/symbols/yin-yang-balance-religion-wisdom-svgrepo-com.svg"}],celebration:[{id:"stethoscope",name:"Stethoscope",src:"gallery/celebration/HealthcareStethescope.svg"},{id:"bride",name:"Bride",src:"gallery/celebration/StanleyCreate_Graphics_Refresh_Bride.svg"},{id:"i_love_you",name:"I Love You",src:"gallery/celebration/ValentinesDay_ILoveYou.svg"}],family:[{id:"girl_dad",name:"Girl Dad",src:"gallery/family/GirlDad.svg"},{id:"mom_tattoo",name:"Mom Tattoo",src:"gallery/family/MomTattoo.svg"},{id:"cool_mom",name:"Cool Mom",src:"gallery/family/StanleyCreate_Graphics_Refresh_Cool Mom.svg"},{id:"tattoo",name:"Tattoo",src:"gallery/family/Tattoo.svg"},{id:"cool_dad",name:"Cool Dad",src:"gallery/family/cool-dad.svg"},{id:"dad_leader",name:"Dad Leader",src:"gallery/family/dad-leader.svg"},{id:"dad_rope",name:"Dad Rope",src:"gallery/family/dad-rope.svg"},{id:"dad_to_the_bone",name:"Dad to the Bone",src:"gallery/family/dad-to-the-bone.svg"},{id:"outdoor_dad",name:"Outdoor Dad",src:"gallery/family/outdoor-dad.svg"},{id:"pet_dad",name:"Pet Dad",src:"gallery/family/pet-dad.svg"},{id:"pops_2023",name:"Pops 2023",src:"gallery/family/pops-2023.svg"},{id:"sports_dad",name:"Sports Dad",src:"gallery/family/sports-dad.svg"},{id:"wolf_pack",name:"Wolf Pack",src:"gallery/family/wolf-pack.svg"}],fan_favorites:[{id:"fan_favorites_american_flag",name:"American Flag",src:"gallery/Fan Favorites/american-flag.svg"},{id:"fan_favorites_bear_hugs",name:"Bear Hugs",src:"gallery/Fan Favorites/bear-hugs.svg"},{id:"fan_favorites_bftw_classic",name:"BFTW Classic",src:"gallery/Fan Favorites/bftw-classic.svg"},{id:"fan_favorites_black_lab",name:"Black Lab",src:"gallery/Fan Favorites/black-lab.svg"},{id:"fan_favorites_boot_quet",name:"Boot-Quet",src:"gallery/Fan Favorites/boot-quet.svg"},{id:"fan_favorites_cool_dad",name:"Cool Dad",src:"gallery/Fan Favorites/cool-dad.svg"},{id:"fan_favorites_elevate_your_heart",name:"Elevate Your Heart",src:"gallery/Fan Favorites/elevate-your-heart.svg"},{id:"fan_favorites_hammock",name:"Hammock",src:"gallery/Fan Favorites/hammock.svg"},{id:"fan_favorites_heart_hooks",name:"Heart Hooks",src:"gallery/Fan Favorites/heart-hooks.svg"},{id:"fan_favorites_monarch_butterfly",name:"Monarch Butterfly",src:"gallery/Fan Favorites/monarch-butterfly.svg"},{id:"fan_favorites_mountain_mamma",name:"Mountain Mamma",src:"gallery/Fan Favorites/mountain-mamma.svg"},{id:"fan_favorites_redfish",name:"Redfish",src:"gallery/Fan Favorites/redfish.svg"},{id:"fan_favorites_whitetail_antlers",name:"Whitetail Antlers",src:"gallery/Fan Favorites/whitetail-antlers.svg"}],valentines:[{id:"heart_hooks",name:"Heart Hooks",src:"gallery/Valentine's Day/heart-hooks.svg"},{id:"boot_quet",name:"Boot-Quet",src:"gallery/Valentine's Day/boot-quet.svg"},{id:"deer_love",name:"Deer Love",src:"gallery/Valentine's Day/deer-love.svg"},{id:"elevate_your_heart",name:"Elevate Your Heart",src:"gallery/Valentine's Day/elevate-your-heart.svg"},{id:"prickly_heart",name:"Prickly Heart",src:"gallery/Valentine's Day/prickly-heart.svg"},{id:"ride_or_die",name:"Ride or Die",src:"gallery/Valentine's Day/ride-or-die.svg"}],zodiac:[{id:"aquarius",name:"Aquarius",src:"gallery/zodiac/Zodiac_Aquarius.svg"},{id:"aries",name:"Aries",src:"gallery/zodiac/Zodiac_Aries.svg"},{id:"cancer",name:"Cancer",src:"gallery/zodiac/Zodiac_Cancer.svg"},{id:"capricorn",name:"Capricorn",src:"gallery/zodiac/Zodiac_Capricorn.svg"},{id:"gemini",name:"Gemini",src:"gallery/zodiac/Zodiac_Gemini.svg"},{id:"leo",name:"Leo",src:"gallery/zodiac/Zodiac_Leo.svg"},{id:"libra",name:"Libra",src:"gallery/zodiac/Zodiac_Libra.svg"},{id:"pisces",name:"Pisces",src:"gallery/zodiac/Zodiac_Pisces.svg"},{id:"sagittarius",name:"Sagittarius",src:"gallery/zodiac/Zodiac_Sagittarius.svg"},{id:"scorpio",name:"Scorpio",src:"gallery/zodiac/Zodiac_Scorpio.svg"},{id:"taurus",name:"Taurus",src:"gallery/zodiac/Zodiac_Taurus.svg"},{id:"virgo",name:"Virgo",src:"gallery/zodiac/Zodiac_Virgo.svg"}]},kA=({setView:h,setGraphic:t,selectedGraphic:i,activeTab:s,initialCategory:a})=>{const[o,l]=ct.useState("categories"),[u,d]=ct.useState(null),f=ct.useRef(null);ct.useEffect(()=>{!a||!fh[a]?.length||(d(a),l("icons"),f.current&&(f.current.scrollTop=0))},[a]);const g=x=>{d(x),l("icons"),f.current&&(f.current.scrollTop=0)},b=x=>{t({...x,scale:1})},y=()=>{o==="icons"?(l("categories"),d(null),f.current&&(f.current.scrollTop=0)):h("main")},A=x=>Z(`gallery.cat.${x.id}`)||x.name;return T.jsxs("div",{className:"flex flex-col h-full w-full",children:[T.jsx(Tl,{setView:h,activeView:"gallery",activeTab:s}),T.jsxs("button",{onClick:y,className:"flex items-center text-black font-bold text-sm mb-4 hover:text-gray-600 hover:underline self-start",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),Z(o==="categories"?"gallery.back":"gallery.backToCategories")]}),i&&!i.isUpload&&T.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:Z("gallery.selectedLabel",{name:i.name})}),T.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[Math.round((i.scale||1)*100),"%"]})]}),T.jsx("input",{type:"range",min:"0.2",max:"1.0",step:"0.05",value:i.scale||1,onChange:x=>t({...i,scale:parseFloat(x.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#002C5F]"})]}),T.jsxs("div",{ref:f,className:"flex-1 overflow-y-auto pr-2 custom-scrollbar max-h-[50vh] md:max-h-full",children:[o==="categories"&&T.jsx("div",{className:"grid grid-cols-3 gap-4",children:Ep.map(x=>T.jsxs("div",{className:"flex flex-col items-center gap-2",children:[T.jsx("button",{onClick:()=>g(x.id),className:"aspect-square w-full bg-white border border-gray-200 rounded-lg flex items-center justify-center p-4 shadow-md hover:border-brand-blue hover:shadow-lg transition-all group",children:T.jsx("img",{src:fh[x.id]?.[0]?.src,alt:A(x),className:"w-12 h-12 md:w-16 md:h-16 object-contain group-hover:scale-105 transition-transform"})}),T.jsx("span",{className:`font-bold text-gray-600 uppercase tracking-wider text-center leading-tight
                                    ${A(x).length>8?"text-[10px]":"text-xs"}
                                `,children:A(x)})]},x.id))}),o==="icons"&&u&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-4",children:A(Ep.find(x=>x.id===u))}),T.jsx("div",{className:"grid grid-cols-3 gap-3",children:fh[u]?.map(x=>T.jsx("button",{onClick:()=>b(x),className:`aspect-square bg-white border rounded-md flex items-center justify-center p-4 shadow-md transition-all
                                        ${i?.id===x.id?"border-brand-blue ring-1 ring-brand-blue shadow-lg":"border-gray-200 hover:border-brand-blue hover:shadow-lg"}
                                    `,children:T.jsx("img",{src:x.src,alt:x.name,className:"w-full h-full object-contain"})},x.id))})]})]}),T.jsx("style",{children:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 6px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: #f1f1f1;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: #cbd5e1;
                    border-radius: 3px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: #94a3b8;
                }
            `})]})},DA=({colors:h,selectedColor:t,setSelectedColor:i,isMobile:s})=>{const[a,o]=ct.useState(!1),l=h.find(u=>u.id===t);return T.jsxs(T.Fragment,{children:[s&&T.jsxs("button",{id:"mobile-color-trigger",onClick:()=>o(!0),className:"absolute top-2 right-2 md:hidden flex items-center bg-white rounded-full shadow-lg p-1 pr-2 border border-gray-200 z-30 transition-transform active:scale-95",children:[T.jsx("div",{className:`w-8 h-8 rounded-full ${l?.bg} ${l?.border||""} shadow-inner`}),T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s&&a&&T.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[T.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>o(!1)}),T.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all",children:[T.jsx("button",{onClick:()=>o(!1),className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-8 pt-10",children:[T.jsx("h3",{className:"text-xl font-bold text-[#002C5F] leading-tight mb-2 tracking-wide uppercase",children:Z("product.heading")}),T.jsx("hr",{className:"mb-6 opacity-20"}),T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsxs("p",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-4",children:[Z("product.colorLabelShort")," ",T.jsx("span",{className:"text-black ml-1",children:l?.name})]}),T.jsx("div",{className:"flex flex-wrap gap-4",children:h.map(u=>T.jsx("button",{onClick:()=>i(u.id),className:`relative w-12 h-12 rounded-full ${u.bg} ${u.border||""} 
                                                    ring-2 ring-offset-4 transition-all duration-200
                                                    ${t===u.id?"ring-[#002C5F]":"ring-transparent"}
                                                `,"aria-label":Z("color.selectAria",{color:u.name}),children:t===u.id&&T.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-white pointer-events-none"})},u.id))})]}),T.jsx("button",{onClick:()=>o(!1),className:"w-full bg-black text-white font-bold py-4 rounded-lg tracking-widest uppercase transition-all active:scale-[0.98] shadow-lg",children:Z("color.update")})]})]})]})]})]})},NA=({onRemove:h,onReview:t,isDisabled:i,isPreparing:s})=>{const a=i||s;return T.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-[#f3f4f6] border-t border-gray-200 p-4 md:p-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50",children:T.jsxs("div",{className:"max-w-md md:max-w-none mx-auto md:mx-0 md:ml-auto md:w-[35%] flex space-x-3 w-full px-4 md:px-12",children:[T.jsx("button",{onClick:h,disabled:i||s,className:`flex-1 px-6 py-4 md:py-4 rounded-lg text-sm font-bold tracking-widest uppercase transition-colors shadow-sm
                    ${i||s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border-2 border-gray-200 text-gray-500 hover:border-red-500 hover:text-red-500"}`,children:Z("bottomBar.remove")}),T.jsx("button",{onClick:t,disabled:a,className:`flex-1 px-6 py-4 md:py-4 rounded-lg text-sm font-bold tracking-widest uppercase transition-colors shadow-sm
                    ${a?"bg-gray-300 text-white cursor-not-allowed":"bg-black text-white hover:bg-gray-800"}`,children:Z(s?"bottomBar.preparing":"bottomBar.review")})]})})},RA=({isOpen:h,onClose:t,onConfirm:i})=>{const[s,a]=ct.useState(!1);return h?T.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl relative overflow-hidden flex flex-col max-h-[90vh]",children:[T.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-6 md:p-8 flex flex-col h-full overflow-hidden",children:[T.jsx("h2",{className:"text-xl font-bold text-[#007db5] text-center uppercase tracking-wider mb-6",children:Z("confirm.heading")}),T.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 mb-6 text-sm text-gray-600 leading-relaxed space-y-4 custom-scrollbar",children:[T.jsx("p",{children:Z("confirm.body1")}),T.jsx("p",{children:Z("confirm.body2")}),T.jsx("p",{children:Z("confirm.body3")}),T.jsx("p",{children:Z("confirm.body4")}),T.jsx("p",{children:Z("confirm.body5")}),T.jsx("p",{children:Z("confirm.body6")})]}),T.jsxs("label",{className:"flex items-start space-x-3 mb-8 cursor-pointer group",children:[T.jsx("div",{className:"flex items-center h-5 mt-0.5",children:T.jsx("input",{type:"checkbox",checked:s,onChange:o=>a(o.target.checked),className:"w-5 h-5 rounded border-gray-300 text-[#007db5] focus:ring-[#007db5] cursor-pointer transition-colors"})}),T.jsx("span",{className:"text-sm font-semibold text-gray-800 group-hover:text-black transition-colors",children:Z("confirm.agreeLabel")})]}),T.jsxs("div",{className:"flex space-x-4",children:[T.jsx("button",{onClick:t,className:"flex-1 py-3 bg-[#007db5] text-white font-bold uppercase tracking-widest text-xs hover:bg-[#006da0] transition-colors rounded shadow-md",children:Z("confirm.cancel")}),T.jsx("button",{onClick:i,disabled:!s,className:`flex-1 py-3 font-bold uppercase tracking-widest text-xs rounded transition-all shadow-md ${s?"bg-[#007db5] text-white hover:bg-[#006da0]":"bg-[#9CA3AF] text-white cursor-not-allowed"}`,children:Z("confirm.accept")})]})]})]})}):null},LA=({onClose:h,onRequestClose:t,customization:i,selectedColor:s,selectedFont:a,selectedMonogramBySide:o,frontImage:l,backImage:u,frontDesignImage:d,backDesignImage:f,setActiveTab:g,setView:b})=>{const[y,A]=ct.useState(!1),[x,w]=ct.useState(""),[C,S]=ct.useState(!1);ct.useEffect(()=>{const D=R=>{const k=R.data;!k||k.type!=="BOTTLE_CUSTOMIZER_ADD_TO_CART_STATUS"||(k.status==="loading"?(A(!0),w("")):k.status==="success"?A(!1):k.status==="error"&&(A(!1),w(k.message||Z("review.errorDefault"))))};return window.addEventListener("message",D),()=>window.removeEventListener("message",D)},[]);const M=ct.useCallback(async()=>{const D=i.FRONT.graphic&&typeof i.FRONT.graphic.src=="string"&&i.FRONT.graphic.src.startsWith("gallery/")?i.FRONT.graphic.src:"",R=i.BACK.graphic&&typeof i.BACK.graphic.src=="string"&&i.BACK.graphic.src.startsWith("gallery/")?i.BACK.graphic.src:"",k={color:s,font:a,frontMonogramStyle:o?.FRONT||"",backMonogramStyle:o?.BACK||"",monogramStyle:o?.BACK||"",frontText:i.FRONT.text||"",backText:i.BACK.text||"",frontMonogram:i.FRONT.monogram||"",backMonogram:i.BACK.monogram||"",frontGraphic:i.FRONT.graphic?i.FRONT.graphic.name:"",backGraphic:i.BACK.graphic?i.BACK.graphic.name:"",frontGraphicSrc:D,backGraphicSrc:R,frontImage:l||"",backImage:u||"",frontDesignImage:d||"",backDesignImage:f||""};console.log("Adding to Cart - Customization Data:",k),w(""),typeof window<"u"&&window.parent&&window.parent!==window?(A(!0),window.parent.postMessage({type:"BOTTLE_CUSTOMIZER_ADD_TO_CART",data:k},"*")):(console.log("Standalone mode - Add to Cart Data:",k),alert("Added to cart! (Check console for payload)"),t())},[i,s,a,o,l,u,d,f,t]),_=D=>{g(D);const R=i[D];R.graphic?b("gallery"):R.monogram?b("monogram"):b("text"),h()};return T.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col font-sans text-slate-900 animate-in fade-in active:fade-out duration-300",children:[y&&T.jsxs("div",{className:"fixed inset-0 z-[100] bg-white/90 flex flex-col items-center justify-center",children:[T.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("p",{className:"text-lg font-semibold text-[#002C5F]",children:Z("review.addingToCart")})]}),T.jsx("header",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:T.jsxs("div",{className:"max-w-[1920px] mx-auto px-4 md:px-6 h-14 md:h-16 flex items-center justify-between",children:[T.jsx("img",{src:"logo.png",alt:Z("review.logoAlt"),className:"h-8 md:h-10 w-auto object-contain"}),T.jsx("button",{onClick:h,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":Z("review.closeAria"),children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[#002C5F]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),T.jsxs("main",{className:"flex-1 overflow-y-auto p-3 md:p-8 bg-[#f9fafb]",children:[T.jsxs("div",{className:"text-center mb-4 md:mb-8 max-w-2xl mx-auto",children:[T.jsx("h1",{className:"text-xl md:text-2xl font-bold text-[#002C5F] uppercase tracking-wider mb-3",children:Z("review.heading")}),T.jsx("p",{className:"text-sm md:text-base text-gray-800 font-medium leading-relaxed px-4",children:Z("review.deliveryNotice")})]}),T.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-12 items-start",children:[T.jsxs("div",{className:"flex flex-col items-center bg-[#f9fafb] p-4 rounded-lg ",children:[T.jsx("div",{className:"relative w-full max-w-[240px] md:max-w-[300px] aspect-[3/5] flex items-center justify-center bg-[#f9fafb] rounded-md overflow-visible mb-4",children:l?T.jsx("img",{src:l,alt:Z("review.frontPreviewAlt"),className:"w-full h-full object-contain drop-shadow-xl mix-blend-multiply"}):T.jsx("div",{className:"text-gray-400 text-sm",children:Z("review.noPreview")})}),T.jsxs("button",{onClick:()=>_("FRONT"),className:"group flex items-center space-x-2 bg-white px-6 py-3 rounded-full shadow-sm border border-gray-100 uppercase font-bold text-[#002C5F] text-xs md:text-sm tracking-wider hover:shadow-md transition-all",children:[T.jsx("span",{children:Z("review.editFront")}),T.jsx("div",{className:"w-6 h-6 rounded-full border border-[#002C5F] flex items-center justify-center group-hover:bg-[#002C5F] group-hover:text-white transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]})]}),T.jsxs("div",{className:"flex flex-col items-center bg-[#f9fafb] p-4 rounded-lg ",children:[T.jsx("div",{className:"relative w-full max-w-[240px] md:max-w-[300px] aspect-[3/5] flex items-center justify-center bg-[#f9fafb] rounded-md overflow-visible mb-4",children:u?T.jsx("img",{src:u,alt:Z("review.backPreviewAlt"),className:"w-full h-full object-contain drop-shadow-xl mix-blend-multiply"}):T.jsx("div",{className:"text-gray-400 text-sm",children:Z("review.noPreview")})}),T.jsxs("button",{onClick:()=>_("BACK"),className:"group flex items-center space-x-2 bg-white px-6 py-3 rounded-full shadow-sm border border-gray-100 uppercase font-bold text-[#002C5F] text-xs md:text-sm tracking-wider hover:shadow-md transition-all",children:[T.jsx("span",{children:Z("review.editBack")}),T.jsx("div",{className:"w-6 h-6 rounded-full border border-[#002C5F] flex items-center justify-center group-hover:bg-[#002C5F] group-hover:text-white transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})})]})]})]})]}),T.jsx("footer",{className:"bg-white border-t border-gray-200 p-3 md:p-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50 flex-shrink-0",children:T.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-3",children:[T.jsx("div",{className:"text-center md:text-left w-full md:w-auto",children:x?T.jsx("p",{className:"text-sm font-medium text-red-600",children:x}):T.jsx("p",{className:"text-sm font-medium text-gray-500",children:Z("review.footerNotice")})}),T.jsxs("div",{className:"w-full md:w-auto flex space-x-3 px-4 md:px-0",children:[T.jsx("button",{onClick:h,disabled:y,className:`flex-1 px-6 py-4 rounded-lg text-sm bg-white border-2 border-gray-200 text-gray-500 font-bold uppercase tracking-widest transition-colors ${y?"opacity-50 cursor-not-allowed":"hover:border-[#002C5F] hover:text-[#002C5F]"}`,children:Z("review.backButton")}),T.jsx("button",{onClick:()=>S(!0),disabled:y,className:`flex-1 px-6 py-4 rounded-lg text-[12px] md:text-sm bg-black text-white font-bold uppercase tracking-widest transition-colors ${y?"opacity-50 cursor-not-allowed":"hover:bg-gray-800"}`,children:Z(y?"review.adding":"review.addToCart")})]})]})}),T.jsx(RA,{isOpen:C,onClose:()=>S(!1),onConfirm:()=>{S(!1),M()}})]})},He=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Th=[.001,0,0,.001,0,0],mh=1.35,di={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Hn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},kr="pdfjs_internal_editor_",Et={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Rt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},OA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ch={TRIANGLES:1,LATTICE:2},Ae={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ml={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ye={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ua={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Cl={ERRORS:0,WARNINGS:1,INFOS:5},Dr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ar={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},BA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _l=Cl.WARNINGS;function FA(h){Number.isInteger(h)&&(_l=h)}function zA(){return _l}function Ml(h){_l>=Cl.INFOS&&console.info(`Info: ${h}`)}function wt(h){_l>=Cl.WARNINGS&&console.warn(`Warning: ${h}`)}function Ht(h){throw new Error(h)}function Ut(h,t){h||Ht(t)}function jA(h){switch(h?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function fb(h,t=null,i=null){if(!h)return null;if(i&&typeof h=="string"&&(i.addDefaultProtocol&&h.startsWith("www.")&&h.match(/\./g)?.length>=2&&(h=`http://${h}`),i.tryConvertEncoding))try{h=VA(h)}catch{}const s=t?URL.parse(h,t):URL.parse(h);return jA(s)?s:null}function mb(h,t,i=!1){const s=URL.parse(h);return s?(s.hash=t,s.href):i&&fb(h,"http://example.com")?h.split("#",1)[0]+`${t?`#${t}`:""}`:""}function xt(h,t,i,s=!1){return Object.defineProperty(h,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const bs=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Tp extends bs{constructor(t,i){super(t,"PasswordException"),this.code=i}}class gh extends bs{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class _h extends bs{constructor(t){super(t,"InvalidPDFException")}}class vl extends bs{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class PA extends bs{constructor(t){super(t,"FormatError")}}class Xn extends bs{constructor(t){super(t,"AbortException")}}function IA(h){(typeof h!="object"||h?.length===void 0)&&Ht("Invalid argument for bytesToString");const t=h.length,i=8192;if(t<i)return String.fromCharCode.apply(null,h);const s=[];for(let a=0;a<t;a+=i){const o=Math.min(a+i,t),l=h.subarray(a,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function kl(h){typeof h!="string"&&Ht("Invalid argument for stringToBytes");const t=h.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=h.charCodeAt(s)&255;return i}function UA(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function HA(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function GA(){try{return new Function(""),!0}catch{return!1}}class we{static get isLittleEndian(){return xt(this,"isLittleEndian",HA())}static get isEvalSupported(){return xt(this,"isEvalSupported",GA())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return xt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return xt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return xt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return xt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return xt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ph=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,i,s){return`#${ph[t]}${ph[i]}${ph[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const a=t[s],o=t[s+1];t[s]=a*i[0]+o*i[2]+i[4],t[s+1]=a*i[1]+o*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const a=i[0],o=i[1],l=i[2],u=i[3],d=i[4],f=i[5];for(let g=0;g<6;g+=2){const b=t[s+g],y=t[s+g+1];t[s+g]=b*a+y*l+d,t[s+g+1]=b*o+y*u+f}}static applyInverseTransform(t,i){const s=t[0],a=t[1],o=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-a*i[2]+i[2]*i[5]-i[4]*i[3])/o,t[1]=(-s*i[1]+a*i[0]+i[4]*i[1]-i[5]*i[0])/o}static axialAlignedBoundingBox(t,i,s){const a=i[0],o=i[1],l=i[2],u=i[3],d=i[4],f=i[5],g=t[0],b=t[1],y=t[2],A=t[3];let x=a*g+d,w=x,C=a*y+d,S=C,M=u*b+f,_=M,D=u*A+f,R=D;if(o!==0||l!==0){const k=o*g,F=o*y,j=l*b,Y=l*A;x+=j,S+=j,C+=Y,w+=Y,M+=k,R+=k,D+=F,_+=F}s[0]=Math.min(s[0],x,C,w,S),s[1]=Math.min(s[1],M,D,_,R),s[2]=Math.max(s[2],x,C,w,S),s[3]=Math.max(s[3],M,D,_,R)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],a=t[1],o=t[2],l=t[3],u=s**2+a**2,d=s*o+a*l,f=o**2+l**2,g=(u+f)/2,b=Math.sqrt(g**2-(u*f-d**2));i[0]=Math.sqrt(g+b||1),i[1]=Math.sqrt(g-b||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>a)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>l?null:[s,o,a,l]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,a,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],i,a),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],i,a)}static#t(t,i,s,a,o,l,u,d,f,g){if(f<=0||f>=1)return;const b=1-f,y=f*f,A=y*f,x=b*(b*(b*t+3*f*i)+3*y*s)+A*a,w=b*(b*(b*o+3*f*l)+3*y*u)+A*d;g[0]=Math.min(g[0],x),g[1]=Math.min(g[1],w),g[2]=Math.max(g[2],x),g[3]=Math.max(g[3],w)}static#e(t,i,s,a,o,l,u,d,f,g,b,y){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,i,s,a,o,l,u,d,-b/g,y);return}const A=g**2-4*b*f;if(A<0)return;const x=Math.sqrt(A),w=2*f;this.#t(t,i,s,a,o,l,u,d,(-g+x)/w,y),this.#t(t,i,s,a,o,l,u,d,(-g-x)/w,y)}static bezierBoundingBox(t,i,s,a,o,l,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,d),this.#e(t,s,o,u,i,a,l,d,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,u,i,a,l,d,3*(-i+3*(a-l)+d),6*(i-2*a+l),3*(a-i),f)}}function VA(h){return decodeURIComponent(escape(h))}let bh=null,Cp=null;function XA(h){return bh||(bh=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Cp=new Map([["","t"]])),h.replaceAll(bh,(t,i,s)=>i?i.normalize("NFKC"):Cp.get(s))}function gb(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const h=new Uint8Array(32);return crypto.getRandomValues(h),IA(h)}const fa="pdfjs_internal_id_";function YA(h,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,a,...o]=i;if(!h(s)&&!Number.isInteger(s)||!t(a))return!1;const l=o.length;let u=!0;switch(a.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const d of o)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Oe(h,t,i){return Math.min(Math.max(h,t),i)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(h){return h.reduce((t,i)=>t+i,0)});class Nr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function a(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(Nr.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&i.push({str:l}),!!o.children)for(const d of o.children)a(d)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class pb{static setupStorage(t,i,s,a,o){const l=a.getValue(i,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{a.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:a,linkService:o}){const{attributes:l}=i,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[d,f]of Object.entries(l))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:s});const u=o!=="richText",d=t.div;if(d.append(l),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=b}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const b=document.createTextNode(a.value);l.append(b),u&&Nr.shouldBuildText(a.name)&&f.push(b)}return{textDivs:f}}const g=[[a,-1,l]];for(;g.length>0;){const[b,y,A]=g.at(-1);if(y+1===b.children.length){g.pop();continue}const x=b.children[++g.at(-1)[1]];if(x===null)continue;const{name:w}=x;if(w==="#text"){const S=document.createTextNode(x.value);f.push(S),A.append(S);continue}const C=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,w):document.createElement(w);if(A.append(C),x.attributes&&this.setAttributes({html:C,element:x,storage:i,intent:o,linkService:s}),x.children?.length>0)g.push([x,-1,C]);else if(x.value){const S=document.createTextNode(x.value);u&&Nr.shouldBuildText(w)&&f.push(S),C.append(S)}}for(const b of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const fn="http://www.w3.org/2000/svg";class xa{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Or(h,t="text"){if(Tr(h,document.baseURI)){const i=await fetch(h);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const a=new XMLHttpRequest;a.open("GET",h,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(a.response);return}i(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class Br{constructor({viewBox:t,userUnit:i,scale:s,rotation:a,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=a,this.offsetX=o,this.offsetY=l,s*=i;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,b,y,A;switch(a%=360,a<0&&(a+=360),a){case 180:g=-1,b=0,y=0,A=1;break;case 90:g=0,b=1,y=1,A=0;break;case 270:g=0,b=-1,y=-1,A=0;break;case 0:g=1,b=0,y=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,A=-A);let x,w,C,S;g===0?(x=Math.abs(f-t[1])*s+o,w=Math.abs(d-t[0])*s+l,C=(t[3]-t[1])*s,S=(t[2]-t[0])*s):(x=Math.abs(d-t[0])*s+o,w=Math.abs(f-t[1])*s+l,C=(t[2]-t[0])*s,S=(t[3]-t[1])*s),this.transform=[g*s,b*s,y*s,A*s,x-g*s*d-y*s*f,w-b*s*d-A*s*f],this.width=C,this.height=S}get rawDims(){const t=this.viewBox;return xt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:o=!1}={}){return new Br({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}convertToViewportPoint(t,i){const s=[t,i];return nt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];nt.applyTransform(i,this.transform);const s=[t[2],t[3]];return nt.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return nt.applyInverseTransform(s,this.transform),s}}class Gh extends bs{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function Dl(h){const t=h.length;let i=0;for(;i<t&&h[i].trim()==="";)i++;return h.substring(i,i+5).toLowerCase()==="data:"}function Vh(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function qA(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function $A(h,t="document.pdf"){if(typeof h!="string")return t;if(Dl(h))return wt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(h);if(!s)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},o=/\.pdf$/i,l=s.pathname.split("/").at(-1);if(o.test(l))return a(l);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(o.test(f))return a(f);const d=Array.from(s.searchParams.keys()).reverse();for(const f of d)if(o.test(f))return a(f)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return a(d[0])}return t}class _p{started=Object.create(null);times=[];time(t){t in this.started&&wt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||wt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:a,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-a}ms
`);return t.join("")}}function Tr(h,t){const i=t?URL.parse(h,t):URL.parse(h);return i?.protocol==="http:"||i?.protocol==="https:"}function Di(h){h.preventDefault()}function le(h){h.preventDefault(),h.stopPropagation()}function KA(h){console.log("Deprecated API usage: "+h)}class Mh{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let a=parseInt(i[2],10);a=a>=1&&a<=12?a-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(i[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(i[6],10);d=d>=0&&d<=59?d:0;const f=i[7]||"Z";let g=parseInt(i[8],10);g=g>=0&&g<=23?g:0;let b=parseInt(i[9],10)||0;return b=b>=0&&b<=59?b:0,f==="-"?(l+=g,u+=b):f==="+"&&(l-=g,u-=b),new Date(Date.UTC(s,a,o,l,u,d))}}function WA(h,{scale:t=1,rotation:i=0}){const{width:s,height:a}=h.attributes.style,o=[0,0,parseInt(s),parseInt(a)];return new Br({viewBox:o,userUnit:1,scale:t,rotation:i})}function Fr(h){if(h.startsWith("#")){const t=parseInt(h.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(t=>parseInt(t)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(wt(`Not a valid color format: "${h}"`),[0,0,0])}function QA(h){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of h.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;h.set(i,Fr(s))}t.remove()}function se(h){const{a:t,b:i,c:s,d:a,e:o,f:l}=h.getTransform();return[t,i,s,a,o,l]}function Gi(h){const{a:t,b:i,c:s,d:a,e:o,f:l}=h.getTransform().invertSelf();return[t,i,s,a,o,l]}function gs(h,t,i=!1,s=!0){if(t instanceof Br){const{pageWidth:a,pageHeight:o}=t.rawDims,{style:l}=h,u=we.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${o}px`,g=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,b=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(l.width=g,l.height=b):(l.width=b,l.height=g)}s&&h.setAttribute("data-main-rotation",t.rotation)}class qi{constructor(){const{pixelRatio:t}=qi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,a,o=-1){let l=1/0,u=1/0,d=1/0;s=qi.capPixels(s,o),s>0&&(l=Math.sqrt(s/(t*i))),a!==-1&&(u=a/t,d=a/i);const f=Math.min(l,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const kh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ZA{static get isDarkMode(){return xt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class JA{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),xt(this,"commentForegroundColor",Fr(s))}}function tw(h,t,i,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return h=Math.round(h*s+a),t=Math.round(t*s+a),i=Math.round(i*s+a),[h,t,i]}function Mp(h,t){const i=h[0]/255,s=h[1]/255,a=h[2]/255,o=Math.max(i,s,a),l=Math.min(i,s,a),u=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const d=o-l;switch(t[1]=u<.5?d/(o+l):d/(2-o-l),o){case i:t[0]=((s-a)/d+(s<a?6:0))*60;break;case s:t[0]=((a-i)/d+2)*60;break;case a:t[0]=((i-s)/d+4)*60;break}}t[2]=u}function Dh(h,t){const i=h[0],s=h[1],a=h[2],o=(1-Math.abs(2*a-1))*s,l=o*(1-Math.abs(i/60%2-1)),u=a-o/2;switch(Math.floor(i/60)){case 0:t[0]=o+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=o+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=l+u;break}}function kp(h){return h<=.03928?h/12.92:((h+.055)/1.055)**2.4}function Dp(h,t,i){Dh(h,i),i.map(kp);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Dh(t,i),i.map(kp);const a=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const Np=new Map;function ew(h,t){const i=h[0]+h[1]*256+h[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Np.get(i);if(s)return s;const a=new Float32Array(9),o=a.subarray(0,3),l=a.subarray(3,6);Mp(h,l);const u=a.subarray(6,9);Mp(t,u);const d=u[2]<.5,f=d?12:4.5;if(l[2]=d?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),Dp(l,u,o)<f){let g,b;d?(g=l[2],b=1):(g=0,b=l[2]);const y=.005;for(;b-g>y;){const A=l[2]=(g+b)/2;d===Dp(l,u,o)<f?g=A:b=A}l[2]=d?b:g}return Dh(l,o),s=nt.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Np.set(i,s),s}function bb({html:h,dir:t,className:i},s){const a=document.createDocumentFragment();if(typeof h=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=h.split(/(?:\r\n?|\n)/);for(let u=0,d=l.length;u<d;++u){const f=l[u];o.append(document.createTextNode(f)),u<d-1&&o.append(document.createElement("br"))}a.append(o)}else pb.render({xfaHtml:h,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",i),s.append(a)}function yb(h){const t=new Path2D;if(!h)return t;for(let i=0,s=h.length;i<s;)switch(h[i++]){case Ar.moveTo:t.moveTo(h[i++],h[i++]);break;case Ar.lineTo:t.lineTo(h[i++],h[i++]);break;case Ar.curveTo:t.bezierCurveTo(h[i++],h[i++],h[i++],h[i++],h[i++],h[i++]);break;case Ar.quadraticCurveTo:t.quadraticCurveTo(h[i++],h[i++],h[i++],h[i++]);break;case Ar.closePath:t.closePath();break;default:wt(`Unrecognized drawing path operator: ${h[i-1]}`);break}return t}class Pt{static#t=null;static#e=null;static#n=null;static#i=0;static#a=[];get pagesNumber(){return Pt.#i}set pagesNumber(t){Pt.#i!==t&&(Pt.#i=t,t===0&&(Pt.#e=null,Pt.#t=null))}addListener(t){Pt.#a.push(t)}removeListener(t){const i=Pt.#a.indexOf(t);i>=0&&Pt.#a.splice(i,1)}#r(){for(const t of Pt.#a)t()}#s(t){if(Pt.#e)return;const i=Pt.#i,s=new Uint32Array(3*i),a=Pt.#e=s.subarray(0,i),o=Pt.#t=s.subarray(i,2*i);if(t)for(let l=0;l<i;l++)a[l]=o[l]=l+1;Pt.#n=s.subarray(2*i)}movePages(t,i,s){this.#s(!0);const a=Pt.#e,o=Pt.#t;Pt.#n.set(o);const l=i.length,u=new Uint32Array(l);let d=0;for(let A=0;A<l;A++){const x=i[A]-1;u[A]=a[x],x<s&&(d+=1)}const f=Pt.#i;let g=s-d;const b=f-l;g=Oe(g,0,b);for(let A=0,x=0;A<f;A++)t.has(A+1)||(a[x++]=a[A]);a.copyWithin(g+l,g,b),a.set(u,g);let y=!1;for(let A=0,x=f;A<x;A++){const w=a[A];y||=w!==A+1,o[w-1]=A+1}this.#r(),y||(this.pagesNumber=0)}hasBeenAltered(){return Pt.#e!==null}getPageMappingForSaving(){return{pageIndices:Pt.#t?Pt.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Pt.#n[Pt.#e[t-1]-1]}getPageNumber(t){return Pt.#t?.[t-1]??t}getPageId(t){return Pt.#e?.[t-1]??t}static get instance(){return xt(this,"instance",new Pt)}getMapping(){return Pt.#e.subarray(0,this.pagesNumber)}}class Mr{#t=null;#e=null;#n;#i=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(t){this.#n=t,Mr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",Di,{signal:i}),t.addEventListener("pointerdown",Mr.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const a=this.#n.toolbarPosition;if(a){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-a[0]:a[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,le(t)}#h(t){this.#n._focusEventsAllowed=!0,le(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Di,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",Mr.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#p(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#p),this.#a=t}addComment(t,i=null){if(this.#r)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#s=this.#p;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(a,i)):this.#i.append(s,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#p)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#p)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null)}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const a=this.#i.querySelector(s);a&&t==="comment"&&this.addComment(i,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class iw{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",Di,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,i){let s=0,a=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(i?o.width:0);if(l>s){a=u,s=l;continue}i?u>a&&(a=u):u<a&&(a=u)}return[i?1-a:a,s]}show(t,i,s){const[a,o]=this.#a(i,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,i,s,a){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",i);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",Di,{signal:u}),o.addEventListener("click",a,{signal:u})),this.#t.append(o)}}function vb(h,t,i){for(const s of i)t.addEventListener(s,h[s].bind(h))}class It{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(It.#e||=new Set).add(t)}static setPointer(t,i){It.#t||=i,It.#i??=t}static setTimeStamp(t){It.#n=t}static isSamePointerId(t){return It.#t===t}static isSamePointerIdOrRemove(t){return It.#t===t?!0:(It.#e?.delete(t),!1)}static isSamePointerType(t){return It.#i===t}static isInitializedAndDifferentPointerType(t){return It.#i!==null&&!It.isSamePointerType(t)}static isSameTimeStamp(t){return It.#n===t}static isUsingMultiplePointers(){return It.#e?.size>=1}static clearPointerType(){It.#i=null}static clearPointerIds(){It.#t=NaN,It.#e=null}static clearTimeStamp(){It.#n=NaN}}class nw{#t=0;get id(){return`${kr}${this.#t++}`}}class Xh{#t=gb();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const o=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return xt(this,"_isSVGFittingCanvas",o)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof i=="string"?(s.url=i,a=await Or(i,"blob")):i instanceof File?a=s.file=i:i instanceof Blob&&(a=i),a.type==="image/svg+xml"){const o=Xh._isSVGFittingCanvas,l=new FileReader,u=new Image,d=new Promise((f,g)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},l.onload=async()=>{const b=s.svgUrl=l.result;u.src=await o?`${b}#svgView(preserveAspectRatio(none))`:b},u.onerror=l.onerror=g});l.readAsDataURL(a),await d}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){wt(a),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:a,type:o}=t;return this.#i(`${i}_${s}_${a}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(i.width,i.height);return a.getContext("2d").drawImage(i,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=a.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class sw{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:a,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:i,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(l&&this.#t[this.#i].type===o){u&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class zr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=we.platform;for(const[s,a,o={}]of t)for(const l of s){const u=l.startsWith("mac+");i&&u?(this.callbacks.set(l.slice(4),{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1))):!i&&!u&&(this.callbacks.set(l,{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:a,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,i)||(a.bind(t,...l,i)(),o||le(i))}}class Yh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return QA(t),xt(this,"_colors",t)}convert(t){const i=Fr(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,a]of this._colors)if(a.every((o,l)=>o===i[l]))return Yh._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?nt.makeHexColor(...i):t}}class Yn{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new sw;#l=null;#d=null;#h=null;#f=0;#p=new Set;#g=null;#u=null;#m=new Set;_editorUndoBar=null;#b=!1;#v=!1;#y=!1;#T=null;#S=null;#w=null;#_=null;#A=!1;#E=null;#D=new nw;#M=!1;#k=!1;#z=!1;#R=null;#O=null;#j=null;#B=null;#V=null;#C=Et.NONE;#x=new Set;#L=null;#P=null;#U=null;#q=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#F=null;#X=null;#Z=null;#J=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Yn.prototype,i=l=>l.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return xt(this,"_keyboardManager",new zr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#X.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}constructor(t,i,s,a,o,l,u,d,f,g,b,y,A,x,w,C){const S=this._signal=this.#t.signal;this.#X=t,this.#Z=i,this.#J=s,this.#r=a,this.#l=o,this.#P=l,this.#Y=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:S}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),u._on("setpreference",this.onSetPreference.bind(this),{signal:S}),u._on("switchannotationeditorparams",M=>this.updateParams(M.type,M.value),{signal:S}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:S}),window.addEventListener("pointerdown",()=>{this.#k=!0},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{this.#k=!1},{capture:!0,signal:S}),this.#rt(),this.#dt(),this.#et(),this.#s=d.annotationStorage,this.#T=d.filterFactory,this.#U=f,this.#_=g||null,this.#b=b,this.#v=y,this.#y=A,this.#V=x||null,this.viewParameters={realScale:xa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=C!==!1,o?.setSidebarUiManager(this)}destroy(){this.#I?.resolve(),this.#I=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#m.clear(),this.#B?.clear(),this.#e=null,this.#x.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#P?.destroy(),this.#E?.hide(),this.#E=null,this.#j?.destroy(),this.#j=null,this.#n=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#F&&(clearTimeout(this.#F),this.#F=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return xt(this,"hcmFilter",this.#U?this.#T.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return xt(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return xt(this,"_highlightColors",this.#_?new Map(this.#_.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return xt(this,"highlightColors",null);const i=new Map,s=!!this.#U;for(const[a,o]of t){const l=a.endsWith("_HCM");if(s&&l){i.set(a.replace("_HCM",""),o);continue}!s&&!l&&i.set(a,o)}return xt(this,"highlightColors",i)}get highlightColorNames(){return xt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#j=t}editAltText(t,i=!1){this.#r?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,a){this.#l?.showDialog(this,t,i,s,a)}selectComment(t,i){this.#a.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,i){const s=()=>{t.comment=i},a=()=>{this._editorUndoBar?.show(s,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:s,mustExec:!0})}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),a=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",a),i())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#P?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#P}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){t==="enableNewAltTextWhenAddingImage"&&(this.#y=i)}onPagesEdited({pagesMapper:t}){for(const a of this.#i.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const i=this.#a,s=this.#a=new Map;for(const[a,o]of i){const l=t.getPrevPageNumber(a+1)-1;if(l===-1){o.destroy();continue}s.set(l,o),o.updatePageIndex(l)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#X.focus()}findParent(t,i){for(const s of this.#a.values()){const{x:a,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+l&&i>=o&&i<=o+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*xa.PDF_TO_CSS_UNITS;for(const i of this.#m)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#a.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u}=s,d=s.toString(),g=this.#Q(s).closest(".textLayer"),b=this.getSelectionBoxes(g);if(!b)return;s.empty();const y=this.#tt(g),A=this.#C===Et.NONE,x=()=>{const w=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:b,anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u,text:d});A&&this.showAllEditors("highlight",!0,!0),i&&w?.editComment()};if(A){this.switchToMode(Et.HIGHLIGHT,x);return}x()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Q(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#E||=new iw(this),this.#E.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${kr}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#E?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#L)return;const a=this.#Q(t).closest(".textLayer");if(!a){this.#L&&(this.#E?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#L=i,this.#N({hasSelectedText:!0}),!(this.#C!==Et.HIGHLIGHT&&this.#C!==Et.NONE)&&(this.#C===Et.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#C===Et.HIGHLIGHT?this.#tt(a):null;if(o?.toggleDrawing(),this.#k){const l=new AbortController,u=this.combinedSignal(l),d=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#C===Et.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#x)if(i.div.contains(t)){this.#O=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#O)return;const[t,i]=this.#O;this.#O=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#R)return;this.#R=new AbortController;const t=this.combinedSignal(this.#R);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#R?.abort(),this.#R=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#x){const a=s.serialize(!0);a&&i.push(a)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){wt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const o=[];for(const d of s){const f=await a.deserialize(d);if(!f)return;o.push(f)}const l=()=>{for(const d of o)this.#it(d);this.#nt(o)},u=()=>{for(const d of o)d.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){wt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==Et.NONE&&!this.isEditorHandlingKeyboard&&Yn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,a])=>this.#$[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#C===Et.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Rt.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#N({isEditing:this.#C!==Et.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,a=!1,o=!1,l=!1){if(this.#C!==t&&!(this.#I&&(await this.#I.promise,!this.#I))){if(this.#I=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===Et.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===Et.NONE){this.setEditingState(!1),this.#mt();for(const u of this.#i.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#I.resolve();return}for(const u of this.#i.values())u.addStandaloneCommentButton();t===Et.SIGNATURE&&await this.#P?.loadSignatures(),s&&It.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#a.values())u.updateMode(t);if(t===Et.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#i.values()){const{annotationElementId:g,hasComment:b,deleted:y}=f;g&&u.add(g),b&&!y&&d.push(f.getData())}for(const f of this.#n){const{id:g,popupRef:b,contentsObj:y}=f;b&&y?.str&&!u.has(g)&&!this.#p.has(g)&&d.push(f)}this.#l?.showSidebar(d)}if(!i){a&&this.addNewEditorFromKeyboard(),this.#I.resolve();return}for(const u of this.#i.values())u.uid===i?(this.setSelected(u),l?u.editComment():o?u.enterInEditMode():u.focus()):u.unselect();this.#I.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Rt.CREATE:this.currentLayer.addNewEditor(i);return;case Rt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#x)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const o of this.#i.values())o.editorType===t&&o.show(i);(this.#q?.get(Rt.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Rt.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#z!==t){this.#z=t;for(const i of this.#a.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#a.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#mt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#p.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#p.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#p.has(t)}removeDeletedAnnotationElement(t){this.#p.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#a.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#x);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#x.has(t)){this.#x.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#x)i!==t&&i.unselect();this.#x.clear(),this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#x.has(t)}get firstSelectedEditor(){return this.#x.values().next().value}unselect(t){t.unselect(),this.#x.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#x.size!==0}get isEnterHandled(){return this.#x.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#x],s=()=>{this._editorUndoBar?.show(a,i.length===1?i[0].editorType:i.length);for(const o of i)o.remove()},a=()=>{for(const o of i)this.#it(o)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#x)i.unselect();this.#x.clear();for(const i of t)i.isEmpty()||(this.#x.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#x)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==Et.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#x)t.unselect();this.#x.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[a,o]=this.#H,l=[...this.#x],u=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of l)this.#i.has(d.id)&&(d.translateInPage(a,o),d.translationDone())},undo:()=>{for(const d of l)this.#i.has(d.id)&&(d.translateInPage(-a,-o),d.translationDone())},mustExec:!1})},u);for(const d of l)d.translateInPage(t,i),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#x)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:a,y:o,pageIndex:l},u]of t)u.newX=a,u.newY=o,u.newPageIndex=l,i||=a!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!i)return!1;const s=(a,o,l,u)=>{if(this.#i.has(a.id)){const d=this.#a.get(u);d?a._setParentAndPosition(d,o,l):(a.pageIndex=u,a.x=o,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:o,newY:l,newPageIndex:u}]of t)s(a,o,l,u)},undo:()=>{for(const[a,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(a,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#x.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==Et.NONE}get imageManager(){return xt(this,"imageManager",new Xh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,g=i.rangeCount;f<g;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:a,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,g,b,y)=>({x:(g-a)/l,y:1-(f+b-s)/o,width:y/l,height:b/o});break;case"180":u=(f,g,b,y)=>({x:1-(f+b-s)/o,y:1-(g+y-a)/l,width:b/o,height:y/l});break;case"270":u=(f,g,b,y)=>({x:1-(g+y-a)/l,y:(f-s)/o,width:y/l,height:b/o});break;default:u=(f,g,b,y)=>({x:(f-s)/o,y:(g-a)/l,width:b/o,height:y/l});break}const d=[];for(let f=0,g=i.rangeCount;f<g;f++){const b=i.getRangeAt(f);if(!b.collapsed)for(const{x:y,y:A,width:x,height:w}of b.getClientRects())x===0||w===0||d.push(u(y,A,x,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#C===Et.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const a=this.#B?.get(t);a&&(a.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Yi{#t=null;#e=!1;#n=null;#i=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Yi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Yi._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Yi.#f.missing),i.setAttribute("data-l10n-id",Yi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Di,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#s=!0,a(o))},{signal:s}),await this.#g(),t}get#p(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Yi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:a,cancel:o=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===i)&&(o||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Yi.#f[this.#p]),this.#i?.setAttribute("data-l10n-id",Yi.#f[`${this.#p}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#a;if(!i){this.#a=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const a=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:o})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class nl{#t=null;#e=null;#n=!1;#i=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const a=this.#i.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#i.parent.boundingClientRect;return[(t-a)/l,(i+s-o)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Di,{signal:s}),i&&(t.addEventListener("focusin",o=>{this.#i._focusEventsAllowed=!1,le(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#i._focusEventsAllowed=!0,le(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#n=!0,a(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,a;if(i)[s,a]=i;else{[s,a]=this.#i.commentButtonPosition;const{width:g,height:b,x:y,y:A}=this.#i;s=y+s*g,a=A+a*b}const o=this.#i.parent.boundingClientRect,{x:l,y:u,width:d,height:f}=o;this.#i._uiManager.editComment(this.#i,l+s*d,u+a*f,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#r=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:i,date:s}){this.#s=t,this.#r=i,this.#o=s,this.#c=!1}setInitialText(t,i=null){this.#a=t,this.data=t,this.#o=null,this.#r=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class Nl{#t;#e=!1;#n=null;#i;#a;#r;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#a=a,this.#r=o,this.#s=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/qi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,o=AbortSignal.any([this.#c,a.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(le(f),d(f))},u),l.addEventListener("pointerup",d,u),l.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:a,capture:!1,passive:!1};o.addEventListener("touchmove",this.#p.bind(this),l);const u=this.#g.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",le,l),o.addEventListener("pointermove",le,l),o.addEventListener("pointercancel",le,l),o.addEventListener("pointerup",le,l),this.#a?.()}if(le(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#p(t){if(!this.#l||t.touches.length!==2)return;le(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:a,screenY:o}=i,{screenX:l,screenY:u}=s,d=this.#l,{touch0X:f,touch0Y:g,touch1X:b,touch1Y:y}=d,A=b-f,x=y-g,w=l-a,C=u-o,S=Math.hypot(w,C)||1,M=Math.hypot(A,x)||1;if(!this.#e&&Math.abs(M-S)<=Nl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=o,d.touch1X=l,d.touch1Y=u,!this.#e){this.#e=!0;return}const _=[(a+l)/2,(o+u)/2];this.#r?.(_,M,S)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(le(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class pt{#t=null;#e=null;#n=null;#i=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#p="";#g=!1;#u=null;#m=!1;#b=!1;#v=!1;#y=null;#T=0;#S=0;#w=null;#_=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#E=pt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Yh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=pt.prototype._resizeWithKeyboard,i=Yn.TRANSLATE_SMALL,s=Yn.TRANSLATE_BIG;return xt(this,"_resizerKeyboardManager",new zr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],pt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[o,l];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return xt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new aw({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(pt._l10n??=t,pt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),pt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);pt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Ht("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#F(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,a){const[o,l]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/o,this.y=(i+a)/l,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,a]=this.parentDimensions;this.setAt(t*s,i*a,this.width*s,this.height*a),this._onTranslated()}#D([t,i],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#D(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,o]}=this;if(this.x+=t/a,this.y+=i/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[d,f]=this.getBaseTranslation();l+=d,u+=f;const{style:g}=s;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=pt,a=s/t,o=s/i;switch(this.rotation){case 90:return[-a,o];case 180:return[a,o];case 270:return[a,-o];default:return[-a,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,a]}=this;let{x:o,y:l,width:u,height:d}=this;if(u*=s,d*=a,o*=s,l*=a,this._mustFixPosition)switch(t){case 0:o=Oe(o,0,s-u),l=Oe(l,0,a-d);break;case 90:o=Oe(o,0,s-d),l=Oe(l,u,a);break;case 180:o=Oe(o,u,s),l=Oe(l,d,a);break;case 270:o=Oe(o,d,s),l=Oe(l,0,a-u);break}this.x=o/=s,this.y=l/=a;const[f,g]=this.getBaseTranslation();o+=f,l+=g,i.left=`${(100*o).toFixed(2)}%`,i.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return pt.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return pt.#M(t,i,360-this.parentRotation)}#k(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#R.bind(this,s),{signal:i}),a.addEventListener("contextmenu",Di,{signal:i}),a.tabIndex=-1}this.div.prepend(this.#c)}#R(t,i){i.preventDefault();const{isMac:s}=we.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",le,{passive:!1,signal:l}),window.addEventListener("contextmenu",Di,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#j()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#O(t,i,s,a){this.width=s,this.height=a,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#j(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,d=this.height;o===t&&l===i&&u===s&&d===a||this.addCommands({cmd:this.#O.bind(this,o,l,u,d),undo:this.#O.bind(this,t,i,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,a]=this.parentDimensions,o=this.x,l=this.y,u=this.width,d=this.height,f=pt.MIN_SIZE/s,g=pt.MIN_SIZE/a,b=this.#k(this.rotation),y=(B,H)=>[b[0]*B+b[2]*H,b[1]*B+b[3]*H],A=this.#k(360-this.rotation),x=(B,H)=>[A[0]*B+A[2]*H,A[1]*B+A[3]*H];let w,C,S=!1,M=!1;switch(t){case"topLeft":S=!0,w=(B,H)=>[0,0],C=(B,H)=>[B,H];break;case"topMiddle":w=(B,H)=>[B/2,0],C=(B,H)=>[B/2,H];break;case"topRight":S=!0,w=(B,H)=>[B,0],C=(B,H)=>[0,H];break;case"middleRight":M=!0,w=(B,H)=>[B,H/2],C=(B,H)=>[0,H/2];break;case"bottomRight":S=!0,w=(B,H)=>[B,H],C=(B,H)=>[0,0];break;case"bottomMiddle":w=(B,H)=>[B/2,H],C=(B,H)=>[B/2,0];break;case"bottomLeft":S=!0,w=(B,H)=>[0,H],C=(B,H)=>[B,0];break;case"middleLeft":M=!0,w=(B,H)=>[0,H/2],C=(B,H)=>[B,H/2];break}const _=w(u,d),D=C(u,d);let R=y(...D);const k=pt._round(o+R[0]),F=pt._round(l+R[1]);let j=1,Y=1,X,Q;if(i.fromKeyboard)({deltaX:X,deltaY:Q}=i);else{const{screenX:B,screenY:H}=i,[J,ft]=this.#l;[X,Q]=this.screenToPageTranslation(B-J,H-ft),this.#l[0]=B,this.#l[1]=H}if([X,Q]=x(X/s,Q/a),S){const B=Math.hypot(u,d);j=Y=Math.max(Math.min(Math.hypot(D[0]-_[0]-X,D[1]-_[1]-Q)/B,1/u,1/d),f/u,g/d)}else M?j=Oe(Math.abs(D[0]-_[0]-X),f,1)/u:Y=Oe(Math.abs(D[1]-_[1]-Q),g,1)/d;const it=pt._round(u*j),lt=pt._round(d*Y);R=y(...C(it,lt));const et=k-R[0],st=F-R[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=it,this.height=lt,this.x=et,this.y=st,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#b)return this._editToolbar;this._editToolbar=new Mr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Yi.initialize(pt._l10n),this.#n=new Yi(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new nl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){if(!this.#i)return null;const{data:{richText:t,text:i,date:s,deleted:a}}=this.#i;return{text:i,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new nl(this),typeof t=="object"&&t!==null?this.#i.restoreData(t):this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new nl(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new nl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,u=l+o+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#U();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[a,o]=this.getInitialTranslation();return this.translate(a,o),vb(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#_||=new Nl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#x.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,i,s){let o=.7*(s/i)+1-.7;if(o===1)return;const l=this.#k(this.rotation),u=(k,F)=>[l[0]*k+l[2]*F,l[1]*k+l[3]*F],[d,f]=this.parentDimensions,g=this.x,b=this.y,y=this.width,A=this.height,x=pt.MIN_SIZE/d,w=pt.MIN_SIZE/f;o=Math.max(Math.min(o,1/y,1/A),x/y,w/A);const C=pt._round(y*o),S=pt._round(A*o);if(C===y&&S===A)return;this.#u||=[g,b,y,A];const M=u(y/2,A/2),_=pt._round(g+M[0]),D=pt._round(b+M[1]),R=u(C/2,S/2);this.x=_-R[0],this.y=D-R[1],this.width=C,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#x(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#j()}pointerdown(t){const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#P(t);return}this.#L(t)}#L(t){const{isMac:i}=we.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,o=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:o},u=f=>{a.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#L(f),s&&this._onStopDragging()};i&&(this.#T=t.clientX,this.#S=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:b,pointerId:y}=f;if(y!==this.#s){le(f);return}const[A,x]=this.screenToPageTranslation(g-this.#T,b-this.#S);this.#T=g,this.#S=b,this._uiManager.dragSelectedEditors(A,x)},l),window.addEventListener("touchmove",le,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#_||f.isPrimary)&&u(f),le(f)},l));const d=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}le(f)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const a=this.parentScale,[o,l]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,g=i/a,b=this.x*o,y=this.y*l,A=this.width*o,x=this.height*l;switch(s){case 0:return[b+f+u,l-y-g-x+d,b+f+A+u,l-y-g+d];case 90:return[b+g+u,l-y+f+d,b+g+x+u,l-y+f+A+d];case 180:return[b-f-A+u,l-y+g+d,b-f+u,l-y+g+x+d];case 270:return[b-g-x+u,l-y-f-A+d,b-g+u,l-y-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,a,o,l]=t,u=o-s,d=l-a;switch(this.rotation){case 0:return[s,i-l,u,d];case 90:return[s,i-a,d,u];case 180:return[o,i-a,u,d];case 270:return[o,i-l,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&pt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:a,deleted:o,richText:l},uid:u,pageIndex:d,creationDate:f,modificationDate:g}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:s||g,popupRef:!o,color:i,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#b=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#b=!1,!0):!1}isInEditMode(){return this.#b}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return i<l&&a>0&&t<o&&s>0}#U(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#U()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const a=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[o,l]=a.pageDimensions,[u,d,f,g]=a.getRectInCurrentCoords(t.rect,l);return a.x=u/o,a.y=d/l,a.width=f/o,a.height=g/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#F(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#_?.destroy(),this.#_=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,a,o,l]=this.getPDFRect();return[pt._round(s+(o-s)*t),pt._round(a+(l-a)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const l=this.#q.bind(this),u=this.#Y.bind(this),d=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#$.bind(this,g),{signal:d}),f.setAttribute("data-l10n-id",pt._l10nResizer[g])}}const s=this.#e[0];let a=0;for(const l of i){if(l===s)break;a++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==a){if(o<a)for(let u=0;u<a-o;u++)this.#c.append(this.#c.firstElementChild);else if(o>a)for(let u=0;u<o-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const u of i){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",pt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#q(t){pt._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#F()}#$(t){this.#p=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#p,{deltaX:t,deltaY:i,fromKeyboard:!0})}#F(){this.#v=!1,this.#H(-1),this.#j()}_stopResizingWithKeyboard(){this.#F(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#m}set isEditing(t){this.#m=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#w||=new Map;const{action:s}=t;let a=this.#w.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},pt._telemetryTimeout),this.#w.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class aw extends pt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Rp=3285377520,_i=4294901760,Vi=65535;class Ab{constructor(t){this.h1=t?t&4294967295:Rp,this.h2=t?t&4294967295:Rp}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let w=0,C=t.length;w<C;w++){const S=t.charCodeAt(w);S<=255?i[s++]=S:(i[s++]=S>>>8,i[s++]=S&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,o=s-a*4,l=new Uint32Array(i.buffer,0,a);let u=0,d=0,f=this.h1,g=this.h2;const b=3432918353,y=461845907,A=b&Vi,x=y&Vi;for(let w=0;w<a;w++)w&1?(u=l[w],u=u*b&_i|u*A&Vi,u=u<<15|u>>>17,u=u*y&_i|u*x&Vi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=l[w],d=d*b&_i|d*A&Vi,d=d<<15|d>>>17,d=d*y&_i|d*x&Vi,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,o){case 3:u^=i[a*4+2]<<16;case 2:u^=i[a*4+1]<<8;case 1:u^=i[a*4],u=u*b&_i|u*A&Vi,u=u<<15|u>>>17,u=u*y&_i|u*x&Vi,a&1?f^=u:g^=u}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&_i|t*36045&Vi,i=i*4283543511&_i|((i<<16|t>>>16)*2950163797&_i)>>>16,t^=i>>>1,t=t*444984403&_i|t*60499&Vi,i=i*3301882366&_i|((i<<16|t>>>16)*3120437893&_i)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const Nh=Object.freeze({map:null,hash:"",transfer:void 0});class qh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof pt&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof pt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let a=!1;if(s!==void 0)for(const[o,l]of Object.entries(i))s[o]!==l&&(a=!0,s[o]=l);else a=!0,this.#i.set(t,i);a&&this.#a(),i instanceof pt&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new wb(this)}get serializable(){if(this.#i.size===0)return Nh;const t=new Map,i=new Ab,s=[],a=Object.create(null);let o=!1;for(const[l,u]of this.#i){const d=u instanceof pt?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(l,d),i.update(`${l}:${JSON.stringify(d)}`),o||=!!d.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:Nh}get editorStats(){let t=null;const i=new Map;let s=0,a=0;for(const o of this.#i.values()){if(!(o instanceof pt)){o.popup&&(o.popup.deleted?a+=1:s+=1);continue}o.isCommentDeleted?a+=1:o.hasEditedComment&&(s+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:u}=l;i.has(u)||i.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,g]of Object.entries(l)){if(f==="type")continue;let b=d.get(f);b||(b=new Map,d.set(f,b));const y=b.get(g)??0;b.set(g,y+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[o,l]of i)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class wb extends qh{#t;constructor(t){super();const{map:i,hash:s,transfer:a}=t.serializable,o=structuredClone(i,a?{transfer:a}:null);this.#t={map:o,hash:s,transfer:a}}get print(){Ht("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return xt(this,"modifiedIds",{ids:new Set,hash:""})}}class rw{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Ut(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:o,style:l}=t,u=new FontFace(a,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{wt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ht("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw wt(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return xt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return xt(this,"isSyncFontLoadingSupported",He||we.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Ut(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:i,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(D,R){return D.charCodeAt(R)<<24|D.charCodeAt(R+1)<<16|D.charCodeAt(R+2)<<8|D.charCodeAt(R+3)&255}function a(D,R,k,F){const j=D.substring(0,R),Y=D.substring(R+k);return j+F+Y}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function g(D,R){if(++f>30){wt("Load test font never loaded."),R();return}if(d.font="30px "+D,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(g.bind(null,D,R))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=a(y,976,b.length,b);const x=16,w=1482184792;let C=s(y,x);for(o=0,l=b.length-3;o<l;o+=4)C=C-w+s(b,o)|0;o<b.length&&(C=C-w+s(b+"XXX",o)|0),y=a(y,x,4,UA(C));const S=`url(data:font/opentype;base64,${btoa(y)});`,M=`@font-face {font-family:"${b}";src:${S}}`;this.insertRule(M);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const D of[t.loadedName,b]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=D,_.append(R)}this._document.body.append(_),g(b,()=>{_.remove(),i.complete()})}}class ow{#t;constructor(t,i=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let a;try{a=t.get(s)}catch(l){wt(`getPathGenerator - ignoring character: "${l}".`)}const o=yb(a?.path);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){xt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){xt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class ba{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let a=0;for(const f of ba.strings){const g=i.encode(t[f]);s[f]=g,a+=4+g.length}const o=new ArrayBuffer(a),l=new Uint8Array(o),u=new DataView(o);let d=0;for(const f of ba.strings){const g=s[f],b=g.length;u.setUint32(d,b),l.set(g,d+4),d+=4+b}return Ut(d===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Ut(t<ba.strings.length,"Invalid string index");let i=0;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ya{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let a=0;for(const y of ya.strings){const A=i.encode(t[y]);s[y]=A,a+=4+A.length}a+=4;let o,l,u=1+a;t.style&&(o=i.encode(t.style.style),l=i.encode(t.style.weight),u+=4+o.length+4+l.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let b=0;g.setUint8(b++,t.guessFallback?1:0),g.setUint32(b,0),b+=4,a=0;for(const y of ya.strings){const A=s[y],x=A.length;a+=4+x,g.setUint32(b,x),f.set(A,b+4),b+=4+x}return g.setUint32(b-a-4,a),t.style&&(g.setUint32(b,o.length),f.set(o,b+4),b+=4+o.length,g.setUint32(b,l.length),f.set(l,b+4),b+=4+l.length),Ut(b<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(b)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Ut(t<ya.strings.length,"Invalid string index");let i=5;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const a=this.#e.getUint32(t),o=this.#n.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:o}}}class $t{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#a=this.#i+1+6;#r;#s;#o;constructor({data:t,extra:i}){this.#r=t,this.#s=new TextDecoder,this.#o=new DataView(this.#r),i&&Object.assign(this,i)}#c(t){Ut(t<$t.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(i)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Ut(t<$t.numbers.length,"Invalid number index"),this.#o.getFloat64($t.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=$t.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=$t.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=$t.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Ut(t<$t.strings.length,"Invalid string index");let i=$t.#a+4;for(let o=0;o<t;o++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,i+4,s)),this.#s.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#r,t+4,o)}clearData(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const o=new Uint8Array(a);return o.set(new Uint8Array(this.#r,t+4,a)),new ba(o.buffer)}get systemFontInfo(){let t=$t.#a;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,t+4,s)),new ya(a.buffer)}static write(t){const i=t.systemFontInfo?ya.write(t.systemFontInfo):null,s=t.cssFontInfo?ba.write(t.cssFontInfo):null,a=new TextEncoder,o={};let l=0;for(const w of $t.strings)o[w]=a.encode(t[w]),l+=4+o[w].length;const u=$t.#a+4+l+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let b=0;const y=$t.bools.length;let A=0,x=0;for(let w=0;w<y;w++){const C=t[$t.bools[w]];A|=(C===void 0?0:C?2:1)<<x,x+=2,(x===8||w===y-1)&&(g.setUint8(b++,A),A=0,x=0)}Ut(b===$t.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of $t.numbers)g.setFloat64(b,t[w]),b+=8;if(Ut(b===$t.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(b++,4);for(const w of t.bbox)g.setInt16(b,w,!0),b+=2}else g.setUint8(b++,0),b+=8;if(Ut(b===$t.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(b++,6);for(const w of t.fontMatrix)g.setFloat64(b,w,!0),b+=8}else g.setUint8(b++,0),b+=48;if(Ut(b===$t.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(b++,1);for(const w of t.defaultVMetrics)g.setInt16(b,w,!0),b+=2}else g.setUint8(b++,0),b+=6;Ut(b===$t.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32($t.#a,0),b+=4;for(const w of $t.strings){const C=o[w],S=C.length;g.setUint32(b,S),f.set(C,b+4),b+=4+S}if(g.setUint32($t.#a,b-$t.#a-4),!i)g.setUint32(b,0),b+=4;else{const w=i.byteLength;g.setUint32(b,w),Ut(b+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),b+4),b+=4+w}if(!s)g.setUint32(b,0),b+=4;else{const w=s.byteLength;g.setUint32(b,w),Ut(b+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),b+4),b+=4+w}return t.data===void 0?(g.setUint32(b,0),b+=4):(g.setUint32(b,t.data.length),f.set(t.data,b+4),b+=4+t.data.length),Ut(b<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(b)}}class Ee{static#t=0;static#e=1;static#n=2;static#i=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,a=[],o=[],l=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],l=t[3],i===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,d=t[1],a=t[2],o=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const g=Math.floor(a.length/2),b=Math.floor(o.length/3),y=l.length,A=u.length;let x=0;for(const R of u)x+=1,x=Math.ceil(x/4)*4,x+=4+R.coords.length*4,x+=4+R.colors.length*4,R.verticesPerRow!==void 0&&(x+=4);const w=20+g*8+b*3+y*8+(s?16:0)+(f?3:0)+x,C=new ArrayBuffer(w),S=new DataView(C),M=new Uint8Array(C);S.setUint8(Ee.#t,i),S.setUint8(Ee.#e,s?1:0),S.setUint8(Ee.#n,f?1:0),S.setUint8(Ee.#i,d),S.setUint32(Ee.#a,g,!0),S.setUint32(Ee.#r,b,!0),S.setUint32(Ee.#s,y,!0),S.setUint32(Ee.#o,A,!0);let _=20;new Float32Array(C,_,g*2).set(a),_+=g*8,M.set(o,_),_+=b*3;for(const[R,k]of l)S.setFloat32(_,R,!0),_+=4,S.setUint32(_,parseInt(k.slice(1),16),!0),_+=4;if(s)for(const R of s)S.setFloat32(_,R,!0),_+=4;f&&(M.set(f,_),_+=3);for(let R=0;R<u.length;R++){const k=u[R];S.setUint8(_,k.type),_+=1,_=Math.ceil(_/4)*4,S.setUint32(_,k.coords.length,!0),_+=4,new Int32Array(C,_,k.coords.length).set(k.coords),_+=k.coords.length*4,S.setUint32(_,k.colors.length,!0),_+=4,new Int32Array(C,_,k.colors.length).set(k.colors),_+=k.colors.length*4,k.verticesPerRow!==void 0&&(S.setUint32(_,k.verticesPerRow,!0),_+=4)}return C}getIR(){const t=this.view,i=this.data[Ee.#t],s=!!this.data[Ee.#e],a=!!this.data[Ee.#n],o=t.getUint32(Ee.#a,!0),l=t.getUint32(Ee.#r,!0),u=t.getUint32(Ee.#s,!0),d=t.getUint32(Ee.#o,!0);let f=20;const g=new Float32Array(this.buffer,f,o*2);f+=o*8;const b=new Uint8Array(this.buffer,f,l*3);f+=l*3;const y=[];for(let C=0;C<u;++C){const S=t.getFloat32(f,!0);f+=4;const M=t.getUint32(f,!0);f+=4,y.push([S,`#${M.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let C=0;C<4;++C)A.push(t.getFloat32(f,!0)),f+=4}let x=null;a&&(x=new Uint8Array(this.buffer,f,3),f+=3);const w=[];for(let C=0;C<d;++C){const S=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const M=t.getUint32(f,!0);f+=4;const _=new Int32Array(this.buffer,f,M);f+=M*4;const D=t.getUint32(f,!0);f+=4;const R=new Int32Array(this.buffer,f,D);f+=D*4;const k={type:S,coords:_,colors:R};S===Ch.LATTICE&&(k.verticesPerRow=t.getUint32(f,!0),f+=4),w.push(k)}if(i===1)return["RadialAxial","axial",A,y,Array.from(g.slice(0,2)),Array.from(g.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,y,[g[0],g[1]],[g[3],g[4]],g[2],g[5]];if(i===3){const C=this.data[Ee.#i];let S=null;if(g.length>0){let M=g[0],_=g[0],D=g[1],R=g[1];for(let k=0;k<g.length;k+=2){const F=g[k],j=g[k+1];M=M>F?F:M,D=D>j?j:D,_=_<F?F:_,R=R<j?j:R}S=[M,D,_,R]}return["Mesh",C,g,b,w,S,A,x]}throw new Error(`Unsupported pattern kind: ${i}`)}}class lw{static write(t){let i,s;return we.isFloat16ArraySupported?(s=new ArrayBuffer(t.length*2),i=new Float16Array(s)):(s=new ArrayBuffer(t.length*4),i=new Float32Array(s)),i.set(t),s}#t;constructor(t){this.#t=t}get path(){return we.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function cw(h){if(h instanceof URL)return h.href;if(typeof h=="string"){if(He)return h;const t=URL.parse(h,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function uw(h){if(He&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return kl(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h?.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function sl(h){if(typeof h!="string")return null;if(h.endsWith("/"))return h;throw new Error(`Invalid factory url: "${h}" must include trailing slash.`)}const Rh=h=>typeof h=="object"&&Number.isInteger(h?.num)&&h.num>=0&&Number.isInteger(h?.gen)&&h.gen>=0,hw=h=>typeof h=="object"&&typeof h?.name=="string",dw=YA.bind(null,Rh,hw);class fw{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,i,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){wt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,i);a=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(i,a)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const al={DATA:1,ERROR:2},be={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Lp(){}function Je(h){if(h instanceof Xn||h instanceof _h||h instanceof Tp||h instanceof vl||h instanceof gh)return h;switch(h instanceof Error||typeof h=="object"&&h!==null||Ht('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new Xn(h.message);case"InvalidPDFException":return new _h(h.message);case"PasswordException":return new Tp(h.message,h.code);case"ResponseException":return new vl(h.message,h.status,h.missing);case"UnknownErrorException":return new gh(h.message,h.details)}return new gh(h.message,h.toString())}class Cr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===al.DATA)a.resolve(t.data);else if(t.callback===al.ERROR)a.reject(Je(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,o=this.comObj;Promise.try(i,t.data).then(function(l){o.postMessage({sourceName:s,targetName:a,callback:al.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:a,callback:al.ERROR,callbackId:t.callbackId,reason:Je(l)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const a=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[a]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:i},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,i,s,a){const o=this.streamId++,l=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:i,desiredSize:f.desiredSize},a),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,d.postMessage({sourceName:l,targetName:u,stream:be.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Ut(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,d.postMessage({sourceName:l,targetName:u,stream:be.CANCEL,streamId:o,reason:Je(f)}),g.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],d={enqueue(f,g=1,b){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=g,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:a,stream:be.ENQUEUE,streamId:i,chunk:f},b)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:be.CLOSE,streamId:i}),delete l.streamSinks[i])},error(f){Ut(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:be.ERROR,streamId:i,reason:Je(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[i]=d,Promise.try(u,t.data,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:be.START_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:be.START_COMPLETE,streamId:i,reason:Je(f)})})}#i(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case be.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Je(t.reason));break;case be.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Je(t.reason));break;case be.PULL:if(!u){o.postMessage({sourceName:s,targetName:a,stream:be.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Lp).then(function(){o.postMessage({sourceName:s,targetName:a,stream:be.PULL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:be.PULL_COMPLETE,streamId:i,reason:Je(f)})});break;case be.ENQUEUE:if(Ut(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case be.CLOSE:if(Ut(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,i);break;case be.ERROR:Ut(l,"error should have stream controller"),l.controller.error(Je(t.reason)),this.#a(l,i);break;case be.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Je(t.reason)),this.#a(l,i);break;case be.CANCEL:if(!u)break;const d=Je(t.reason);Promise.try(u.onCancel||Lp,d).then(function(){o.postMessage({sourceName:s,targetName:a,stream:be.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:a,stream:be.CANCEL_COMPLETE,streamId:i,reason:Je(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#a(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class xb{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Ht("Abstract method `_createCanvas` called.")}}class mw extends xb{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class Sb{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Op extends Sb{async _fetch(t){const i=await Or(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):kl(i)}}class Eb{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,a,o){return"none"}destroy(t=!1){}}class gw extends Eb{#t;#e;#n;#i;#a;#r;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#a=i}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#n){const t=this.#a.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#a.createElementNS(fn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#a.createElementNS(fn,"defs"),t.append(s),s.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let b=0;b<256;b++)f[b]=d[b]/255;const g=f.join(",");return[g,g,g]}const[i,s,a]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let d=0;d<256;d++)o[d]=i[d]/255,l[d]=s[d]/255,u[d]=a[d]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#a.URL;i!==this.#a.baseURI&&(Dl(i)?wt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=mb(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,a,o]=this.#d(t),l=t.length===1?s:`${s}${a}${o}`;if(i=this.#o.get(l),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(l,d);const f=this.#g(u);return this.#m(s,a,o,f),d}addHCMFilter(t,i){const s=`${t}-${i}`,a="base";let o=this.#c.get(a);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(a,o)),!t||!i))return o.url;const l=this.#v(t);t=nt.makeHexColor(...l);const u=this.#v(i);if(i=nt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const d=new Array(256);for(let A=0;A<=255;A++){const x=A/255;d[A]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=d.join(","),g=`g_${this.#i}_hcm_filter`,b=o.filter=this.#g(g);this.#m(f,f,f,b),this.#p(b);const y=(A,x)=>{const w=l[A]/255,C=u[A]/255,S=new Array(x+1);for(let M=0;M<=x;M++)S[M]=w+M/x*(C-w);return S.join(",")};return this.#m(y(0,5),y(1,5),y(2,5),b),o.url=this.#h(g),o.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),a=`alpha_${s}`;if(i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_alpha_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#b(s,u),l}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_luminosity_map_${this.#s++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#f(u),t&&this.#b(s,u),l}addHighlightHCMFilter(t,i,s,a,o){const l=`${i}-${s}-${a}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[d,f]=[i,s].map(this.#v.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),b=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,A]=[a,o].map(this.#v.bind(this));b<g&&([g,b,y,A]=[b,g,A,y]),this.#l.style.color="";const x=(S,M,_)=>{const D=new Array(256),R=(b-g)/_,k=S/255,F=(M-S)/(255*_);let j=0;for(let Y=0;Y<=_;Y++){const X=Math.round(g+Y*R),Q=k+Y*F;for(let it=j;it<=X;it++)D[it]=Q;j=X+1}for(let Y=j;Y<256;Y++)D[Y]=D[j-1];return D.join(",")},w=`g_${this.#i}_hcm_${t}_filter`,C=u.filter=this.#g(w);return this.#p(C),this.#m(x(y[0],A[0],5),x(y[1],A[1],5),x(y[2],A[2],5),C),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(t){const i=this.#a.createElementNS(fn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#p(t){const i=this.#a.createElementNS(fn,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#a.createElementNS(fn,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const a=this.#a.createElementNS(fn,i);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#m(t,i,s,a){const o=this.#a.createElementNS(fn,"feComponentTransfer");a.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",i),this.#u(o,"feFuncB",s)}#b(t,i){const s=this.#a.createElementNS(fn,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,Fr(getComputedStyle(this.#l).getPropertyValue("color"))}}class Tb{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Bp extends Tb{async _fetch(t){const i=await Or(t,"arraybuffer");return new Uint8Array(i)}}class Cb{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Fp extends Cb{async _fetch(t){const i=await Or(t,"arraybuffer");return new Uint8Array(i)}}He&&wt("Please use the `legacy` build in Node.js environments.");async function $h(h){const i=await process.getBuiltinModule("fs").promises.readFile(h);return new Uint8Array(i)}class pw extends Eb{}class bw extends xb{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class yw extends Sb{async _fetch(t){return $h(t)}}class vw extends Tb{async _fetch(t){return $h(t)}}class Aw extends Cb{async _fetch(t){return $h(t)}}const ra="__forcedDependency",{floor:zp,ceil:jp}=Math;function rl(h,t,i,s,a,o){h[t*4+0]=Math.min(h[t*4+0],i),h[t*4+1]=Math.min(h[t*4+1],s),h[t*4+2]=Math.max(h[t*4+2],a),h[t*4+3]=Math.max(h[t*4+3],o)}const Lh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class ww{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Lh}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const ol=(h,t)=>{if(!h)return;let i=h.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},h.set(t,i)),i};class xw{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[ra]:[]};#n=new Map;#i=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#p;#g;#u;#m;constructor(t,i,s=!1){this.#f=t.width,this.#p=t.height,this.#b(i),s&&(this.#m=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#b(t,this.#u)}#b(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Lh,i.length)):this.#u.fill(Lh)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[ra]:{__proto__:this.#e[ra]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(ol(this.#m,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(ol(this.#m,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const i=this.#a.pop();return i!==void 0&&(ol(this.#m,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#r.push(nt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(ra,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(ra,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,a,o,l){const u=nt.multiplyByDOMMatrix(this.#r.at(-1),i.getTransform()),d=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([s,o,a,l],u,d);const f=nt.intersect(this.#s,d);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,a,o,l){const u=this.#s;if(u[0]===1/0)return this;const d=nt.multiplyByDOMMatrix(this.#r.at(-1),i.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([s,o,a,l],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([s,o,a,l],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,a=1,o=0,l=0,u){const d=s.bbox;let f,g;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(s),f!==!1&&(g=[0,0,0,0],nt.axialAlignedBoundingBox(d,s.fontMatrix,g),(a!==1||o!==0||l!==0)&&nt.scaleMinMax([a,0,0,-a,o,l],g),f)))return this.recordBBox(t,i,g[0],g[2],g[1],g[3]);if(!u)return this.recordFullPageBBox(t);const b=u();return d&&g&&f===void 0&&(f=g[0]<=o-b.actualBoundingBoxLeft&&g[2]>=o+b.actualBoundingBoxRight&&g[1]<=l-b.actualBoundingBoxAscent&&g[3]>=l+b.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,g[0],g[2],g[1],g[3]):this.recordBBox(t,i,o-b.actualBoundingBoxLeft,o+b.actualBoundingBoxRight,l-b.actualBoundingBoxAscent,l+b.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#p,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,a=this.#t,o=this.#e;for(const l of i)l in this.#t?s.add(a[l]):l in o&&o[l].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[ra]),this.#m){const s=ol(this.#m,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#i.forEach(a.add,a),this.#a.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=zp(this.#o[0]*256/this.#f),a=zp(this.#o[1]*256/this.#p),o=jp(this.#o[2]*256/this.#f),l=jp(this.#o[3]*256/this.#p);rl(this.#g,t,s,a,o,l);for(const u of this.#l)u!==t&&rl(this.#g,u,s,a,o,l);for(const u of this.#i)u!==t&&rl(this.#g,u,s,a,o,l);for(const u of this.#a)u!==t&&rl(this.#g,u,s,a,o,l);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new ww(this.#u,this.#g)}takeDebugMetadata(){return this.#m}}class Al{#t;#e;#n;#i=0;#a=0;constructor(t,i,s){if(t instanceof Al&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,a,o,l){return this.#n||this.#t.recordClipBox(this.#e,i,s,a,o,l),this}recordBBox(t,i,s,a,o,l){return this.#n||this.#t.recordBBox(this.#e,i,s,a,o,l),this}recordCharacterBBox(t,i,s,a,o,l,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,a,o,l,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Mi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Be={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Oh(h,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],i,s),h.clip(a)}class Kh{isModifyingCurrentTransform(){return!1}getPattern(){Ht("Abstract method `getPattern` called.")}}class Sw extends Kh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,i=null){let s,a=this._p0,o=this._p1;if(i&&(a=a.slice(),o=o.slice(),nt.applyTransform(a,i),nt.applyTransform(o,i)),this._type==="axial")s=t.createLinearGradient(a[0],a[1],o[0],o[1]);else if(this._type==="radial"){let l=this._r0,u=this._r1;if(i){const d=new Float32Array(2);nt.singularValueDecompose2dScale(i,d),l*=d[0],u*=d[0]}s=t.createRadialGradient(a[0],a[1],l,o[0],o[1],u)}for(const l of this._colorStops)s.addColorStop(l[0],l[1]);return s}getPattern(t,i,s,a){let o;if(a===Be.STROKE||a===Be.FILL){if(this.isOriginBased()){let y=nt.transform(s,i.baseTransform);this.matrix&&(y=nt.transform(y,this.matrix));const A=.001,x=Math.hypot(y[0],y[1]),w=Math.hypot(y[2],y[3]),C=(y[0]*y[2]+y[1]*y[3])/(x*w);if(Math.abs(C)<A)if(this.isRadial()){if(Math.abs(x-w)<A)return this._createGradient(t,y)}else return this._createGradient(t,y)}const l=i.current.getClippedPathBoundingBox(a,se(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,d),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),s=nt.transform(s,[1,0,0,1,l[0],l[1]]),g.transform(...i.baseTransform),this.matrix&&g.transform(...this.matrix),Oh(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=t.createPattern(f.canvas,"no-repeat");const b=new DOMMatrix(s);o.setTransform(b)}else Oh(t,this._bbox),o=this._createGradient(t);return o}}function yh(h,t,i,s,a,o,l,u){const d=t.coords,f=t.colors,g=h.data,b=h.width*4;let y;d[i+1]>d[s+1]&&(y=i,i=s,s=y,y=o,o=l,l=y),d[s+1]>d[a+1]&&(y=s,s=a,a=y,y=l,l=u,u=y),d[i+1]>d[s+1]&&(y=i,i=s,s=y,y=o,o=l,l=y);const A=(d[i]+t.offsetX)*t.scaleX,x=(d[i+1]+t.offsetY)*t.scaleY,w=(d[s]+t.offsetX)*t.scaleX,C=(d[s+1]+t.offsetY)*t.scaleY,S=(d[a]+t.offsetX)*t.scaleX,M=(d[a+1]+t.offsetY)*t.scaleY;if(x>=M)return;const _=f[o],D=f[o+1],R=f[o+2],k=f[l],F=f[l+1],j=f[l+2],Y=f[u],X=f[u+1],Q=f[u+2],it=Math.round(x),lt=Math.round(M);let et,st,B,H,J,ft,At,L;for(let G=it;G<=lt;G++){if(G<C){const mt=G<x?0:(x-G)/(x-C);et=A-(A-w)*mt,st=_-(_-k)*mt,B=D-(D-F)*mt,H=R-(R-j)*mt}else{let mt;G>M?mt=1:C===M?mt=0:mt=(C-G)/(C-M),et=w-(w-S)*mt,st=k-(k-Y)*mt,B=F-(F-X)*mt,H=j-(j-Q)*mt}let q;G<x?q=0:G>M?q=1:q=(x-G)/(x-M),J=A-(A-S)*q,ft=_-(_-Y)*q,At=D-(D-X)*q,L=R-(R-Q)*q;const tt=Math.round(Math.min(et,J)),ht=Math.round(Math.max(et,J));let bt=b*G+tt*4;for(let mt=tt;mt<=ht;mt++)q=(et-mt)/(et-J),q<0?q=0:q>1&&(q=1),g[bt++]=st-(st-ft)*q|0,g[bt++]=B-(B-At)*q|0,g[bt++]=H-(H-L)*q|0,g[bt++]=255}}function Ew(h,t,i){const s=t.coords,a=t.colors;let o,l;switch(t.type){case Ch.LATTICE:const u=t.verticesPerRow,d=Math.floor(s.length/u)-1,f=u-1;for(o=0;o<d;o++){let g=o*u;for(let b=0;b<f;b++,g++)yh(h,i,s[g],s[g+1],s[g+u],a[g],a[g+1],a[g+u]),yh(h,i,s[g+u+1],s[g+1],s[g+u],a[g+u+1],a[g+1],a[g+u])}break;case Ch.TRIANGLES:for(o=0,l=s.length;o<l;o+=3)yh(h,i,s[o],s[o+1],s[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class Tw extends Kh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-d,b=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),A=f/b,x=g/y,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/x},C=b+4,S=y+4,M=s.getCanvas("mesh",C,S),_=M.context,D=_.createImageData(b,y);if(i){const k=D.data;for(let F=0,j=k.length;F<j;F+=4)k[F]=i[0],k[F+1]=i[1],k[F+2]=i[2],k[F+3]=255}for(const k of this._figures)Ew(D,k,w);return _.putImageData(D,2,2),{canvas:M.canvas,offsetX:u-2*A,offsetY:d-2*x,scaleX:A,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,a){Oh(t,this._bbox);const o=new Float32Array(2);if(a===Be.SHADING)nt.singularValueDecompose2dScale(se(t),o);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,o);const[u,d]=o;nt.singularValueDecompose2dScale(i.baseTransform,o),o[0]*=u,o[1]*=d}else nt.singularValueDecompose2dScale(i.baseTransform,o);const l=this._createMeshCanvas(o,a===Be.SHADING?null:this._background,i.cachedCanvases);return a!==Be.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class Cw extends Kh{getPattern(){return"hotpink"}}function _w(h){switch(h[0]){case"RadialAxial":return new Sw(h);case"Mesh":return new Tw(h);case"Dummy":return new Cw}throw new Error(`Unknown IR type: ${h[0]}`)}const Pp={COLORED:1,UNCOLORED:2};class Wh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,i){const{bbox:s,operatorList:a,paintType:o,tilingType:l,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),Ml("TilingType: "+l);const b=s[0],y=s[1],A=s[2],x=s[3],w=A-b,C=x-y,S=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,S);const[M,_]=S;nt.singularValueDecompose2dScale(this.baseTransform,S);const D=M*S[0],R=_*S[1];let k=w,F=C,j=!1,Y=!1;const X=Math.ceil(f*D),Q=Math.ceil(g*R),it=Math.ceil(w*D),lt=Math.ceil(C*R);X>=it?k=f:j=!0,Q>=lt?F=g:Y=!0;const et=this.getSizeAndScale(k,this.ctx.canvas.width,D),st=this.getSizeAndScale(F,this.ctx.canvas.height,R),B=t.cachedCanvases.getCanvas("pattern",et.size,st.size),H=B.context,J=d.createCanvasGraphics(H,i);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,o,u),H.translate(-et.scale*b,-st.scale*y),J.transform(0,et.scale,0,0,st.scale,0,0),H.save(),J.dependencyTracker?.save(),this.clipBbox(J,b,y,A,x),J.baseTransform=se(J.ctx),J.executeOperatorList(a),J.endDrawing(),J.dependencyTracker?.restore(),H.restore(),j||Y){const ft=B.canvas;j&&(k=f),Y&&(F=g);const At=this.getSizeAndScale(k,this.ctx.canvas.width,D),L=this.getSizeAndScale(F,this.ctx.canvas.height,R),G=At.size,q=L.size,tt=t.cachedCanvases.getCanvas("pattern-workaround",G,q),ht=tt.context,bt=j?Math.floor(w/f):0,mt=Y?Math.floor(C/g):0;for(let Qt=0;Qt<=bt;Qt++)for(let Ot=0;Ot<=mt;Ot++)ht.drawImage(ft,G*Qt,q*Ot,G,q,0,0,G,q);return{canvas:tt.canvas,scaleX:At.scale,scaleY:L.scale,offsetX:b,offsetY:y}}return{canvas:B.canvas,scaleX:et.scale,scaleY:st.scale,offsetX:b,offsetY:y}}getSizeAndScale(t,i,s){const a=Math.max(Wh.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=a?o=a:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,a,o){const l=a-i,u=o-s;t.ctx.rect(i,s,l,u),nt.axialAlignedBoundingBox([i,s,a,o],se(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const a=t.ctx,o=t.current;switch(i){case Pp.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;a.fillStyle=o.fillColor=l,a.strokeStyle=o.strokeColor=u;break;case Pp.UNCOLORED:a.fillStyle=a.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new PA(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,a,o){let l=s;a!==Be.SHADING&&(l=nt.transform(l,i.baseTransform),this.matrix&&(l=nt.transform(l,this.matrix)));const u=this.createPatternCanvas(i,o);let d=new DOMMatrix(l);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function Mw({src:h,srcPos:t=0,dest:i,width:s,height:a,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=we.isLittleEndian?4278190080:255,[d,f]=l?[o,u]:[u,o],g=s>>3,b=s&7,y=h.length;i=new Uint32Array(i.buffer);let A=0;for(let x=0;x<a;x++){for(const C=t+g;t<C;t++){const S=t<y?h[t]:255;i[A++]=S&128?f:d,i[A++]=S&64?f:d,i[A++]=S&32?f:d,i[A++]=S&16?f:d,i[A++]=S&8?f:d,i[A++]=S&4?f:d,i[A++]=S&2?f:d,i[A++]=S&1?f:d}if(b===0)continue;const w=t<y?h[t++]:255;for(let C=0;C<b;C++)i[A++]=w&1<<7-C?f:d}return{srcPos:t,destPos:A}}const Ip=16,Up=100,kw=15,Hp=10,ti=16,vh=new DOMMatrix,mi=new Float32Array(2),ma=new Float32Array([1/0,1/0,-1/0,-1/0]);function Dw(h,t){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){t.save(),this.__originalSave()},h.restore=function(){t.restore(),this.__originalRestore()},h.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},h.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},h.transform=function(i,s,a,o,l,u){t.transform(i,s,a,o,l,u),this.__originalTransform(i,s,a,o,l,u)},h.setTransform=function(i,s,a,o,l,u){t.setTransform(i,s,a,o,l,u),this.__originalSetTransform(i,s,a,o,l,u)},h.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},h.rotate=function(i){t.rotate(i),this.__originalRotate(i)},h.clip=function(i){t.clip(i),this.__originalClip(i)},h.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},h.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},h.bezierCurveTo=function(i,s,a,o,l,u){t.bezierCurveTo(i,s,a,o,l,u),this.__originalBezierCurveTo(i,s,a,o,l,u)},h.rect=function(i,s,a,o){t.rect(i,s,a,o),this.__originalRect(i,s,a,o)},h.closePath=function(){t.closePath(),this.__originalClosePath()},h.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Nw{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,i,s)):(a=this.canvasFactory.create(i,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function ll(h,t,i,s,a,o,l,u,d,f){const[g,b,y,A,x,w]=se(h);if(b===0&&y===0){const M=l*g+x,_=Math.round(M),D=u*A+w,R=Math.round(D),k=(l+d)*g+x,F=Math.abs(Math.round(k)-_)||1,j=(u+f)*A+w,Y=Math.abs(Math.round(j)-R)||1;return h.setTransform(Math.sign(g),0,0,Math.sign(A),_,R),h.drawImage(t,i,s,a,o,0,0,F,Y),h.setTransform(g,b,y,A,x,w),[F,Y]}if(g===0&&A===0){const M=u*y+x,_=Math.round(M),D=l*b+w,R=Math.round(D),k=(u+f)*y+x,F=Math.abs(Math.round(k)-_)||1,j=(l+d)*b+w,Y=Math.abs(Math.round(j)-R)||1;return h.setTransform(0,Math.sign(b),Math.sign(y),0,_,R),h.drawImage(t,i,s,a,o,0,0,Y,F),h.setTransform(g,b,y,A,x,w),[Y,F]}h.drawImage(t,i,s,a,o,l,u,d,f);const C=Math.hypot(g,b),S=Math.hypot(y,A);return[C*d,S*f]}class Gp{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Th;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ae.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=ma.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Be.FILL,i=null){const s=this.minMax.slice();if(t===Be.STROKE){i||Ht("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(i,mi);const a=mi[0]*this.lineWidth/2,o=mi[1]*this.lineWidth/2;s[0]-=a,s[1]-=o,s[2]+=a,s[3]+=o}return s}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ma,0)}getClippedPathBoundingBox(t=Be.FILL,i=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function Vp(h,t){if(t instanceof ImageData){h.putImageData(t,0,0);return}const i=t.height,s=t.width,a=i%ti,o=(i-a)/ti,l=a===0?o:o+1,u=h.createImageData(s,ti);let d=0,f;const g=t.data,b=u.data;let y,A,x,w;if(t.kind===ml.GRAYSCALE_1BPP){const C=g.byteLength,S=new Uint32Array(b.buffer,0,b.byteLength>>2),M=S.length,_=s+7>>3,D=4294967295,R=we.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(x=y<o?ti:a,f=0,A=0;A<x;A++){const k=C-d;let F=0;const j=k>_?s:k*8-7,Y=j&-8;let X=0,Q=0;for(;F<Y;F+=8)Q=g[d++],S[f++]=Q&128?D:R,S[f++]=Q&64?D:R,S[f++]=Q&32?D:R,S[f++]=Q&16?D:R,S[f++]=Q&8?D:R,S[f++]=Q&4?D:R,S[f++]=Q&2?D:R,S[f++]=Q&1?D:R;for(;F<j;F++)X===0&&(Q=g[d++],X=128),S[f++]=Q&X?D:R,X>>=1}for(;f<M;)S[f++]=0;h.putImageData(u,0,y*ti)}}else if(t.kind===ml.RGBA_32BPP){for(A=0,w=s*ti*4,y=0;y<o;y++)b.set(g.subarray(d,d+w)),d+=w,h.putImageData(u,0,A),A+=ti;y<l&&(w=s*a*4,b.set(g.subarray(d,d+w)),h.putImageData(u,0,A))}else if(t.kind===ml.RGB_24BPP)for(x=ti,w=s*x,y=0;y<l;y++){for(y>=o&&(x=a,w=s*x),f=0,A=w;A--;)b[f++]=g[d++],b[f++]=g[d++],b[f++]=g[d++],b[f++]=255;h.putImageData(u,0,y*ti)}else throw new Error(`bad image kind: ${t.kind}`)}function Xp(h,t){if(t.bitmap){h.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,a=i%ti,o=(i-a)/ti,l=a===0?o:o+1,u=h.createImageData(s,ti);let d=0;const f=t.data,g=u.data;for(let b=0;b<l;b++){const y=b<o?ti:a;({srcPos:d}=Mw({src:f,srcPos:d,dest:g,width:s,height:y,nonBlackColor:0})),h.putImageData(u,0,b*ti)}}function wr(h,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)h[s]!==void 0&&(t[s]=h[s]);h.setLineDash!==void 0&&(t.setLineDash(h.getLineDash()),t.lineDashOffset=h.lineDashOffset)}function cl(h){h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0);const{filter:t}=h;t!=="none"&&t!==""&&(h.filter="none")}function Yp(h,t){if(t)return!0;nt.singularValueDecompose2dScale(h,mi);const i=Math.fround(qi.pixelRatio*xa.PDF_TO_CSS_UNITS);return mi[0]<=i&&mi[1]<=i}const Rw=["butt","round","square"],Lw=["miter","round","bevel"],Ow={},qp={};class va{constructor(t,i,s,a,o,{optionalContentConfig:l,markedContentStack:u=null},d,f,g){this.ctx=t,this.current=new Gp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=a,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new Nw(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:a=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...se(this.compositeCtx))}this.ctx.save(),cl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=se(this.ctx)}executeOperatorList(t,i,s,a,o){const l=t.argsArray,u=t.fnArray;let d=i||0;const f=l.length;if(f===d)return d;const g=f-d>Hp&&typeof s=="function",b=g?Date.now()+kw:0;let y=0;const A=this.commonObjs,x=this.objs;let w,C;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,s),d;if(!o||o(d))if(w=u[d],C=l[d]??null,w!==Dr.dependency)C===null?this[w](d):this[w](d,...C);else for(const S of C){this.dependencyTracker?.recordNamedData(S,d);const M=S.startsWith("g_")?A:x;if(!M.has(S))return M.get(S,s),d}if(d++,d===f)return d;if(g&&++y>Hp){if(Date.now()>b)return s(),d;y=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),l=Math.max(Math.hypot(i[2],i[3]),1),u=s,d=a,f="prescale1",g,b;for(;o>2&&u>1||l>2&&d>1;){let y=u,A=d;o>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/y),l>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/A),g=this.cachedCanvases.getCanvas(f,y,A),b=g.context,b.clearRect(0,0,y,A),b.drawImage(t,0,0,u,d,0,0,y,A),t=g.canvas,u=y,d=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,i){const s=this.ctx,{width:a,height:o}=i,l=this.current.fillColor,u=this.current.patternFill,d=se(s);let f,g,b,y;if((i.bitmap||i.data)&&i.count>1){const X=i.bitmap||i.data.buffer;g=JSON.stringify(u?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get(X),f||(f=new Map,this._cachedBitmapsMap.set(X,f));const Q=f.get(g);if(Q&&!u){const it=Math.round(Math.min(d[0],d[2])+d[4]),lt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Mi.transformAndFill),{canvas:Q,offsetX:it,offsetY:lt}}b=Q}b||(y=this.cachedCanvases.getCanvas("maskCanvas",a,o),Xp(y.context,i));let A=nt.transform(d,[1/a,0,0,-1/o,0,0]);A=nt.transform(A,[1,0,0,1,0,-o]);const x=ma.slice();nt.axialAlignedBoundingBox([0,0,a,o],A,x);const[w,C,S,M]=x,_=Math.round(S-w)||1,D=Math.round(M-C)||1,R=this.cachedCanvases.getCanvas("fillCanvas",_,D),k=R.context,F=w,j=C;k.translate(-F,-j),k.transform(...A),b||(b=this._scaleImage(y.canvas,Gi(k)),b=b.img,f&&u&&f.set(g,b)),k.imageSmoothingEnabled=Yp(se(k),i.interpolate),ll(k,b,0,0,b.width,b.height,0,0,a,o),k.globalCompositeOperation="source-in";const Y=nt.transform(Gi(k),[1,0,0,1,-F,-j]);return k.fillStyle=u?l.getPattern(s,this,Y,Be.FILL,t):l,k.fillRect(0,0,a,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,R.canvas)),this.dependencyTracker?.recordDependencies(t,Mi.transformAndFill),{canvas:R.canvas,offsetX:Math.round(F),offsetY:Math.round(j)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Rw[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Lw[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,a]of i)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(a,i,s);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),wr(this.suspendedCtx,l),Dw(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),wr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,a){const o=a[0],l=a[1],u=a[2]-o,d=a[3]-l;u===0||d===0||(this.genericComposeSMask(i.context,s,u,d,i.subtype,i.backdrop,i.transferMap,o,l,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,a,o,l,u,d,f,g,b){let y=t.canvas,A=d-g,x=f-b;if(l)if(A<0||x<0||A+s>y.width||x+a>y.height){const C=this.cachedCanvases.getCanvas("maskExtension",s,a),S=C.context;S.drawImage(y,-A,-x),S.globalCompositeOperation="destination-atop",S.fillStyle=l,S.fillRect(0,0,s,a),S.globalCompositeOperation="source-over",y=C.canvas,A=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,x,s,a),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(A,x,s,a),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,f,s,a),i.clip(w),i.globalCompositeOperation="destination-in",i.drawImage(y,A,x,s,a,d,f,s,a),i.restore()}save(t){this.inSMaskMode&&wr(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&wr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,a,o,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,a,o,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,a){let[o]=s;if(!a){o||=s[0]=new Path2D,this[i](t,o);return}if(this.dependencyTracker!==null){const l=i===Dr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-l,a[2]+l,a[1]-l,a[3]+l).recordDependencies(t,["transform"])}o instanceof Path2D||(o=s[0]=yb(o)),nt.axialAlignedBoundingBox(a,se(this.ctx),this.current.minMax),this[i](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const a=this.ctx,o=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=o.getPattern(a,this,Gi(a),Be.STROKE,t),l){const u=new Path2D;u.addPath(i,a.getTransform().invertSelf().multiplySelf(l)),i=u}this.rescaleAndStroke(i,!1),a.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,Mi.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(Be.STROKE,se(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const a=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const f=o.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=o.getPattern(a,this,Gi(a),Be.FILL,t),f){const g=new Path2D;g.addPath(i,a.getTransform().invertSelf().multiplySelf(f)),i=g}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(i,"evenodd"),this.pendingEOFill=!1):a.fill(i)),this.dependencyTracker?.recordDependencies(t,Mi.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,d)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,Mi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Ow}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=qp}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;i!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(i!==void 0){const a=new Path2D,o=s.getTransform().invertSelf();for(const{transform:l,x:u,y:d,fontSize:f,path:g}of i)g&&a.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(u,d).scale(f,-f));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const a=this.commonObjs.get(i),o=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=a.fontMatrix||Th,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&wt("Invalid font matrix for font "+i),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${l}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let g=s;s<Ip?g=Ip:s>Up&&(g=Up),this.current.fontSizeScale=s/g,this.ctx.font=`${f} ${d} ${g}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),a}paintChar(t,i,s,a,o,l){const u=this.ctx,d=this.current,f=d.font,g=d.textRenderingMode,b=d.fontSize/d.fontSizeScale,y=g&Ae.FILL_STROKE_MASK,A=!!(g&Ae.ADD_TO_PATH_FLAG),x=d.patternFill&&!f.missingFile,w=d.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||A||x||w)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,i)),C&&(f.disableFontFace||x||w)){u.save(),u.translate(s,a),u.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(t,u,f);let S;if(y===Ae.FILL||y===Ae.FILL_STROKE)if(o){S=u.getTransform(),u.setTransform(...o);const M=this.#n(C,S,o);u.fill(M)}else u.fill(C);if(y===Ae.STROKE||y===Ae.FILL_STROKE)if(l){S||=u.getTransform(),u.setTransform(...l);const{a:M,b:_,c:D,d:R}=S,k=nt.inverseTransform(l),F=nt.transform([M,_,D,R,0,0],k);nt.singularValueDecompose2dScale(F,mi),u.lineWidth*=Math.max(mi[0],mi[1])/b,u.stroke(this.#n(C,S,l))}else u.lineWidth/=b,u.stroke(C);u.restore()}else(y===Ae.FILL||y===Ae.FILL_STROKE)&&(u.fillText(i,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,a,()=>u.measureText(i))),(y===Ae.STROKE||y===Ae.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,a,()=>u.measureText(i)).recordDependencies(t,Mi.stroke),u.strokeText(i,s,a));A&&((this.pendingTextPaths||=[]).push({transform:se(u),x:s,y:a,fontSize:b,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<i.length;a+=4)if(i[a]>0&&i[a]<255){s=!0;break}return xt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Mi.showText).resetBBox(t),this.current.textRenderingMode&Ae.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=s.fontSizeScale,d=s.charSpacing,f=s.wordSpacing,g=s.fontDirection,b=s.textHScale*g,y=i.length,A=a.vertical,x=A?1:-1,w=a.defaultVMetrics,C=o*s.fontMatrix[0],S=s.textRenderingMode===Ae.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),g>0?l.scale(b,-1):l.scale(b,1);let M,_;const D=s.textRenderingMode&Ae.FILL_STROKE_MASK,R=D===Ae.FILL||D===Ae.FILL_STROKE,k=D===Ae.STROKE||D===Ae.FILL_STROKE;if(R&&s.patternFill){l.save();const Q=s.fillColor.getPattern(l,this,Gi(l),Be.FILL,t);M=se(l),l.restore(),l.fillStyle=Q}if(k&&s.patternStroke){l.save();const Q=s.strokeColor.getPattern(l,this,Gi(l),Be.STROKE,t);_=se(l),l.restore(),l.strokeStyle=Q}let F=s.lineWidth;const j=s.textMatrixScale;if(j===0||F===0?k&&(F=this.getSinglePixelWidth()):F/=j,u!==1&&(l.scale(u,u),F/=u),l.lineWidth=F,a.isInvalidPDFjsFont){const Q=[];let it=0;for(const et of i)Q.push(et.unicode),it+=et.width;const lt=Q.join("");if(l.fillText(lt,0,0),this.dependencyTracker!==null){const et=l.measureText(lt);this.dependencyTracker.recordBBox(t,this.ctx,-et.actualBoundingBoxLeft,et.actualBoundingBoxRight,-et.actualBoundingBoxAscent,et.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=it*C*b,l.restore(),this.compose();return}let Y=0,X;for(X=0;X<y;++X){const Q=i[X];if(typeof Q=="number"){Y+=x*Q*o/1e3;continue}let it=!1;const lt=(Q.isSpace?f:0)+d,et=Q.fontChar,st=Q.accent;let B,H,J=Q.width;if(A){const L=Q.vmetric||w,G=-(Q.vmetric?L[1]:J*.5)*C,q=L[2]*C;J=L?-L[0]:J,B=G/u,H=(Y+q)/u}else B=Y/u,H=0;let ft;if(a.remeasure&&J>0){ft=l.measureText(et);const L=ft.width*1e3/o*u;if(J<L&&this.isFontSubpixelAAEnabled){const G=J/L;it=!0,l.save(),l.scale(G,1),B/=G}else J!==L&&(B+=(J-L)/2e3*o/u)}if(this.contentVisible&&(Q.isInFont||a.missingFile)){if(S&&!st)l.fillText(et,B,H),this.dependencyTracker?.recordCharacterBBox(t,l,ft?{bbox:null}:a,o/u,B,H,()=>ft??l.measureText(et));else if(this.paintChar(t,et,B,H,M,_),st){const L=B+o*st.offset.x/u,G=H-o*st.offset.y/u;this.paintChar(t,st.fontChar,L,G,M,_)}}const At=A?J*C-lt*g:J*C+lt*g;Y+=At,it&&l.restore()}A?s.y-=Y:s.x+=Y*b,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,a=this.current,o=a.font,l=a.fontSize,u=a.fontDirection,d=o.vertical?1:-1,f=a.charSpacing,g=a.wordSpacing,b=a.textHScale*u,y=a.fontMatrix||Th,A=i.length,x=a.textRenderingMode===Ae.INVISIBLE;let w,C,S,M;if(x||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(b,u);const _=this.dependencyTracker;for(this.dependencyTracker=_?new Al(_,t):null,w=0;w<A;++w){if(C=i[w],typeof C=="number"){M=d*C*l/1e3,this.ctx.translate(M,0),a.x+=M*b;continue}const D=(C.isSpace?g:0)+f,R=o.charProcOperatorList[C.operatorListId];R?this.contentVisible&&(this.save(),s.scale(l,l),s.transform(...y),this.executeOperatorList(R),this.restore()):wt(`Type3 character "${C.operatorListId}" is not available.`);const k=[C.width,0];nt.applyTransform(k,y),S=k[0]*l+D,s.translate(S,0),a.x+=S*b}s.restore(),_&&(this.dependencyTracker=_)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,a,o,l,u){const d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,l,o,u).recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const a=this.baseTransform||se(this.ctx),o={createCanvasGraphics:(l,u)=>new va(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Al(this.dependencyTracker,u,!0):null)};s=new Wh(i,this.ctx,o,a)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=_w(this.getObject(t,i)),this.cachedPatterns.set(i,a)),s&&(a.matrix=s),a}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,i);s.fillStyle=a.getPattern(s,this,Gi(s),Be.SHADING,t);const o=Gi(s);if(o){const{width:l,height:u}=s.canvas,d=ma.slice();nt.axialAlignedBoundingBox([0,0,l,u],o,d);const[f,g,b,y]=d;this.ctx.fillRect(f,g,b-f,y-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Mi.transform).recordDependencies(t,Mi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ht("Should not call beginInlineImage")}beginImageData(){Ht("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=se(this.ctx),s)){nt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,o,l,u]=s,d=new Path2D;d.rect(a,o,l-a,u-o),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||Ml("TODO: Support non-isolated groups."),i.knockout&&wt("Knockout groups not supported.");const a=se(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=ma.slice();nt.axialAlignedBoundingBox(i.bbox,se(s),o);const l=[0,0,s.canvas.width,s.canvas.height];o=nt.intersect(o,l)||[0,0,0,0];const u=Math.floor(o[0]),d=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),g=Math.max(Math.ceil(o[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,g]);let b="groupAt"+this.groupLevel;i.smask&&(b+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(b,f,g),A=y.context;A.translate(-u,-d),A.transform(...a);let x=new Path2D;const[w,C,S,M]=i.bbox;if(x.rect(w,C,S-w,M-C),i.matrix){const _=new Path2D;_.addPath(x,new DOMMatrix(i.matrix)),x=_}A.clip(x),i.smask&&this.smaskStack.push({canvas:y.canvas,context:A,offsetX:u,offsetY:d,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),wr(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=se(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=ma.slice();nt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,i,s,a,o,l){if(this.#t(),cl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,nt.singularValueDecompose2dScale(se(this.ctx),mi);const{viewportScale:f}=this,g=Math.ceil(u*this.outputScaleX*f),b=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,b);const{canvas:y,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(mi[0],0,0,-mi[1],0,d*mi[1]),cl(this.ctx)}else{cl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,d),this.ctx.clip(f)}}this.current=new Gp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const a=this.ctx,o=this._createMaskCanvas(t,i),l=o.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,a=0,o=0,l,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const d=this.ctx;d.save();const f=se(d);d.transform(s,a,o,l,0,0);const g=this._createMaskCanvas(t,i);d.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let b=0,y=u.length;b<y;b+=2){const A=nt.transform(f,[s,a,o,l,u[b],u[b+1]]);d.drawImage(g.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+g.canvas.width,A[5],A[5]+g.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Mi.transformAndFill);for(const l of i){const{data:u,width:d,height:f,transform:g}=l,b=this.cachedCanvases.getCanvas("maskCanvas",d,f),y=b.context;y.save();const A=this.getObject(t,u,l);Xp(y,A),y.globalCompositeOperation="source-in",y.fillStyle=o?a.getPattern(y,this,Gi(s),Be.FILL,t):a,y.fillRect(0,0,d,f),y.restore(),s.save(),s.transform(...g),s.scale(1,-1),ll(s,b.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){wt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,a,o){if(!this.contentVisible)return;const l=this.getObject(t,i);if(!l){wt("Dependent image isn't ready yet");return}const u=l.width,d=l.height,f=[];for(let g=0,b=o.length;g<b;g+=2)f.push({transform:[s,0,0,a,o[g],o[g+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:a}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,a),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(i,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,a=i.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/s,-1/a);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const g=this.cachedCanvases.getCanvas("inlineImage",s,a).context;Vp(g,i),u=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(u,Gi(o));o.imageSmoothingEnabled=Yp(se(o),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-a,0).recordDependencies(t,Mi.imageXObject).recordOperation(t),ll(o,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const a=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const l=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",l,u).context;Vp(f,i),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),ll(a,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Mi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(a||(this.pendingClip===qp?o.clip(i,"evenodd"):o.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=se(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:a,d:o}=this.ctx.getTransform();let l,u;if(s===0&&a===0){const d=Math.abs(i),f=Math.abs(o);if(d===f)if(t===0)l=u=1/d;else{const g=d*t;l=u=g<1?1/g:1}else if(t===0)l=1/d,u=1/f;else{const g=d*t,b=f*t;l=g<1?1/g:1,u=b<1?1/b:1}}else{const d=Math.abs(i*o-s*a),f=Math.hypot(i,s),g=Math.hypot(a,o);if(t===0)l=g/d,u=f/d;else{const b=t*d;l=g>b?g/b:1,u=f>b?f/b:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:a}}=this,[o,l]=this.getScaleForStroking();if(o===l){s.lineWidth=(a||1)*o,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(o,l),vh.a=1/o,vh.d=1/l;const d=new Path2D;if(d.addPath(t,vh),u.length>0){const f=Math.max(o,l);s.setLineDash(u.map(g=>g/f)),s.lineDashOffset/=f}s.lineWidth=a||1,s.stroke(d),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const h in Dr)va.prototype[h]!==void 0&&(va.prototype[Dr[h]]=va.prototype[h]);class Aa{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Bw{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ha=Symbol("INTERNAL");class Fw{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:a,rbGroups:o}){this.#t=!!(t&di.DISPLAY),this.#e=!!(t&di.PRINT),this.name=i,this.intent=s,this.usage=a,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==ha&&Ht("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class zw{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=di.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Fw(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(ha,!1);for(const s of t.on)this.#e.get(s)._setVisible(ha,!0);for(const s of t.off)this.#e.get(s)._setVisible(ha,!1);this.#n=this.getHash()}}#a(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let a=1;a<i;a++){const o=t[a];let l;if(Array.isArray(o))l=this.#a(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return wt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Ml("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(wt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return wt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return wt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return wt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return wt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return wt(`Unknown optional content policy ${t.policy}.`),!0}return wt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const a=this.#e.get(t);if(!a){wt(`Optional content group not found: ${t}`);return}if(s&&i&&a.rbGroups.length)for(const o of a.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(ha,!1,!0);a._setVisible(ha,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const o=this.#e.get(a);if(o)switch(s){case"ON":this.setVisibility(a,!0,i);break;case"OFF":this.setVisibility(a,!1,i);break;case"Toggle":this.setVisibility(a,!o.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Ab;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Rl{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,i,s){this._source=t,this.#t=i,this.#e=s}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Ut(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new this.#e(this,t,i);return this._rangeReaders.add(s),s}cancelAllRequests(t){this._fullReader?.cancel(t);for(const i of new Set(this._rangeReaders))i.cancel(t)}}class Ll{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Ht("Abstract method `read` called")}cancel(t){Ht("Abstract method `cancel` called")}}class Ol{_stream=null;constructor(t,i,s){this._stream=t}async read(){Ht("Abstract method `read` called")}cancel(t){Ht("Abstract method `cancel` called")}}function $p(h){return h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength?h.buffer:new Uint8Array(h).buffer}class jw extends Rl{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,Pw,Iw);const{pdfDataRangeTransport:i}=t,{initialData:s,progressiveDone:a}=i;if(s?.length>0){const o=$p(s);this._queuedChunks.push(o)}this._progressiveDone=a,i.addRangeListener((o,l)=>{this.#t(o,l)}),i.addProgressListener((o,l)=>{l!==void 0&&this._fullReader?.onProgress?.({loaded:o,total:l})}),i.addProgressiveReadListener(o=>{this.#t(void 0,o)}),i.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),i.transportReady()}#t(t,i){const s=$p(i);if(t===void 0)this._fullReader?this._fullReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.keys().find(o=>o._begin===t);Ut(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(s)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onDone=()=>this._rangeReaders.delete(s),this._source.pdfDataRangeTransport.requestDataRange(t,i)),s}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class Pw extends Ll{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:i,disableRange:s,disableStream:a}=t._source,{length:o,contentDispositionFilename:l}=i;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=o,this._isStreamingSupported=!a,this._isRangeSupported=!s,Vh(l)&&(this._filename=l),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class Iw extends Ol{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,i,s){super(t,i,s),this._begin=i}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function Uw(h){let t=!0,i=s("filename\\*","i").exec(h);if(i){i=i[1];let g=u(i);return g=unescape(g),g=d(g),g=f(g),o(g)}if(i=l(h),i){const g=f(i);return o(g)}if(i=s("filename","i").exec(h),i){i=i[1];let g=u(i);return g=f(g),o(g)}function s(g,b){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function a(g,b){if(g){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const y=new TextDecoder(g,{fatal:!0}),A=kl(b);b=y.decode(A),t=!1}catch{}}return b}function o(g){return t&&/[\x80-\xff]/.test(g)&&(g=a("utf-8",g),t&&(g=a("iso-8859-1",g))),g}function l(g){const b=[];let y;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=A.exec(g))!==null;){let[,w,C,S]=y;if(w=parseInt(w,10),w in b){if(w===0)break;continue}b[w]=[C,S]}const x=[];for(let w=0;w<b.length&&w in b;++w){let[C,S]=b[w];S=u(S),C&&(S=unescape(S),w===0&&(S=d(S))),x.push(S)}return x.join("")}function u(g){if(g.startsWith('"')){const b=g.slice(1).split('\\"');for(let y=0;y<b.length;++y){const A=b[y].indexOf('"');A!==-1&&(b[y]=b[y].slice(0,A),b.length=y+1),b[y]=b[y].replaceAll(/\\(.)/g,"$1")}g=b.join('"')}return g}function d(g){const b=g.indexOf("'");if(b===-1)return g;const y=g.slice(0,b),x=g.slice(b+1).replace(/^[^']*'/,"");return a(y,x)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,y,A,x){if(A==="q"||A==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,C){return String.fromCharCode(parseInt(C,16))}),a(y,x);try{x=atob(x)}catch{}return a(y,x)})}return""}function _b(h,t){const i=new Headers;if(!h||!t||typeof t!="object")return i;for(const s in t){const a=t[s];a!==void 0&&i.append(s,a)}return i}function Bl(h){return URL.parse(h)?.origin??null}function Mb({responseHeaders:h,isHttp:t,rangeChunkSize:i,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(h.get("Content-Length"),10);return!Number.isInteger(o)||(a.suggestedLength=o,o<=2*i)||s||!t||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function kb(h){const t=h.get("Content-Disposition");if(t){let i=Uw(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(Vh(i))return i}return null}function Fl(h,t){return new vl(`Unexpected server response (${h}) while retrieving PDF "${t}".`,h,h===404||h===0&&t.startsWith("file:"))}function Db(h,t){if(h!==t)throw new Error(`Expected range response-origin "${h}" to match "${t}".`)}function Nb(h,t,i,s){return fetch(h,{method:"GET",headers:t,signal:s.signal,mode:"cors",credentials:i?"include":"same-origin",redirect:"follow"})}function Rb(h,t){if(h!==200&&h!==206)throw Fl(h,t)}function Lb(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(wt(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class Hw extends Rl{_responseOrigin=null;constructor(t){super(t,Gw,Vw),this.isHttp=/^https?:/i.test(t.url),this.headers=_b(this.isHttp,t.httpHeaders)}}class Gw extends Ll{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:i,disableStream:s,length:a,rangeChunkSize:o,url:l,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!i;const d=new Headers(t.headers);Nb(l,d,u,this._abortController).then(f=>{t._responseOrigin=Bl(f.url),Rb(f.status,l),this._reader=f.body.getReader();const g=f.headers,{allowRangeRequests:b,suggestedLength:y}=Mb({responseHeaders:g,isHttp:t.isHttp,rangeChunkSize:o,disableRange:i});this._isRangeSupported=b,this._contentLength=y||this._contentLength,this._filename=kb(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Lb(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Vw extends Ol{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,i,s){super(t,i,s);const{url:a,withCredentials:o}=t._source,l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`),Nb(a,l,o,this._abortController).then(u=>{const d=Bl(u.url);Db(d,t._responseOrigin),Rb(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:Lb(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Ah=200,Kp=206;function Xw(h){return typeof h!="string"?h:kl(h).buffer}class Yw extends Rl{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,qw,$w),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=_b(this.isHttp,t.httpHeaders)}_request(t){const i=new XMLHttpRequest,s={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(i,s),i.open("GET",this.url),i.withCredentials=this._source.withCredentials;for(const[a,o]of this.headers)i.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.validateStatus=a=>a===Kp||a===Ah):s.validateStatus=a=>a===Ah,i.responseType="arraybuffer",Ut(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>t.onError(i.status),i.onreadystatechange=this.#n.bind(this,i),i.onprogress=this.#e.bind(this,i),i.send(null),i}#e(t,i){this.#t.get(t)?.onProgress?.(i)}#n(t,i){const s=this.#t.get(t);if(!s||(t.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){s.onError(t.status);return}const a=t.status||Ah;if(!s.validateStatus(a)){s.onError(t.status);return}const o=Xw(t.response);if(a===Kp){const l=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(l)?s.onDone(o):(wt('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone(o):s.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onClosed=()=>this._rangeReaders.delete(s)),s}}class qw extends Ll{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:i}=t._source;this._contentLength=i,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#n.bind(this),onProgress:this.#i.bind(this)})}#t(){const t=this._stream,{disableRange:i,rangeChunkSize:s}=t._source,a=this._fullRequestXhr;t._responseOrigin=Bl(a.responseURL);const o=a.getAllResponseHeaders(),l=new Headers(o?o.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[g,...b]=f.split(": ");return[g,b.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=Mb({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:s,disableRange:i});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=kb(l),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}#n(t){this._storedError=Fl(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#i(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class $w extends Ol{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,i,s){super(t,i,s),this._requestXhr=t._request({begin:i,end:s,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#n.bind(this),onProgress:null})}#t(){const t=Bl(this._requestXhr?.responseURL);try{Db(t,this._stream._responseOrigin)}catch(i){this._storedError=i,this.#n(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#n(t){this._storedError??=Fl(t,this._stream.url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const Kw=/^[a-z][a-z0-9\-+.]+:/i;function Ww(h){if(Kw.test(h))return new URL(h);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(h))}function Ob(h){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(h):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(h)}function Bb(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(wt(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class Qw extends Rl{constructor(t){super(t,Zw,Jw),this.url=Ww(t.url),Ut(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class Zw extends Ll{_reader=null;constructor(t){super(t);const{disableRange:i,disableStream:s,length:a,rangeChunkSize:o}=t._source;this._contentLength=a,this._isStreamingSupported=!s,this._isRangeSupported=!i;const l=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(l).then(d=>{const f=u.createReadStream(l),g=Ob(f);this._reader=g.getReader();const{size:b}=d;b<=2*o&&(this._isRangeSupported=!1),this._contentLength=b,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=Fl(0,l.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Bb(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class Jw extends Ol{_readCapability=Promise.withResolvers();_reader=null;constructor(t,i,s){super(t,i,s);const a=t.url,o=process.getBuiltinModule("fs");try{const l=o.createReadStream(a,{start:i,end:s-1}),u=Ob(l);this._reader=u.getReader(),this._readCapability.resolve()}catch(l){this._readCapability.reject(l)}}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:Bb(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const xr=Symbol("INITIAL_DATA");class Fb{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:xr}}get(t,i=null){if(i){const a=this.#e(t);return a.promise.then(()=>i(a.data)),null}const s=this.#t[t];if(!s||s.data===xr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==xr}delete(t){const i=this.#t[t];return!i||i.data===xr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==xr&&(yield[t,i])}}}const tx=1e5,Wp=30;class fi{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#p=[];#g=null;#u=[];#m=new WeakMap;#b=null;static#v=new Map;static#y=new Map;static#T=new WeakMap;static#S=null;static#w=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*qi.pixelRatio,this.#d=s.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#b=[1,0,0,-1,-l,u+o],this.#o=a,this.#s=o,fi.#k(),i.style.setProperty("--min-font-size",fi.#S),gs(i,s),this.#t.promise.finally(()=>{fi.#w.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=we.platform;return xt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#a??=i.lang,Object.assign(this.#f,i.styles),this.#_(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),fi.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*qi.pixelRatio,a=t.rotation;if(a!==this.#d&&(i?.(),this.#d=a,gs(this.#l,{rotation:a})),s!==this.#h){i?.(),this.#h=s;const o={div:null,properties:null,ctx:fi.#D(this.#a)};for(const l of this.#u)o.properties=this.#m.get(l),o.div=l,this.#E(o)}}cancel(){const t=new Xn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#p}#_(t){if(this.#n)return;this.#r.ctx??=fi.#D(this.#a);const i=this.#u,s=this.#p;for(const a of t){if(i.length>tx){wt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),o.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#A(a)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const a=nt.transform(this.#b,t.transform);let o=Math.atan2(a[1],a[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=fi.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*fi.#z(u,l,this.#a);let g,b;o===0?(g=a[4],b=a[5]-f):(g=a[4]+f*Math.sin(o),b=a[5]-f*Math.cos(o));const y=i.style;y.left=`${(100*g/this.#o).toFixed(2)}%`,y.top=`${(100*b/this.#s).toFixed(2)}%`,y.setProperty("--font-height",`${d.toFixed(2)}px`),y.fontFamily=u,s.fontSize=d,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const x=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);x!==w&&Math.max(x,w)/Math.min(x,w)>1.5&&(A=!0)}if(A&&(s.canvasWidth=l.vertical?t.height:t.width),this.#m.set(i,s),this.#r.div=i,this.#r.properties=s,this.#E(this.#r),s.hasText&&this.#e.append(i),s.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this.#e.append(x)}}#E(t){const{div:i,properties:s,ctx:a}=t,{style:o}=i;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=o,{canvasWidth:u,fontSize:d}=s;fi.#M(a,d*this.#h,l);const{width:f}=a.measureText(i.textContent);f>0&&o.setProperty("--scale-x",u*this.#h/f)}s.angle!==0&&o.setProperty("--rotate",`${s.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#D(t=null){let i=this.#y.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,i),this.#T.set(i,{size:0,family:""})}return i}static#M(t,i,s){const a=this.#T.get(t);i===a.size&&s===a.family||(t.font=`${i}px ${s}`,a.size=i,a.family=s)}static#k(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#z(t,i,s){const a=this.#v.get(t);if(a)return a;const o=this.#D(s);o.canvas.width=o.canvas.height=Wp,this.#M(o,Wp,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return u?f=u/(u+d):(we.platform.isFirefox&&wt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const ex=100;function zb(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const t=new Qh,{docId:i}=t,s=h.url?cw(h.url):null,a=h.data?uw(h.data):null,o=h.httpHeaders||null,l=h.withCredentials===!0,u=h.password??null,d=h.range instanceof jb?h.range:null,f=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:2**16;let g=h.worker instanceof Rr?h.worker:null;const b=h.verbosity,y=typeof h.docBaseUrl=="string"&&!Dl(h.docBaseUrl)?h.docBaseUrl:null,A=sl(h.cMapUrl),x=h.cMapPacked!==!1,w=h.CMapReaderFactory||(He?yw:Op),C=sl(h.iccUrl),S=sl(h.standardFontDataUrl),M=h.StandardFontDataFactory||(He?vw:Bp),_=sl(h.wasmUrl),D=h.WasmFactory||(He?Aw:Fp),R=h.stopAtErrors!==!0,k=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,F=h.isEvalSupported!==!1,j=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!He,Y=typeof h.isImageDecoderSupported=="boolean"?h.isImageDecoderSupported:!He&&(we.platform.isFirefox||!globalThis.chrome),X=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,Q=typeof h.disableFontFace=="boolean"?h.disableFontFace:He,it=h.fontExtraProperties===!0,lt=h.enableXfa===!0,et=h.ownerDocument||globalThis.document,st=h.disableRange===!0,B=h.disableStream===!0,H=h.disableAutoFetch===!0,J=h.pdfBug===!0,ft=h.CanvasFactory||(He?bw:mw),At=h.FilterFactory||(He?pw:gw),L=h.enableHWA===!0,G=h.useWasm!==!1,q=d?d.length:h.length??NaN,tt=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!He&&!Q,ht=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:!!(w===Op&&M===Bp&&D===Fp&&A&&S&&_&&Tr(A,document.baseURI)&&Tr(S,document.baseURI)&&Tr(_,document.baseURI)),bt=null;FA(b);const mt={canvasFactory:new ft({ownerDocument:et,enableHWA:L}),filterFactory:new At({docId:i,ownerDocument:et}),cMapReaderFactory:ht?null:new w({baseUrl:A,isCompressed:x}),standardFontDataFactory:ht?null:new M({baseUrl:S}),wasmFactory:ht?null:new D({baseUrl:_})};g||(g=Rr.create({verbosity:b,port:Aa.workerPort}),t._worker=g);const Qt={docId:i,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:H,rangeChunkSize:f,length:q,docBaseUrl:y,enableXfa:lt,evaluatorOptions:{maxImageSize:k,disableFontFace:Q,ignoreErrors:R,isEvalSupported:F,isOffscreenCanvasSupported:j,isImageDecoderSupported:Y,canvasMaxAreaInBytes:X,fontExtraProperties:it,useSystemFonts:tt,useWasm:G,useWorkerFetch:ht,cMapUrl:A,iccUrl:C,standardFontDataUrl:S,wasmUrl:_}},Ot={ownerDocument:et,pdfBug:J,styleElement:bt,enableHWA:L,loadingParams:{disableAutoFetch:H,enableXfa:lt}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const gi=g.messageHandler.sendWithPromise("GetDocRequest",Qt,a?[a.buffer]:null);let de;if(d)de=new jw({pdfDataRangeTransport:d,disableRange:st,disableStream:B});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const pi=Tr(s)?Hw:He?Qw:Yw;de=new pi({url:s,length:q,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:st,disableStream:B})}return gi.then(pi=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const yt=new Cr(i,pi,g.port),Lt=new sx(yt,t,de,Ot,mt);t._transport=Lt,yt.send("Ready",null)})}).catch(t._capability.reject),t}class Qh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Qh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class jb{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,i,s=!1,a=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#a)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Ht("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class ix{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class nx{#t=!1;#e=Pt.instance;constructor(t,i,s,a=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=a?new _p:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new Fb,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}={}){return new Br({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:a="display",annotationMode:o=Hn.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:b=null,isEditing:y=!1,recordOperations:A=!1,operationsFilter:x=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(a,o,b,y),{renderingIntent:C,cacheKey:S}=w;this.#t=!1,d||=this._transport.getOptionalContentConfig(C);let M=this._intentStates.get(S);M||(M=Object.create(null),this._intentStates.set(S,M)),M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null);const _=!!(C&di.PRINT);M.displayReadyCapability||(M.displayReadyCapability=Promise.withResolvers(),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const D=!!(this._pdfBug&&globalThis.StepperManager?.enabled),R=!this.recordedBBoxes&&(A||D),k=Y=>{if(M.renderTasks.delete(F),R){const X=F.gfx?.dependencyTracker.take();X&&(F.stepper&&F.stepper.setOperatorBBoxes(X,F.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=X))}_&&(this.#t=!0),this.#n(),Y?(F.capability.reject(Y),this._abortOperatorList({intentState:M,reason:Y instanceof Error?Y:new Error(Y)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},F=new ga({callback:k,params:{canvas:i,canvasContext:t,dependencyTracker:R?new xw(i,M.operatorList.length,D):null,viewport:s,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:M.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:x});(M.renderTasks||=new Set).add(F);const j=F.task;return Promise.all([M.displayReadyCapability.promise,d]).then(([Y,X])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(X.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:Y,optionalContentConfig:X}),F.operatorListChanged()}).catch(k),j}getOperatorList({intent:t="display",annotationMode:i=Hn.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(t,i,s,a,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Nr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,a){function o(){l.read().then(function({value:d,done:f}){if(f){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),o()},a)}const l=i.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#n();return t&&i&&(this._stats&&=new _p),i}#n(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,a=t.length;s<a;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#n()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:a}){const{map:o,transfer:l}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:a},l).getReader(),f=this._intentStates.get(i);f.streamReader=d;const g=()=>{d.read().then(({value:b,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,f),g())},b=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#n()}if(f.displayReadyCapability)f.displayReadyCapability.reject(b);else if(f.opListReadCapability)f.opListReadCapability.reject(b);else throw b}})};g()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof Gh){let a=ex;i.extraDelay>0&&i.extraDelay<1e3&&(a+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},a);return}}if(t.streamReader.cancel(new Xn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,o]of this._intentStates)if(o===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Gn,Fi,gn,ds,Sl,fs,ms,Ve,gl,Pb,Ib,_r,wa,pl;const ie=class ie{constructor({name:t=null,port:i=null,verbosity:s=zA()}={}){Ui(this,Ve);Ui(this,Gn,Promise.withResolvers());Ui(this,Fi,null);Ui(this,gn,null);Ui(this,ds,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(ee(ie,ms).has(i))throw new Error("Cannot use more than one PDFWorker per port.");ee(ie,ms).set(i,this),Hi(this,Ve,Pb).call(this,i)}else Hi(this,Ve,Ib).call(this)}get promise(){return ee(this,Gn).promise}get port(){return ee(this,gn)}get messageHandler(){return ee(this,Fi)}destroy(){this.destroyed=!0,ee(this,ds)?.terminate(),Ze(this,ds,null),ee(ie,ms).delete(ee(this,gn)),Ze(this,gn,null),ee(this,Fi)?.destroy(),Ze(this,Fi,null)}static create(t){const i=ee(this,ms).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new ie(t)}static get workerSrc(){if(Aa.workerSrc)return Aa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return xt(this,"_setupFakeWorkerGlobal",(async()=>ee(this,wa,pl)?ee(this,wa,pl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gn=new WeakMap,Fi=new WeakMap,gn=new WeakMap,ds=new WeakMap,Sl=new WeakMap,fs=new WeakMap,ms=new WeakMap,Ve=new WeakSet,gl=function(){ee(this,Gn).resolve(),ee(this,Fi).send("configure",{verbosity:this.verbosity})},Pb=function(t){Ze(this,gn,t),Ze(this,Fi,new Cr("main","worker",t)),ee(this,Fi).on("ready",()=>{}),Hi(this,Ve,gl).call(this)},Ib=function(){if(ee(ie,fs)||ee(ie,wa,pl)){Hi(this,Ve,_r).call(this);return}let{workerSrc:t}=ie;try{ie._isSameOrigin(window.location,t)||(t=ie._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new Cr("main","worker",i),a=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?ee(this,Gn).reject(new Error("Worker was destroyed")):Hi(this,Ve,_r).call(this)},o=new AbortController;i.addEventListener("error",()=>{ee(this,ds)||a()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){a();return}Ze(this,Fi,s),Ze(this,gn,i),Ze(this,ds,i),Hi(this,Ve,gl).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){a();return}try{l()}catch{Hi(this,Ve,_r).call(this)}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{Ml("The worker has been disabled.")}Hi(this,Ve,_r).call(this)},_r=function(){ee(ie,fs)||(wt("Setting up fake worker."),Ze(ie,fs,!0)),ie._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){ee(this,Gn).reject(new Error("Worker was destroyed"));return}const i=new fw;Ze(this,gn,i);const s=`fake${ap(ie,Sl)._++}`,a=new Cr(s+"_worker",s,i);t.setup(a,i),Ze(this,Fi,new Cr(s,s+"_worker",i)),Hi(this,Ve,gl).call(this)}).catch(t=>{ee(this,Gn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},wa=new WeakSet,pl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ui(ie,wa),Ui(ie,Sl,0),Ui(ie,fs,!1),Ui(ie,ms,new WeakMap),He&&(Ze(ie,fs,!0),Aa.workerSrc||="./pdf.worker.mjs"),ie._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(i,s);return s.origin===a.origin},ie._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},ie.fromPort=t=>{if(KA("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return ie.create(t)};let Rr=ie;class sx{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#n=null;#i=new Map;#a=new Map;#r=new Map;#s=null;#o=Pt.instance;constructor(t,i,s,a,o){this.messageHandler=t,this.loadingTask=i,this.#n=s,this.commonObjs=new Fb,this.fontLoader=new rw({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,i=new Map;for(let s=0,a=this.#o.pagesNumber;s<a;s++){const o=this.#o.getPrevPageNumber(s+1)-1,l=this.#i.get(o);l&&t.set(s,l);const u=this.#a.get(o);u&&i.set(s,u)}this.#i=t,this.#a=i}#l(t,i=null){const s=this.#e.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,i);return this.#e.set(t,a),a}#d({loaded:t,total:i}){this.loadingTask.onProgress?.({loaded:t,total:i,percent:Oe(Math.round(t/i*100),0,100)})}get annotationStorage(){return xt(this,"annotationStorage",new qh)}getRenderingIntent(t,i=Hn.ENABLE,s=null,a=!1,o=!1){let l=di.DISPLAY,u=Nh;switch(t){case"any":l=di.ANY;break;case"display":break;case"print":l=di.PRINT;break;default:wt(`getRenderingIntent - invalid intent: ${t}`)}const d=l&di.PRINT&&s instanceof wb?s:this.annotationStorage;switch(i){case Hn.DISABLE:l+=di.ANNOTATIONS_DISABLE;break;case Hn.ENABLE:break;case Hn.ENABLE_FORMS:l+=di.ANNOTATIONS_FORMS;break;case Hn.ENABLE_STORAGE:l+=di.ANNOTATIONS_STORAGE,u=d.serializable;break;default:wt(`getRenderingIntent - invalid annotationMode: ${i}`)}a&&(l+=di.IS_EDITING),o&&(l+=di.OPLIST);const{ids:f,hash:g}=d.modifiedIds,b=[l,u.hash,g];return{renderingIntent:l,cacheKey:b.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#i.values())t.push(s._destroy());this.#i.clear(),this.#a.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),fi.cleanup(),this.#n?.cancelAllRequests(new Xn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,a)=>{Ut(this.#n,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#n.getFullReader(),this.#t.onProgress=o=>this.#d(o),a.onPull=()=>{this.#t.read().then(function({value:o,done:l}){if(l){a.close();return}Ut(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{a.error(o)})},a.onCancel=o=>{this.#t.cancel(o),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:o,contentLength:l}=this.#t;return a&&o&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,a)=>{Ut(this.#n,"GetRangeReader - no `BasePDFStream` instance available.");const o=this.#n.getRangeReader(s.begin,s.end);if(!o){a.close();return}a.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){a.close();return}Ut(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{o.cancel(l),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this.#o.pagesNumber=s.numPages,this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new ix(s,this))}),t.on("DocException",s=>{i._capability.reject(Je(s))}),t.on("PasswordRequest",s=>{this.#s=Promise.withResolvers();try{if(!i.onPassword)throw Je(s);const a=o=>{o instanceof Error?this.#s.reject(o):this.#s.resolve({password:o})};i.onPassword(a,s.code)}catch(a){this.#s.reject(a)}return this.#s.promise}),t.on("DataLoaded",s=>{this.#d({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#i.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in o){const b=o.error;wt(`Error during font loading: ${b}`),this.commonObjs.resolve(s,b);break}const l=new $t(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(b,y)=>globalThis.FontInspector.fontAdded(b,y):null,d=new ow(l,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=o;Ut(f,"The imageRef must be defined.");for(const b of this.#i.values())for(const[,y]of b.objs)if(y?.ref===f)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new lw(o));break;case"Image":this.commonObjs.resolve(s,o);break;case"Pattern":const g=new Ee(o);this.commonObjs.resolve(s,g.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,o,l])=>{if(this.destroyed)return;const u=this.#i.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||this.#d(s)}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&wt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#o.getPageId(t)-1,a=this.#a.get(i);if(a)return a;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#r.set(l.refStr,s);const u=new nx(i,l,this,this._params.pdfBug);return this.#i.set(i,u),u});return this.#a.set(i,o),o}async getPageIndex(t){if(!Rh(t))throw new Error("Invalid pageIndex request.");const i=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(i+1)-1}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:i})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(i=>new zw(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#e.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new Bw(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#i.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),fi.cleanup()}}cachedPageNumber(t){if(!Rh(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,s=this.#r.get(i);return s>=0?this.#o.getPageNumber(s+1):null}}class ax{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this._internalRenderTask;return t.form||t.canvas&&i?.size>0}}class ga{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:a,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:b=!1,pageColors:y=null,enableHWA:A=!1,operationsFilter:x=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=b,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ax(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(ga.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ga.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:o,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new va(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ga.#e.delete(this._canvas),t||=new Gh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ga.#e.delete(this._canvas),this.callback())))}}const rx="5.4.624",ox="384c6208b";class ki{#t=null;#e=null;#n;#i=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return xt(this,"_keyboardManager",new zr([[["Escape","mac+Escape"],ki.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ki.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ki.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ki.prototype._moveToPrevious],[["Home","mac+Home"],ki.prototype._moveToBeginning],[["End","mac+End"],ki.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#r=!1,this.#s=t):this.#r=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ki.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#p.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",Di,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",a),o.title=s,o.setAttribute("data-l10n-id",ki.#d[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=a,o.ariaSelected=a===this.#n,o.addEventListener("click",this.#f.bind(this,a),{signal:i}),t.append(o)}return t.addEventListener("keydown",this.#p.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Rt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#m){this.#g(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#g(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#m){this.#g(t);return}this.#i.lastElementChild?.focus()}#p(t){ki._keyboardManager.exec(this,t)}#g(t){if(this.#m){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Lr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Lr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",Lr.#i[t]),a.addEventListener("input",()=>{this.#n.updateParams(i,a.value)},{signal:this.#n._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Qp(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function Sr(h){return Math.max(0,Math.min(255,255*h))}class Zp{static CMYK_G([t,i,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Sr(t),[t,t,t]}static G_HTML([t]){const i=Qp(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(Sr)}static RGB_HTML(t){return`#${t.map(Qp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,i+a)]}static CMYK_rgb([t,i,s,a]){return[Sr(1-Math.min(1,t+a)),Sr(1-Math.min(1,s+a)),Sr(1-Math.min(1,i+a))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const a=1-t,o=1-i,l=1-s,u=Math.min(a,o,l);return["CMYK",a,o,l,u]}}class lx{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${i}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${i}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ht("Abstract method `_createSVG` called.")}}class wl extends lx{_createSVG(t){return document.createElementNS(fn,t)}}const cx=9,ps=new WeakSet,ux=new Date().getTimezoneOffset()*60*1e3;class wh{static create(t){switch(t.data.annotationType){case ye.LINK:return new Zh(t);case ye.TEXT:return new dx(t);case ye.WIDGET:switch(t.data.fieldType){case"Tx":return new fx(t);case"Btn":return t.data.radioButton?new Ub(t):t.data.checkBox?new gx(t):new px(t);case"Ch":return new bx(t);case"Sig":return new mx(t)}return new ys(t);case ye.POPUP:return new Bh(t);case ye.FREETEXT:return new Hb(t);case ye.LINE:return new vx(t);case ye.SQUARE:return new Ax(t);case ye.CIRCLE:return new wx(t);case ye.POLYLINE:return new Gb(t);case ye.CARET:return new Sx(t);case ye.INK:return new Jh(t);case ye.POLYGON:return new xx(t);case ye.HIGHLIGHT:return new Vb(t);case ye.UNDERLINE:return new Ex(t);case ye.SQUIGGLY:return new Tx(t);case ye.STRIKEOUT:return new Cx(t);case ye.STAMP:return new Xb(t);case ye.FILEATTACHMENT:return new _x(t);default:return new ae(t)}}}class ae{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ae._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:a}=this.data;let o=-1/0,l=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>l?(l=i[u+1],o=i[u+2]):i[u+1]===l&&(o=Math.max(o,i[u+2]));return[o,l]}if(s?.length>=1){for(const u of s)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>l?(l=u[d+1],o=u[d]):u[d+1]===l&&(o=Math.max(o,u[d]));if(o!==1/0)return[o,l]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-l)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${kr}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${kr}${i.id}`,{id:i.id,annotationType:i.annotationType,page:this.parent.page,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let a=this.#n?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#n.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/o}%`,i.top=`${100*(l-t[3]+d)/l}%`,a===0?(i.width=`${100*(t[2]-t[0])/o}%`,i.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(a)}_createContainer(t){const{data:i,parent:{page:s,viewport:a}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),!(this instanceof ys)&&!(this instanceof Zh)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof Bh){const{rotation:w}=i;return!i.hasOwnCanvas&&w!==0&&this.setRotation(w,o),o}const{width:u,height:d}=this;if(!t&&i.borderStyle.width>0){l.borderWidth=`${i.borderStyle.width}px`;const w=i.borderStyle.horizontalCornerRadius,C=i.borderStyle.verticalCornerRadius;if(w>0||C>0){const M=`calc(${w}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;l.borderRadius=M}else if(this instanceof Ub){const M=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;l.borderRadius=M}switch(i.borderStyle.style){case ua.SOLID:l.borderStyle="solid";break;case ua.DASHED:l.borderStyle="dashed";break;case ua.BEVELED:wt("Unimplemented border style: beveled");break;case ua.INSET:wt("Unimplemented border style: inset");break;case ua.UNDERLINE:l.borderBottomStyle="solid";break}const S=i.borderColor||null;S?(this.#e=!0,l.borderColor=nt.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):l.borderWidth=0}const f=nt.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:g,pageHeight:b,pageX:y,pageY:A}=a.rawDims;l.left=`${100*(f[0]-y)/g}%`,l.top=`${100*(f[1]-A)/b}%`;const{rotation:x}=i;return i.hasOwnCanvas||x===0?(l.width=`${100*u/g}%`,l.height=`${100*d/b}%`):this.setRotation(x,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),i.style.width=`${100*o/s}%`,i.style.height=`${100*l/a}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,a)=>{const o=a.detail[i],l=o[0],u=o.slice(1);a.target.style[s]=Zp[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:Zp[`${l}_rgb`](u)})};return xt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const a of Object.keys(i.detail))(t[a]||s[a])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[a,o]of Object.entries(i)){const l=s[a];if(l){const u={detail:{[a]:o},target:t};l(u),delete i[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,a,o]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,C,S,M]=t.subarray(2,6);if(a===w&&o===C&&i===S&&s===M)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:C}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const d=a-i,f=o-s,{svgFactory:g}=this,b=g.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const y=g.createElement("defs");b.append(y);const A=g.createElement("clipPath"),x=`clippath_${this.data.id}`;A.setAttribute("id",x),A.setAttribute("clipPathUnits","objectBoundingBox"),y.append(A);for(let w=2,C=t.length;w<C;w+=8){const S=t[w],M=t[w+1],_=t[w+2],D=t[w+3],R=g.createElement("rect"),k=(_-i)/d,F=(o-M)/f,j=(S-_)/d,Y=(M-D)/f;R.setAttribute("x",k),R.setAttribute("y",F),R.setAttribute("width",j),R.setAttribute("height",Y),A.append(R),u?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${F}" width="${j}" height="${Y}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(b),this.container.style.clipPath=`url(#${x})`}_createPopup(t=null){const{data:i}=this;let s,a;t?(s={str:t.text},a=t.date):(s=i.contentsObj,a=i.modificationDate),this.#n=new Bh({data:{color:i.color,titleObj:i.titleObj,modificationDate:a,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Ht("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:o,id:l,exportValues:u}of a){if(o===-1||l===i)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!ps.has(f)){wt(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:d,domElement:f})}return s}for(const a of document.getElementsByName(t)){const{exportValue:o}=a,l=a.getAttribute("data-element-id");l!==i&&ps.has(a)&&s.push({id:l,exportValue:o,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class hx extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Zh extends ae{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",a=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,a),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(i.actions)){const o=s.get(a);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:a}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){wt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:o,include:l}=i,u=[];if(a.length!==0||o.length!==0){const g=new Set(o);for(const b of a){const y=this._fieldObjects[b]||[];for(const{id:A}of y)g.add(A)}for(const b of Object.values(this._fieldObjects))for(const y of b)g.has(y.id)===l&&u.push(y)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const d=this.annotationStorage,f=[];for(const g of u){const{id:b}=g;switch(f.push(b),g.type){case"text":{const A=g.defaultValue||"";d.setValue(b,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;d.setValue(b,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";d.setValue(b,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${b}"]`);if(y){if(!ps.has(y)){wt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class dx extends ae{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ys extends ae{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return we.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,a,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!i.focused||!l.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l)}})})}_setEventListeners(t,i,s,a){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,o,l,a),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":nt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||cx,o=t.style;let l;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(f/(mh*a))||1,b=f/g;l=Math.min(a,d(b/mh))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(a,d(f/mh))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=nt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class fx extends ys{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,a){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[i]=s),o.setValue(l.id,{[a]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(i,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ps.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:b}=this.data,y=!!g&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",x=>{t.setValue(i,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",x=>{const w=this.data.defaultFieldValue??"";s.value=d.userValue=w,d.formattedValue=null});let A=x=>{const{formattedValue:w}=d;w!=null&&(x.target.value=w),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",w=>{if(d.focused)return;const{target:C}=w;if(y&&(C.type=g,b&&(C.step=b)),d.userValue){const S=d.userValue;if(y)if(g==="time"){const M=new Date(S),_=[M.getHours(),M.getMinutes(),M.getSeconds()];C.value=_.map(D=>D.toString().padStart(2,"0")).join(":")}else C.value=new Date(S-ux).toISOString().split(g==="date"?"T":".",1)[0];else C.value=S}d.lastCommittedValue=C.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const C={value(S){d.userValue=S.detail.value??"",y||t.setValue(i,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:M}=S.detail;d.formattedValue=M,M!=null&&S.target!==document.activeElement&&(S.target.value=M);const _={formattedValue:M};y&&(_.value=M),t.setValue(i,_)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{const{charLimit:M}=S.detail,{target:_}=S;if(M===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",M);let D=d.userValue;!D||D.length<=M||(D=D.slice(0,M),_.value=d.userValue=D,t.setValue(i,{value:D}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(C,w)}),s.addEventListener("keydown",w=>{d.commitKey=1;let C=-1;if(w.key==="Escape"?C=0:w.key==="Enter"&&!this.data.multiLine?C=2:w.key==="Tab"&&(d.commitKey=3),C===-1)return;const{value:S}=w.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:C,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const x=A;A=null,s.addEventListener("blur",w=>{if(!d.focused||!w.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:C}=w;let{value:S}=C;if(y){if(S&&g==="time"){const M=S.split(":").map(_=>parseInt(_,10));S=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),C.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();C.type="text"}d.userValue=S,d.lastCommittedValue!==S&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),x(w)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",w=>{d.lastCommittedValue=null;const{data:C,target:S}=w,{value:M,selectionStart:_,selectionEnd:D}=S;let R=_,k=D;switch(w.inputType){case"deleteWordBackward":{const F=M.substring(0,_).match(/\w*[^\w]*$/);F&&(R-=F[0].length);break}case"deleteWordForward":{const F=M.substring(_).match(/^[^\w]*\w*/);F&&(k+=F[0].length);break}case"deleteContentBackward":_===D&&(R-=1);break;case"deleteContentForward":_===D&&(k+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:M,change:C||"",willCommit:!1,selStart:R,selEnd:k}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class mx extends ys{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class gx extends ys{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return ps.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s)){const g=d&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue||"Off";l.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Ub extends ys{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof a=="string"&&(a=a!==i.buttonValue,t.setValue(s,{value:a})),a)for(const l of this._getElementsByName(i.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(ps.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:d})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue;l.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const l=i.buttonValue;o.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const g=l===f.detail.value;for(const b of this._getElementsByName(f.target.name)){const y=g&&b.id===s;b.domElement&&(b.domElement.checked=y),t.setValue(b.id,{value:y})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class px extends Zh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class bx extends ys{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),a=document.createElement("select");ps.add(a),a.setAttribute("data-element-id",i),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",g=>{const b=this.data.defaultFieldValue;for(const y of a.options)y.selected=y.value===b});for(const g of this.data.options){const b=document.createElement("option");b.textContent=g.displayValue,b.value=g.exportValue,s.value.includes(g.exportValue)&&(b.setAttribute("selected",!0),o=!1),a.append(b)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),a.prepend(g),l=()=>{g.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const u=g=>{const b=g?"value":"textContent",{options:y,multiple:A}=a;return A?Array.prototype.filter.call(y,x=>x.selected).map(x=>x[b]):y.selectedIndex===-1?null:y[y.selectedIndex][b]};let d=u(!1);const f=g=>{const b=g.target.options;return Array.prototype.map.call(b,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",g=>{const b={value(y){l?.();const A=y.detail.value,x=new Set(Array.isArray(A)?A:[A]);for(const w of a.options)w.selected=x.has(w.value);t.setValue(i,{value:u(!0)}),d=u(!1)},multipleSelection(y){a.multiple=!0},remove(y){const A=a.options,x=y.detail.remove;A[x].selected=!1,a.remove(x),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),d=u(!1)},clear(y){for(;a.length!==0;)a.remove(0);t.setValue(i,{value:null,items:[]}),d=u(!1)},insert(y){const{index:A,displayValue:x,exportValue:w}=y.detail.insert,C=a.children[A],S=document.createElement("option");S.textContent=x,S.value=w,C?C.before(S):a.append(S),t.setValue(i,{value:u(!0),items:f(y)}),d=u(!1)},items(y){const{items:A}=y.detail;for(;a.length!==0;)a.remove(0);for(const x of A){const{displayValue:w,exportValue:C}=x,S=document.createElement("option");S.textContent=w,S.value=C,a.append(S)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),d=u(!1)},indices(y){const A=new Set(y.detail.indices);for(const x of y.target.options)x.selected=A.has(x.index);t.setValue(i,{value:u(!0)}),d=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(b,g)}),a.addEventListener("input",g=>{const b=u(!0),y=u(!1);t.setValue(i,{value:b}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:d,change:y,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):a.addEventListener("input",function(g){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Bh extends ae{constructor(t){const{data:i,elements:s,parent:a}=t,o=!!a._commentManager;if(super(t,{isRenderable:!o&&ae._hasPopupData(i)}),this.elements=s,o&&ae._hasPopupData(i)){const l=this.popup=this.#t();for(const u of s)u.popup=l}else this.popup=null}#t(){return new yx({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=i,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${fa}${a}`).join(",")),this.container}}class yx{#t=null;#e=this.#V.bind(this);#n=this.#P.bind(this);#i=this.#L.bind(this);#a=this.#x.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#p=null;#g=null;#u=null;#m=null;#b=null;#v=null;#y=null;#T=null;#S=null;#w=null;#_=!1;#A=null;#E=null;constructor({container:t,color:i,elements:s,titleObj:a,modificationDate:o,contentsObj:l,richText:u,parent:d,rect:f,parentRect:g,open:b,commentManager:y=null}){this.#s=t,this.#S=a,this.#o=l,this.#T=u,this.#d=d,this.#r=i,this.#y=f,this.#h=g,this.#l=s,this.#t=y,this.#A=s[0],this.#c=Mh.toDateObject(o),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),y||(this.#D(),this.#s.hidden=!0,b&&this.#x())}#D(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#a,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#m){this.#m.parentNode||this.#A.container.after(this.#m);return}if(this.#b||this.#M(),!this.#b)return;const{signal:t}=this.#g=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#m=this.#A.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#m=document.createElement("button");l.className="annotationCommentButton";const u=this.#A.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#k(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),u.after(l)}}#k(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#m||this.renderCommentButton();const[t,i]=this.#b,{style:s}=this.#m;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#z(){this.#A.extraPopupElement||(this.#m||this.renderCommentButton(),this.#m.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#m?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}}get elementBeforePopup(){return this.#m}get comment(){return this.#E||=this.#A.commentText,this.#E}set comment(t){t!==this.comment&&(this.#A.commentText=this.#E=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#m&&(this.#m.classList.toggle("selected",t),this.#m.ariaExpanded=i)}setSelectedCommentButton(t){this.#m.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#m.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#A.layer.getBoundingClientRect();return[(t-a)/l,(i+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#b}get commentButtonWidth(){return this.#m.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:o,y:l,width:u,height:d}=a;this.#t.showDialog(null,this,o+i*u,l+s*d,{...t,parentDimensions:a})}render(){if(this.#p)return;const t=this.#p=document.createElement("div");if(t.className="popup",this.#r){const s=t.style.outlineColor=nt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#S?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#S}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}bb({html:this.#R||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#R(){const t=this.#T,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#T.html||null}get#O(){return this.#R?.attributes?.style?.fontSize||0}get#j(){return this.#R?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},a={style:{color:this.#j,fontSize:this.#O?`calc(${this.#O}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:a});return s}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#x()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):i&&(i.deleted?this.remove():(this.#z(),this.#E=i.text)),t&&(this.#b=null,this.#M(),this.#k());return}if(s||i?.deleted){this.remove();return}this.#D(),this.#w||={contentsObj:this.#o,richText:this.#T},t&&(this.#u=null),i&&i.text&&(this.#T=this.#B(i.text),this.#c=Mh.toDateObject(i.date),this.#o=null),this.#p?.remove(),this.#p=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#T}=this.#w,this.#w=null,this.#p?.remove(),this.#p=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#p?.remove(),this.#p=null,this.#_=!1,this.#f=!1,this.#m?.remove(),this.#m=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#y;for(const x of this.#l)if(!u||nt.intersect(x.data.rect,u)!==null){u=x.data.rect,l=!0;break}const d=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=l?u[2]-u[0]+5:0,b=d[0]+g,y=d[1];this.#u=[100*(b-a)/i,100*(y-o)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#x(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#e)):(this.#P(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#p||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#C(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#P(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#_&&(this.#p||this.#L(),this.#_=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Hb extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Et.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class vx extends ae{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),a.append(o),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ax extends ae{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",i-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class wx extends ae{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",i/2),l.setAttribute("cy",s/2),l.setAttribute("rx",i/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gb extends ae{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:a},width:o,height:l}=this;if(!i)return this.container;const u=this.svgFactory.create(o,l,!0);let d=[];for(let g=0,b=i.length;g<b;g+=2){const y=i[g]-t[0],A=t[3]-i[g+1];d.push(`${y},${A}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class xx extends Gb{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Sx extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Jh extends ae{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Et.HIGHLIGHT:Et.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:a,popupRef:o}}=this,{transform:l,width:u,height:d}=this.#n(i,t),f=this.svgFactory.create(u,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",a.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let b=0,y=s.length;b<y;b++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[b].join(",")),g.append(A)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:a}=t,o=this.#t;if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(a){const{transform:l,width:u,height:d}=this.#n(this.data.rotation,a);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Vb extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Et.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Ex extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Tx extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Cx extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Xb extends ae{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Et.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class _x extends ae{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=we.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(a?o.metaKey:o.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class td{#t=null;#e=null;#n=null;#i=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:a,page:o,viewport:l,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:g}){this.div=t,this.#t=i,this.#e=s,this.#a=u||null,this.#r=f||null,this.#n=g||new qh,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;gs(s,this.viewport);const a=new Map,o=[],l={data:null,layer:s,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new wl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const d=u.annotationType===ye.POPUP;if(d){const b=a.get(u.id);if(!b)continue;if(!this._commentManager){o.push(u);continue}l.elements=b}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;l.data=u;const f=wh.create(l);if(!f.isRenderable)continue;if(!d&&(this.#s.push(f),u.popupRef)){const b=a.get(u.popupRef);b?b.push(f):a.set(u.popupRef,[f])}const g=f.render();u.hidden&&(g.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of o){const d=l.elements=a.get(u.id);l.data=u;const f=wh.create(l);if(!f.isRenderable)continue;const g=f.render();f.contentElement.id=`${fa}${u.id}`,u.hidden&&(g.style.visibility="hidden"),d.at(-1).container.after(g)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:s,data:{id:a}}of this.#s){const o=s.id=`${fa}${a}`;t.push(this.#a?.getAriaAttributes(o).then(l=>{if(l)for(const[u,d]of l)s.setAttribute(u,d)}))}}this.#s.sort(({data:{rect:[s,a,o,l]}},{data:{rect:[u,d,f,g]}})=>{if(s===o&&a===l)return 1;if(u===f&&d===g)return-1;const b=l,y=a,A=(a+l)/2,x=g,w=d,C=(d+g)/2;if(A>=x&&C<=y)return-1;if(C>=b&&A<=w)return 1;const S=(s+o)/2,M=(u+f)/2;return S-M});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#r,svgFactory:new wl,parent:this};for(const s of t){s.borderStyle||=td._defaultBorderStyle,i.data=s;const a=wh.create(i);a.isRenderable&&(a.render(),a.contentElement.id=`${fa}${s.id}`,this.#s.push(a))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,gs(i,{rotation:t.rotation}),this.#l(),i.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${i}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:o}=a;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):a.append(s);const l=this.#i.get(i);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,a.id,s),l._hasNoCanvas=!1):l.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:a}=t,o=new hx({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#n});return o.render(),o.contentElement.id=`${fa}${s}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(t){const i=this.#s.findIndex(a=>a.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return xt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ua.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ul=/\r\n?|\n/g;class Te extends pt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Te.prototype,i=o=>o.isEmpty(),s=Yn.TRANSLATE_SMALL,a=Yn.TRANSLATE_BIG;return xt(this,"_keyboardManager",new zr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:i}]]))}static _type="freetext";static _editorType=Et.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Te._defaultColor||pt._defaultLineColor,this.#i=t.fontSize||Te._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){pt.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Rt.FREETEXT_SIZE:Te._defaultFontSize=i;break;case Rt.FREETEXT_COLOR:Te._defaultColor=i;break}}updateParams(t,i){switch(t){case Rt.FREETEXT_SIZE:this.#a(i);break;case Rt.FREETEXT_COLOR:this.#r(i);break}}static get defaultPropertiesToUpdate(){return[[Rt.FREETEXT_SIZE,Te._defaultFontSize],[Rt.FREETEXT_COLOR,Te._defaultColor||pt._defaultLineColor]]}get propertiesToUpdate(){return[[Rt.FREETEXT_SIZE,this.#i],[Rt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Lr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.FREETEXT_COLOR}#a(t){const i=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#i)*this.parentScale),this.#i=a,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const i=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Te._internalPadding*t,-(Te._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(Te.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",a.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Te._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,g]=this.pageDimensions,[b,y]=this.pageTranslation;let A,x;switch(this.rotation){case 0:A=t+(l[0]-b)/f,x=i+this.height-(l[1]-y)/g;break;case 90:A=t+(l[0]-b)/f,x=i-(l[1]-y)/g,[u,d]=[d,-u];break;case 180:A=t-this.width+(l[0]-b)/f,x=i-(l[1]-y)/g,[u,d]=[-u,-d];break;case 270:A=t+(l[0]-b-this.height*g)/f,x=i+(l[1]-y-this.width*f)/g,[u,d]=[-d,u];break}this.setAt(A*a,x*o,u,d)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ul,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=Te.#h(i.getData("text")||"").replaceAll(ul,`
`);if(!a)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!a.includes(`
`)){l.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:d}=l,f=[],g=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(g.push(u.nodeValue.slice(d).replaceAll(ul,"")),A!==this.editorDiv){let x=f;for(const w of this.editorDiv.childNodes){if(w===A){x=g;continue}x.push(Te.#c(w))}}f.push(u.nodeValue.slice(0,d).replaceAll(ul,""))}else if(u===this.editorDiv){let A=f,x=0;for(const w of this.editorDiv.childNodes)x++===d&&(A=g),A.push(Te.#c(w))}this.#t=`${f.join(`
`)}${a}${g.join(`
`)}`,this.#l();const b=new Range;let y=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const x=A.nodeValue.length;if(y<=x){b.setStart(A,y),b.setEnd(A,y);break}y-=x}o.removeAllRanges(),o.addRange(b)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Te._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let a=null;if(t instanceof Hb){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:g,popupRef:b,richText:y,contentsObj:A,creationDate:x,modificationDate:w},textContent:C,textPosition:S,parent:{page:{pageNumber:M}}}=t;if(!C||C.length===0)return null;a=t={annotationType:Et.FREETEXT,color:Array.from(u),fontSize:l,value:C.join(`
`),position:S,pageIndex:M-1,rect:d.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:b,comment:A?.str||null,richText:y,creationDate:x,modificationDate:w}}const o=await super.deserialize(t,i,s);return o.#i=t.fontSize,o.color=nt.makeHexColor(...t.color),o.#t=Te.#h(t.value),o._initialData=a,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=pt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((l,u)=>l!==a[u])||t.pageIndex!==o}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class at{static PRECISION=1e-4;toSVGPath(){Ht("Abstract method `toSVGPath` must be implemented.")}get box(){Ht("Abstract getter `box` must be implemented.")}serialize(t,i){Ht("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=i+t[u]*a,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=i+t[u+1]*a,l[u+1]=s+t[u]*o;return l}static _translate(t,i,s,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=i+t[o],a[o+1]=s+t[o+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,a,o){switch(o){case 90:return[1-i/s,t/a];case 180:return[1-t/s,1-i/a];case 270:return[i/s,1-t/a];default:return[t/s,i/a]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,a,o,l){return[(t+5*s)/6,(i+5*a)/6,(5*s+o)/6,(5*a+l)/6,(s+o)/2,(a+l)/2]}}class hs{#t;#e=[];#n;#i;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#p=8;static#g=2;static#u=hs.#p+hs.#g;constructor({x:t,y:i},s,a,o,l,u=0){this.#t=s,this.#h=o*a,this.#i=l,this.#r.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=hs.#p*a,this.#c=hs.#u*a,this.#d=a,this.#f.push(t,i)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),i=this.#r.subarray(16,18),[s,a,o,l]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/o,(this.#o+(t[1]-i[1])/2-a)/l,(this.#s+(i[0]-t[0])/2-s)/o,(this.#o+(i[1]-t[1])/2-a)/l]}add({x:t,y:i}){this.#s=t,this.#o=i;const[s,a,o,l]=this.#t;let[u,d,f,g]=this.#r.subarray(8,12);const b=t-f,y=i-g,A=Math.hypot(b,y);if(A<this.#c)return!1;const x=A-this.#l,w=x/A,C=w*b,S=w*y;let M=u,_=d;u=f,d=g,f+=C,g+=S,this.#f?.push(t,i);const D=-S/x,R=C/x,k=D*this.#h,F=R*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+k,g+F],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-k,g-F],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([u+k,d+F],2),this.#a.push(NaN,NaN,NaN,NaN,(u+k-s)/o,(d+F-a)/l),this.#r.set([u-k,d-F],14),this.#e.push(NaN,NaN,NaN,NaN,(u-k-s)/o,(d-F-a)/l)),this.#r.set([M,_,u,d,f,g],6),!this.isEmpty()):(this.#r.set([M,_,u,d,f,g],6),Math.abs(Math.atan2(_-d,M-u)-Math.atan2(S,C))<Math.PI/2?([u,d,f,g]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/o,((d+g)/2-a)/l),[u,d,M,_]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-s)/o,((_+d)/2-a)/l),!0):([M,_,u,d,f,g]=this.#r.subarray(0,6),this.#a.push(((M+5*u)/6-s)/o,((_+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+g)/6-a)/l,((u+f)/2-s)/o,((d+g)/2-a)/l),[f,g,u,d,M,_]=this.#r.subarray(12,18),this.#e.push(((M+5*u)/6-s)/o,((_+5*d)/6-a)/l,((5*u+f)/6-s)/o,((5*d+g)/6-a)/l,((u+f)/2-s)/o,((d+g)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,i=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#y(s);for(let a=i.length-6;a>=6;a-=6)isNaN(i[a])?s.push(`L${i[a+4]} ${i[a+5]}`):s.push(`C${i[a]} ${i[a+1]} ${i[a+2]} ${i[a+3]} ${i[a+4]} ${i[a+5]}`);return this.#v(s),s.join(" ")}#b(){const[t,i,s,a]=this.#t,[o,l,u,d]=this.#m();return`M${(this.#r[2]-t)/s} ${(this.#r[3]-i)/a} L${(this.#r[4]-t)/s} ${(this.#r[5]-i)/a} L${o} ${l} L${u} ${d} L${(this.#r[16]-t)/s} ${(this.#r[17]-i)/a} L${(this.#r[14]-t)/s} ${(this.#r[15]-i)/a} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#y(t){const[i,s,a,o]=this.#t,l=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,g,b]=this.#m();t.push(`L${(l[0]-i)/a} ${(l[1]-s)/o} L${d} ${f} L${g} ${b} L${(u[0]-i)/a} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,i,s,a,o,l){return new Yb(t,i,s,a,o,l)}getOutlines(){const t=this.#a,i=this.#e,s=this.#r,[a,o,l,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let b=0,y=d.length-2;b<y;b+=2)d[b]=(this.#f[b]-a)/l,d[b+1]=(this.#f[b+1]-o)/u;if(d[d.length-2]=(this.#s-a)/l,d[d.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#T(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let b=0;b<g;b+=2){if(isNaN(t[b])){f[b]=f[b+1]=NaN;continue}f[b]=t[b],f[b+1]=t[b+1]}g=this.#w(f,g);for(let b=i.length-6;b>=6;b-=6)for(let y=0;y<6;y+=2){if(isNaN(i[b+y])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=i[b+y],f[g+1]=i[b+y+1],g+=2}return this.#S(f,g),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#n,this.#i)}#T(t){const i=this.#r,[s,a,o,l]=this.#t,[u,d,f,g]=this.#m(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-a)/l,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-a)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-a)/l,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-a)/l],0),this.newFreeDrawOutline(b,t,this.#t,this.#d,this.#n,this.#i)}#S(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#w(t,i){const s=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[o,l,u,d]=this.#t,[f,g,b,y]=this.#m();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,b,y,NaN,NaN,NaN,NaN,(a[0]-o)/u,(a[1]-l)/d],i),i+=24}}class Yb extends at{#t;#e=new Float32Array(4);#n;#i;#a;#r;#s;constructor(t,i,s,a,o,l){super(),this.#s=t,this.#a=i,this.#t=s,this.#r=a,this.#n=o,this.#i=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,d,f,g]=this.#e;for(let b=0,y=t.length;b<y;b+=2)t[b]=(t[b]-u)/f,t[b+1]=(t[b+1]-d)/g;for(let b=0,y=i.length;b<y;b+=2)i[b]=(i[b]-u)/f,i[b+1]=(i[b+1]-d)/g}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,a],o){const l=s-t,u=a-i;let d,f;switch(o){case 0:d=at._rescale(this.#s,t,a,l,-u),f=at._rescale(this.#a,t,a,l,-u);break;case 90:d=at._rescaleAndSwap(this.#s,t,i,l,u),f=at._rescaleAndSwap(this.#a,t,i,l,u);break;case 180:d=at._rescale(this.#s,s,i,-l,u),f=at._rescale(this.#a,s,i,-l,u);break;case 270:d=at._rescaleAndSwap(this.#s,s,a,-l,-u),f=at._rescaleAndSwap(this.#a,s,a,-l,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const i=this.#s;let s=i[4],a=i[5];const o=[s,a,s,a];let l=s,u=a,d=s,f=a;const g=t?Math.max:Math.min,b=new Float32Array(4);for(let A=6,x=i.length;A<x;A+=6){const w=i[A+4],C=i[A+5];isNaN(i[A])?(nt.pointBoundingBox(w,C,o),u>C?(l=w,u=C):u===C&&(l=g(l,w)),f<C?(d=w,f=C):f===C&&(d=g(d,w))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,nt.bezierBoundingBox(s,a,...i.slice(A,A+6),b),nt.rectBoundingBox(b[0],b[1],b[2],b[3],o),u>b[1]?(l=b[0],u=b[1]):u===b[1]&&(l=g(l,b[0])),f<b[3]?(d=b[2],f=b[3]):f===b[3]&&(d=g(d,b[2]))),s=w,a=C}const y=this.#e;y[0]=o[0]-this.#n,y[1]=o[1]-this.#n,y[2]=o[2]-o[0]+2*this.#n,y[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[l,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,i,s,a,o,l=0){return new hs(t,i,s,a,o,l)}getNewOutline(t,i){const[s,a,o,l]=this.#e,[u,d,f,g]=this.#t,b=o*f,y=l*g,A=s*f+u,x=a*g+d,w=this.newOutliner({x:this.#a[0]*b+A,y:this.#a[1]*y+x},this.#t,this.#r,t,this.#i,i??this.#n);for(let C=2;C<this.#a.length;C+=2)w.add({x:this.#a[C]*b+A,y:this.#a[C+1]*y+x});return w.getOutlines()}}class Fh{#t;#e;#n;#i=[];#a=[];constructor(t,i=0,s=0,a=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:w,y:C,width:S,height:M}of t){const _=Math.floor((w-i)/l)*l,D=Math.ceil((w+S+i)/l)*l,R=Math.floor((C-i)/l)*l,k=Math.ceil((C+M+i)/l)*l,F=[_,R,k,!0],j=[D,R,k,!1];this.#i.push(F,j),nt.rectBoundingBox(_,R,D,k,o)}const u=o[2]-o[0]+2*s,d=o[3]-o[1]+2*s,f=o[0]-s,g=o[1]-s;let b=a?-1/0:1/0,y=1/0;const A=this.#i.at(a?-1:-2),x=[A[0],A[2]];for(const w of this.#i){const[C,S,M,_]=w;!_&&a?S<y?(y=S,b=C):S===y&&(b=Math.max(b,C)):_&&!a&&(S<y?(y=S,b=C):S===y&&(b=Math.min(b,C))),w[0]=(C-f)/u,w[1]=(S-g)/d,w[2]=(M-g)/d}this.#t=new Float32Array([f,g,u,d]),this.#e=[b,y],this.#n=x}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#r(t)}#r(t){const i=[],s=new Set;for(const l of t){const[u,d,f]=l;i.push([u,d,l],[u,f,l])}i.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=i.length;l<u;l+=2){const d=i[l][2],f=i[l+1][2];d.push(f),f.push(d),s.add(d),s.add(f)}const a=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,d,f,g,b]=l;s.delete(l);let y=u,A=d;for(o=[u,f],a.push(o);;){let x;if(s.has(g))x=g;else if(s.has(b))x=b;else break;s.delete(x),[u,d,f,g,b]=x,y!==u&&(o.push(y,A,u,A===d?d:f),y=u),A=A===d?f:d}o.push(y,A)}return new Mx(a,this.#t,this.#e,this.#n)}#s(t){const i=this.#a;let s=0,a=i.length-1;for(;s<=a;){const o=s+a>>1,l=i[o][0];if(l===t)return o;l<t?s=o+1:a=o-1}return a+1}#o([,t,i]){const s=this.#s(t);this.#a.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let a=s;a<this.#a.length;a++){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===i){this.#a.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[o,l]=this.#a[a];if(o!==t)break;if(o===t&&l===i){this.#a.splice(a,1);return}}}#l(t){const[i,s,a]=t,o=[[i,s,a]],l=this.#s(a);for(let u=0;u<l;u++){const[d,f]=this.#a[u];for(let g=0,b=o.length;g<b;g++){const[,y,A]=o[g];if(!(f<=y||A<=d)){if(y>=d){if(A>f)o[g][1]=f;else{if(b===1)return[];o.splice(g,1),g--,b--}continue}o[g][2]=d,A>f&&o.push([i,f,A])}}}return o}}class Mx extends at{#t;#e;constructor(t,i,s,a){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const i of this.#e){let[s,a]=i;t.push(`M${s} ${a}`);for(let o=2;o<i.length;o+=2){const l=i[o],u=i[o+1];l===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,i,s,a],o){const l=[],u=s-t,d=a-i;for(const f of this.#e){const g=new Array(f.length);for(let b=0;b<f.length;b+=2)g[b]=t+f[b]*u,g[b+1]=a-f[b+1]*d;l.push(g)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class zh extends hs{newFreeDrawOutline(t,i,s,a,o,l){return new kx(t,i,s,a,o,l)}}class kx extends Yb{newOutliner(t,i,s,a,o,l=0){return new zh(t,i,s,a,o,l)}}class he extends pt{#t=null;#e=0;#n;#i=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#p=null;#g=null;#u="";#m;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Et.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=he.prototype;return xt(this,"_keyboardManager",new zr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||he._defaultColor,this.#m=t.thickness||he._defaultThickness,this.opacity=t.opacity||he._defaultOpacity,this.#n=t.boxes||null,this.#b=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Fh(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new Fh(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#p=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#m/2+a,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:he.#E(this.#l.box,(b-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:he.#E(this.#r.box,b),path:{d:this.#r.toSVGPath()}})}const[o,l,u,d]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=d;break;case 90:{const[b,y]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*y/b,this.height=d*b/y;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=d;break;case 270:{const[b,y]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*y/b,this.height=d*b/y;break}}const{firstPoint:f}=t;this.#f=[(f[0]-o)/u,(f[1]-l)/d];const{lastPoint:g}=this.#r;this.#p=[(g[0]-o)/u,(g[1]-l)/d]}static initialize(t,i){pt.initialize(t,i),he._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Rt.HIGHLIGHT_COLOR:he._defaultColor=i;break;case Rt.HIGHLIGHT_THICKNESS:he._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#p}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Rt.HIGHLIGHT_COLOR:this.#T(i);break;case Rt.HIGHLIGHT_THICKNESS:this.#S(i);break}}static get defaultPropertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,he._defaultColor],[Rt.HIGHLIGHT_THICKNESS,he._defaultThickness]]}get propertiesToUpdate(){return[[Rt.HIGHLIGHT_COLOR,this.color||he._defaultColor],[Rt.HIGHLIGHT_THICKNESS,this.#m||he._defaultThickness],[Rt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#T(t){const i=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:i.bind(this,t,he._defaultOpacity),undo:i.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const i=this.#m,s=a=>{this.#m=a,this.#w(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Rt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new ki({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#k())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#k())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#_():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#w(t){this.#h&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#_(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,i,s,a],o){switch(o){case 90:return[1-i-a,t,a,s];case 180:return[1-t-s,1-i-a,s,a];case 270:return[i,1-t-s,a,s]}return[t,i,s,a]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=he.#E(this.#l.box,t)):s=he.#E([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:he.#E(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),vb(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#D(t){he._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#k(){return this.#h?this.rotation:0}#z(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,a]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:d,y:f,width:g,height:b}of o){const y=d*t+s,A=(1-f)*i+a;l[u]=l[u+4]=y,l[u+1]=l[u+3]=A,l[u+2]=l[u+6]=y+g*t,l[u+5]=l[u+7]=A-b*i,u+=8}return l}#R(t){return this.#l.serialize(t,this.#k())}static startHighlighting(t,i,{target:s,x:a,y:o}){const{x:l,y:u,width:d,height:f}=s.getBoundingClientRect(),g=new AbortController,b=t.combinedSignal(g),y=A=>{g.abort(),this.#j(t,A)};window.addEventListener("blur",y,{signal:b}),window.addEventListener("pointerup",y,{signal:b}),window.addEventListener("pointerdown",le,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Di,{signal:b}),s.addEventListener("pointermove",this.#O.bind(this,t),{signal:b}),this._freeHighlight=new zh({x:a,y:o},[l,u,d,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#O(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let a=null;if(t instanceof Vb){const{data:{quadPoints:x,rect:w,rotation:C,id:S,color:M,opacity:_,popupRef:D,richText:R,contentsObj:k,creationDate:F,modificationDate:j},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:Et.HIGHLIGHT,color:Array.from(M),opacity:_,quadPoints:x,boxes:null,pageIndex:Y-1,rect:w.slice(0),rotation:C,annotationElementId:S,id:S,deleted:!1,popupRef:D,richText:R,comment:k?.str||null,creationDate:F,modificationDate:j}}else if(t instanceof Jh){const{data:{inkLists:x,rect:w,rotation:C,id:S,color:M,borderStyle:{rawWidth:_},popupRef:D,richText:R,contentsObj:k,creationDate:F,modificationDate:j},parent:{page:{pageNumber:Y}}}=t;a=t={annotationType:Et.HIGHLIGHT,color:Array.from(M),thickness:_,inkLists:x,boxes:null,pageIndex:Y-1,rect:w.slice(0),rotation:C,annotationElementId:S,id:S,deleted:!1,popupRef:D,richText:R,comment:k?.str||null,creationDate:F,modificationDate:j}}const{color:o,quadPoints:l,inkLists:u,opacity:d}=t,f=await super.deserialize(t,i,s);f.color=nt.makeHexColor(...o),f.opacity=d||1,u&&(f.#m=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[g,b]=f.pageDimensions,[y,A]=f.pageTranslation;if(l){const x=f.#n=[];for(let w=0;w<l.length;w+=8)x.push({x:(l[w]-y)/g,y:1-(l[w+1]-A)/b,width:(l[w+2]-l[w])/g,height:(l[w+1]-l[w+5])/b});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const x=u[0],w={x:x[0]-y,y:b-(x[1]-A)},C=new zh(w,[0,0,g,b],1,f.#m/2,!0,.001);for(let _=0,D=x.length;_<D;_+=2)w.x=x[_]-y,w.y=b-(x[_+1]-A),C.add(w);const{id:S,clipPathId:M}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#y({highlightOutlines:C.getOutlines(),highlightId:S,clipPathId:M}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=pt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#m,quadPoints:this.#z(),outlines:this.#R(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==i[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class qb{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ht("Not implemented")}}class jt extends pt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(jt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[a,o]of Object.entries(i))s.has(a)?Object.assign(t[a],o):t[a]=o;return t}static getDefaultDrawingOptions(t){Ht("Not implemented")}static get typesMap(){Ht("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(jt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,i[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,i[a]]);return t}_updateProperty(t,i,s){const a=this._drawingOptions,o=a[i],l=u=>{a.updateProperty(i,u);const d=this.#t.updateProperty(i,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,i,s,a]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(l/o),a*(o/l)];case 180:return[1-t,1-i,s,a];case 270:return[1-i,t,s*(l/o),a*(o/l)];default:return[t,i,s,a]}}#d(){const{x:t,y:i,width:s,height:a,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(o/l),a*(l/o)];case 180:return[1-t,1-i,s,a];case 270:return[i,1-t,s*(o/l),a*(l/o)];default:return[t,i,s,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:a,rotation:o,parentRotation:l,parentDimensions:[u,d]}=this;switch((o*4+l)/90){case 1:return[1-i-a,t,a,s];case 2:return[1-t-s,1-i-a,s,a];case 3:return[i,1-t-s,a,s];case 4:return[t,i-s*(u/d),a*(d/u),s*(u/d)];case 5:return[1-i,t,s*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-i,a*(d/u),s*(u/d)];case 7:return[i-s*(u/d),1-t-a*(d/u),s*(u/d),a*(d/u)];case 8:return[t-s,i-a,s,a];case 9:return[1-i,t-s,a,s];case 10:return[1-t,1-i,s,a];case 11:return[i-a,1-t,a,s];case 12:return[t-a*(d/u),i,a*(d/u),s*(u/d)];case 13:return[1-i-s*(u/d),t-a*(d/u),s*(u/d),a*(d/u)];case 14:return[1-t,1-i-s*(u/d),a*(d/u),s*(u/d)];case 15:return[i,1-t,s*(u/d),a*(d/u)];default:return[t,i,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,a,o){Ht("Not implemented")}static startDrawing(t,i,s,a){const{target:o,offsetX:l,offsetY:u,pointerId:d,pointerType:f}=a;if(It.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:g}}=t,{width:b,height:y}=o.getBoundingClientRect(),A=jt.#i=new AbortController,x=t.combinedSignal(A);if(It.setPointer(f,d),window.addEventListener("pointerup",w=>{It.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:x}),window.addEventListener("pointercancel",w=>{It.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:x}),window.addEventListener("pointerdown",w=>{It.isSamePointerType(w.pointerType)&&(It.initializeAndAddPointerId(w.pointerId),jt.#n.isCancellable()&&(jt.#n.removeLastElement(),jt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Di,{signal:x}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),o.addEventListener("touchmove",w=>{It.isSameTimeStamp(w.timeStamp)&&le(w)},{signal:x}),t.toggleDrawing(),i._editorUndoBar?.hide(),jt.#n){t.drawLayer.updateProperties(this._currentDrawId,jt.#n.startNew(l,u,b,y,g));return}i.updateUIForDefaultProperties(this),jt.#n=this.createDrawerInstance(l,u,b,y,g),jt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(jt.#a.toSVGProperties(),jt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(It.isSameTimeStamp(t.timeStamp),!jt.#n)return;const{offsetX:i,offsetY:s,pointerId:a}=t;if(It.isSamePointerId(a)){if(It.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,jt.#n.add(i,s)),It.setTimeStamp(t.timeStamp),le(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,jt.#n=null,jt.#a=null,It.clearTimeStamp()),jt.#i&&(jt.#i.abort(),jt.#i=null,It.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,jt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=jt.#n,a=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(a,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:Rt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Rt.DRAW_STEP),!jt.#n.isEmpty()){const{pageDimensions:[s,a],scale:o}=i,l=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:jt.#n.getOutlines(s*o,a*o,o,this._INNER_MARGIN),drawingOptions:jt.#a,mustBeCommitted:!t});return this._cleanup(!0),l}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,a,o,l){Ht("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}=i.viewport,d=this.deserializeDraw(l,u,a,o,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[a,o]=this.pageDimensions;return this.#t.serialize([i,s,a,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class Dx{#t=new Float64Array(6);#e;#n;#i;#a;#r;#s="";#o=0;#c=new jr;#l;#d;constructor(t,i,s,a,o,l){this.#l=s,this.#d=a,this.#i=o,this.#a=l,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#r=[t,i],this.#n=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#a=i)}#h(t,i){return at._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,a,o,l]=this.#t.subarray(2,6),u=t-o,d=i-l;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,i),isNaN(s)?(this.#t.set([o,l,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,o,l,t,i],0),this.#e.push(...at.createBezierPoints(s,a,o,l,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,a,o){this.#l=s,this.#d=a,this.#i=o,[t,i]=this.#h(t,i);const l=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#r=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:a}=this.#n[t];this.#e=s,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=at.svgRound(this.#e[4]),i=at.svgRound(this.#e[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#r.length<=6){const a=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,a)} M ${t} ${i}`,this.#o=6}if(this.#r.length===4){const a=at.svgRound(this.#e[10]),o=at.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${a} ${o}`,this.#o=12,this.#s}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let a=this.#o,o=this.#e.length;a<o;a+=6){const[l,u,d,f,g,b]=this.#e.slice(a,a+6).map(at.svgRound);s.push(`C${l} ${u} ${d} ${f} ${g} ${b}`)}return this.#s+=s.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,i,s,a){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,i,s,this.#i,this.#a,a),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class jr extends at{#t;#e=0;#n;#i;#a;#r;#s;#o;#c;build(t,i,s,a,o,l,u){this.#a=i,this.#r=s,this.#s=a,this.#o=o,this.#c=l,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${at.svgRound(i[4])} ${at.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${at.svgRound(i[10])} ${at.svgRound(i[11])}`);continue}for(let s=6,a=i.length;s<a;s+=6){const[o,l,u,d,f,g]=i.subarray(s,s+6).map(at.svgRound);t.push(`C${o} ${l} ${u} ${d} ${f} ${g}`)}}return t.join("")}serialize([t,i,s,a],o){const l=[],u=[],[d,f,g,b]=this.#d();let y,A,x,w,C,S,M,_,D;switch(this.#o){case 0:D=at._rescale,y=t,A=i+a,x=s,w=-a,C=t+d*s,S=i+(1-f-b)*a,M=t+(d+g)*s,_=i+(1-f)*a;break;case 90:D=at._rescaleAndSwap,y=t,A=i,x=s,w=a,C=t+f*s,S=i+d*a,M=t+(f+b)*s,_=i+(d+g)*a;break;case 180:D=at._rescale,y=t+s,A=i,x=-s,w=a,C=t+(1-d-g)*s,S=i+f*a,M=t+(1-d)*s,_=i+(f+b)*a;break;case 270:D=at._rescaleAndSwap,y=t+s,A=i+a,x=-s,w=-a,C=t+(1-f-b)*s,S=i+(1-d-g)*a,M=t+(1-f)*s,_=i+(1-d)*a;break}for(const{line:R,points:k}of this.#i)l.push(D(R,y,A,x,w,o?new Array(R.length):null)),u.push(D(k,y,A,x,w,o?new Array(k.length):null));return{lines:l,points:u,rect:[C,S,M,_]}}static deserialize(t,i,s,a,o,{paths:{lines:l,points:u},rotation:d,thickness:f}){const g=[];let b,y,A,x,w;switch(d){case 0:w=at._rescale,b=-t/s,y=i/a+1,A=1/s,x=-1/a;break;case 90:w=at._rescaleAndSwap,b=-i/a,y=-t/s,A=1/a,x=1/s;break;case 180:w=at._rescale,b=t/s+1,y=-i/a,A=-1/s,x=1/a;break;case 270:w=at._rescaleAndSwap,b=i/a+1,y=t/s+1,A=-1/a,x=-1/s;break}if(!l){l=[];for(const S of u){const M=S.length;if(M===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(M===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const _=new Float32Array(3*(M-2));l.push(_);let[D,R,k,F]=S.subarray(0,4);_.set([NaN,NaN,NaN,NaN,D,R],0);for(let j=4;j<M;j+=2){const Y=S[j],X=S[j+1];_.set(at.createBezierPoints(D,R,k,F,Y,X),(j-2)*3),[D,R,k,F]=[k,F,Y,X]}}}for(let S=0,M=l.length;S<M;S++)g.push({line:w(l[S].map(_=>_??NaN),b,y,A,x),points:w(u[S].map(_=>_??NaN),b,y,A,x)});const C=new this.prototype.constructor;return C.build(g,s,a,1,d,f,o),C}#l(t=this.#c){const i=this.#n+t/2*this.#s;return this.#o%180===0?[i/this.#a,i/this.#r]:[i/this.#r,i/this.#a]}#d(){const[t,i,s,a]=this.#t,[o,l]=this.#l(0);return[t+o,i+l,s-2*o,a-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#i){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)nt.pointBoundingBox(a[u],a[u+1],t);continue}let o=a[4],l=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,g,b,y,A,x]=a.subarray(u,u+6);nt.bezierBoundingBox(o,l,f,g,b,y,A,x,t),o=A,l=x}}const[i,s]=this.#l();t[0]=Oe(t[0]-i,0,1),t[1]=Oe(t[1]-s,0,1),t[2]=Oe(t[2]+i,0,1),t[3]=Oe(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[a,o]=this.#l(),[l,u]=[a-i,o-s],d=this.#t;return d[0]-=l,d[1]-=u,d[2]+=2*l,d[3]+=2*u,d}updateParentDimensions([t,i],s){const[a,o]=this.#l();this.#a=t,this.#r=i,this.#s=s;const[l,u]=this.#l(),d=l-a,f=u-o,g=this.#t;return g[0]-=d,g[1]-=f,g[2]+=2*d,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(at.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,a=0,o=0,l=0,u=0,d=0;switch(this.#e){case 90:a=i/t,o=-t/i,u=t;break;case 180:s=-1,l=-1,u=t,d=i;break;case 270:a=-i/t,o=t/i,d=i;break;default:return""}return`matrix(${s} ${a} ${o} ${l} ${at.svgRound(u)} ${at.svgRound(d)})`}getPathResizingSVGProperties([t,i,s,a]){const[o,l]=this.#l(),[u,d,f,g]=this.#t;if(Math.abs(f-o)<=at.PRECISION||Math.abs(g-l)<=at.PRECISION){const w=t+s/2-(u+f/2),C=i+a/2-(d+g/2);return{path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:`${this.rotationTransform} translate(${w} ${C})`}}}const b=(s-2*o)/(f-2*o),y=(a-2*l)/(g-2*l),A=f/s,x=g/a;return{path:{"transform-origin":`${at.svgRound(u)} ${at.svgRound(d)}`,transform:`${this.rotationTransform} scale(${A} ${x}) translate(${at.svgRound(o)} ${at.svgRound(l)}) scale(${b} ${y}) translate(${at.svgRound(-o)} ${at.svgRound(-l)})`}}}getPathResizedSVGProperties([t,i,s,a]){const[o,l]=this.#l(),u=this.#t,[d,f,g,b]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=a,Math.abs(g-o)<=at.PRECISION||Math.abs(b-l)<=at.PRECISION){const C=t+s/2-(d+g/2),S=i+a/2-(f+b/2);for(const{line:M,points:_}of this.#i)at._translate(M,C,S,M),at._translate(_,C,S,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*o)/(g-2*o),A=(a-2*l)/(b-2*l),x=-y*(d+o)+t+o,w=-A*(f+l)+i+l;if(y!==1||A!==1||x!==0||w!==0)for(const{line:C,points:S}of this.#i)at._rescale(C,x,w,y,A,C),at._rescale(S,x,w,y,A,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[a,o]=s,l=this.#t,u=t-l[0],d=i-l[1];if(this.#a===a&&this.#r===o)for(const{line:f,points:g}of this.#i)at._translate(f,u,d,f),at._translate(g,u,d,g);else{const f=this.#a/a,g=this.#r/o;this.#a=a,this.#r=o;for(const{line:b,points:y}of this.#i)at._rescale(b,u,d,f,g,b),at._rescale(y,u,d,f,g,y);l[2]*=f,l[3]*=g}return l[0]=t,l[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t[0])} ${at.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class zl extends qb{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:pt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new zl(this._viewParameters);return t.updateAll(this),t}}class ed extends jt{static _type="ink";static _editorType=Et.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){pt.initialize(t,i),this._defaultDrawingOptions=new zl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return xt(this,"typesMap",new Map([[Rt.INK_THICKNESS,"stroke-width"],[Rt.INK_COLOR,"stroke"],[Rt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,a,o){return new Dx(t,i,s,a,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,a,o,l){return jr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){let a=null;if(t instanceof Jh){const{data:{inkLists:l,rect:u,rotation:d,id:f,color:g,opacity:b,borderStyle:{rawWidth:y},popupRef:A,richText:x,contentsObj:w,creationDate:C,modificationDate:S},parent:{page:{pageNumber:M}}}=t;a=t={annotationType:Et.INK,color:Array.from(g),thickness:y,opacity:b,paths:{points:l},boxes:null,pageIndex:M-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:x,comment:w?.str||null,creationDate:C,modificationDate:S}}const o=await super.deserialize(t,i,s);return o._initialData=a,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new Lr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Rt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=ed.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:pt._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==i[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class jh extends jr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const hl=8,Er=3;class da{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,a){return s-=t,a-=i,s===0?a>0?0:4:s===1?a+6:2-a}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const g=(-f+d-u+16)%8,b=this.#n[2*g],y=this.#n[2*g+1];if(t[(s+b)*i+(a+y)]!==0)return g}return-1}static#a(t,i,s,a,o,l,u){const d=this.#e(s,a,o,l);for(let f=0;f<8;f++){const g=(f+d+u+16)%8,b=this.#n[2*g],y=this.#n[2*g+1];if(t[(s+b)*i+(a+y)]!==0)return g}return-1}static#r(t,i,s,a){const o=t.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=t[g]<=a?1:0;for(let g=1;g<s-1;g++)l[g*i]=l[g*i+i-1]=0;for(let g=0;g<i;g++)l[g]=l[i*s-1-g]=0;let u=1,d;const f=[];for(let g=1;g<s-1;g++){d=1;for(let b=1;b<i-1;b++){const y=g*i+b,A=l[y];if(A===0)continue;let x=g,w=b;if(A===1&&l[y-1]===0)u+=1,w-=1;else if(A>=1&&l[y+1]===0)u+=1,w+=1,A>1&&(d=A);else{A!==1&&(d=Math.abs(A));continue}const C=[b,g],S=w===b+1,M={isHole:S,points:C,id:u,parent:0};f.push(M);let _;for(const Q of f)if(Q.id===d){_=Q;break}_?_.isHole?M.parent=S?_.parent:d:M.parent=S?d:_.parent:M.parent=S?d:0;const D=this.#i(l,i,g,b,x,w,0);if(D===-1){l[y]=-u,l[y]!==1&&(d=Math.abs(l[y]));continue}let R=this.#n[2*D],k=this.#n[2*D+1];const F=g+R,j=b+k;x=F,w=j;let Y=g,X=b;for(;;){const Q=this.#a(l,i,Y,X,x,w,1);R=this.#n[2*Q],k=this.#n[2*Q+1];const it=Y+R,lt=X+k;C.push(lt,it);const et=Y*i+X;if(l[et+1]===0?l[et]=-u:l[et]===1&&(l[et]=u),it===g&&lt===b&&Y===F&&X===j){l[y]!==1&&(d=Math.abs(l[y]));break}else x=Y,w=X,Y=it,X=lt}}}return f}static#s(t,i,s,a){if(s-i<=4){for(let F=i;F<s-2;F+=2)a.push(t[F],t[F+1]);return}const o=t[i],l=t[i+1],u=t[s-4]-o,d=t[s-3]-l,f=Math.hypot(u,d),g=u/f,b=d/f,y=g*l-b*o,A=d/u,x=1/f,w=Math.atan(A),C=Math.cos(w),S=Math.sin(w),M=x*(Math.abs(C)+Math.abs(S)),_=x*(1-M+M**2),D=Math.max(Math.atan(Math.abs(S+C)*_),Math.atan(Math.abs(S-C)*_));let R=0,k=i;for(let F=i+2;F<s-2;F+=2){const j=Math.abs(y-g*t[F+1]+b*t[F]);j>R&&(k=F,R=j)}R>(f*D)**2?(this.#s(t,i,k+2,a),this.#s(t,k,s,a)):a.push(o,l)}static#o(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,a,o,l){const u=new Float32Array(l**2),d=-2*a**2,f=l>>1;for(let w=0;w<l;w++){const C=(w-f)**2;for(let S=0;S<l;S++)u[w*l+S]=Math.exp((C+(S-f)**2)/d)}const g=new Float32Array(256),b=-2*o**2;for(let w=0;w<256;w++)g[w]=Math.exp(w**2/b);const y=t.length,A=new Uint8Array(y),x=new Uint32Array(256);for(let w=0;w<s;w++)for(let C=0;C<i;C++){const S=w*i+C,M=t[S];let _=0,D=0;for(let k=0;k<l;k++){const F=w+k-f;if(!(F<0||F>=s))for(let j=0;j<l;j++){const Y=C+j-f;if(Y<0||Y>=i)continue;const X=t[F*i+Y],Q=u[k*l+j]*g[Math.abs(X-M)];_+=X*Q,D+=Q}}const R=A[S]=Math.round(_/D);x[R]++}return[A,x]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let a=-1/0,o=1/0;for(let u=0,d=s.length;u<d;u++){const f=s[u]=t[u<<2];a=Math.max(a,f),o=Math.min(o,f)}const l=255/(a-o);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-o)*l;return s}static#h(t){let i,s=-1/0,a=-1/0;const o=t.findIndex(d=>d!==0);let l=o,u=o;for(i=o;i<256;i++){const d=t[i];d>s&&(i-l>a&&(a=i-l,u=i-1),s=d,l=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:a}=t,{maxDim:o}=this.#t;let l=s,u=a;if(s>o||a>o){let y=s,A=a,x=Math.log2(Math.max(s,a)/o);const w=Math.floor(x);x=x===w?w-1:w;for(let S=0;S<x;S++){l=Math.ceil(y/2),u=Math.ceil(A/2);const M=new OffscreenCanvas(l,u);M.getContext("2d").drawImage(t,0,0,y,A,0,0,l,u),y=l,A=u,t!==i&&t.close(),t=M.transferToImageBitmap()}const C=Math.min(o/l,o/u);l=Math.round(l*C),u=Math.round(u*C)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const g=f.getImageData(0,0,l,u).data;return[this.#d(g),l,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:a},o,l,u,d){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const b=200,y=g.font=`${s} ${a} ${b}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:x,actualBoundingBoxAscent:w,actualBoundingBoxDescent:C,fontBoundingBoxAscent:S,fontBoundingBoxDescent:M,width:_}=g.measureText(t),D=1.5,R=Math.ceil(Math.max(Math.abs(A)+Math.abs(x)||0,_)*D),k=Math.ceil(Math.max(Math.abs(w)+Math.abs(C)||b,Math.abs(S)+Math.abs(M)||b)*D);f=new OffscreenCanvas(R,k),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=y,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,R,k),g.fillStyle="black",g.fillText(t,R*(D-1)/2,k*(3-D)/2);const F=this.#d(g.getImageData(0,0,R,k).data),j=this.#l(F),Y=this.#h(j),X=this.#r(F,R,k,Y);return this.processDrawnLines({lines:{curves:X,width:R,height:k},pageWidth:o,pageHeight:l,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,i,s,a,o){const[l,u,d]=this.#f(t),[f,g]=this.#c(l,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),b=this.#h(g),y=this.#r(f,u,d,b);return this.processDrawnLines({lines:{curves:y,width:u,height:d},pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:l,areContours:u}){a%180!==0&&([i,s]=[s,i]);const{curves:d,width:f,height:g}=t,b=t.thickness??0,y=[],A=Math.min(i/f,s/g),x=A/i,w=A/s,C=[];for(const{points:M}of d){const _=l?this.#o(M):M;if(!_)continue;C.push(_);const D=_.length,R=new Float32Array(D),k=new Float32Array(3*(D===2?2:D-2));if(y.push({line:k,points:R}),D===2){R[0]=_[0]*x,R[1]=_[1]*w,k.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[F,j,Y,X]=_;F*=x,j*=w,Y*=x,X*=w,R.set([F,j,Y,X],0),k.set([NaN,NaN,NaN,NaN,F,j],0);for(let Q=4;Q<D;Q+=2){const it=R[Q]=_[Q]*x,lt=R[Q+1]=_[Q+1]*w;k.set(at.createBezierPoints(F,j,Y,X,it,lt),(Q-2)*3),[F,j,Y,X]=[Y,X,it,lt]}}if(y.length===0)return null;const S=u?new jh:new jr;return S.build(y,i,s,1,a,u?0:b,o),{outline:S,newCurves:C,areContours:u,thickness:b,width:f,height:g}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:a,height:o}){let l=1/0,u=-1/0,d=0;for(const _ of t){d+=_.length;for(let D=2,R=_.length;D<R;D++){const k=_[D]-_[D-2];l=Math.min(l,k),u=Math.max(u,k)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const g=t.length,b=hl+Er*g,y=new Uint32Array(b);let A=0;y[A++]=b*Uint32Array.BYTES_PER_ELEMENT+(d-2*g)*f.BYTES_PER_ELEMENT,y[A++]=0,y[A++]=a,y[A++]=o,y[A++]=i?0:1,y[A++]=Math.max(0,Math.floor(s??0)),y[A++]=g,y[A++]=f.BYTES_PER_ELEMENT;for(const _ of t)y[A++]=_.length-2,y[A++]=_[0],y[A++]=_[1];const x=new CompressionStream("deflate-raw"),w=x.writable.getWriter();await w.ready,w.write(y);const C=f.prototype.constructor;for(const _ of t){const D=new C(_.length-2);for(let R=2,k=_.length;R<k;R++)D[R-2]=_[R]-_[R-2];w.write(D)}w.close();const S=await new Response(x.readable).arrayBuffer();return new Uint8Array(S).toBase64()}static async decompressSignature(t){try{const i=Uint8Array.fromBase64(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),o=a.getWriter();await o.ready,o.write(i).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const _ of s)l||=new Uint8Array(new Uint32Array(_.buffer,0,4)[0]),l.set(_,u),u+=_.length;const d=new Uint32Array(l.buffer,0,l.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=d[2],b=d[3],y=d[4]===0,A=d[5],x=d[6],w=d[7],C=[],S=(hl+Er*x)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(w){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(l.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(l.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(l.buffer,S);break}u=0;for(let _=0;_<x;_++){const D=d[Er*_+hl],R=new Float32Array(D+2);C.push(R);for(let k=0;k<Er-1;k++)R[k]=d[Er*_+hl+k+1];for(let k=0;k<D;k++)R[k+2]=R[k]+M[u++]}return{areContours:y,thickness:A,outlines:C,width:g,height:b}}catch(i){return wt(`decompressSignature: ${i}`),null}}}class id extends qb{constructor(){super(),super.updateProperties({fill:pt._defaultLineColor,"stroke-width":0})}clone(){const t=new id;return t.updateAll(this),t}}class nd extends zl{constructor(t){super(t),super.updateProperties({stroke:pt._defaultLineColor,"stroke-width":1})}clone(){const t=new nd(this._viewParameters);return t.updateAll(this),t}}class Xi extends jt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=Et.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){pt.initialize(t,i),this._defaultDrawingOptions=new id,this._defaultDrawnSignatureOptions=new nd(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return xt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:a,mustSmooth:o,areContours:l,description:u,uuid:d,heightInPage:f}=this.#n,{rawDims:{pageWidth:g,pageHeight:b},rotation:y}=this.parent.viewport,A=da.processDrawnLines({lines:a,pageWidth:g,pageHeight:b,rotation:y,innerMargin:Xi._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(A,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:a,height:o}=this.#n,l=Math.max(a,o),u=da.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:s,width:a,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,a){const{x:o,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof jh,this.description=s;let d;this.#t?d=Xi.getDefaultDrawingOptions():(d=Xi._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let g=i/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return da.process(t,i,s,a,Xi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:a},rotation:o}=this.parent.viewport;return da.extractContoursFromText(t,i,s,a,o,Xi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return da.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:Xi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Xi.getDefaultDrawingOptions():(this._drawingOptions=Xi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(o),t?(o.paths={lines:i,points:s},o.uuid=this.#i,o.isCopy=!0):o.lines=i,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,i,s,a,o,l){return l.areContours?jh.deserialize(t,i,s,a,o,l):jr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){const a=await super.deserialize(t,i,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#i=t.uuid,a}}class Nx extends pt{#t=null;#e=null;#n=null;#i=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Et.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){pt.initialize(t,i)}static isHandlingMimeForPasting(t){return kh.includes(t)}static paste(t,i){i.pasteEditor({mode:Et.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:o,height:l,channels:a.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),i&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#p(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#a){const s=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=kh.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#p();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#p()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#m()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[a,o]=this.pageDimensions,l=.75;if(this.width)i=this.width*a,s=this.height*o;else if(i>l*a||s>l*o){const d=Math.min(l*a/i,l*o/s);i*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/a,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:a,height:o}=this.#t,l=new qi;let u=this.#t,d=a,f=o,g=null;if(i){if(a>i||o>i){const k=Math.min(i/a,i/o);d=Math.floor(a*k),f=Math.floor(o*k)}g=document.createElement("canvas");const y=g.width=Math.ceil(d*l.sx),A=g.height=Math.ceil(f*l.sy);this.#l||(u=this.#u(y,A));const x=g.getContext("2d");x.filter=this._uiManager.hcmFilter;let w="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":ZA.isDarkMode&&(w="#8f8f9d",C="#42414d");const S=15,M=S*l.sx,_=S*l.sy,D=new OffscreenCanvas(M*2,_*2),R=D.getContext("2d");R.fillStyle=w,R.fillRect(0,0,M*2,_*2),R.fillStyle=C,R.fillRect(0,0,M,_),R.fillRect(M,_,M,_),x.fillStyle=x.createPattern(D,"repeat"),x.fillRect(0,0,y,A),x.drawImage(u,0,0,u.width,u.height,0,0,y,A)}let b=null;if(s){let y,A;if(l.symmetric&&u.width<t&&u.height<t)y=u.width,A=u.height;else if(u=this.#t,a>t||o>t){const C=Math.min(t/a,t/o);y=Math.floor(a*C),A=Math.floor(o*C),this.#l||(u=this.#u(y,A))}const w=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,y,A),b={width:y,height:A,data:w.getImageData(0,0,y,A).data}}return{canvas:g,width:d,height:f,imageData:b}}#u(t,i){const{width:s,height:a}=this.#t;let o=s,l=a,u=this.#t;for(;o>2*t||l>2*i;){const d=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(u,0,0,d,f,0,0,o,l),u=g.transferToImageBitmap()}return u}#m(){const[t,i]=this.parentDimensions,{width:s,height:a}=this,o=new qi,l=Math.ceil(s*t*o.sx),u=Math.ceil(a*i*o.sy),d=this.#s;if(!d||d.width===l&&d.height===u)return;d.width=l,d.height=u;const f=this.#l?this.#t:this.#u(l,u),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#b(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,a=Math.round(this.width*i*xa.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*xa.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(a,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let a=null,o=!1;if(t instanceof Xb){const{data:{rect:w,rotation:C,id:S,structParent:M,popupRef:_,richText:D,contentsObj:R,creationDate:k,modificationDate:F},container:j,parent:{page:{pageNumber:Y}},canvas:X}=t;let Q,it;X?(delete t.canvas,{id:Q,bitmap:it}=s.imageManager.getFromCanvas(j.id,X),X.remove()):(o=!0,t._hasNoCanvas=!0);const lt=(await i._structTree.getAriaAttributes(`${fa}${S}`))?.get("aria-label")||"";a=t={annotationType:Et.STAMP,bitmapId:Q,bitmap:it,pageIndex:Y-1,rect:w.slice(0),rotation:C,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:lt},isSvg:!1,structParent:M,popupRef:_,richText:D,comment:R?.str||null,creationDate:k,modificationDate:F}}const l=await super.deserialize(t,i,s),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:g,isSvg:b,accessibilityData:y}=t;o?(s.addMissingCanvas(t.id,l),l.#o=!0):g&&s.imageManager.isValidId(g)?(l.#e=g,d&&(l.#t=d)):l.#i=f,l.#l=b;const[A,x]=l.pageDimensions;return l.width=(u[2]-u[0])/A,l.height=(u[3]-u[1])/x,y&&(l.altTextData=y),l._initialData=a,t.comment&&l.setCommentData(t),l.#d=!!a,l}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#b(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:o}=this.serializeAltText(!1);if(!a&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const l=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#b(!1);else if(this.#l){const u=i.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#b(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===i,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class mn{#t;#e=!1;#n=null;#i=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#p=null;#g=-1;#u;static _initialized=!1;static#m=new Map([Te,ed,Nx,he,Xi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:a,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:d,viewport:f,l10n:g}){const b=[...mn.#m.values()];if(!mn._initialized){mn._initialized=!0;for(const y of b)y.initialize(g,t)}t.registerEditorTypes(b),this.#u=t,this.pageIndex=i,this.div=s,this.#t=o,this.#n=l,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Et.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case Et.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Et.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Et.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===Et.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of mn.#m.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#b(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#p?.abort(),this.#p=null;const t=new Set;for(const s of this.#b)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#p){this.#p=new AbortController;const a=this.#u.combinedSignal(this.#p);this.#h.div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:d,timeStamp:f}=o,g=this.#g;if(f-g>500){this.#g=f;return}this.#g=-1;const{classList:b}=this.div;b.toggle("getElements",!0);const y=document.elementsFromPoint(u,d);if(b.toggle("getElements",!1),!this.div.contains(y[0]))return;let A;const x=new RegExp(`^${kr}[0-9]+$`);for(const C of y)if(x.test(C.id)){A=C.id;break}if(!A)return;const w=this.#r.get(A);w?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),w.dblclick(o))},{signal:a,capture:!0})}const t=this.#n,i=[];if(t){const a=new Map,o=new Map;for(const u of this.#b){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else o.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const l=t.getEditableAnnotations();for(const u of l){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=o.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const a of mn.#m.values())s.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=we.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),he.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),pt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#r.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#y(){return mn.#m.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#T(t){const i=this.#y;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#S(),o=this.getNextId(),l=this.#T({parent:this,id:o,x:s,y:a,uiManager:this.#u,isCentered:!0,...i});l&&this.add(l)}async deserialize(t){return await mn.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const a=this.getNextId(),o=this.#T({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:i,width:s,height:a}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,i),u=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,i+a),f=(o+u)/2-t,g=(l+d)/2-i,[b,y]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:b,offsetY:y}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===Et.STAMP||s===Et.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===Et.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#y.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,i,s){const a=this.#u.findParent(i,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,gs(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,gs(this.div,{rotation:s}),i!==s)for(const a of this.#r.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Le{#t=null;#e=new Map;#n=new Map;static#i=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return xt(this,"_svgFactory",new wl)}static#a(t,[i,s,a,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*i}%`,l.width=`${100*a}%`,l.height=`${100*o}%`}#r(){const t=Le._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Le._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${i}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const o=Le._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),a}#o(t,i){for(const[s,a]of Object.entries(i))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,i=!1,s=!1){const a=Le.#i++,o=this.#r(),l=Le._svgFactory.createElement("defs");o.append(l);const u=Le._svgFactory.createElement("path");l.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(a,u);const f=s?this.#s(l,d):null,g=Le._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(o,t),this.#e.set(a,o),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Le.#i++,a=this.#r(),o=Le._svgFactory.createElement("defs");a.append(o);const l=Le._svgFactory.createElement("path");o.append(l);const u=`path_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(i){const b=Le._svgFactory.createElement("mask");o.append(b),d=`mask_${s}`,b.setAttribute("id",d),b.setAttribute("maskUnits","objectBoundingBox");const y=Le._svgFactory.createElement("rect");b.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const A=Le._svgFactory.createElement("use");b.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Le._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const g=f.cloneNode();return a.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:a,rootClass:o,path:l}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&Le.#a(u,a),o){const{classList:d}=u;for(const[f,g]of Object.entries(o))d.toggle(f,g)}if(l){const f=u.firstElementChild.firstElementChild;this.#o(f,l)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Fh};globalThis.pdfjsLib={AbortException:Xn,AnnotationEditorLayer:mn,AnnotationEditorParamsType:Rt,AnnotationEditorType:Et,AnnotationEditorUIManager:Yn,AnnotationLayer:td,AnnotationMode:Hn,AnnotationType:ye,applyOpacity:tw,build:ox,ColorPicker:ki,createValidAbsoluteUrl:fb,CSSConstants:JA,DOMSVGFactory:wl,DrawLayer:Le,FeatureTest:we,fetchData:Or,findContrastColor:ew,getDocument:zb,getFilenameFromUrl:qA,getPdfFilenameFromUrl:$A,getRGB:Fr,getUuid:gb,getXfaPageViewport:WA,GlobalWorkerOptions:Aa,ImageKind:ml,InvalidPDFException:_h,isDataScheme:Dl,isPdfFile:Vh,isValidExplicitDest:dw,MathClamp:Oe,noContextMenu:Di,normalizeUnicode:XA,OPS:Dr,OutputScale:qi,PagesMapper:Pt,PasswordResponses:BA,PDFDataRangeTransport:jb,PDFDateString:Mh,PDFWorker:Rr,PermissionFlag:OA,PixelsPerInch:xa,RenderingCancelledException:Gh,renderRichText:bb,ResponseException:vl,setLayerDimensions:gs,shadow:xt,SignatureExtractor:da,stopEvent:le,SupportedImageMimeTypes:kh,TextLayer:fi,TouchManager:Nl,updateUrlHash:mb,Util:nt,VerbosityLevel:Cl,version:rx,XfaLayer:pb};const Rx=({isOpen:h,onClose:t,onConfirm:i})=>{const[s,a]=ct.useState(!1);return h?T.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl relative overflow-hidden flex flex-col max-h-[90vh]",children:[T.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsxs("div",{className:"p-6 md:p-8 flex flex-col h-full overflow-hidden",children:[T.jsx("h2",{className:"text-lg md:text-xl font-bold text-[#007db5] text-center uppercase tracking-wider mb-6 leading-tight",children:Z("uploadConfirm.heading")}),T.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 mb-6 text-sm text-gray-600 leading-relaxed space-y-4 custom-scrollbar",children:[T.jsx("p",{children:Z("uploadConfirm.body1")}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:Z("uploadConfirm.repWarrantiesHeading")}),T.jsx("p",{children:Z("uploadConfirm.repWarrantiesBody")}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:Z("uploadConfirm.liabilityHeading")}),T.jsx("p",{className:"uppercase",children:Z("uploadConfirm.liabilityBody")}),T.jsx("h3",{className:"font-bold text-gray-800 uppercase text-xs tracking-wider",children:Z("uploadConfirm.indemnificationHeading")}),T.jsx("p",{children:Z("uploadConfirm.indemnificationBody")})]}),T.jsxs("label",{className:"flex items-start space-x-3 mb-8 cursor-pointer group flex-shrink-0",children:[T.jsx("div",{className:"flex items-center h-5 mt-0.5",children:T.jsx("input",{type:"checkbox",checked:s,onChange:o=>a(o.target.checked),className:"w-5 h-5 rounded border-gray-300 text-[#007db5] focus:ring-[#007db5] cursor-pointer transition-colors"})}),T.jsx("span",{className:"text-sm font-semibold text-gray-800 group-hover:text-black transition-colors",children:Z("uploadConfirm.agreeLabel")})]}),T.jsxs("div",{className:"flex space-x-4 flex-shrink-0",children:[T.jsx("button",{onClick:t,className:"flex-1 py-3 bg-[#007db5] text-white font-bold uppercase tracking-widest text-xs hover:bg-[#006da0] transition-colors rounded shadow-md",children:Z("uploadConfirm.cancel")}),T.jsx("button",{onClick:i,disabled:!s,className:`flex-1 py-3 font-bold uppercase tracking-widest text-xs rounded transition-all shadow-md ${s?"bg-[#007db5] text-white hover:bg-[#006da0]":"bg-[#9CA3AF] text-white cursor-not-allowed"}`,children:Z("uploadConfirm.submit")})]})]})]})}):null},Jp={white:{start:"#a8a7a7",mid:"#8e8e8e",end:"#555555"},other:{start:"#e6e5e5ff",mid:"#9e9e9e",end:"#656565"}},sd=h=>{const t=h==="white"?Jp.white:Jp.other;return`linear-gradient(90deg, ${t.start} 0%, ${t.mid} 50%, ${t.end} 100%)`},tb={white:{start:"#b9b8b8",mid:"#9c9c9c",end:"#5e5e5e"},other:{start:"#f5f4f4",mid:"#aeaeae",end:"#717171"}},$b=h=>h==="white"?tb.white:tb.other,Sa=h=>!h||typeof h!="string"?"none":`url("${h.replace(/"/g,'\\"')}")`;Aa.workerSrc=new URL("./pdf.worker.min.js",import.meta.url).toString();const Lx=1024,dl=(h,t,i,s,a,o)=>{let l=0,u=0,d=0,f=0;const g=Math.max(0,s),b=Math.max(0,a),y=Math.min(t,g+o),A=Math.min(i,b+o);for(let x=b;x<A;x++)for(let w=g;w<y;w++){const C=(x*t+w)*4;l+=h[C],u+=h[C+1],d+=h[C+2],f++}return f?{r:l/f,g:u/f,b:d/f}:{r:0,g:0,b:0}},eb=(h,t)=>{const i=h.r-t.r,s=h.g-t.g,a=h.b-t.b;return Math.sqrt(i*i+s*s+a*a)},Ox=(h,t={})=>{const{invert:i=!1,threshold:s=170,softness:a=40,gamma:o=.7}=t;for(let l=0;l<h.length;l+=4){const u=h[l],d=h[l+1],f=h[l+2],g=.299*u+.587*d+.114*f;let y=(i?g-s:s-g)/a*255;y<0&&(y=0),y>255&&(y=255),o!==1&&y>0&&(y=Math.pow(y/255,o)*255),y<25?y=0:y>230&&(y=255),h[l]=0,h[l+1]=0,h[l+2]=0,h[l+3]=Math.round(y)}},Bx=h=>{const t=h.naturalWidth||h.width,i=h.naturalHeight||h.height;if(!t||!i)return null;const s=Math.min(1,Lx/Math.max(t,i)),a=Math.max(1,Math.round(t*s)),o=Math.max(1,Math.round(i*s)),l=document.createElement("canvas");l.width=a,l.height=o;const u=l.getContext("2d",{willReadFrequently:!0});if(!u)return null;u.drawImage(h,0,0,a,o);let d;try{d=u.getImageData(0,0,a,o)}catch(b){return console.warn("Failed to read image data for metal mask:",b),null}const f=d.data;let g=!1;for(let b=3;b<f.length;b+=4)if(f[b]<250){g=!0;break}if(g)for(let b=0;b<f.length;b+=4){const y=f[b+3];f[b]=0,f[b+1]=0,f[b+2]=0,f[b+3]=y}else{const b=Math.max(2,Math.round(Math.min(a,o)*.04)),y=[dl(f,a,o,0,0,b),dl(f,a,o,a-b,0,b),dl(f,a,o,0,o-b,b),dl(f,a,o,a-b,o-b,b)],A=y.reduce((j,Y)=>({r:j.r+Y.r/y.length,g:j.g+Y.g/y.length,b:j.b+Y.b/y.length}),{r:0,g:0,b:0});let x=0;for(const j of y)x=Math.max(x,eb(j,A));const w=.299*A.r+.587*A.g+.114*A.b,C=w<130,S=C?Math.min(230,w+45):Math.max(25,w-45),M=45,_=Math.min(100,Math.max(14,x*2.2)),D=18;let R=0;const k=a*o;for(let j=0;j<f.length;j+=4){const Y=f[j],X=f[j+1],Q=f[j+2];if(f[j+3]<10){f[j]=0,f[j+1]=0,f[j+2]=0,f[j+3]=0;continue}const lt=eb({r:Y,g:X,b:Q},A);let et=0;lt>_&&(lt<_+D?et=Math.round((lt-_)/D*255):et=255);const st=.299*Y+.587*X+.114*Q;let H=(C?st-S:S-st)/M*255;H<0&&(H=0),H>255&&(H=255);let J=Math.max(et,H);J>0&&J<255&&(J=Math.pow(J/255,.65)*255),J<20?J=0:J>230&&(J=255),J>0&&R++,f[j]=0,f[j+1]=0,f[j+2]=0,f[j+3]=J}const F=R/Math.max(1,k);(F>.95||F<.01)&&Ox(f,{invert:C,threshold:S,softness:M,gamma:.7})}return u.putImageData(d,0,0),l.toDataURL("image/png")},Fx=({setView:h,setGraphic:t,graphicInput:i,activeTab:s,selectedColor:a})=>{const o=ct.useRef(null),[l,u]=ct.useState(!1),[d,f]=ct.useState(!1),[g,b]=ct.useState(null),[y,A]=ct.useState(null),x=.67,w=1.5,C=async j=>{const Y=j.target.files[0];if(!Y)return;b(null),f(!0),u(!1),A(null);const X=Y.type,Q=Y.name.toLowerCase();try{let it="";if(X==="application/pdf"||Q.endsWith(".pdf"))try{it=await D(Y)}catch(et){console.error("PDF Render error:",et),b(Z("upload.errorPdf")),f(!1);return}else it=await _(Y);const lt=new Image;lt.onload=()=>{const et=(lt.naturalWidth||lt.width)/(lt.naturalHeight||lt.height);if(et<x||et>w){b(Z("upload.errorAspectRatio",{ratio:et.toFixed(2)})),f(!1),o.current&&(o.current.value="");return}let st=null;try{st=Bx(lt)}catch(B){console.warn("Failed to generate metal mask:",B)}A({src:it,name:Y.name,isUpload:!0,scale:.5,fileType:Q.split(".").pop(),maskSrc:st}),f(!1),u(!0)},lt.onerror=()=>{b(Z("upload.errorLoadImage")),f(!1)},lt.src=it}catch(it){console.error(it),b(Z("upload.errorProcessing")),f(!1)}},S=()=>{y&&(t(y),A(null),u(!1))},M=()=>{A(null),u(!1),o.current&&(o.current.value="")},_=j=>new Promise((Y,X)=>{const Q=new FileReader;Q.onload=it=>Y(it.target.result),Q.onerror=it=>X(it),Q.readAsDataURL(j)}),D=async j=>{const Y=await j.arrayBuffer(),Q=await(await zb({data:Y,disableWorker:!0}).promise).getPage(1),it=Q.getViewport({scale:2}),lt=document.createElement("canvas");lt.width=it.width,lt.height=it.height;const et=lt.getContext("2d");return await Q.render({canvasContext:et,viewport:it}).promise,lt.toDataURL("image/png")},R=()=>{t(null),o.current&&(o.current.value="")},k=Z(s==="FRONT"?"tab.front":"tab.back"),F=sd(a);return T.jsxs("div",{className:"w-full h-full flex flex-col p-4 md:p-8 overflow-y-auto pb-32",children:[T.jsx("input",{type:"file",ref:o,onChange:C,accept:"image/png, image/jpeg, image/jpg, image/bmp, image/svg+xml, application/pdf",className:"hidden"}),T.jsx(Tl,{setView:h,activeView:"upload",activeTab:s}),T.jsx("div",{className:"mb-6",children:T.jsxs("button",{onClick:()=>h("main"),className:"flex items-center text-[#002C5F] font-bold text-sm tracking-widest uppercase hover:text-brand-blue transition-colors group",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 transform group-hover:-translate-x-1 transition-transform",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),k]})}),g&&T.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-3",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-xs font-bold text-red-700 uppercase tracking-wide mb-1",children:Z("upload.uploadFailed")}),T.jsx("p",{className:"text-xs text-red-600",children:g})]})]}),d?T.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[T.jsx("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("span",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:Z("upload.processing")})]}):i?T.jsxs("div",{className:"flex flex-col items-center w-full animate-fade-in-up",children:[T.jsx("div",{className:"w-full aspect-square max-w-[200px] border-2 border-dashed border-gray-300 rounded bg-gray-50 flex items-center justify-center p-4 mb-6 relative overflow-hidden",children:i.maskSrc?T.jsx("div",{className:"w-full h-full",style:{maskImage:Sa(i.maskSrc),WebkitMaskImage:Sa(i.maskSrc),maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:F,filter:"contrast(1.1) brightness(1.1)",opacity:.95}}):T.jsx("img",{src:i.src,alt:Z("upload.previewAlt"),className:"max-w-full max-h-full object-contain",style:{filter:"grayscale(100%) contrast(1.2) brightness(1.2)"}})}),T.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 w-full",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:Z("upload.sizeLabel")}),T.jsxs("span",{className:"text-xs font-bold text-gray-500",children:[Math.round((i.scale||.5)*100),"%"]})]}),T.jsx("input",{type:"range",min:"0.2",max:"1.0",step:"0.05",value:i.scale||.5,onChange:j=>t({...i,scale:parseFloat(j.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#002C5F]"})]}),T.jsx("button",{onClick:R,className:"text-xs font-bold text-red-500 underline hover:text-red-700 uppercase tracking-wider mb-2",children:Z("upload.removeImage")}),T.jsx("p",{className:"text-[10px] text-gray-400 text-center",children:Z("upload.placementHint")})]}):T.jsxs("div",{className:"flex flex-col w-full animate-fade-in-up",children:[T.jsx("button",{onClick:()=>o.current.click(),className:"w-full py-4 bg-white border-2 border-[#002C5F] text-[#002C5F] font-bold text-sm tracking-widest uppercase rounded hover:bg-gray-50 transition-colors mb-6 shadow-sm",children:Z("upload.uploadDesign")}),T.jsx("p",{className:"text-center text-xs text-gray-700 font-semibold mb-8 uppercase tracking-wide",children:Z("upload.acceptedTypes")}),T.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-8",children:[T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsx("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900",children:T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),T.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),T.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:Z("upload.iconImageSize").split(`
`).map((j,Y)=>T.jsxs("span",{children:[j,Y===0&&T.jsx("br",{})]},Y))})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsx("span",{className:"font-serif font-bold text-2xl",children:"TM"}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:Z("upload.iconNoTrademark")})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsx("span",{className:"font-sans font-bold text-3xl",children:""}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:Z("upload.iconNoCopyright")})]}),T.jsxs("div",{className:"flex flex-col items-center text-center",children:[T.jsxs("div",{className:"w-14 h-14 mb-2 flex items-center justify-center text-gray-900 relative",children:[T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[T.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),T.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-0.5 bg-gray-900 rotate-45 transform origin-center"})})]}),T.jsx("span",{className:"text-[10px] leading-tight text-gray-800 font-medium",children:Z("upload.iconNoPhotos")})]})]}),T.jsx("div",{className:"w-full h-px bg-gray-200 mb-6"}),T.jsxs("div",{className:"mb-4 space-y-4",children:[T.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-widest mb-4 text-center",children:Z("upload.instructionsHeading")}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:Z("upload.instruction1")}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:Z("upload.instruction2")}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:Z("upload.instruction3")}),T.jsx("p",{className:"text-xs text-gray-700 font-medium leading-relaxed text-left",children:Z("upload.instruction4")})]})]}),T.jsx(Rx,{isOpen:l,onClose:M,onConfirm:S})]})},Fe=[{name:"ITC Modern",style:{fontFamily:"ITC Modern",fontSize:"1.8em"},maxLength:1,frontSize:"1.1em",backSize:"8.2em",frontSizeMobile:"0.84em",backSizeMobile:"3.8em"},{name:"Nexa Script",style:{fontFamily:"Nexa Script",fontSize:"1.8em"},maxLength:1,frontSize:"1.2em",backSize:"7em",frontSizeMobile:"0.84em",backSizeMobile:"4.2em"},{name:"Roman",style:{fontFamily:"Roman",fontSize:"1.2em"},middleLarger:!0,frontSize:"0.96em",backSize:"4.64em",frontSizeMobile:"0.66em",backSizeMobile:"2.4em"},{name:"rJ#",style:{fontFamily:"Two Character Circle",fontSize:"1.2em",marginLeft:"0.1em"},frontSize:"1.2em",backSize:"7.4em",frontSizeMobile:"0.72em",backSizeMobile:"3.6em",useCircleGlyphs:!0},{name:"N-Gram",style:{fontFamily:"Two Character N-Gram",fontSize:"1.2em",marginLeft:"0.1em"},frontSize:"1.2em",backSize:"6.6em",frontSizeMobile:"0.72em",backSizeMobile:"3.7em",useNGramGlyphs:!0},{name:"Vine",style:{fontFamily:"Vine",fontSize:"1.2em",letterSpacing:".55em",marginLeft:"0.6em"},frontSize:"0.96em",backSize:"2.8em",frontSizeMobile:"0.6em",backSizeMobile:"1.3em"}],Kb={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"0",K:"!",L:"@",M:"#",N:"$",O:"%",P:"^",Q:"&",R:"*",S:"(",T:")",U:"-",V:"+",W:"[",X:"]",Y:"\\",Z:":"},jl=(h,t)=>{if(!h)return"";const i=h.toUpperCase();if(h.length===2)return i[0].toLowerCase()+i[1];if(h.length===3){const s=i[0].toLowerCase(),a=i[1],o=Kb[i[2]]||i[2];return s+a+o}return h},Pl=h=>h===2?"Two Character Circle":h===3?"Three Character Circle":"Two Character Circle",Il=h=>{if(!h)return"";const t=h.toUpperCase();if(h.length===2)return"?"+t[0].toLowerCase()+t[1];if(h.length===3){const i=t[0].toLowerCase(),s=t[1],a=Kb[t[2]]||t[2];return"?"+i+s+a}return h},Ul=h=>h===2?"Two Character N-Gram":h===3?"Three Character N-Gram":"Two Character N-Gram",Hl=h=>Fe.find(i=>i.name===h)?.useNGramGlyphs===!0,Gl=h=>Fe.find(i=>i.name===h)?.useCircleGlyphs===!0,pa=(h,t,i,s=!1)=>{const a=Fe.find(u=>u.name===h),o=s?`max(4px, min(${150/Math.max(1,i)}cqi, 17cqi))`:`max(4px, min(${150/Math.max(1,i)}cqi, 20cqi))`;if(!a)return o;let l;return s?l=t==="FRONT"?a.frontSizeMobile:a.backSizeMobile:l=t==="FRONT"?a.frontSize:a.backSize,l||o},Pr=(h,t)=>{const i=Fe.find(s=>s.name===h);return i?i.useCircleGlyphs||i.useNGramGlyphs?t===2||t===3:(i.maxLength===1,t>=1):!1},Wb={FRONT:{text:{top:"32.4%",left:"36%",right:"36%",bottom:"62%"},monogram:{top:"29%",left:"33%",right:"33%",bottom:"58%"},graphic:{top:"33%",left:"36%",right:"36%",bottom:"62%"},boundary:{top:"32.5%",left:"35%",right:"34%",bottom:"61%"}},BACK:{text:{top:"39%",left:"36%",right:"36%",bottom:"31%"},textVertical:{top:"40%",left:"36%",right:"36%",bottom:"25%"},monogram:{top:"28%",left:"26%",right:"26%",bottom:"26%"},graphic:{top:"33%",left:"36%",right:"36%",bottom:"31%"},boundary:{top:"40.5%",left:"35.5%",right:"36%",bottom:"31%"},boundaryVertical:{top:"39%",left:"35.5%",right:"36%",bottom:"25%"}}},Qb={FRONT:{text:{top:"32.4%",left:"36%",right:"36%",bottom:"62%"},monogram:{top:"28%",left:"33%",right:"33%",bottom:"57%"},graphic:{top:"27.5%",left:"36%",right:"36%",bottom:"56.6%"},boundary:{top:"32.5%",left:"35%",right:"34%",bottom:"61%"}},BACK:{text:{top:"38%",left:"36%",right:"36%",bottom:"31%"},textVertical:{top:"40.5%",left:"38%",right:"38%",bottom:"27%"},monogram:{top:"30%",left:"26%",right:"26%",bottom:"24%"},graphic:{top:"33%",left:"22%",right:"22%",bottom:"31%"},boundary:{top:"39.5%",left:"36%",right:"36%",bottom:"31%"},boundaryVertical:{top:"38%",left:"36%",right:"36%",bottom:"21%"}}},xl={mobile:{FRONT:.38,BACK:.54},test:{FRONT:.24,BACK:.48},desktop:{FRONT:.78,BACK:.9}},xh=({side:h,customization:t,selectedColor:i,selectedFont:s,selectedMonogram:a,fonts:o,isMobile:l,isImageLoading:u,setIsImageLoading:d,view:f,monogramScale:g=1})=>{const b=f==="capture",y=h==="BACK"&&t.BACK?.isVertical,A=yt=>{if(g===1||!yt)return yt;const Lt=yt.match(/^([\d.]+)(em|px|rem|cqi)$/i);return Lt?`${(parseFloat(Lt[1])*g).toFixed(2)}${Lt[2]}`:`calc(${yt} * ${g})`},x=yt=>{const Lt=yt[h];return{...Lt,text:y&&Lt.textVertical?Lt.textVertical:Lt.text,boundary:y&&Lt.boundaryVertical?Lt.boundaryVertical:Lt.boundary}},C={FRONT:{text:"top-[30%] md:top-[32.4%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[62%] md:bottom-[62%]",monogram:"top-[25.2%] md:top-[29%] left-[33%] md:left-[33%] right-[33%] md:right-[33%] bottom-[57%] md:bottom-[58%]",graphic:"top-[26%] md:top-[33%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[61%] md:bottom-[62%]",boundary:"top-[31%] md:top-[32.5%] left-[35%] md:left-[35%] right-[34%] md:right-[34%] bottom-[63%] md:bottom-[61%]",zoom:"scale-[1.7] translate-y-[25%] md:scale-[2.5] md:translate-y-[25%]"},BACK:{text:h==="BACK"&&t.BACK?.isVertical?"top-[38%] md:top-[40%] left-[38%] md:left-[36%] right-[38%] md:right-[36%] bottom-[25%] md:bottom-[25%]":"top-[38%] md:top-[39%] left-[36%] md:left-[36%] right-[36%] md:right-[36%] bottom-[31%] md:bottom-[31%]",monogram:"top-[30%] md:top-[28%] left-[26%] md:left-[26%] right-[26%] md:right-[26%] bottom-[24%] md:bottom-[26%]",graphic:"top-[33%] md:top-[33%] left-[20%] md:left-[36%] right-[20%] md:right-[36%] bottom-[31%] md:bottom-[31%]",boundary:h==="BACK"&&t.BACK?.isVertical?"top-[38%] md:top-[39%] left-[36%] md:left-[35.5%] right-[36%] md:right-[36%] bottom-[21%] md:bottom-[25%]":"top-[39.5%] md:top-[40.5%] left-[36%] md:left-[35.5%] right-[36%] md:right-[35%] bottom-[31%] md:bottom-[31%]",zoom:"scale-[1.4] translate-y-[1%] md:scale-[2.5] md:translate-y-[-4%]"}}[h],S=x(b&&l?Qb:Wb),M=t[h],_=M.text,D=M.monogram,R=M.graphic,k=R?.isUpload?R.maskSrc||R.src:R?.src,[F,j]=ct.useState(!1),[Y,X]=ct.useState(null);ct.useEffect(()=>{if(k){if(b){X(k);return}if(k===Y)return;j(!0);const yt=new Image;yt.onload=()=>{X(k),j(!1)},yt.onerror=()=>{X(k),j(!1)},yt.src=k}else X(null),j(!1)},[k,b]);const Q=()=>{d&&d(!1)},it=yt=>{console.warn("Image load error",yt.target.src),d&&d(!1)},lt=yt=>b?{position:"absolute",...S[yt]}:{},et=yt=>b?"absolute":`absolute ${C[yt]}`,st=b?{width:"300px",height:"500px",transform:"none",marginBottom:0,position:"relative"}:{},B=b?"":`relative mb-4 md:mb-2 transition-transform duration-300 ease-in-out w-[240px] h-[360px] md:w-[420px] md:h-[700px] ${f&&f!=="main"?C.zoom:""}`,J=`${(l?xl.mobile:xl.desktop)[h]*100}%`,ft=sd(i),At=R&&(!R.isUpload||R.maskSrc)?Y:null,L=ct.useRef(null),G=ct.useRef(null),[q,tt]=ct.useState({width:0,height:0}),[ht,bt]=ct.useState(null),[mt,Qt]=ct.useState(0),Ot=o.find(yt=>yt.name===s)?.style||{},gi=Ot.fontFamily||"sans-serif";Ot.fontWeight,Ot.fontStyle,ct.useEffect(()=>{let yt=!1;return(async()=>{try{document?.fonts?.load&&await document.fonts.load(`16px ${gi}`),document?.fonts?.ready&&await document.fonts.ready}finally{yt||Qt(ze=>ze+1)}})(),()=>{yt=!0}},[gi]),ct.useLayoutEffect(()=>{const yt=L.current;if(!yt)return;const Lt=()=>{tt({width:yt.offsetWidth||0,height:yt.offsetHeight||0})};Lt();let ze;return typeof ResizeObserver<"u"&&(ze=new ResizeObserver(Lt),ze.observe(yt)),window.addEventListener("resize",Lt),()=>{window.removeEventListener("resize",Lt),ze&&ze.disconnect()}},[h,b,l,i,M?.isVertical,!!_]);const de=ct.useMemo(()=>q.width?Math.max(1,(h==="FRONT"?.18:.54)*q.width):null,[q.width,h]),pi=ct.useMemo(()=>{if(!(h==="BACK"&&M?.isVertical)||!_||!q.height)return null;const Lt=q.height/100,ze=Math.max(1,_.length),Pe=Math.max(8,Math.min(150/ze*Lt,54*Lt)),rt=Math.max(1,...String(_).split(`
`).map(_e=>Math.max(1,_e.length))),dt=1.2;if(rt>3)return Pe;const Kt=l?.9:.92,ne=q.height*Kt/(rt*dt);let Ce=Math.min(Pe,ne);if(rt<=2&&q.width){const _e=l?.86:.9,pn=q.width*_e/dt;Ce=Math.min(Ce,pn)}return Math.max(8,Ce)},[h,M?.isVertical,_,q.height,q.width,l]);return ct.useLayoutEffect(()=>{const yt=h==="BACK"&&M?.isVertical;if(!_||yt){bt(null);return}if(!de||!q.width||!q.height)return;const Lt=q.width,ze=q.height,Pe=G.current;if(!Pe)return;const rt=l?.91:.92,dt=Lt*rt,Kt=ze*rt,ne=Ni=>{Pe.style.fontSize=`${Ni}px`;const Ri=Pe.offsetWidth||0,Xl=Pe.offsetHeight||0;return Ri<=dt&&Xl<=Kt};let Ce=1,_e=de,pn=1;for(let Ni=0;Ni<16;Ni++){const Ri=(Ce+_e)/2;ne(Ri)?(pn=Ri,Ce=Ri):_e=Ri}const Ie=l?.92:.9,Vl=!b&&!l&&f&&f!=="main"?.95:1,Ea=Math.max(1,pn*Ie*Vl);bt(Ni=>Ni&&Math.abs(Ni-Ea)<.05?Ni:Ea)},[_,h,M?.isVertical,de,q.width,q.height,mt,l,b,f]),T.jsx("div",{className:"flex flex-col items-center",children:T.jsxs("div",{className:B,style:st,children:[T.jsx("img",{src:`bottle/${h==="FRONT"?"front":"back"}/${i}${h==="BACK"?"back":""}.webp`,alt:Z("bottlePreview.alt",{side:h}),loading:"eager",className:`w-full h-full object-contain mix-blend-multiply drop-shadow-2xl transition-opacity duration-300 ${u?"opacity-0":"opacity-100"}`,onLoad:Q,onError:it}),u&&!b&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-10 h-10 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin"})}),_&&T.jsxs("div",{ref:L,className:`${et("text")} flex items-center justify-center z-20 pointer-events-none overflow-hidden`,style:{containerType:"inline-size",...lt("text"),writingMode:h==="BACK"&&M.isVertical?"vertical-rl":void 0,textOrientation:h==="BACK"&&M.isVertical?"sideways":void 0,glyphOrientationVertical:h==="BACK"&&M.isVertical?"90deg":void 0},children:[!(h==="BACK"&&M.isVertical)&&de&&T.jsx("span",{ref:G,"aria-hidden":"true",style:{position:"absolute",left:-99999,top:-99999,visibility:"hidden",pointerEvents:"none",...o.find(yt=>yt.name===s)?.style,fontSize:`${de}px`,letterSpacing:"0.5px",whiteSpace:"pre",wordBreak:"normal",overflowWrap:"normal",lineHeight:1.2,display:"inline-block"},children:_}),T.jsx("span",{className:"text-center block",style:{...o.find(yt=>yt.name===s)?.style,fontSize:h==="BACK"&&M.isVertical?pi?`${pi}px`:`max(8px, min(${150/Math.max(1,_.length)}cqi, 54cqi))`:ht?`${ht}px`:h==="FRONT"?`max(4px, min(${100/Math.max(1,_.length)}cqi, 18cqi))`:`max(8px, min(${150/Math.max(1,_.length)}cqi, 54cqi))`,letterSpacing:"0.5px",...h==="BACK"&&M.isVertical?{wordBreak:"break-word",whiteSpace:"pre-wrap"}:{wordBreak:"normal",overflowWrap:"normal",whiteSpace:"pre"},lineHeight:1.2,fontVariantEmoji:"text",verticalAlign:"middle",textRendering:"geometricPrecision",boxSizing:"border-box",width:h==="BACK"&&M.isVertical?"fit-content":"100%",height:h==="BACK"&&M.isVertical?"100%":void 0,maxWidth:"100%",display:h==="BACK"&&M.isVertical?"inline-block":"block",marginInline:h==="BACK"&&M.isVertical?"auto":void 0,background:ft,WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",WebkitTextFillColor:"transparent"},children:_})]},`text-${i}`),R&&T.jsxs("div",{className:`${et("graphic")} flex items-center justify-center z-20 pointer-events-none overflow-hidden`,style:{containerType:"inline-size",transform:R.scale?`scale(${R.scale})`:"none",transformOrigin:"center center",...lt("graphic")},children:[F&&!b&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-[#002C5F] rounded-full animate-spin"})}),Y&&!F&&T.jsx(T.Fragment,{children:At?T.jsx("div",{className:"w-full h-full transition-opacity duration-200",style:{maskImage:Sa(At),WebkitMaskImage:Sa(At),maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:ft,filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",opacity:.95,maxHeight:J,maxWidth:J}}):T.jsx("img",{src:R.src,alt:R.name||Z("bottlePreview.uploadedImageAlt"),className:"w-full h-full object-contain transition-opacity duration-200",style:{filter:"grayscale(100%) contrast(1.2) brightness(1.2)",maxHeight:J,maxWidth:J}})})]},`graphic-${i}-${Y}`),D&&Pr(a,D.length)&&T.jsx("div",{className:`${et("monogram")} flex items-center justify-center z-20 pointer-events-none`,style:{containerType:"inline-size",...lt("monogram")},children:Gl(a)?T.jsx("span",{className:"text-center whitespace-nowrap block",style:{fontFamily:Pl(D.length),fontSize:A(pa(a,h,D.length,b?!1:l)),lineHeight:1.4,background:ft,WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:jl(D)}):Hl(a)?T.jsx("span",{className:"text-center whitespace-nowrap block",style:{...Fe.find(yt=>yt.name===a)?.style,fontFamily:Ul(D.length),fontSize:A(pa(a,h,D.length,b?!1:l)),lineHeight:1.4,background:ft,WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:Il(D)}):Fe.find(yt=>yt.name===a)?.middleLarger&&D.length===3?T.jsxs("span",{className:"text-center whitespace-nowrap block",style:{...Fe.find(yt=>yt.name===a)?.style,fontSize:A(pa(a,h,D.length,b?!1:l)),display:"inline-flex",alignItems:"center",lineHeight:1.4,background:ft,WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:[T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"0.2em":"0.75em"},children:D[0]}),T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"1.3em":"1em"},children:D[1]}),T.jsx("span",{style:{fontSize:l&&h==="FRONT"?"0.2em":"0.75em"},children:D[2]})]}):T.jsx("span",{className:"text-center whitespace-nowrap block",style:{...Fe.find(yt=>yt.name===a)?.style,fontSize:A(pa(a,h,D.length,b?!1:l)),lineHeight:a==="Vine"?2.4:1.4,marginLeft:a==="Vine"?0:void 0,paddingLeft:a==="Vine"?"0.6em":void 0,paddingTop:a==="Vine"?"0.3em":void 0,paddingBottom:a==="Vine"?"0.3em":void 0,background:ft,WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",WebkitTextFillColor:"transparent"},children:Fe.find(yt=>yt.name===a)?.maxLength===1?D.charAt(0):D})},`monogram-${i}-${a}`),f&&f!=="main"&&!b&&T.jsx("div",{className:`absolute ${C.boundary} border border-dashed border-gray-400/60 rounded-sm pointer-events-none transition-opacity duration-300 ${u?"opacity-0":"opacity-100"}`})]})})},ib=({side:h,customization:t,selectedColor:i,selectedFont:s,selectedMonogram:a,fonts:o,monogramScale:l=1})=>{const u=t[h],d=u.text,f=u.monogram,g=u.graphic,b=`${Math.round(180*l)}px`,y=sd(i),A=g?g.isUpload?g.maskSrc:g.src:null,x=ct.useRef(null),w=ct.useRef(null),[C,S]=ct.useState({width:0,height:0}),[M,_]=ct.useState(null),[D,R]=ct.useState(0),k=o.find(X=>X.name===s)?.style||{},F=k.fontFamily||"sans-serif";k.fontWeight,k.fontStyle,ct.useEffect(()=>{let X=!1;return(async()=>{try{document?.fonts?.load&&await document.fonts.load(`16px ${F}`),document?.fonts?.ready&&await document.fonts.ready}finally{X||R(it=>it+1)}})(),()=>{X=!0}},[F]),ct.useLayoutEffect(()=>{const X=x.current;if(!X)return;const Q=()=>{S({width:X.offsetWidth||0,height:X.offsetHeight||0})};Q();let it;return typeof ResizeObserver<"u"&&(it=new ResizeObserver(Q),it.observe(X)),window.addEventListener("resize",Q),()=>{window.removeEventListener("resize",Q),it&&it.disconnect()}},[h,u?.isVertical]);const j=ct.useMemo(()=>72,[]);ct.useLayoutEffect(()=>{const X=h==="BACK"&&u?.isVertical;if(!d||X){_(null);return}if(!C.width||!C.height)return;const Q=Math.max(0,C.width-20),it=Math.max(0,C.height-20),lt=w.current;if(!lt)return;const et=.92,st=Q*et,B=it*et,H=q=>{lt.style.fontSize=`${q}px`;const tt=lt.offsetWidth||0,ht=lt.offsetHeight||0;return tt<=st&&ht<=B};let J=1,ft=j,At=1;for(let q=0;q<16;q++){const tt=(J+ft)/2;H(tt)?(At=tt,J=tt):ft=tt}const G=Math.max(1,At*.9);_(q=>q&&Math.abs(q-G)<.05?q:G)},[d,h,u?.isVertical,C.width,C.height,j,D]);const Y={width:"300px",height:"300px",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"};return T.jsxs("div",{style:Y,children:[d&&T.jsxs("div",{ref:x,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",padding:"10px",boxSizing:"border-box",writingMode:h==="BACK"&&u.isVertical?"vertical-rl":void 0},children:[!(h==="BACK"&&u.isVertical)&&T.jsx("span",{ref:w,"aria-hidden":"true",style:{position:"absolute",left:-99999,top:-99999,visibility:"hidden",pointerEvents:"none",...o.find(X=>X.name===s)?.style,fontSize:`${j}px`,letterSpacing:"0.5px",whiteSpace:"pre",wordBreak:"normal",overflowWrap:"normal",lineHeight:1.2,display:"inline-block"},children:d}),T.jsx("span",{style:{...o.find(X=>X.name===s)?.style,color:"#333333",fontSize:h==="BACK"&&u.isVertical?`max(16px, min(${100/Math.max(1,d.length)}cqi, 72px))`:M?`${M}px`:`max(16px, min(${100/Math.max(1,d.length)}cqi, 72px))`,letterSpacing:"0.5px",...h==="BACK"&&u.isVertical?{wordBreak:"break-word",whiteSpace:"pre-wrap"}:{wordBreak:"normal",overflowWrap:"normal",whiteSpace:"pre"},lineHeight:1.2,fontVariantEmoji:"text",textAlign:"center",verticalAlign:"middle",textRendering:"geometricPrecision",display:"block",width:"100%",containerType:"inline-size"},children:d})]}),g&&T.jsx("div",{style:{width:"80%",height:"80%",display:"flex",alignItems:"center",justifyContent:"center"},children:A?T.jsx("div",{style:{width:"100%",height:"100%",maskImage:Sa(A),WebkitMaskImage:Sa(A),maskSize:"contain",WebkitMaskSize:"contain",maskPosition:"center",WebkitMaskPosition:"center",maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",background:y,filter:"contrast(1.1) brightness(1.1) drop-shadow(0 1px 1px rgba(0,0,0,0.3))",opacity:.95}}):T.jsx("img",{src:g.src,alt:g.name,style:{width:"100%",height:"100%",objectFit:"contain",filter:"grayscale(100%) contrast(1.2) brightness(1.2)"}})}),f&&Pr(a,f.length)&&T.jsx("div",{style:{width:"80%",height:"80%",display:"flex",alignItems:"center",justifyContent:"center"},children:Gl(a)?T.jsx("span",{style:{fontFamily:Pl(f.length),color:"#333333",fontSize:b,lineHeight:1},children:jl(f)}):Hl(a)?T.jsx("span",{style:{...Fe.find(X=>X.name===a)?.style,fontFamily:Ul(f.length),color:"#333333",fontSize:b,lineHeight:1},children:Il(f)}):Fe.find(X=>X.name===a)?.middleLarger&&f.length===3?T.jsxs("span",{style:{...Fe.find(X=>X.name===a)?.style,color:"#333333",fontSize:b,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center"},children:[T.jsx("span",{style:{fontSize:"0.75em"},children:f[0]}),T.jsx("span",{style:{fontSize:"1em"},children:f[1]}),T.jsx("span",{style:{fontSize:"0.75em"},children:f[2]})]}):T.jsx("span",{style:{...Fe.find(X=>X.name===a)?.style,color:"#333333",fontSize:b,lineHeight:1},children:Fe.find(X=>X.name===a)?.maxLength===1?f.charAt(0):f})})]})},Ph=()=>{if(typeof window>"u"||typeof navigator>"u")return!1;const h=navigator.userAgent||"",t=navigator.platform||"";return!!(/iPad|iPhone|iPod/.test(h)&&!window.MSStream||t==="MacIntel"&&navigator.maxTouchPoints>1||/Safari/.test(h)&&/Apple/.test(navigator.vendor)&&"ontouchstart"in window&&navigator.maxTouchPoints>1&&(!/Macintosh/.test(h)||navigator.maxTouchPoints>1))},Zb=h=>new Promise((t,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>t(s),s.onerror=a=>i(a),s.src=h}),Ge=3,oa=300*Ge,la=500*Ge,ca=300*Ge,zx=16*Ge,Sh=(h,t,i)=>{const s=parseFloat(h.top)/100,a=parseFloat(h.bottom)/100,o=parseFloat(h.left)/100,l=parseFloat(h.right)/100,u=o*t,d=s*i,f=t-o*t-l*t,g=i-s*i-a*i;return{x:u,y:d,width:f,height:g}},Jb=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontFamily?i.style.fontFamily:"sans-serif"},ty=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontWeight?i.style.fontWeight:"normal"},ey=(h,t)=>{const i=t.find(s=>s.name===h);return i&&i.style&&i.style.fontStyle?i.style.fontStyle:"normal"},jx=(h,t,i,s,a,o)=>{const l=t.naturalWidth||t.width,u=t.naturalHeight||t.height;if(!l||!u)return;const d=Math.min(a/l,o/u),f=l*d,g=u*d,b=i+(a-f)/2,y=s+(o-g)/2;h.drawImage(t,b,y,f,g)},ad=(h,t,i)=>{const s=h.createLinearGradient(t.x,t.y+t.height/2,t.x+t.width,t.y+t.height/2),a=$b(i);return s.addColorStop(0,a.start),s.addColorStop(.5,a.mid),s.addColorStop(1,a.end),s},Px=(h,t,i)=>{const s=Math.max(1,h.length),a=t/100;if(i==="FRONT"){const o=100/s*a,l=18*a;return Math.max(4*Ge,Math.min(o,l))}else{const o=150/s*a,l=54*a;return Math.max(8*Ge,Math.min(o,l))}},iy=(h,t,i,s,a,o,l,u,d=!1)=>{if(!t)return;h.save(),h.shadowColor="rgba(0, 0, 0, 0.3)",h.shadowBlur=2*Ge,h.shadowOffsetX=0,h.shadowOffsetY=1*Ge,h.textAlign="center",h.textBaseline="middle";const f=i.x+i.width/2,g=i.y+i.height/2,b=String(t).replace(/\r\n/g,`
`).split(`
`),y=.5*Ge,A=1.2,x=.82,w=(S,M)=>{h.font=`${o} ${a} ${M}px ${s}`;const _=h.measureText(S).width,D=(S?.length||0)*y;return _+D},C=()=>{const S=1*Ge,M=Math.max(S,(u==="FRONT"?.18:.54)*i.width),_=F=>{const j=Math.max(0,...b.map(X=>w(X,F))),Y=b.length*F*A;return j<=i.width*x&&Y<=i.height*x};let D=S,R=M,k=S;for(let F=0;F<16;F++){const j=(D+R)/2;_(j)?(k=j,D=j):R=j}return k};if(d){const S=Px(t,i.height,u),M=Math.max(1,...String(t).split(`
`).map(st=>Math.max(1,st.length))),_=i.height*.92/(M*A);let D=M<=3?Math.min(S,_):S;if(M<=2){const st=i.width*.9/A;D=Math.min(D,st)}const R=Math.max(8*Ge,D);h.font=`${o} ${a} ${R}px ${s}`,h.translate(f,g),h.rotate(Math.PI/2);const k=h.createLinearGradient(0,i.width/2,0,-i.width/2),F=$b(l);k.addColorStop(0,F.start),k.addColorStop(.5,F.mid),k.addColorStop(1,F.end),h.fillStyle=k;const j=R*1.05,Y=i.height,X=[];let Q="";const it=()=>{const st=Q.replace(/^\s+/,"");st&&X.push(st),Q=""};for(const st of String(t)){if(st===`
`){it();continue}if(!Q&&(st===" "||st==="	"))continue;const B=Q+st,H=h.measureText(B).width;if(Q&&H>Y){if(it(),st===" "||st==="	")continue;Q=st}else Q=B}it(),X.length||X.push("");const et=-((X.length-1)*j)/2;X.forEach((st,B)=>{const H=et+B*j;h.fillText(st,0,H)})}else{const S=C();h.font=`${o} ${a} ${S}px ${s}`;const M=ad(h,i,l);h.fillStyle=M;const _=b.length*S*A,D=g-_/2+S*A/2;b.forEach((R,k)=>{const F=D+k*S*A;h.fillText(R,f,F)})}h.restore()},Ix=(h,t,i=zx)=>{if(!h)return i;const s=String(h).trim();if(/^[\d.]+em$/i.test(s))return parseFloat(s)*i;if(/^[\d.]+cqi$/i.test(s)){const a=parseFloat(s);return t/100*a}if(/^[\d.]+px$/i.test(s))return parseFloat(s)*Ge;if(s.startsWith("max(")||s.startsWith("min(")){const a=t/100;let o=s.replace(/([\d.]+)cqi/g,(l,u)=>String(parseFloat(u)*a));o=o.replace(/([\d.]+)px/g,(l,u)=>String(parseFloat(u)*Ge)),o=o.replace(/([\d.]+)em/g,(l,u)=>String(parseFloat(u)*i));try{const l=o.replace(/max/g,"Math.max").replace(/min/g,"Math.min");return new Function("return "+l)()}catch(l){return console.warn("Failed to parse CSS font size:",h,l),i}}return(parseFloat(s)||16)*Ge},ny=(h,t,i,s,a,o,l=1)=>{if(!t||!Pr(i,t.length))return;h.save();const u=ad(h,s,a);h.fillStyle=u,h.textAlign="center",h.textBaseline="middle";const d=s.x+s.width/2,f=s.y+s.height/2;let g=t,b="sans-serif",y=0;const A=Fe.find(C=>C.name===i),x=pa(i,o,t.length,!1),w=Ix(x,s.width)*l;if(Gl(i)?(g=jl(t),b=Pl(t.length)):Hl(i)?(g=Il(t),b=Ul(t.length),o==="BACK"&&(y=w*.05)):A&&(b=A.style?.fontFamily||"sans-serif",A.maxLength===1&&(g=t.charAt(0))),h.font=`normal normal ${w}px ${b}`,A?.middleLarger&&t.length===3){const C=w*.75,S=w;h.font=`normal normal ${C}px ${b}`;const M=h.measureText(t[0]);h.font=`normal normal ${S}px ${b}`;const _=h.measureText(t[1]);h.font=`normal normal ${C}px ${b}`;const D=h.measureText(t[2]),R=M.width+_.width+D.width;let k=d-R/2;h.font=`normal normal ${C}px ${b}`,h.fillText(t[0],k+M.width/2,f),k+=M.width,h.font=`normal normal ${S}px ${b}`,h.fillText(t[1],k+_.width/2,f),k+=_.width,h.font=`normal normal ${C}px ${b}`,h.fillText(t[2],k+D.width/2,f)}else if(i==="Vine"){const C=w*.55;let S=0;const M=[];for(let D=0;D<g.length;D++){const R=h.measureText(g[D]).width;M.push(R),S+=R,D<g.length-1&&(S+=C)}let _=d-S/2;for(let D=0;D<g.length;D++)h.fillText(g[D],_+M[D]/2,f),_+=M[D]+C}else h.fillText(g,d+y,f);h.restore()},sy=async(h,t,i,s,a=.75)=>{if(!(!t||!t.src))try{const l=(t.isUpload?t.maskSrc:t.src)||t.src,u=await Zb(l),d=t.scale||.5,f=Math.min(i.width,i.height)*a,g=u.width/u.height;let b,y;g>1?(b=f*d,y=b/g):(y=f*d,b=y*g);const A=i.x+(i.width-b)/2,x=i.y+(i.height-y)/2;if(h.save(),!t.isUpload||!!t.maskSrc){const C=document.createElement("canvas");C.width=b,C.height=y;const S=C.getContext("2d"),_=ad(S,{x:0,y:0,width:b,height:y},s);S.fillStyle=_,S.fillRect(0,0,b,y),S.globalCompositeOperation="destination-in",S.drawImage(u,0,0,b,y),h.globalAlpha=.95,h.filter="contrast(1.1) brightness(1.1) drop-shadow(0px 1px 1px rgba(0,0,0,0.3))",h.drawImage(C,A,x)}else h.filter="grayscale(100%) contrast(1.2) brightness(1.2)",h.globalCompositeOperation="source-over",h.globalAlpha=.9,h.drawImage(u,A,x,b,y);h.restore()}catch(o){console.warn("Failed to load graphic for canvas capture:",o)}},fl=async(h,t,i,s,a,o,l=1)=>{const u=document.createElement("canvas");u.width=oa,u.height=la;const d=u.getContext("2d");document.fonts&&document.fonts.ready&&await document.fonts.ready;const f=h==="FRONT"?`bottle/front/${i}.webp`:`bottle/back/${i}back.webp`;try{const S=await Zb(f);jx(d,S,0,0,oa,la)}catch(S){console.warn("Failed to load bottle image:",S),d.fillStyle="#f3f4f6",d.fillRect(0,0,oa,la)}const g=t[h],b=g?.text||"",y=g?.monogram||"",A=g?.graphic||null,x=h==="BACK"&&g?.isVertical,w=Ph(),C=w?Qb[h]:Wb[h];if(b){const S=x?C.textVertical:C.text,M=Sh(S,oa,la),_=Jb(s,o),D=ty(s,o),R=ey(s,o);iy(d,b,M,_,D,R,i,h,x)}if(y){const S=Sh(C.monogram,oa,la);ny(d,y,a,S,i,h,l)}if(A){const M=(w?xl.test:xl.desktop)[h],_=Sh(C.graphic,oa,la);await sy(d,A,_,i,M)}return u.toDataURL("image/png")},nb=async(h,t,i,s,a,o,l=1)=>{const u=t[h],d=u?.text||"",f=u?.monogram||"",g=u?.graphic||null;if(!d&&!f&&!g)return null;const b=document.createElement("canvas");b.width=ca,b.height=ca;const y=b.getContext("2d");document.fonts&&document.fonts.ready&&await document.fonts.ready,y.clearRect(0,0,ca,ca);const A=20*Ge,x={x:A,y:A,width:ca-A*2,height:ca-A*2},w=h==="BACK"&&u?.isVertical;if(d){const C=Jb(s,o),S=ty(s,o),M=ey(s,o);iy(y,d,x,C,S,M,"white",h,w)}return f&&Pr(a,f.length)&&ny(y,f,a,x,"white",h,l),g&&await sy(y,g,x,"white"),b.toDataURL("image/png")},Ux=()=>{const[h,t]=ct.useState("FRONT"),i=ct.useRef(null),s=ct.useRef(null),a=ct.useRef(null),o=ct.useRef(null),l=ct.useRef(null),[u,d]=ct.useState("black"),[f,g]=ct.useState("main"),[b,y]=ct.useState(null),[A,x]=ct.useState(!1),[w,C]=ct.useState(!1),[S,M]=ct.useState(!1),_=rt=>{C(rt),!rt&&!S&&M(!0)},[D,R]=ct.useState(!1);ct.useEffect(()=>{const rt=()=>x(window.innerWidth<768);return rt(),window.addEventListener("resize",rt),window.takeSnapshot=async()=>{if(i.current)try{const dt=await aa(i.current,{cacheBust:!0}),Kt=document.createElement("a");Kt.download=`bottle-snapshot-${Date.now()}.png`,Kt.href=dt,Kt.click(),console.log("Snapshot taken with html-to-image!")}catch(dt){console.error("Snapshot failed:",dt)}else console.warn("Bottle preview ref not found")},()=>{window.removeEventListener("resize",rt),delete window.takeSnapshot}},[]),ct.useEffect(()=>{C(!0)},[u,h]),ct.useEffect(()=>(window.setForceCanvasCapture=rt=>{R(!!rt),console.log(`[Customizer] Force canvas capture: ${!!rt}`)},window.getForceCanvasCapture=()=>D,()=>{delete window.setForceCanvasCapture,delete window.getForceCanvasCapture}),[D]);const[k,F]=ct.useState({FRONT:{text:"",monogram:""},BACK:{text:"",monogram:"",isVertical:!1}}),[j,Y]=ct.useState("BeFit"),[X,Q]=ct.useState({FRONT:"Roman",BACK:"Roman"}),it=X[h],lt=rt=>{Q(dt=>({...dt,[h]:rt}))},et=[{name:"BeFit",css:"font-sans",style:{fontFamily:'BeFit, "Noto Emoji", sans-serif'}},{name:"BeFit Slim",css:"font-sans",style:{fontFamily:'BeFit Slim, "Noto Emoji", sans-serif'}},{name:"BeFit Bold Italic",css:"font-sans font-bold italic",style:{fontFamily:'BeFit, "Noto Emoji", sans-serif',fontWeight:"bold",fontStyle:"italic"}},{name:"Sackers Gothic",css:"font-sans uppercase tracking-widest",style:{fontFamily:'Oswald, "Noto Emoji", sans-serif'}},{name:"Yearbook Solid",css:"font-serif uppercase font-black",style:{fontFamily:'Bebas Neue, "Noto Emoji", sans-serif'}},{name:"VAG Rounded Next",css:"font-sans",style:{fontFamily:'Nunito, "Noto Emoji", sans-serif'}},{name:"Samantha Script",css:"font-cursive",style:{fontFamily:'Dancing Script, "Noto Emoji", cursive'}},{name:"Nexa Script",css:"font-cursive",style:{fontFamily:'Nexa Script, "Noto Emoji", cursive'}},{name:"Cotford",css:"font-serif",style:{fontFamily:'Merriweather, "Noto Emoji", serif'}},{name:"Arial Bold",css:"font-sans font-bold",style:{fontFamily:'Arial, "Noto Emoji", sans-serif',fontWeight:"bold"}},{name:"ITC Modern No 216",css:"font-serif font-bold",style:{fontFamily:'Bodoni Moda, "Noto Emoji", serif'}},{name:"Benguiat Pro ITC Bold",css:"font-serif font-bold",style:{fontFamily:'Playfair Display, "Noto Emoji", serif',fontWeight:"bold"}},{name:"Rockwell Bold",css:"font-serif font-bold",style:{fontFamily:'Alfa Slab One, "Noto Emoji", serif'}},{name:"WHIPHAND",css:"font-display uppercase",style:{fontFamily:'Permanent Marker, "Noto Emoji", cursive',fontStyle:"italic"}},{name:"WOOD TYPE",css:"font-display uppercase tracking-wide",style:{fontFamily:'Bungee, "Noto Emoji", sans-serif'}}],st=.7,[B,H]=ct.useState(!1),[J,ft]=ct.useState(!1),[At,L]=ct.useState({front:null,back:null,frontDesign:null,backDesign:null}),G=()=>typeof window<"u"&&window.parent&&window.parent!==window?(window.parent.postMessage({type:"BOTTLE_CUSTOMIZER_CLOSE"},"*"),!0):!1,q=k[h].text,tt=k[h].monogram,ht=k[h].graphic,bt=rt=>{F(dt=>({...dt,[h]:{...dt[h],text:rt,monogram:rt?"":dt[h].monogram,graphic:rt?null:dt[h].graphic}}))},mt=rt=>{F(dt=>({...dt,[h]:{...dt[h],monogram:rt,text:rt?"":dt[h].text,graphic:rt?null:dt[h].graphic}}))},Qt=rt=>{F(dt=>({...dt,[h]:{...dt[h],graphic:rt,text:rt?"":dt[h].text,monogram:rt?"":dt[h].monogram}}))},Ot=rt=>{F(dt=>({...dt,[h]:{...dt[h],isVertical:rt}}))},gi=()=>{F(rt=>({...rt,[h]:{text:"",monogram:"",graphic:null}}))},de=rt=>new Promise(dt=>{if(!rt.current){dt();return}const Kt=rt.current.querySelectorAll("img");if(Kt.length===0){dt();return}let ne=0;const Ce=()=>{ne++,ne>=Kt.length&&dt()};Kt.forEach(_e=>{_e.complete?Ce():(_e.addEventListener("load",Ce),_e.addEventListener("error",Ce))}),setTimeout(dt,2e3)});ct.useEffect(()=>(window.takeSnapshotCanvas=async(rt="FRONT")=>{const dt=rt.toUpperCase();if(dt!=="FRONT"&&dt!=="BACK"){console.error('[takeSnapshotCanvas] Invalid side. Use "FRONT" or "BACK".');return}console.log(`[takeSnapshotCanvas] Capturing ${dt} with canvas compositor...`);try{document.fonts&&document.fonts.ready&&await document.fonts.ready;const Kt=await fl(dt,k,u,j,X[dt],et),ne=document.createElement("a");ne.download=`bottle-canvas-${dt.toLowerCase()}-${Date.now()}.png`,ne.href=Kt,ne.click(),console.log(`[takeSnapshotCanvas] ${dt} snapshot saved!`)}catch(Kt){console.error("[takeSnapshotCanvas] Failed:",Kt)}},window.compareSnapshots=async(rt="FRONT")=>{const dt=rt.toUpperCase();if(dt!=="FRONT"&&dt!=="BACK"){console.error('[compareSnapshots] Invalid side. Use "FRONT" or "BACK".');return}const Kt=dt==="FRONT"?s:a;console.log(`[compareSnapshots] Capturing ${dt} with both methods...`);try{await de(Kt),document.fonts&&document.fonts.ready&&await document.fonts.ready,await new Promise(pn=>setTimeout(pn,100));let ne=null;Kt.current&&(ne=await aa(Kt.current,{cacheBust:!0,skipAutoScale:!0}));const Ce=await fl(dt,k,u,j,X[dt],et);window.open("","_blank","width=700,height=600").document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head><title>Snapshot Comparison - ${dt}</title></head>
                    <body style="margin:0;padding:20px;background:#f0f0f0;font-family:sans-serif;">
                        <h3 style="margin:0 0 10px;">Snapshot Comparison: ${dt}</h3>
                        <div style="display:flex;gap:20px;">
                            <div style="text-align:center;">
                                <p style="margin:0 0 5px;font-weight:bold;">html-to-image</p>
                                <img src="${ne}" style="border:1px solid #ccc;max-width:300px;" />
                            </div>
                            <div style="text-align:center;">
                                <p style="margin:0 0 5px;font-weight:bold;">Canvas Compositor</p>
                                <img src="${Ce}" style="border:1px solid #ccc;max-width:300px;" />
                            </div>
                        </div>
                        <p style="margin-top:20px;font-size:12px;color:#666;">
                            Canvas should match html-to-image. If text/position differs, adjust canvasCapture.js
                        </p>
                    </body>
                    </html>
                `),console.log("[compareSnapshots] Comparison window opened!")}catch(ne){console.error("[compareSnapshots] Failed:",ne)}},()=>{delete window.takeSnapshotCanvas,delete window.compareSnapshots}),[k,u,j,X]);const pi=async()=>{try{ft(!0),C(!0);let rt=null,dt=null,Kt=null,ne=null;Ph()||D?(console.log(`[Customizer] Using canvas capture (iOS: ${Ph()}, forced: ${D})`),document.fonts&&document.fonts.ready&&await document.fonts.ready,rt=await fl("FRONT",k,u,j,X.FRONT,et,st),dt=await fl("BACK",k,u,j,X.BACK,et,st),Kt=await nb("FRONT",k,u,j,X.FRONT,et,st),ne=await nb("BACK",k,u,j,X.BACK,et,st)):(console.log("[Customizer] Using html-to-image capture"),await new Promise(_e=>requestAnimationFrame(()=>requestAnimationFrame(_e))),await Promise.all([de(s),de(a),de(o),de(l)]),await new Promise(_e=>setTimeout(_e,100)),s.current&&(rt=await aa(s.current,{cacheBust:!0,skipAutoScale:!0})),a.current&&(dt=await aa(a.current,{cacheBust:!0,skipAutoScale:!0})),o.current&&(k.FRONT.text||k.FRONT.monogram||k.FRONT.graphic)&&(Kt=await aa(o.current,{cacheBust:!0,backgroundColor:null})),l.current&&(k.BACK.text||k.BACK.monogram||k.BACK.graphic)&&(ne=await aa(l.current,{cacheBust:!0,backgroundColor:null}))),L({front:rt,back:dt,frontDesign:Kt,backDesign:ne}),C(!1),ft(!1),H(!0)}catch(rt){console.error("Failed to capture review images",rt),C(!1),ft(!1),H(!0)}},yt=q||tt||ht,Lt=()=>{y(null),g("gallery")},ze=rt=>{y(rt),g("gallery")},Pe=[{id:"black",name:Z("color.black"),bg:"bg-black",text:"text-white"},{id:"white",name:Z("color.white"),bg:"bg-white",text:"text-black",border:"border-gray-200"},{id:"aqua",name:Z("color.blue"),bg:"bg-[#2ea5d1]",text:"text-white"},{id:"red",name:Z("color.red"),bg:"bg-[#C8102E]",text:"text-white"}];return T.jsxs("div",{className:"flex flex-col h-screen bg-gray-100 font-sans text-slate-900 overflow-y-auto",children:[T.jsx("header",{id:"app-header",className:"bg-white border-b border-gray-200 z-10 relative",children:T.jsxs("div",{className:"max-w-[1920px] mx-auto px-4 md:px-6 h-14 md:h-16 flex items-center justify-between",children:[T.jsx("div",{className:"flex-shrink-0",children:T.jsx("img",{src:"logo.png",alt:"YETI",loading:"lazy",className:"h-8 md:h-10 w-auto object-contain"})}),T.jsx("nav",{className:"flex space-x-4 md:space-x-8 h-full",children:["FRONT","BACK"].map(rt=>T.jsx("button",{onClick:()=>t(rt),className:`relative h-full px-1 text-xs md:text-sm font-bold tracking-widest uppercase transition-colors
                  ${h===rt?"text-black border-b-4 border-brand-blue":"text-gray-400 hover:text-gray-600"}`,children:Z(rt==="FRONT"?"tab.front":"tab.back")},rt))}),T.jsx("button",{onClick:G,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-[#002C5F]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})}),T.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-y-auto md:overflow-hidden relative",children:[T.jsxs("div",{id:"bottle-canvas",className:"w-full md:w-[65%] flex items-center justify-center bg-[#f3f4f6] relative py-6 md:py-0 overflow-hidden min-h-[200px] md:min-h-0",children:[T.jsxs("div",{ref:i,className:"flex flex-col items-center md:mb-[100px]",children:[T.jsx(xh,{side:h,customization:k,selectedColor:u,selectedFont:j,selectedMonogram:it,fonts:et,isMobile:A,isImageLoading:w,setIsImageLoading:_,view:f}),T.jsxs("div",{className:`text-center space-y-1 md:space-y-2 hidden md:block transition-opacity duration-300 md:mb-12 md:-mt-8 ${f!=="main"?"opacity-0 pointer-events-none":"opacity-100"}`,children:[T.jsx("h2",{className:"text-xs md:text-sm font-bold text-[#002C5F] tracking-wider uppercase",children:Z("product.heading")}),T.jsx("div",{className:"flex items-center justify-center space-x-3",children:Pe.map(rt=>T.jsx("button",{onClick:()=>d(rt.id),className:`w-8 h-8 rounded-full ${rt.bg} ${rt.border||""} 
                                     ring-2 ring-offset-2 transition-all duration-200
                                     ${u===rt.id?"ring-[#002C5F]":"ring-transparent hover:ring-gray-300"}
                                 `,"aria-label":Z("color.selectAria",{color:rt.name})},rt.id))}),T.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:[Z("product.colorLabel")," ",T.jsx("span",{className:"text-black",children:Pe.find(rt=>rt.id===u)?.name})]})]})]}),T.jsx(DA,{colors:Pe,selectedColor:u,setSelectedColor:d,isMobile:A})]}),T.jsxs("div",{className:`w-full md:w-[35%] p-4 md:p-12 flex flex-col items-center justify-start flex-1 md:mb-0 md:overflow-y-auto md:pb-32 min-h-[60vh] md:min-h-0 pb-24 bg-[#f3f4f6] ${f!=="main"?"md:pb-36":""}`,children:[f==="main"&&T.jsx(CA,{setView:g,activeTab:h,openGallery:Lt,openGalleryCategory:ze}),f==="text"&&T.jsx(_A,{setView:g,textInput:q,setTextInput:bt,fonts:et,selectedFont:j,setSelectedFont:Y,activeTab:h,isVertical:k[h].isVertical,setIsVertical:Ot}),f==="monogram"&&T.jsx(MA,{setView:g,monogramInput:tt,setMonogramInput:mt,monogramStyles:Fe,selectedMonogram:it,setSelectedMonogram:lt,activeTab:h}),f==="gallery"&&T.jsx(kA,{setView:g,setGraphic:Qt,selectedGraphic:ht,activeTab:h,initialCategory:b}),f==="upload"&&T.jsx(Fx,{setView:g,setGraphic:Qt,graphicInput:ht,activeTab:h,selectedColor:u})]}),f!=="main"&&T.jsx(NA,{onRemove:gi,onReview:pi,isDisabled:!yt,isPreparing:J})]}),S&&T.jsxs("div",{style:{position:"fixed",top:0,left:"-9999px",pointerEvents:"none",zIndex:-1},children:[T.jsx("div",{ref:s,children:T.jsx(xh,{side:"FRONT",customization:k,selectedColor:u,selectedFont:j,selectedMonogram:X.FRONT,fonts:et,isMobile:!1,view:"capture",monogramScale:st})}),T.jsx("div",{ref:a,children:T.jsx(xh,{side:"BACK",customization:k,selectedColor:u,selectedFont:j,selectedMonogram:X.BACK,fonts:et,isMobile:!1,view:"capture",monogramScale:st})}),T.jsx("div",{ref:o,children:T.jsx(ib,{side:"FRONT",customization:k,selectedColor:u,selectedFont:j,selectedMonogram:X.FRONT,fonts:et,monogramScale:st})}),T.jsx("div",{ref:l,children:T.jsx(ib,{side:"BACK",customization:k,selectedColor:u,selectedFont:j,selectedMonogram:X.BACK,fonts:et,monogramScale:st})})]}),J&&T.jsxs("div",{className:"fixed inset-0 z-[60] bg-white/95 flex flex-col items-center justify-center",children:[T.jsx("div",{className:"w-14 h-14 border-4 border-gray-300 border-t-[#002C5F] rounded-full animate-spin mb-4"}),T.jsx("p",{className:"text-lg font-semibold text-[#002C5F]",children:Z("loader.preparingDesign")})]}),B&&T.jsx(LA,{onClose:()=>H(!1),onRequestClose:G,customization:k,selectedColor:u,selectedFont:j,selectedMonogramBySide:X,fonts:et,monogramStyles:Fe,convertToCircleGlyphs:jl,getCircleFontFamily:Pl,usesCircleGlyphs:Gl,convertToNGramGlyphs:Il,getNGramFontFamily:Ul,usesNGramGlyphs:Hl,getMonogramFontSize:pa,shouldDisplayMonogram:Pr,setActiveTab:t,setView:g,frontImage:At.front,backImage:At.back,frontDesignImage:At.frontDesign,backDesignImage:At.backDesign})]})};function Hx(){return T.jsx(Ux,{})}Rv.createRoot(document.getElementById("root")).render(T.jsx(ct.StrictMode,{children:T.jsx(Hx,{})}));
